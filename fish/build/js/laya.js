(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[921],{80340:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Config=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.Config=s,s.animationInterval=50,s.isAntialias=!0,s.isAlpha=!1,s.premultipliedAlpha=!0,s.isStencil=!0,s.preserveDrawingBuffer=!1,s.webGL2D_MeshAllocMaxMem=!0,s.is2DPixelArtGame=!1,s.useWebGL2=!0,s.printWebglOrder=!1,s.allowGPUInstanceDynamicBatch=!0,s.enableStaticBatch=!0,s.useRetinalCanvas=!1,window.Config=s},92493:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ILaya=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"regClass",value:function(e){t.__classMap[e.name]=e}}]),t}();e.ILaya=o,o.Laya=null,o.Timer=null,o.WorkerLoader=null,o.Dragging=null,o.GraphicsBounds=null,o.Sprite=null,o.TextRender=null,o.TextAtlas=null,o.timer=null,o.systemTimer=null,o.startTimer=null,o.updateTimer=null,o.lateTimer=null,o.physicsTimer=null,o.stage=null,o.Loader=null,o.loader=null,o.TTFLoader=null,o.SoundManager=null,o.WebAudioSound=null,o.AudioSound=null,o.ShaderCompile=null,o.ClassUtils=null,o.SceneUtils=null,o.Context=null,o.Render=null,o.MouseManager=null,o.Text=null,o.Browser=null,o.WebGL=null,o.Pool=null,o.Utils=null,o.Graphics=null,o.Submit=null,o.Stage=null,o.Resource=null,o.__classMap={}},24629:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.__init=e.Laya=void 0,e._static=function(t,e){for(var i=0,n=e.length;i<n;i+=2)if("length"==e[i])t.length=e[i+1].call(t);else{!function(){var n=e[i],a=e[i+1];(0,o.default)(t,n,{get:function(){return delete this[n],this[n]=a.call(this)},set:function(t){delete this[n],this[n]=t},enumerable:!0,configurable:!0})}()}},e.version=e.updateTimer=e.timer=e.systemTimer=e.startTimer=e.stage=e.render=e.physicsTimer=e.loader=e.lateTimer=e.isWXPosMsg=e.isWXOpenDataContext=e.init=e.enableDebugPanel=e.alertGlobalError=void 0;var r=a(i(78914)),s=a(i(3649)),o=a(i(63978)),l=a(i(47302)),u=a(i(51942)),h=a(i(15375)),c=a(i(17061)),d=i(92493),f=i(72276),_=i(93697),v=i(61891),y=i(54190),p=i(78362),g=i(77590),m=i(81870),x=i(78499),T=i(47002),k=i(33873),C=i(16313),S=i(17886),E=i(30690),M=i(85096),L=i(33063),b=i(20966),I=i(65356),R=i(84935),w=i(85136),A=i(8272),B=i(79741),D=i(26776),P=i(93894),O=i(25883),F=i(93568),U=i(17939),N=i(23835),G=i(13104),H=i(97617),W=i(64210),V=i(21383),Y=i(683),X=i(14334),z=i(52842),K=i(56083),j=i(76006),q=i(43989),Z=i(2717),Q=i(11984),$=i(56978),J=i(22245),tt=i(17),et=i(36296),it=i(30875),nt=i(56161),at=i(97441),rt=i(62285),st=i(61266),ot=i(37397),lt=i(32996),ut=i(86044),ht=i(34415),ct=i(94286),dt=i(30966),ft=i(96088),_t=i(48856),vt=i(41107),yt=i(14400),pt=i(18008),gt=i(64178),mt=i(89662),xt=i(80340),Tt=function(){function t(){(0,h.default)(this,t)}return(0,c.default)(t,null,[{key:"__init",value:function(t){(0,r.default)(t).call(t,(function(t){t.__init$&&t.__init$()}))}},{key:"init",value:function(i,n){if(!t._isinit){t._isinit=!0,(0,s.default)(ArrayBuffer.prototype)||(ArrayBuffer.prototype.slice=t._arrayBufferSlice),F.Browser.__init__();var a=F.Browser.mainCanvas=new D.HTMLCanvas(!0),r=a.source.style;r.position="absolute",r.top=r.left="0px",r.background="#000000",F.Browser.onKGMiniGame||F.Browser.onAlipayMiniGame||F.Browser.container.appendChild(a.source),F.Browser.canvas=new D.HTMLCanvas(!0),F.Browser.context=F.Browser.canvas.getContext("2d"),F.Browser.supportWebAudio=S.SoundManager.__init__(),F.Browser.supportLocalStorage=b.LocalStorage.__init__(),t.systemTimer=new z.Timer(!1),e.systemTimer=Lt=z.Timer.gSysTimer=t.systemTimer,t.startTimer=new z.Timer(!1),t.physicsTimer=new z.Timer(!1),t.updateTimer=new z.Timer(!1),t.lateTimer=new z.Timer(!1),t.timer=new z.Timer(!1),e.startTimer=bt=d.ILaya.startTimer=t.startTimer,e.lateTimer=wt=d.ILaya.lateTimer=t.lateTimer,e.updateTimer=Rt=d.ILaya.updateTimer=t.updateTimer,d.ILaya.systemTimer=t.systemTimer,e.timer=At=d.ILaya.timer=t.timer,e.physicsTimer=It=d.ILaya.physicsTimer=t.physicsTimer,t.loader=new L.LoaderManager,d.ILaya.Laya=t,e.loader=Bt=d.ILaya.loader=t.loader,j.WeakObject.__init__(),V.SceneUtils.__init(),lt.Mouse.__init__(),rt.WebGL.inner_enable();for(var o=arguments.length,l=new Array(o>2?o-2:0),u=2;u<o;u++)l[u-2]=arguments[u];if(l)for(var h=0,c=l.length;h<c;h++)l[h]&&l[h].enable&&l[h].enable();return d.ILaya.Render.isConchApp&&t.enableNative(),t.enableWebGLPlus(),U.CacheManger.beginCheck(),e.stage=Mt=t.stage=new g.Stage,d.ILaya.stage=t.stage,K.Utils.gStage=t.stage,R.URL.rootPath=R.URL._basePath=t._getUrlPath(),ct.MeshQuadTexture.__int__(),ut.MeshVG.__init__(),dt.MeshTexture.__init__(),t.render=new w.Render(0,0,F.Browser.mainCanvas),e.render=Pt=t.render,t.stage.size(i,n),window.stage=t.stage,st.WebGLContext.__init__(),ht.MeshParticle2D.__init__(),at.ShaderCompile.__init__(),A.RenderSprite.__init__(),x.KeyBoardManager.__init__(),T.MouseManager.instance.__init__(t.stage,w.Render.canvas),v.Input.__init__(),S.SoundManager.autoStopMusic=!0,Y.Stat._StatRender=new X.StatUI,J.Value2D._initone(q.ShaderDefines2D.TEXTURE2D,$.TextureSV),J.Value2D._initone(q.ShaderDefines2D.TEXTURE2D|q.ShaderDefines2D.FILTERGLOW,$.TextureSV),J.Value2D._initone(q.ShaderDefines2D.PRIMITIVE,Q.PrimitiveSV),J.Value2D._initone(q.ShaderDefines2D.SKINMESH,Z.SkinSV),w.Render.canvas}}},{key:"_getUrlPath",value:function(){return R.URL.getPath(location.protocol+"//"+location.host+location.pathname)}},{key:"_arrayBufferSlice",value:function(t,e){var i=new Uint8Array(this,t,e-t),n=new Uint8Array(i.length);return n.set(i),n.buffer}},{key:"alertGlobalError",value:function(t){var e=0;F.Browser.window.onerror=t?function(t,i,n,a,r){e++<5&&r&&this.alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+r.stack)}:null}},{key:"_runScript",value:function(e){return F.Browser.window[t._evcode](e)}},{key:"enableDebugPanel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"libs/laya.debugtool.js";if(window.Laya.DebugPanel)window.Laya.DebugPanel.enable();else{var e=F.Browser.createElement("script");e.onload=function(){window.Laya.DebugPanel.enable()},e.src=t,F.Browser.document.body.appendChild(e)}}},{key:"enableWebGLPlus",value:function(){st.WebGLContext.__init_native()}},{key:"enableNative",value:function(){t.isNativeRender_enable||(t.isNativeRender_enable=!0,w.Render.supportWebGLPlusRendering&&(tt.Shader.prototype.uploadTexture2D=function(t){var e=k.LayaGL.instance;e.bindTexture(e.TEXTURE_2D,t)}),nt.RenderState2D.width=F.Browser.window.innerWidth,nt.RenderState2D.height=F.Browser.window.innerHeight,F.Browser.measureText=function(t,e){return window.conchTextCanvas.font=e,window.conchTextCanvas.measureText(t)},g.Stage.clear=function(t){B.Context.set2DRenderConfig();var e=G.ColorUtils.create(t).arrColor,i=k.LayaGL.instance;e&&i.clearColor(e[0],e[1],e[2],e[3]),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT),nt.RenderState2D.clear()},p.Sprite.drawToCanvas=function(t,e,i,n,a,r){a-=t.x,r-=t.y,a|=0,r|=0,i|=0,n|=0;var s=new D.HTMLCanvas(!1),o=s.getContext("2d");return s.size(i,n),o.asBitmap=!0,o._targets.start(),A.RenderSprite.renders[e]._fun(t,o,a,r),o.flush(),o._targets.end(),o._targets.restore(),s},(0,o.default)(P.RenderTexture2D.prototype,"uv",{get:function(){return this._uv},set:function(t){this._uv=t}}),D.HTMLCanvas.prototype.getTexture=function(){return this._texture||(this._texture=this.context._targets,this._texture.uv=P.RenderTexture2D.flipyuv,this._texture.bitmap=this._texture),this._texture})}}]),t}();e.Laya=Tt,Tt.stage=null,Tt.systemTimer=null,Tt.startTimer=null,Tt.physicsTimer=null,Tt.updateTimer=null,Tt.lateTimer=null,Tt.timer=null,Tt.loader=null,Tt.version="2.12.2",Tt._isinit=!1,Tt.isWXOpenDataContext=!1,Tt.isWXPosMsg=!1,Tt.__classmap=null,Tt.Config=xt.Config,Tt.TextRender=it.TextRender,Tt.EventDispatcher=_t.EventDispatcher,Tt.SoundChannel=ft.SoundChannel,Tt.Stage=g.Stage,Tt.Render=w.Render,Tt.Browser=F.Browser,Tt.Sprite=p.Sprite,Tt.Node=y.Node,Tt.Context=B.Context,Tt.WebGL=rt.WebGL,Tt.Handler=vt.Handler,Tt.RunDriver=yt.RunDriver,Tt.Utils=K.Utils,Tt.Input=v.Input,Tt.Loader=M.Loader,Tt.LocalStorage=b.LocalStorage,Tt.SoundManager=S.SoundManager,Tt.URL=R.URL,Tt.Event=mt.Event,Tt.Matrix=pt.Matrix,Tt.HTMLImage=gt.HTMLImage,Tt.Laya=Tt,Tt._evcode="eval",Tt.isNativeRender_enable=!1,Tt.__classmap=d.ILaya.__classMap,d.ILaya.Timer=z.Timer,d.ILaya.Dragging=H.Dragging,d.ILaya.GraphicsBounds=_.GraphicsBounds,d.ILaya.Sprite=p.Sprite,d.ILaya.TextRender=it.TextRender,d.ILaya.Loader=M.Loader,d.ILaya.TTFLoader=I.TTFLoader,d.ILaya.WebAudioSound=E.WebAudioSound,d.ILaya.SoundManager=S.SoundManager,d.ILaya.ShaderCompile=at.ShaderCompile,d.ILaya.ClassUtils=N.ClassUtils,d.ILaya.SceneUtils=V.SceneUtils,d.ILaya.Context=B.Context,d.ILaya.Render=w.Render,d.ILaya.MouseManager=T.MouseManager,d.ILaya.Text=m.Text,d.ILaya.Browser=F.Browser,d.ILaya.WebGL=rt.WebGL,d.ILaya.AudioSound=C.AudioSound,d.ILaya.Pool=W.Pool,d.ILaya.Utils=K.Utils,d.ILaya.Graphics=f.Graphics,d.ILaya.Submit=et.Submit,d.ILaya.Stage=g.Stage,d.ILaya.Resource=O.Resource,d.ILaya.WorkerLoader=ot.WorkerLoader;var kt=window._layalibs;if(kt){(0,l.default)(kt).call(kt,(function(t,e){return t.i-e.i}));for(var Ct=0;Ct<kt.length;Ct++)kt[Ct].f(window,window.document,Tt)}var St=window;St.Laya?(St.Laya.Laya=Tt,(0,u.default)(St.Laya,Tt)):St.Laya=Tt;var Et=Tt.__init;e.__init=Et;var Mt,Lt,bt,It,Rt,wt,At,Bt,Dt=Tt.init;e.init=Dt,e.stage=Mt,e.systemTimer=Lt,e.startTimer=bt,e.physicsTimer=It,e.updateTimer=Rt,e.lateTimer=wt,e.timer=At,e.loader=Bt;var Pt,Ot=Tt.version;e.version=Ot,e.render=Pt,e.isWXOpenDataContext=undefined,e.isWXPosMsg=undefined;var Ft=Tt.alertGlobalError;e.alertGlobalError=Ft;var Ut=Tt.enableDebugPanel;e.enableDebugPanel=Ut},14529:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.UIConfig=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.UIConfig=s,s.touchScrollEnable=!0,s.mouseWheelEnable=!0,s.showButtons=!0,s.popupBgColor="#000000",s.popupBgAlpha=.5,s.closeDialogOnSide=!0,window.UIConfig=s},13407:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Const=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.Const=s,s.NOT_ACTIVE=1,s.ACTIVE_INHIERARCHY=2,s.AWAKED=4,s.NOT_READY=8,s.DISPLAY=16,s.HAS_ZORDER=32,s.HAS_MOUSE=64,s.DISPLAYED_INSTAGE=128,s.DRAWCALL_OPTIMIZE=256},49029:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.IAniLib=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.IAniLib=s,s.Skeleton=null,s.AnimationTemplet=null,s.Templet=null},44799:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AnimationContent=void 0;var r=a(i(15375));e.AnimationContent=function t(){(0,r.default)(this,t)}},50355:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AnimationNodeContent=void 0;var r=a(i(15375));e.AnimationNodeContent=function t(){(0,r.default)(this,t)}},44611:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AnimationParser01=void 0;var r=a(i(3649)),s=a(i(15375)),o=a(i(17061)),l=i(44799),u=i(50355),h=i(90984),c=i(49029),d=i(14002),f=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"parse",value:function(t,e){var i,n,a,s,o,f,_,v=e.__getBuffer(),y=e.readUTFString();t._aniClassName=y;var p,g=e.readUTFString().split("\n"),m=e.getUint8(),x=e.getUint32(),T=e.getUint32();x>0&&(p=(0,r.default)(v).call(v,x,T));var k=new d.Byte(p);for(T>0&&(t._publicExtData=(0,r.default)(v).call(v,T,v.byteLength)),t._useParent=!!e.getUint8(),t._anis.length=m,i=0;i<m;i++){var C=t._anis[i]=new l.AnimationContent;C.nodes=[];var S=C.name=g[e.getUint16()];t._aniMap[S]=i,C.bone3DMap={},C.playTime=e.getFloat32();var E=C.nodes.length=e.getUint8();for(C.totalKeyframeDatasLength=0,n=0;n<E;n++){var M=C.nodes[n]=new u.AnimationNodeContent;M.childs=[];var L=e.getInt16();L>=0&&(M.name=g[L],C.bone3DMap[M.name]=n),M.keyFrame=[],M.parentIndex=e.getInt16(),-1==M.parentIndex?M.parent=null:M.parent=C.nodes[M.parentIndex],M.lerpType=e.getUint8();var b=e.getUint32();k.pos=b;var I=M.keyframeWidth=k.getUint16();if(C.totalKeyframeDatasLength+=I,0===M.lerpType||1===M.lerpType)for(M.interpolationMethod=[],M.interpolationMethod.length=I,a=0;a<I;a++)M.interpolationMethod[a]=c.IAniLib.AnimationTemplet.interpolation[k.getUint8()];null!=M.parent&&M.parent.childs.push(M);var R=e.getUint16();R>0&&(M.extenData=(0,r.default)(v).call(v,e.pos,e.pos+R),e.pos+=R);var w=e.getUint16();M.keyFrame.length=w;var A,B=0;for(a=0,s=w;a<s;a++){if((A=M.keyFrame[a]=new h.KeyFramesContent).duration=e.getFloat32(),A.startTime=B,2===M.lerpType){A.interpolationData=[];var D,P=e.getUint8();switch(D=e.getFloat32()){case 254:for(A.interpolationData.length=I,_=0;_<I;_++)A.interpolationData[_]=0;break;case 255:for(A.interpolationData.length=I,_=0;_<I;_++)A.interpolationData[_]=5;break;default:for(A.interpolationData.push(D),f=1;f<P;f++)A.interpolationData.push(e.getFloat32())}}for(A.data=new Float32Array(I),A.dData=new Float32Array(I),A.nextData=new Float32Array(I),o=0;o<I;o++)A.data[o]=e.getFloat32(),A.data[o]>-1e-8&&A.data[o]<1e-8&&(A.data[o]=0);B+=A.duration}A.startTime=C.playTime,M.playTime=C.playTime,t._calculateKeyFrame(M,w,I)}}}}]),t}();e.AnimationParser01=f},39340:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AnimationParser02=void 0;var r=a(i(3649)),s=a(i(15375)),o=a(i(17061)),l=i(44799),u=i(50355),h=i(90984),c=i(49029),d=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"READ_DATA",value:function(){t._DATA.offset=t._reader.getUint32(),t._DATA.size=t._reader.getUint32()}},{key:"READ_BLOCK",value:function(){for(var e=t._BLOCK.count=t._reader.getUint16(),i=t._BLOCK.blockStarts=[],n=t._BLOCK.blockLengths=[],a=0;a<e;a++)i.push(t._reader.getUint32()),n.push(t._reader.getUint32())}},{key:"READ_STRINGS",value:function(){var e=t._reader.getUint32(),i=t._reader.getUint16(),n=t._reader.pos;t._reader.pos=e+t._DATA.offset;for(var a=0;a<i;a++)t._strings[a]=t._reader.readUTFString();t._reader.pos=n}},{key:"parse",value:function(e,i){t._templet=e,t._reader=i;i.__getBuffer();t.READ_DATA(),t.READ_BLOCK(),t.READ_STRINGS();for(var n=0,a=t._BLOCK.count;n<a;n++){var r=i.getUint16(),s=t._strings[r],o=t["READ_"+s];if(null==o)throw new Error("model file err,no this function:"+r+" "+s);o.call(null)}}},{key:"READ_ANIMATIONS",value:function(){var e,i,n,a,s=t._reader,o=s.__getBuffer(),d=s.getUint16(),f=[];for(f.length=d,e=0;e<d;e++)f[e]=c.IAniLib.AnimationTemplet.interpolation[s.getByte()];var _=s.getUint8();for(t._templet._anis.length=_,e=0;e<_;e++){var v=t._templet._anis[e]=new l.AnimationContent;v.nodes=[];var y=v.name=t._strings[s.getUint16()];t._templet._aniMap[y]=e,v.bone3DMap={},v.playTime=s.getFloat32();var p=v.nodes.length=s.getInt16();for(v.totalKeyframeDatasLength=0,i=0;i<p;i++){var g=v.nodes[i]=new u.AnimationNodeContent;g.keyframeWidth=d,g.childs=[];var m=s.getUint16();m>=0&&(g.name=t._strings[m],v.bone3DMap[g.name]=i),g.keyFrame=[],g.parentIndex=s.getInt16(),-1==g.parentIndex?g.parent=null:g.parent=v.nodes[g.parentIndex],v.totalKeyframeDatasLength+=d,g.interpolationMethod=f,null!=g.parent&&g.parent.childs.push(g);var x=s.getUint16();g.keyFrame.length=x;var T=null,k=null;for(n=0,a=x;n<a;n++){(T=g.keyFrame[n]=new h.KeyFramesContent).startTime=s.getFloat32(),k&&(k.duration=T.startTime-k.startTime),T.dData=new Float32Array(d),T.nextData=new Float32Array(d);var C=t._DATA.offset,S=s.getUint32(),E=4*d,M=(0,r.default)(o).call(o,C+S,C+S+E);T.data=new Float32Array(M),k=T}T.duration=0,g.playTime=v.playTime,t._templet._calculateKeyFrame(g,x,d)}}}}]),t}();e.AnimationParser02=d,d._strings=[],d._BLOCK={count:0},d._DATA={offset:0,size:0}},48796:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.AnimationPlayer=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(48220),d=i(683),f=i(89662);function _(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var v=function(t){(0,l.default)(i,t);var e=_(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this)).isCache=!0,t.playbackRate=1,t._destroyed=!1,t._currentAnimationClipIndex=-1,t._currentKeyframeIndex=-1,t._currentTime=0,t._overallDuration=Number.MAX_VALUE,t._stopWhenCircleFinish=!1,t._elapsedPlaybackTime=0,t._startUpdateLoopCount=-1,t._cachePlayRate=1,t.cacheFrameRate=60,t.returnToZeroStopped=!1,t}return(0,o.default)(i,[{key:"templet",get:function(){return this._templet},set:function(t){this.state!==c.AnimationState.stopped&&this.stop(!0),this._templet!==t&&(this._templet=t,this._computeFullKeyframeIndices())}},{key:"playStart",get:function(){return this._playStart}},{key:"playEnd",get:function(){return this._playEnd}},{key:"playDuration",get:function(){return this._playDuration}},{key:"overallDuration",get:function(){return this._overallDuration}},{key:"currentAnimationClipIndex",get:function(){return this._currentAnimationClipIndex}},{key:"currentKeyframeIndex",get:function(){return this._currentKeyframeIndex}},{key:"currentPlayTime",get:function(){return this._currentTime+this._playStart}},{key:"currentFrameTime",get:function(){return this._currentFrameTime}},{key:"cachePlayRate",get:function(){return this._cachePlayRate},set:function(t){this._cachePlayRate!==t&&(this._cachePlayRate=t,this._templet&&this._computeFullKeyframeIndices())}},{key:"cacheFrameRate",get:function(){return this._cacheFrameRate},set:function(t){this._cacheFrameRate!==t&&(this._cacheFrameRate=t,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&this._computeFullKeyframeIndices())}},{key:"currentTime",set:function(t){if(-1!==this._currentAnimationClipIndex&&this._templet){if(t<this._playStart||t>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=d.Stat.loopCount;var e=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/e),this._currentFrameTime=this._currentKeyframeIndex*e}}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t,t&&this.event(f.Event.PAUSED)}},{key:"cacheFrameRateInterval",get:function(){return this._cacheFrameRateInterval}},{key:"state",get:function(){return-1===this._currentAnimationClipIndex?c.AnimationState.stopped:this._paused?c.AnimationState.paused:c.AnimationState.playing}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_onTempletLoadedComputeFullKeyframeIndices",value:function(t,e,i){this._templet===i&&this._cachePlayRate===t&&this._cacheFrameRate===e&&this._computeFullKeyframeIndices()}},{key:"_computeFullKeyframeIndices",value:function(){}},{key:"_onAnimationTempletLoaded",value:function(){this.destroyed||this._calculatePlayDuration()}},{key:"_calculatePlayDuration",value:function(){if(this.state!==c.AnimationState.stopped){var t=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=t),this._playEnd>t&&(this._playEnd=t),this._playDuration=this._playEnd-this._playStart}}},{key:"_setPlayParams",value:function(t,e){this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/e+.01),this._currentFrameTime=this._currentKeyframeIndex*e}},{key:"_setPlayParamsWhenStop",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._currentTime=t;var n=i>0?i:t;this._currentKeyframeIndex=Math.floor(n/e+.01),this._currentKeyframeIndex=Math.floor(t/e+.01),this._currentFrameTime=this._currentKeyframeIndex*e,this._currentAnimationClipIndex=-1}},{key:"_update",value:function(t){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet){var e=this._cacheFrameRateInterval*this._cachePlayRate,i=0;this._startUpdateLoopCount!==d.Stat.loopCount&&(i=t*this.playbackRate,this._elapsedPlaybackTime+=i);var n=this.playDuration;if(i+=this._currentTime,0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=n||0===this._overallDuration&&i>=this.playEnd)return this._setPlayParamsWhenStop(n,e,this.playEnd),void this.event(f.Event.STOPPED);if(n>0){if(i>=n)return this._stopWhenCircleFinish?(this._setPlayParamsWhenStop(n,e),this._stopWhenCircleFinish=!1,void this.event(f.Event.STOPPED)):(i%=n,this._setPlayParams(i,e),void this.event(f.Event.COMPLETE));this._setPlayParams(i,e)}else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(n,e),this._stopWhenCircleFinish=!1,void this.event(f.Event.STOPPED);this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event(f.Event.COMPLETE)}}}},{key:"_destroy",value:function(){this.offAll(),this._templet=null,this._destroyed=!0}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2147483647,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(i<0||n<0||a<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==a&&n>a)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=e,this._overallDuration=i,this._playStart=n,this._playEnd=a,this._paused=!1,this._currentAnimationClipIndex=t,this._currentKeyframeIndex=0,this._startUpdateLoopCount=d.Stat.loopCount,this.event(f.Event.PLAYED),this._calculatePlayDuration(),this._update(0)}},{key:"playByFrame",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2147483647,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:30,s=1e3/r;this.play(t,e,i,n*s,a*s)}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event(f.Event.STOPPED)):this._stopWhenCircleFinish=!0}},{key:"destroy",value:function(){}}]),i}(i(48856).EventDispatcher);e.AnimationPlayer=v},48220:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AnimationState=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.AnimationState=s,s.stopped=0,s.paused=1,s.playing=2},23038:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.AnimationTemplet=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(44611),d=i(39340),f=i(25883),_=i(64968),v=i(49029),y=i(14002),p=i(67988);function g(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var m=function(t){(0,l.default)(i,t);var e=g(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this))._anis=[],t._aniMap={},t.unfixedLastAniIndex=-1,t._fullFrames=null,t._boneCurKeyFrm=[],t}return(0,o.default)(i,[{key:"parse",value:function(t){var e=new y.Byte(t);this._aniVersion=e.readUTFString(),c.AnimationParser01.parse(this,e)}},{key:"_calculateKeyFrame",value:function(t,e,i){var n=t.keyFrame;n[e]=n[0];for(var a=0;a<e;a++)for(var r=n[a],s=0;s<i;s++)r.dData[s]=0===r.duration?0:(n[a+1].data[s]-r.data[s])/r.duration,r.nextData[s]=n[a+1].data[s];n.length--}},{key:"_onAsynLoaded",value:function(t){var e=new y.Byte(t);if(this._aniVersion=e.readUTFString(),"LAYAANIMATION:02"===this._aniVersion)d.AnimationParser02.parse(this,e);else c.AnimationParser01.parse(this,e)}},{key:"getAnimationCount",value:function(){return this._anis.length}},{key:"getAnimation",value:function(t){return this._anis[t]}},{key:"getAniDuration",value:function(t){return this._anis[t].playTime}},{key:"getNodes",value:function(t){return this._anis[t].nodes}},{key:"getNodeIndexWithName",value:function(t,e){return this._anis[t].bone3DMap[e]}},{key:"getNodeCount",value:function(t){return this._anis[t].nodes.length}},{key:"getTotalkeyframesLength",value:function(t){return this._anis[t].totalKeyframeDatasLength}},{key:"getPublicExtData",value:function(){return this._publicExtData}},{key:"getAnimationDataWithCache",value:function(t,e,i,n){var a=e[i];if(a){var r=a[t];return r?r[n]:null}return null}},{key:"setAnimationDataWithCache",value:function(t,e,i,n,a){var r=e[i]||(e[i]={});(r[t]||(r[t]=[]))[n]=a}},{key:"getNodeKeyFrame",value:function(t,e,i){var n=this._boneCurKeyFrm[e],a=t.length;(null==n||n>=a)&&(n=this._boneCurKeyFrm[e]=0);var r=t[n],s=i-r.startTime;if(0==s||s>0&&r.duration>s)return n;var o=0;if(s>0){for(i+=.01,o=n+1;o<a;o++)if((r=t[o]).startTime<=i&&r.startTime+r.duration>i)return this._boneCurKeyFrm[e]=o,o;return a-1}for(o=0;o<n;o++)if((r=t[o]).startTime<=i&&r.startTime+r.duration>i)return this._boneCurKeyFrm[e]=o,o;return n}},{key:"getOriginalData",value:function(t,e,n,a,r){var s=this._anis[t].nodes,o=this._boneCurKeyFrm;o.length<s.length&&(o.length=s.length);for(var l=0,u=0,h=s.length,c=0;u<h;u++){var d,f=s[u],_=f.keyFrame;d=_[this.getNodeKeyFrame(_,u,r)],f.dataOffset=c;var v=r-d.startTime,y=f.lerpType;if(y)switch(y){case 0:case 1:for(l=0;l<f.keyframeWidth;)l+=f.interpolationMethod[l](f,l,e,c+l,d.data,v,d.dData,d.duration,d.nextData);break;case 2:var p=d.interpolationData,g=p.length,m=0;for(l=0;l<g;){var x=p[l];switch(x){case 6:case 7:l+=i.interpolation[x](f,m,e,c+m,d.data,v,d.dData,d.duration,d.nextData,p,l+1);break;default:l+=i.interpolation[x](f,m,e,c+m,d.data,v,d.dData,d.duration,d.nextData)}m++}}else for(l=0;l<f.keyframeWidth;)l+=f.interpolationMethod[l](f,l,e,c+l,d.data,v,d.dData,d.duration,d.nextData);c+=f.keyframeWidth}}},{key:"getNodesCurrentFrameIndex",value:function(t,e){var i=this._anis[t].nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(i.length),this.unfixedCurrentTimes=new Float32Array(i.length),this.unfixedLastAniIndex=t);for(var n=0,a=i.length;n<a;n++){var r=i[n];for(e<this.unfixedCurrentTimes[n]&&(this.unfixedCurrentFrameIndexes[n]=0),this.unfixedCurrentTimes[n]=e;this.unfixedCurrentFrameIndexes[n]<r.keyFrame.length&&!(r.keyFrame[this.unfixedCurrentFrameIndexes[n]].startTime>this.unfixedCurrentTimes[n]);)this.unfixedCurrentFrameIndexes[n]++;this.unfixedCurrentFrameIndexes[n]--}return this.unfixedCurrentFrameIndexes}},{key:"getOriginalDataUnfixedRate",value:function(t,e,n){var a=this._anis[t].nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(a.length),this.unfixedCurrentTimes=new Float32Array(a.length),this.unfixedKeyframes=[],this.unfixedLastAniIndex=t);for(var r=0,s=0,o=a.length,l=0;s<o;s++){var u=a[s];for(n<this.unfixedCurrentTimes[s]&&(this.unfixedCurrentFrameIndexes[s]=0),this.unfixedCurrentTimes[s]=n;this.unfixedCurrentFrameIndexes[s]<u.keyFrame.length&&!(u.keyFrame[this.unfixedCurrentFrameIndexes[s]].startTime>this.unfixedCurrentTimes[s]);)this.unfixedKeyframes[s]=u.keyFrame[this.unfixedCurrentFrameIndexes[s]],this.unfixedCurrentFrameIndexes[s]++;var h=this.unfixedKeyframes[s];u.dataOffset=l;var c=n-h.startTime;if(u.lerpType)switch(u.lerpType){case 0:case 1:for(r=0;r<u.keyframeWidth;)r+=u.interpolationMethod[r](u,r,e,l+r,h.data,c,h.dData,h.duration,h.nextData);break;case 2:var d=h.interpolationData,f=d.length,_=0;for(r=0;r<f;){var v=d[r];switch(v){case 6:case 7:r+=i.interpolation[v](u,_,e,l+_,h.data,c,h.dData,h.duration,h.nextData,d,r+1);break;default:r+=i.interpolation[v](u,_,e,l+_,h.data,c,h.dData,h.duration,h.nextData)}_++}}else for(r=0;r<u.keyframeWidth;)r+=u.interpolationMethod[r](u,r,e,l+r,h.data,c,h.dData,h.duration,h.nextData);l+=u.keyframeWidth}}}],[{key:"_LinearInterpolation_0",value:function(t,e,i,n,a,r,s,o,l){return i[n]=a[e]+r*s[e],1}},{key:"_QuaternionInterpolation_1",value:function(t,e,i,n,a,r,s,o,l){var u=0===o?0:r/o;return _.MathUtil.slerpQuaternionArray(a,e,l,e,u,i,n),4}},{key:"_AngleInterpolation_2",value:function(t,e,i,n,a,r,s,o,l){return 0}},{key:"_RadiansInterpolation_3",value:function(t,e,i,n,a,r,s,o,l){return 0}},{key:"_Matrix4x4Interpolation_4",value:function(t,e,i,n,a,r,s,o,l){for(var u=0;u<16;u++,e++)i[n+u]=a[e]+r*s[e];return 16}},{key:"_NoInterpolation_5",value:function(t,e,i,n,a,r,s,o,l){return i[n]=a[e],1}},{key:"_BezierInterpolation_6",value:function(t,e,i,n,a,r,s,o,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;return i[n]=a[e]+(l[e]-a[e])*p.BezierLerp.getBezierRate(r/o,u[h],u[h+1],u[h+2],u[h+3]),5}},{key:"_BezierInterpolation_7",value:function(t,e,i,n,a,r,s,o,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;return i[n]=u[h+4]+u[h+5]*p.BezierLerp.getBezierRate((.001*r+u[h+6])/u[h+7],u[h],u[h+1],u[h+2],u[h+3]),9}}]),i}(f.Resource);e.AnimationTemplet=m,m.interpolation=[m._LinearInterpolation_0,m._QuaternionInterpolation_1,m._AngleInterpolation_2,m._RadiansInterpolation_3,m._Matrix4x4Interpolation_4,m._NoInterpolation_5,m._BezierInterpolation_6,m._BezierInterpolation_7],v.IAniLib.AnimationTemplet=m},2689:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.GraphicsAni=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(18008);function d(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var f=function(t){(0,l.default)(i,t);var e=d(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"drawSkin",value:function(t,e){this.drawTriangles(t.texture,0,0,t.vertices,t.uvs,t.indexes,t.transform||c.Matrix.EMPTY,e)}}],[{key:"create",value:function(){return i._caches.pop()||new i}},{key:"recycle",value:function(t){t.clear(),i._caches.push(t)}}]),i}(i(72276).Graphics);e.GraphicsAni=f,f._caches=[]},90984:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.KeyFramesContent=void 0;var r=a(i(15375));e.KeyFramesContent=function t(){(0,r.default)(this,t)}},62775:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Bone=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(81097),l=i(78362),u=i(18008),h=i(92493),c=function(){function t(){(0,r.default)(this,t),this.length=10,this.resultTransform=new o.Transform,this.resultMatrix=new u.Matrix,this.inheritScale=!0,this.inheritRotation=!0,this.d=-1,this._children=[]}return(0,s.default)(t,[{key:"setTempMatrix",value:function(t){this._tempMatrix=t;var e,i=0;for(i=0,e=this._children.length;i<e;i++)this._children[i].setTempMatrix(this._tempMatrix)}},{key:"update",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.rotation=this.transform.skX,e)t=this.resultTransform.getMatrix(),u.Matrix.mul(t,e,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)t=this.resultTransform.getMatrix(),u.Matrix.mul(t,this.parentBone.resultMatrix,this.resultMatrix);else{var i,n,a,r=this.parentBone,s=this.parentBone.resultMatrix;t=this.resultTransform.getMatrix();var o=s.a*t.tx+s.c*t.ty+s.tx,l=s.b*t.tx+s.d*t.ty+s.ty,h=new u.Matrix;this.inheritRotation?(i=Math.atan2(r.resultMatrix.b,r.resultMatrix.a),n=Math.cos(i),a=Math.sin(i),h.setTo(n,a,-a,n,0,0),u.Matrix.mul(this._tempMatrix,h,u.Matrix.TEMP),u.Matrix.TEMP.copyTo(h),t=this.resultTransform.getMatrix(),u.Matrix.mul(t,h,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI),this.resultMatrix.tx=o,this.resultMatrix.ty=l):(this.inheritScale,t=this.resultTransform.getMatrix(),u.Matrix.TEMP.identity(),u.Matrix.TEMP.d=this.d,u.Matrix.mul(t,u.Matrix.TEMP,this.resultMatrix),this.resultMatrix.tx=o,this.resultMatrix.ty=l)}else(t=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var c=0,d=0;for(c=0,d=this._children.length;c<d;c++)this._children[c].update()}},{key:"updateChild",value:function(){var t,e=0;for(e=0,t=this._children.length;e<t;e++)this._children[e].update()}},{key:"setRotation",value:function(t){this._sprite&&(this._sprite.rotation=180*t/Math.PI)}},{key:"updateDraw",value:function(e,i){t.ShowBones&&!t.ShowBones[this.name]||(this._sprite?(this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=i+this.resultMatrix.ty):(this._sprite=new l.Sprite,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),h.ILaya.stage.addChild(this._sprite),this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=i+this.resultMatrix.ty));var n,a=0;for(a=0,n=this._children.length;a<n;a++)this._children[a].updateDraw(e,i)}},{key:"addChild",value:function(t){this._children.push(t),t.parentBone=this}},{key:"findBone",value:function(t){if(this.name==t)return this;var e,i,n;for(e=0,i=this._children.length;e<i;e++)if(n=this._children[e].findBone(t))return n;return null}},{key:"localToWorld",value:function(t){var e=t[0],i=t[1];t[0]=e*this.resultMatrix.a+i*this.resultMatrix.c+this.resultMatrix.tx,t[1]=e*this.resultMatrix.b+i*this.resultMatrix.d+this.resultMatrix.ty}}]),t}();e.Bone=c,c.ShowBones={}},18460:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BoneSlot=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(69616),l=i(59514),u=i(92493),h=i(18008),c=function(){function t(){(0,r.default)(this,t),this.srcDisplayIndex=-1,this.type="src",this.displayIndex=-1,this.originalIndex=-1,this._replaceDic={}}return(0,s.default)(t,[{key:"showSlotData",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currSlotData=t,e&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null}},{key:"showDisplayByName",value:function(t){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(t))}},{key:"replaceDisplayByName",value:function(t,e){var i,n;this.currSlotData&&(i=this.currSlotData.getDisplayByName(t),n=this.currSlotData.getDisplayByName(e),this.replaceDisplayByIndex(i,n))}},{key:"replaceDisplayByIndex",value:function(t,e){this.currSlotData&&(this._replaceDic[t]=e,this.originalIndex==t&&this.showDisplayByIndex(t))}},{key:"showDisplayByIndex",value:function(t){if(this.originalIndex=t,null!=this._replaceDic[t]&&(t=this._replaceDic[t]),this.currSlotData&&t>-1&&t<this.currSlotData.displayArr.length){if(this.displayIndex=t,this.currDisplayData=this.currSlotData.displayArr[t],this.currDisplayData){var e=this.currDisplayData.name;this.currTexture=this.templet.getTexture(e),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null}},{key:"replaceSkin",value:function(t){this._diyTexture=t,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)}},{key:"setParentMatrix",value:function(t){this._parentMatrix=t}},{key:"getSaveVerticle",value:function(e){return t.useSameMatrixAndVerticle&&this._preGraphicVerticle&&t.isSameArr(e,this._preGraphicVerticle)?e=this._preGraphicVerticle:(e=u.ILaya.Utils.copyArray([],e),this._preGraphicVerticle=e),e}},{key:"getSaveMatrix",value:function(e){if(t.useSameMatrixAndVerticle&&this._preGraphicMatrix&&t.isSameMatrix(e,this._preGraphicMatrix))e=this._preGraphicMatrix;else{var i=e.clone();e=i,this._preGraphicMatrix=e}return e}},{key:"draw",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if((null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var r,s=this.currTexture;switch(this._diyTexture&&(s=this._diyTexture),this.currDisplayData.type){case 0:if(e){var l=this.getDisplayMatrix();if(this._parentMatrix){var u=!1;if(l){var c;if(h.Matrix.mul(l,this._parentMatrix,h.Matrix.TEMP),n?(null==this._resultMatrix&&(this._resultMatrix=new h.Matrix),c=this._resultMatrix):c=t._tempResultMatrix,this._diyTexture&&this.currDisplayData.uvs){var d=t._tempMatrix;d.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(d.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(u=!0,d.rotate(-Math.PI/2)),h.Matrix.mul(d,h.Matrix.TEMP,c)}else h.Matrix.TEMP.copyTo(c);n||(c=this.getSaveMatrix(c)),c._checkTransform(),u?e.drawTexture(s,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,c,a):e.drawTexture(s,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,c,a)}}}break;case 1:if(n?(null==this._skinSprite&&(this._skinSprite=t.createSkinMesh()),r=this._skinSprite):r=t.createSkinMesh(),null==r)return;var f;if(null==this.currDisplayData.bones){var _,v=this.currDisplayData.weights;this.deformData&&(v=this.deformData),this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=o.UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=o.UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),_=this._curDiyUV):_=this.currDisplayData.uvs,this._mVerticleArr=v;this.currDisplayData.triangles.length;f=this.currDisplayData.triangles,this.deformData&&(n||(this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr))),r.init2(s,f,this._mVerticleArr,_);var y,p=this.getDisplayMatrix();if(this._parentMatrix)if(p)h.Matrix.mul(p,this._parentMatrix,h.Matrix.TEMP),n?(null==this._resultMatrix&&(this._resultMatrix=new h.Matrix),y=this._resultMatrix):y=t._tempResultMatrix,h.Matrix.TEMP.copyTo(y),n||(y=this.getSaveMatrix(y)),r.transform=y}else this.skinMesh(i,r);e.drawSkin(r,a);break;case 2:if(n?(null==this._skinSprite&&(this._skinSprite=t.createSkinMesh()),r=this._skinSprite):r=t.createSkinMesh(),null==r)return;this.skinMesh(i,r),e.drawSkin(r,a)}}}},{key:"skinMesh",value:function(e,i){var n,a=this.currTexture,r=this.currDisplayData.bones;this._diyTexture?(a=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=o.UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=o.UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),n=this._curDiyUV):n=this.currDisplayData.uvs;var s,l,u,h,c,d=this.currDisplayData.weights,f=this.currDisplayData.triangles,_=0,v=0,y=0,p=0,g=0,m=0,x=0;if(t._tempVerticleArr.length=0,c=t._tempVerticleArr,this.deformData&&this.deformData.length>0){var T=0;for(m=0,x=r.length;m<x;){for(y=r[m++]+m,_=0,v=0;m<y;m++)l=e[r[m]],u=d[p]+this.deformData[T++],h=d[p+1]+this.deformData[T++],g=d[p+2],_+=(u*l.a+h*l.c+l.tx)*g,v+=(u*l.b+h*l.d+l.ty)*g,p+=3;c.push(_,v)}}else for(m=0,x=r.length;m<x;){for(y=r[m++]+m,_=0,v=0;m<y;m++)l=e[r[m]],u=d[p],h=d[p+1],g=d[p+2],_+=(u*l.a+h*l.c+l.tx)*g,v+=(u*l.b+h*l.d+l.ty)*g,p+=3;c.push(_,v)}this._mVerticleArr=c,s=f,this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr),i.init2(a,s,this._mVerticleArr,n)}},{key:"drawBonePoint",value:function(t){t&&this._parentMatrix&&t.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")}},{key:"getDisplayMatrix",value:function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null}},{key:"getMatrix",value:function(){return this._resultMatrix}},{key:"copy",value:function(){var e=new t;return e.type="copy",e.name=this.name,e.attachmentName=this.attachmentName,e.srcDisplayIndex=this.srcDisplayIndex,e.parent=this.parent,e.displayIndex=this.displayIndex,e.templet=this.templet,e.currSlotData=this.currSlotData,e.currTexture=this.currTexture,e.currDisplayData=this.currDisplayData,e}}],[{key:"createSkinMesh",value:function(){return new l.SkinMeshForGraphic}},{key:"isSameArr",value:function(t,e){if(t.length!=e.length)return!1;var i,n;for(n=t.length,i=0;i<n;i++)if(t[i]!=e[i])return!1;return!0}},{key:"isSameMatrix",value:function(t,e){return t.a==e.a&&t.b==e.b&&t.c==e.c&&t.d==e.d&&Math.abs(t.tx-e.tx)<1e-5&&Math.abs(t.ty-e.ty)<1e-5}}]),t}();e.BoneSlot=c,c._tempMatrix=new h.Matrix,c._tempResultMatrix=new h.Matrix,c.useSameMatrixAndVerticle=!0,c._tempVerticleArr=[]},39512:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DeformAniData=void 0;var r=a(i(15375));e.DeformAniData=function t(){(0,r.default)(this,t),this.deformSlotDataList=[]}},28973:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DeformSlotData=void 0;var r=a(i(15375));e.DeformSlotData=function t(){(0,r.default)(this,t),this.deformSlotDisplayList=[]}},50403:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DeformSlotDisplayData=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t),this.slotIndex=-1,this.timeList=[],this.vectices=[],this.tweenKeyList=[],this.frameIndex=0}return(0,s.default)(t,[{key:"binarySearch1",value:function(t,e){var i=0,n=t.length-2;if(0==n)return 1;for(var a=n>>>1;;){if(t[Math.floor(a+1)]<=e?i=a+1:n=a,i==n)return i+1;a=i+n>>>1}return 0}},{key:"apply",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t+=.05,!(this.timeList.length<=0)){var n=0,a=this.timeList[0];if(!(t<a)){var r=this.vectices[0].length,s=[],o=this.binarySearch1(this.timeList,t);if(this.frameIndex=o,t>=this.timeList[this.timeList.length-1]){var l=this.vectices[this.vectices.length-1];if(i<1)for(n=0;n<r;n++)s[n]+=(l[n]-s[n])*i;else for(n=0;n<r;n++)s[n]=l[n];this.deformData=s}else{var u,h=this.vectices[this.frameIndex-1],c=this.vectices[this.frameIndex],d=this.timeList[this.frameIndex-1],f=this.timeList[this.frameIndex];for(i=this.tweenKeyList[o-1]?(t-d)/(f-d):0,n=0;n<r;n++)u=h[n],s[n]=u+(c[n]-u)*i;this.deformData=s}}}}}]),t}();e.DeformSlotDisplayData=o},29564:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawOrderData=void 0;var r=a(i(15375));e.DrawOrderData=function t(){(0,r.default)(this,t),this.drawOrder=[]}},15571:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.EventData=void 0;var r=a(i(15375));e.EventData=function t(){(0,r.default)(this,t)}},11142:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.IkConstraint=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=i(78362),u=i(92493),h=function(){function t(e,i){(0,r.default)(this,t),this.isSpine=!0,this.isDebug=!1,this._targetBone=i[e.targetBoneIndex],this.isSpine=e.isSpine,null==this._bones&&(this._bones=[]),this._bones.length=0;for(var n=0,a=e.boneIndexs.length;n<a;n++)this._bones.push(i[e.boneIndexs[n]]);this.name=e.name,this.mix=e.mix,this.bendDirection=e.bendDirection}return(0,s.default)(t,[{key:"apply",value:function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}}},{key:"_applyIk1",value:function(e,i,n,a){var r=e.parentBone,s=1/(r.resultMatrix.a*r.resultMatrix.d-r.resultMatrix.b*r.resultMatrix.c),o=i-r.resultMatrix.tx,l=n-r.resultMatrix.ty,u=(o*r.resultMatrix.d-l*r.resultMatrix.c)*s-e.transform.x,h=(l*r.resultMatrix.a-o*r.resultMatrix.b)*s-e.transform.y,c=Math.atan2(h,u)*t.radDeg-0-e.transform.skX;e.transform.scX<0&&(c+=180),c>180?c-=360:c<-180&&(c+=360),e.transform.skX=e.transform.skY=e.transform.skX+c*a,e.update()}},{key:"updatePos",value:function(t,e){this._sp&&this._sp.pos(t,e)}},{key:"_applyIk2",value:function(e,i,n,a,r,s){if(0!=s){var o,h,c,d=e.resultTransform.x,f=e.resultTransform.y,_=e.transform.scX,v=e.transform.scY,y=i.transform.scX;_<0?(_=-_,o=180,c=-1):(o=0,c=1),v<0&&(v=-v,c=-c),y<0?(y=-y,h=180):h=0;var p,g,m,x=i.resultTransform.x,T=e.resultMatrix.a,k=e.resultMatrix.c,C=e.resultMatrix.b,S=e.resultMatrix.d,E=Math.abs(_-v)<=1e-4;E?(g=T*x+k*(p=i.resultTransform.y)+e.resultMatrix.tx,m=C*x+S*p+e.resultMatrix.ty):(p=0,g=T*x+e.resultMatrix.tx,m=C*x+e.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new l.Sprite,u.ILaya.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(n,a,15,"#ffff00"),this._sp.graphics.drawCircle(g,m,15,"#ff00ff")),e.setRotation(Math.atan2(m-e.resultMatrix.ty,g-e.resultMatrix.tx));var M=e.parentBone;T=M.resultMatrix.a,k=M.resultMatrix.c,C=M.resultMatrix.b;var L,b,I=1/(T*(S=M.resultMatrix.d)-k*C),R=n-M.resultMatrix.tx,w=a-M.resultMatrix.ty,A=(R*S-w*k)*I-d,B=(w*T-R*C)*I-f,D=((R=g-M.resultMatrix.tx)*S-(w=m-M.resultMatrix.ty)*k)*I-d,P=(w*T-R*C)*I-f,O=Math.sqrt(D*D+P*P),F=i.length*y;if(E){var U=(A*A+B*B-O*O-(F*=_)*F)/(2*O*F);U<-1?U=-1:U>1&&(U=1),b=Math.acos(U)*r,T=O+F*U,k=F*Math.sin(b),L=Math.atan2(B*T-A*k,A*T+B*k)}else{var N=(T=_*F)*T,G=(k=v*F)*k,H=A*A+B*B,W=Math.atan2(B,A),V=-2*G*O,Y=G-N;if((S=V*V-4*Y*(C=G*O*O+N*H-N*G))>0){var X=Math.sqrt(S);V<0&&(X=-X);var z=(X=-(V+X)/2)/Y,K=C/X,j=Math.abs(z)<Math.abs(K)?z:K;j*j<=H&&(w=Math.sqrt(H-j*j)*r,L=W-Math.atan2(w,j),b=Math.atan2(w/v,(j-O)/_))}var q=0,Z=Number.MAX_VALUE,Q=0,$=0,J=0,tt=0,et=0,it=0;(S=(R=O+T)*R)>tt&&(J=0,tt=S,et=R),(S=(R=O-T)*R)<Z&&(q=Math.PI,Z=S,Q=R);var nt=Math.acos(-T*O/(N-G));(S=(R=T*Math.cos(nt)+O)*R+(w=k*Math.sin(nt))*w)<Z&&(q=nt,Z=S,Q=R,$=w),S>tt&&(J=nt,tt=S,et=R,it=w),H<=(Z+tt)/2?(L=W-Math.atan2($*r,Q),b=q*r):(L=W-Math.atan2(it*r,et),b=J*r)}var at=Math.atan2(p,x)*c,rt=e.resultTransform.skX;(L=(L-at)*t.radDeg+o-rt)>180?L-=360:L<-180&&(L+=360),e.resultTransform.x=d,e.resultTransform.y=f,e.resultTransform.skX=e.resultTransform.skY=rt+L*s,rt=i.resultTransform.skX,rt%=360,(b=((b+at)*t.radDeg-0)*c+h-rt)>180?b-=360:b<-180&&(b+=360),i.resultTransform.x=x,i.resultTransform.y=p,i.resultTransform.skX=i.resultTransform.skY=i.resultTransform.skY+b*s,e.update()}}},{key:"_applyIk3",value:function(e,i,n,a,r,s){if(0!=s){var o,h,c,d,f,_,v=i.resultMatrix.a*i.length,y=i.resultMatrix.b*i.length,p=v*v+y*y,g=Math.sqrt(p),m=e.resultMatrix.tx,x=e.resultMatrix.ty,T=i.resultMatrix.tx,k=i.resultMatrix.ty,C=T-m,S=k-x,E=C*C+S*S,M=Math.sqrt(E),L=(C=n-e.resultMatrix.tx)*C+(S=a-e.resultMatrix.ty)*S,b=Math.sqrt(L);if(g+M<=b||b+g<=M||b+M<=g){var I;T=m+(I=g+M<=b?1:-1)*(n-m)*M/b,k=x+I*(a-x)*M/b}else{var R=(E-p+L)/(2*L),w=Math.sqrt(E-R*R*L)/b,A=m+C*R,B=x+S*R,D=-S*w,P=C*w;r>0?(T=A-D,k=B-P):(T=A+D,k=B+P)}o=T,h=k,this.isDebug&&(this._sp||(this._sp=new l.Sprite,u.ILaya.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(m,x,15,"#ff00ff"),this._sp.graphics.drawCircle(n,a,15,"#ffff00"),this._sp.graphics.drawCircle(o,h,15,"#ff00ff")),c=Math.atan2(h-e.resultMatrix.ty,o-e.resultMatrix.tx),e.setRotation(c),(d=t._tempMatrix).identity(),d.rotate(c),d.scale(e.resultMatrix.getScaleX(),e.resultMatrix.getScaleY()),d.translate(e.resultMatrix.tx,e.resultMatrix.ty),d.copyTo(e.resultMatrix),e.updateChild(),f=Math.atan2(a-h,n-o),i.setRotation(f),(_=t._tempMatrix).identity(),_.rotate(f),_.scale(i.resultMatrix.getScaleX(),i.resultMatrix.getScaleY()),_.translate(o,h),d.copyTo(i.resultMatrix),i.updateChild()}}}]),t}();e.IkConstraint=h,h.radDeg=180/Math.PI,h.degRad=Math.PI/180,h._tempMatrix=new o.Matrix},36514:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.IkConstraintData=void 0;var r=a(i(15375));e.IkConstraintData=function t(){(0,r.default)(this,t),this.boneNames=[],this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneIndexs=[]}},42869:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.PathConstraint=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=function(){function t(e,i){(0,r.default)(this,t),this._debugKey=!1,this._segments=[],this._curves=[],this.data=e,this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.bones=[];for(var n=this.data.bones,a=0,s=n.length;a<s;a++)this.bones.push(i[n[a]])}return(0,s.default)(t,[{key:"apply",value:function(t,e){if(this.target){var i=this.translateMix,n=this.translateMix,a=n>0,r=this.data.spacingMode,s="length"==r,o=this.data.rotateMode,l="tangent"==o,u="chainScale"==o,h=[],c=this.bones.length,d=l?c:c+1,f=[];this._spaces=f,f[0]=this.position;var _=this.spacing;if(u||s)for(var v=0,y=d-1;v<y;){var p=this.bones[v],g=p.length,m=g*p.resultMatrix.a,x=g*p.resultMatrix.b;g=Math.sqrt(m*m+x*x),u&&(h[v]=g),f[++v]=s?Math.max(0,g+_):_}else for(v=1;v<d;v++)f[v]=_;var T=this.computeWorldPositions(this.target,t,e,d,l,"percent"==this.data.positionMode,"percent"==r);if(this._debugKey){for(v=0;v<T.length;v++)e.drawCircle(T[v++],T[v++],5,"#00ff00");var k=[];for(v=0;v<T.length;v++)k.push(T[v++],T[v++]);e.drawLines(0,0,k,"#ff0000")}var C,S=T[0],E=T[1],M=this.data.offsetRotation,L="chain"==o&&0==M;for(v=0,C=3;v<c;v++,C+=3){(p=this.bones[v]).resultMatrix.tx+=(S-p.resultMatrix.tx)*i,p.resultMatrix.ty+=(E-p.resultMatrix.ty)*i;var b=(m=T[C])-S,I=(x=T[C+1])-E;if(u&&0!=(g=h[v])){var R=(Math.sqrt(b*b+I*I)/g-1)*n+1;p.resultMatrix.a*=R,p.resultMatrix.c*=R}if(S=m,E=x,a){var w,A,B,D=p.resultMatrix.a,P=p.resultMatrix.c,O=p.resultMatrix.b,F=p.resultMatrix.d;w=l?T[C-1]:0==f[v+1]?T[C+2]:Math.atan2(I,b),w-=Math.atan2(O,D)-M/180*Math.PI,L&&(A=Math.cos(w),B=Math.sin(w),S+=((g=p.length)*(A*D-B*O)-b)*n,E+=(g*(B*D+A*O)-I)*n),w>Math.PI?w-=2*Math.PI:w<-Math.PI&&(w+=2*Math.PI),w*=n,A=Math.cos(w),B=Math.sin(w),p.resultMatrix.a=A*D-B*O,p.resultMatrix.c=A*P-B*F,p.resultMatrix.b=B*D+A*O,p.resultMatrix.d=B*P+A*F}}}}},{key:"computeWorldVertices2",value:function(e,i,n,a,r,s){var o,l,u,h=e.currDisplayData.bones,c=e.currDisplayData.weights,d=e.currDisplayData.triangles,f=0,_=0,v=0,y=0,p=0,g=0,m=0,x=0,T=0,k=0;if(null!=h){for(f=0;f<n;f+=2)_+=(y=h[_])+1,v+=y;var C=i;for(p=s,g=3*v;p<a;p+=2){for(m=0,x=0,y=h[_++],y+=_;_<y;_++,g+=3){o=C[h[_]].resultMatrix,T=c[g],k=c[g+1];var S=c[g+2];m+=(T*o.a+k*o.c+o.tx)*S,x+=(T*o.b+k*o.d+o.ty)*S}r[p]=m,r[p+1]=x}}else{var E,M;if(d||(d=c),e.deformData&&(d=e.deformData),E=e.parent,i)for(u=i.length,f=0;f<u;f++)if(i[f].name==E){l=i[f];break}l&&(M=l.resultMatrix),M||(M=t._tempMt);var L=M.tx,b=M.ty,I=M.a,R=M.b,w=M.c,A=M.d;for(l&&(A*=l.d),_=n,p=s;p<a;_+=2,p+=2)T=d[_],k=d[_+1],r[p]=T*I+k*R+L,r[p+1]=-(T*w+k*A+b)}}},{key:"computeWorldPositions",value:function(t,e,i,n,a,r,s){t.currDisplayData.bones,t.currDisplayData.weights,t.currDisplayData.triangles;var o,l,u,h,c,d,f,_=[],v=0,y=t.currDisplayData.verLen,p=this.position,g=this._spaces,m=[],x=[],T=y/6,k=-1;if(T--,y-=4,this.computeWorldVertices2(t,e,2,y,_,0),this._debugKey)for(v=0;v<_.length;)i.drawCircle(_[v++],_[v++],10,"#ff0000");m=_,this._curves.length=T;var C=this._curves;o=0;var S,E,M,L,b,I,R,w,A,B=m[0],D=m[1],P=0,O=0,F=0,U=0,N=0,G=0;for(v=0,A=2;v<T;v++,A+=6)P=m[A],O=m[A+1],F=m[A+2],U=m[A+3],b=2*(S=.1875*(B-2*P+F))+(M=.09375*(3*(P-F)-B+(N=m[A+4]))),I=2*(E=.1875*(D-2*O+U))+(L=.09375*(3*(O-U)-D+(G=m[A+5]))),R=.75*(P-B)+S+.16666667*M,w=.75*(O-D)+E+.16666667*L,o+=Math.sqrt(R*R+w*w),R+=b,w+=I,b+=M,I+=L,o+=Math.sqrt(R*R+w*w),R+=b,w+=I,o+=Math.sqrt(R*R+w*w),R+=b+M,w+=I+L,o+=Math.sqrt(R*R+w*w),C[v]=o,B=N,D=G;if(r&&(p*=o),s)for(v=0;v<n;v++)g[v]*=o;var H,W=this._segments,V=0;for(v=0,l=0,u=0,H=0;v<n;v++,l+=3)if((h=p+=c=g[v])<0)this.addBeforePosition(h,m,0,x,l);else if(h>o)this.addAfterPosition(h-o,m,y-4,x,l);else{for(;;u++)if(!(h>(f=C[u]))){0==u?h/=f:h=(h-(d=C[u-1]))/(f-d);break}if(u!=k){k=u;var Y=6*u;for(B=m[Y],D=m[Y+1],P=m[Y+2],O=m[Y+3],F=m[Y+4],U=m[Y+5],b=2*(S=.03*(B-2*P+F))+(M=.006*(3*(P-F)-B+(N=m[Y+6]))),I=2*(E=.03*(D-2*O+U))+(L=.006*(3*(O-U)-D+(G=m[Y+7]))),R=.3*(P-B)+S+.16666667*M,w=.3*(O-D)+E+.16666667*L,V=Math.sqrt(R*R+w*w),W[0]=V,Y=1;Y<8;Y++)R+=b,w+=I,b+=M,I+=L,V+=Math.sqrt(R*R+w*w),W[Y]=V;R+=b,w+=I,V+=Math.sqrt(R*R+w*w),W[8]=V,R+=b+M,w+=I+L,V+=Math.sqrt(R*R+w*w),W[9]=V,H=0}for(h*=V;;H++)if(!(h>(f=W[H]))){0==H?h/=f:h=H+(h-(d=W[H-1]))/(f-d);break}this.addCurvePosition(.1*h,B,D,P,O,F,U,N,G,x,l,a||v>0&&0==c)}return x}},{key:"addBeforePosition",value:function(t,e,i,n,a){var r=e[i],s=e[i+1],o=e[i+2]-r,l=e[i+3]-s,u=Math.atan2(l,o);n[a]=r+t*Math.cos(u),n[a+1]=s+t*Math.sin(u),n[a+2]=u}},{key:"addAfterPosition",value:function(t,e,i,n,a){var r=e[i+2],s=e[i+3],o=r-e[i],l=s-e[i+1],u=Math.atan2(l,o);n[a]=r+t*Math.cos(u),n[a+1]=s+t*Math.sin(u),n[a+2]=u}},{key:"addCurvePosition",value:function(t,e,i,n,a,r,s,o,l,u,h,c){0==t&&(t=1e-4);var d=t*t,f=d*t,_=1-t,v=_*_,y=v*_,p=_*t,g=3*p,m=_*g,x=g*t,T=e*y+n*m+r*x+o*f,k=i*y+a*m+s*x+l*f;u[h]=T,u[h+1]=k,u[h+2]=c?Math.atan2(k-(i*v+a*p*2+s*d),T-(e*v+n*p*2+r*d)):0}}]),t}();e.PathConstraint=l,l.BEFORE=-2,l.AFTER=-3,l._tempMt=new o.Matrix},17847:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.PathConstraintData=void 0;var r=a(i(15375));e.PathConstraintData=function t(){(0,r.default)(this,t),this.bones=[]}},37564:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Skeleton=void 0;var s=r(i(92762)),o=r(i(15375)),l=r(i(17061)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(11142),_=i(42869),v=i(950),y=i(48796),p=i(2689),g=i(78362),m=i(41107),x=i(18008),T=i(89662),k=i(17886),C=i(14002),S=i(49029),E=i(92493),M=i(23835);function L(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var b=function(t){(0,h.default)(i,t);var e=L(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,o.default)(this,i),(t=e.call(this))._boneMatrixArray=[],t._lastTime=0,t._currAniIndex=-1,t._pause=!0,t._aniClipIndex=-1,t._clipIndex=-1,t._skinIndex=0,t._skinName="default",t._aniMode=0,t._index=-1,t._total=-1,t._indexControl=!1,t._eventIndex=0,t._drawOrderIndex=0,t._drawOrder=null,t._lastAniClipIndex=-1,t._lastUpdateAniClipIndex=-1,t._playAudio=!0,t._soundChannelArr=[],n&&t.init(n,a),t}return(0,l.default)(i,[{key:"init",value:function(t){var e,i,n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=0;if(1==r)for(this._graphicsCache=[],s=0,e=t.getAnimationCount();s<e;s++)this._graphicsCache.push([]);if(this._yReverseMatrix=t.yReverseMatrix,this._aniMode=r,this._templet=t,this._templet._addReference(1),this._player=new y.AnimationPlayer,this._player.cacheFrameRate=t.rate,this._player.templet=t,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=t.mBoneArr,this._rootBone=t.mRootBone,this._aniSectionDic=t.aniSectionDic,t.ikArr.length>0)for(this._ikArr=[],s=0,e=t.ikArr.length;s<e;s++)this._ikArr.push(new f.IkConstraint(t.ikArr[s],this._boneList));if(t.pathArr.length>0)for(null==this._pathDic&&(this._pathDic={}),s=0,e=t.pathArr.length;s<e;s++)i=t.pathArr[s],n=new _.PathConstraint(i,this._boneList),(a=this._boneSlotDic[i.name])&&((n=new _.PathConstraint(i,this._boneList)).target=a),this._pathDic[i.name]=n;if(t.tfArr.length>0)for(this._tfArr=[],s=0,e=t.tfArr.length;s<e;s++)this._tfArr.push(new v.TfConstraint(t.tfArr[s],this._boneList));if(t.skinDataArray.length>0){var o=this._templet.skinDataArray[this._skinIndex];this._skinName=o.name}this._player.on(T.Event.PLAYED,this,this._onPlay),this._player.on(T.Event.STOPPED,this,this._onStop),this._player.on(T.Event.PAUSED,this,this._onPause)}},{key:"url",get:function(){return this._aniPath},set:function(t){this.load(t)}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._aniPath=t,this._complete=e,this._loadAniMode=i,E.ILaya.loader.load([{url:t,type:E.ILaya.Loader.BUFFER}],m.Handler.create(this,this._onLoaded))}},{key:"_onLoaded",value:function(){var t,e=E.ILaya.Loader.getRes(this._aniPath);null!=e&&(null==S.IAniLib.Templet.TEMPLET_DICTIONARY&&(S.IAniLib.Templet.TEMPLET_DICTIONARY={}),(t=S.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath])?t.isParseFail?this._parseFail():t.isParserComplete?this._parseComplete():(t.on(T.Event.COMPLETE,this,this._parseComplete),t.on(T.Event.ERROR,this,this._parseFail)):((t=new S.IAniLib.Templet)._setCreateURL(this._aniPath),S.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath]=t,t.on(T.Event.COMPLETE,this,this._parseComplete),t.on(T.Event.ERROR,this,this._parseFail),t.isParserComplete=!1,t.parseData(null,e)))}},{key:"_parseComplete",value:function(){var t=S.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath];t&&(this.init(t,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)}},{key:"_parseFail",value:function(){console.log("[Error]:"+this._aniPath+"解析失败")}},{key:"_onPlay",value:function(){this.event(T.Event.PLAYED)}},{key:"_onStop",value:function(){var t,e=this._templet.eventAniArr[this._aniClipIndex];if(e&&this._eventIndex<e.length)for(;this._eventIndex<e.length;this._eventIndex++)(t=e[this._eventIndex]).time>=this._player.playStart&&t.time<=this._player.playEnd&&this.event(T.Event.LABEL,t);this._drawOrder=null,this.event(T.Event.STOPPED)}},{key:"_onPause",value:function(){this.event(T.Event.PAUSED)}},{key:"_parseSrcBoneMatrix",value:function(){var t=0,e=0;for(e=this._templet.srcBoneMatrixArr.length,t=0;t<e;t++)this._boneMatrixArray.push(new x.Matrix);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var i,n,a=this._templet.boneSlotArray;for(t=0,e=a.length;t<e;t++)i=a[t],null==(n=this._bindBoneBoneSlotDic[i.parent])&&(this._bindBoneBoneSlotDic[i.parent]=n=[]),this._boneSlotDic[i.name]=i=i.copy(),n.push(i),this._boneSlotArray.push(i)}}},{key:"_emitMissedEvents",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this._templet.eventAniArr,a=n[this._player.currentAnimationClipIndex];if(a){var r,s,o=0;for(r=a.length,o=i;o<r;o++)(s=a[o]).time>=this._player.playStart&&s.time<=this._player.playEnd&&this.event(T.Event.LABEL,s)}}},{key:"_update",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!(t&&this._pause||t&&this._indexControl)){var e=this.timer.currTimer,i=this._player.currentKeyframeIndex,n=e-this._lastTime;if(t?this._player._update(n):i=-1,this._lastTime=e,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||n>0&&this._clipIndex==i&&this._lastUpdateAniClipIndex==this._aniClipIndex))){this._lastUpdateAniClipIndex=this._aniClipIndex,i>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var a,r,s=this._templet.eventAniArr[this._aniClipIndex];if(s&&this._eventIndex<s.length){var o=s[this._eventIndex];o.time>=this._player.playStart&&o.time<=this._player.playEnd?this._player.currentPlayTime>=o.time&&(this.event(T.Event.LABEL,o),this._eventIndex++,this._playAudio&&o.audioValue&&"null"!==o.audioValue&&"undefined"!==o.audioValue&&(a=k.SoundManager.playSound(this._player.templet._path+o.audioValue,1,m.Handler.create(this,this._onAniSoundStoped)),k.SoundManager.playbackRate=this._player.playbackRate,a&&this._soundChannelArr.push(a))):o.time<this._player.playStart&&this._playAudio&&o.audioValue&&"null"!==o.audioValue&&"undefined"!==o.audioValue?(this._eventIndex++,a=k.SoundManager.playSound(this._player.templet._path+o.audioValue,1,m.Handler.create(this,this._onAniSoundStoped),null,(this._player.currentPlayTime-o.time)/1e3),k.SoundManager.playbackRate=this._player.playbackRate,a&&this._soundChannelArr.push(a)):this._eventIndex++}0==this._aniMode?(r=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=r&&(this.graphics=r):1==this._aniMode?(r=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=r&&(this.graphics=r):this._createGraphics()}}}},{key:"_onAniSoundStoped",value:function(t){for(var e,i=this._soundChannelArr.length,n=0;n<i;n++){var a;if((e=this._soundChannelArr[n]).isStopped||t)!e.isStopped&&e.stop(),(0,s.default)(a=this._soundChannelArr).call(a,n,1),i--,n--}}},{key:"_createGraphics",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;-1==t&&(t=this._clipIndex);var e,i=t*this._player.cacheFrameRateInterval,n=this._templet.drawOrderAniArr,a=n[this._aniClipIndex];if(a&&a.length>0)for(this._drawOrderIndex=0,e=a[this._drawOrderIndex];i>=e.time&&(this._drawOrder=e.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=a.length));)e=a[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=p.GraphicsAni.create():this.graphics instanceof p.GraphicsAni?this.graphics.clear():this.graphics=p.GraphicsAni.create();var r=this.graphics,s=this._templet.getNodes(this._aniClipIndex),o=0==this._player.state;this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,null,t,o?i+this._player.cacheFrameRateInterval:i);var l,u,h,c,d=this._aniSectionDic[this._aniClipIndex],f=0,_=0,v=0,y=0,g=0,m=this._templet.srcBoneMatrixArr.length,T=this._curOriginalData;for(_=0,g=d[0];_<m;_++){var k=(c=this._boneList[_]).resultTransform;h=this._templet.srcBoneMatrixArr[_],k.scX=h.scX*T[f++],k.skX=h.skX+T[f++],k.skY=h.skY+T[f++],k.scY=h.scY*T[f++],k.x=h.x+T[f++],k.y=h.y+T[f++],8===this._templet.tMatrixDataLen&&(k.skewX=h.skewX+T[f++],k.skewY=h.skewY+T[f++])}var S,E={},M={};for(g+=d[1];_<g;_++)E[(S=s[_]).name]=T[f++],M[S.name]=T[f++],f+=4;var L,b,I={},R={};for(g+=d[2];_<g;_++)I[(S=s[_]).name]=T[f++],R[S.name]=T[f++],f+=4;if(this._pathDic)for(g+=d[3];_<g;_++)if(S=s[_],L=this._pathDic[S.name]){var w=new C.Byte(S.extenData);switch(w.getByte()){case 1:L.position=T[f++];break;case 2:L.spacing=T[f++];break;case 3:L.rotateMix=T[f++],L.translateMix=T[f++]}}if(this._rootBone.update(this._yReverseMatrix||x.Matrix.TEMP.identity()),this._ikArr)for(_=0,g=this._ikArr.length;_<g;_++)(b=this._ikArr[_]).name in I&&(b.bendDirection=I[b.name]),b.name in R&&(b.mix=R[b.name]),b.apply();if(this._pathDic)for(var A in this._pathDic)(L=this._pathDic[A]).apply(this._boneList,r);if(this._tfArr)for(_=0,y=this._tfArr.length;_<y;_++)this._tfArr[_].apply();for(_=0,y=this._boneList.length;_<y;_++)if(c=this._boneList[_],u=this._bindBoneBoneSlotDic[c.name],c.resultMatrix.copyTo(this._boneMatrixArray[_]),u)for(v=0,g=u.length;v<g;v++)(l=u[v])&&l.setParentMatrix(c.resultMatrix);var B,D,P,O,F={},U=this._templet.deformAniArr;if(U&&U.length>0){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,_=0,g=this._boneSlotArray.length;_<g;_++)(l=this._boneSlotArray[_]).deformData=null;var N,G=U[this._aniClipIndex];for(N in B=G.default,this._setDeform(B,F,this._boneSlotArray,i),G)"default"!=N&&N!=this._skinName&&(B=G[N],this._setDeform(B,F,this._boneSlotArray,i));B=G[this._skinName],this._setDeform(B,F,this._boneSlotArray,i)}if(this._drawOrder)for(_=0,g=this._drawOrder.length;_<g;_++)D=E[(l=this._boneSlotArray[this._drawOrder[_]]).name],P=M[l.name],isNaN(P),isNaN(D)||-2==D||(this._templet.attachmentNames?l.showDisplayByName(this._templet.attachmentNames[D]):l.showDisplayByIndex(D)),F[this._drawOrder[_]]?(O=F[this._drawOrder[_]],l.currDisplayData&&O[l.currDisplayData.attachmentName]?l.deformData=O[l.currDisplayData.attachmentName]:l.deformData=null):l.deformData=null,isNaN(P)?l.draw(r,this._boneMatrixArray,2==this._aniMode):l.draw(r,this._boneMatrixArray,2==this._aniMode,P),isNaN(P);else for(_=0,g=this._boneSlotArray.length;_<g;_++)D=E[(l=this._boneSlotArray[_]).name],P=M[l.name],isNaN(P),isNaN(D)||-2==D||(this._templet.attachmentNames?l.showDisplayByName(this._templet.attachmentNames[D]):l.showDisplayByIndex(D)),F[_]?(O=F[_],l.currDisplayData&&O[l.currDisplayData.attachmentName]?l.deformData=O[l.currDisplayData.attachmentName]:l.deformData=null):l.deformData=null,isNaN(P)?l.draw(r,this._boneMatrixArray,2==this._aniMode):l.draw(r,this._boneMatrixArray,2==this._aniMode,P),isNaN(P);return 0==this._aniMode?(this._templet.setGrahicsDataWithCache(this._aniClipIndex,t,r),this._checkIsAllParsed(this._aniClipIndex)):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,t,r),r}},{key:"_checkIsAllParsed",value:function(t){var e,i;for(i=Math.floor(.01+this._templet.getAniDuration(t)/1e3*this._player.cacheFrameRate),e=0;e<i;e++)if(!this._templet.getGrahicsDataWithCache(t,e))return;this._templet.getGrahicsDataWithCache(t,i)?this._templet.deleteAniData(t):this._createGraphics(i)}},{key:"_setDeform",value:function(t,e,i,n){var a,r,s,o,l,u;if(t&&t)for(o=0,l=t.deformSlotDataList.length;o<l;o++)for(a=t.deformSlotDataList[o],u=0;u<a.deformSlotDisplayList.length;u++)s=i[(r=a.deformSlotDisplayList[u]).slotIndex],r.apply(n,s),e[r.slotIndex]||(e[r.slotIndex]={}),e[r.slotIndex][r.attachment]=r.deformData}},{key:"getAnimNum",value:function(){return this._templet.getAnimationCount()}},{key:"getAniNameByIndex",value:function(t){return this._templet.getAniNameByIndex(t)}},{key:"getSlotByName",value:function(t){return this._boneSlotDic[t]}},{key:"showSkinByName",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.showSkinByIndex(this._templet.getSkinIndexByName(t),e)}},{key:"showSkinByIndex",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=0;i<this._boneSlotArray.length;i++)this._boneSlotArray[i].showSlotData(null,e);if(this._templet.showSkinByIndex(this._boneSlotDic,t,e)){var n=this._templet.skinDataArray[t];this._skinIndex=t,this._skinName=n.name}this._clearCache()}},{key:"showSlotSkinByIndex",value:function(t,e){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.showDisplayByIndex(e),this._clearCache()}}},{key:"showSlotSkinByName",value:function(t,e){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.showDisplayByName(e),this._clearCache()}}},{key:"replaceSlotSkinName",value:function(t,e,i){if(0!=this._aniMode){var n=this.getSlotByName(t);n&&n.replaceDisplayByName(e,i),this._clearCache()}}},{key:"replaceSlotSkinByIndex",value:function(t,e,i){if(0!=this._aniMode){var n=this.getSlotByName(t);n&&n.replaceDisplayByIndex(e,i),this._clearCache()}}},{key:"setSlotSkin",value:function(t,e){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.replaceSkin(e),this._clearCache()}}},{key:"_clearCache",value:function(){if(1==this._aniMode)for(var t=0,e=this._graphicsCache.length;t<e;t++){for(var i=0,n=this._graphicsCache[t].length;i<n;i++){var a=this._graphicsCache[t][i];a&&a!=this.graphics&&p.GraphicsAni.recycle(a)}this._graphicsCache[t].length=0}}},{key:"play",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this._playAudio=s,this._indexControl=!1;var o,l=-1;if(o=e?2147483647:0,"string"==typeof t)for(var u=0,h=this._templet.getAnimationCount();u<h;u++){var c=this._templet.getAnimation(u);if(c&&t==c.name){l=u;break}}else l=t;l>-1&&l<this.getAnimNum()&&(this._aniClipIndex=l,(i||this._pause||this._currAniIndex!=l)&&(this._currAniIndex=l,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(l)),this._drawOrder=null,this._eventIndex=0,this._player.play(l,this._player.playbackRate,o,n,a),r&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=E.ILaya.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))}},{key:"stop",value:function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this._soundChannelArr.length>0&&this._onAniSoundStoped(!0),this.timer.clear(this,this._update))}},{key:"playbackRate",value:function(t){this._player&&(this._player.playbackRate=t)}},{key:"paused",value:function(){if(!this._pause){if(this._pause=!0,this._player&&(this._player.paused=!0),this._soundChannelArr.length>0)for(var t,e=this._soundChannelArr.length,i=0;i<e;i++)(t=this._soundChannelArr[i]).isStopped||t.pause();this.timer.clear(this,this._update)}}},{key:"resume",value:function(){if(this._indexControl=!1,this._pause){if(this._pause=!1,this._player&&(this._player.paused=!1),this._soundChannelArr.length>0)for(var t,e=this._soundChannelArr.length,i=0;i<e;i++)(t=this._soundChannelArr[i]).audioBuffer&&t.resume();this._lastTime=E.ILaya.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)}}},{key:"_getGrahicsDataWithCache",value:function(t,e){return this._graphicsCache[t][e]}},{key:"_setGrahicsDataWithCache",value:function(t,e,i){this._graphicsCache[t][e]=i}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._templet._removeReference(1),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update),this._soundChannelArr.length>0&&this._onAniSoundStoped(!0)}},{key:"index",get:function(){return this._index},set:function(t){this.player&&(this._index=t,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,(this._aniClipIndex<0||this._aniClipIndex>=this.getAnimNum())&&(this._aniClipIndex=0,this._currAniIndex=0,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(this._currAniIndex)),this._drawOrder=null,this._eventIndex=0),this._update(!1))}},{key:"total",get:function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}},{key:"player",get:function(){return this._player}},{key:"templet",get:function(){return this._templet}}]),i}(g.Sprite);e.Skeleton=b,b.useSimpleMeshInCanvas=!1,S.IAniLib.Skeleton=b,E.ILaya.regClass(b),M.ClassUtils.regClass("laya.ani.bone.Skeleton",b),M.ClassUtils.regClass("Laya.Skeleton",b)},92487:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SkinData=void 0;var r=a(i(15375));e.SkinData=function t(){(0,r.default)(this,t),this.slotArr=[]}},4286:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SkinSlotDisplayData=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(54598),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"createTexture",value:function(t){return this.texture||(this.texture=new o.Texture(t.bitmap,this.uvs),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=t.height,this.texture.height=t.width,this.texture.offsetX=-t.offsetX,this.texture.offsetY=-t.offsetY,this.texture.sourceWidth=t.sourceHeight,this.texture.sourceHeight=t.sourceWidth):(this.texture.width=t.width,this.texture.height=t.height,this.texture.offsetX=-t.offsetX,this.texture.offsetY=-t.offsetY,this.texture.sourceWidth=t.sourceWidth,this.texture.sourceHeight=t.sourceHeight)),this.texture}},{key:"destory",value:function(){this.texture&&this.texture.destroy()}}]),t}();e.SkinSlotDisplayData=l},8359:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SlotData=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t),this.displayArr=[]}return(0,s.default)(t,[{key:"getDisplayByName",value:function(t){for(var e=0,i=this.displayArr.length;e<i;e++)if(this.displayArr[e].attachmentName==t)return e;return-1}}]),t}();e.SlotData=o},48365:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Templet=void 0;var s=r(i(3649)),o=r(i(23054)),l=r(i(81643)),u=r(i(15375)),h=r(i(17061)),c=r(i(45408)),d=r(i(97709)),f=r(i(38191)),_=r(i(52305)),v=i(62775),y=i(87338),p=i(17847),g=i(39512),m=i(28973),x=i(50403),T=i(29564),k=i(15571),C=i(23038),S=i(18460),E=i(92487),M=i(4286),L=i(8359),b=i(81097),I=i(36514),R=i(54598),w=i(18008),A=i(41107),B=i(89662),D=i(14002),P=i(49029),O=i(37564),F=i(92493);function U(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,_.default)(t);if(e){var r=(0,_.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,f.default)(this,i)}}var N=function(t){(0,d.default)(i,t);var e=U(i);function i(){var t;return(0,u.default)(this,i),(t=e.apply(this,arguments))._graphicsCache=[],t.srcBoneMatrixArr=[],t.ikArr=[],t.tfArr=[],t.pathArr=[],t.boneSlotDic={},t.bindBoneBoneSlotDic={},t.boneSlotArray=[],t.skinDataArray=[],t.skinDic={},t.subTextureDic={},t.isParseFail=!1,t.drawOrderAniArr=[],t.eventAniArr=[],t.attachmentNames=null,t.deformAniArr=[],t.skinSlotDisplayDataArr=[],t._isParseAudio=!1,t._isDestroyed=!1,t._rate=30,t.isParserComplete=!1,t.aniSectionDic={},t._textureDic={},t.mBoneArr=[],t}return(0,h.default)(i,[{key:"loadAni",value:function(t){this._skBufferUrl=t,F.ILaya.loader.load(t,A.Handler.create(this,this.onComplete),null,F.ILaya.Loader.BUFFER)}},{key:"onComplete",value:function(){var t,e;if(this._isDestroyed)this.destroy();else{var i=F.ILaya.Loader.getRes(this._skBufferUrl);i?(this._path=(0,s.default)(t=this._skBufferUrl).call(t,0,(0,o.default)(e=this._skBufferUrl).call(e,"/"))+"/",this.parseData(null,i)):this.event(B.Event.ERROR,"load failed:"+this._skBufferUrl)}}},{key:"parseData",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(!this._path){var n=this._relativeUrl||this.url;if(n){var a=(0,o.default)(n).call(n,"/");this._path=a>0?(0,s.default)(n).call(n,0,a)+"/":""}}this._mainTexture=t,this._rate=i,this.parse(e)}},{key:"buildArmature",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new O.Skeleton(this,t)}},{key:"parse",value:function(t){(0,c.default)((0,_.default)(i.prototype),"parse",this).call(this,t),this.event(B.Event.LOADED,this),this._aniVersion===i.LAYA_ANIMATION_VISION?this._isParseAudio=!0:this._aniVersion!=i.LAYA_ANIMATION_160_VISION&&console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+i.LAYA_ANIMATION_VISION),this._mainTexture?this._parsePublicExtData():this._parseTexturePath()}},{key:"_parseTexturePath",value:function(){if(this._isDestroyed)this.destroy();else{var t=0;this._loadList=[];var e,i=new D.Byte(this.getPublicExtData()),n=0,a=0,r=0,s=i.getInt32(),o=i.readUTFString(),u=o.split("\n");for(t=0;t<s;t++){var h;e=this._path+u[2*t],o=u[2*t+1],i.getFloat32(),i.getFloat32(),n=i.getFloat32(),a=i.getFloat32(),r=i.getFloat32(),isNaN(r)?0:r,r=i.getFloat32(),isNaN(r)?0:r,r=i.getFloat32(),isNaN(r)?n:r,r=i.getFloat32(),isNaN(r)?a:r,-1==(0,l.default)(h=this._loadList).call(h,e)&&this._loadList.push(e)}F.ILaya.loader.load(this._loadList,A.Handler.create(this,this._textureComplete))}}},{key:"_textureComplete",value:function(){for(var t,e=0,i=this._loadList.length;e<i;e++)t=this._loadList[e],this._textureDic[t]=F.ILaya.Loader.getRes(t);this._parsePublicExtData()}},{key:"_parsePublicExtData",value:function(){var t,e=0,i=0,n=0,a=0,r=0;for(e=0,r=this.getAnimationCount();e<r;e++)this._graphicsCache.push([]);t="Dragon"!=this._aniClassName;var s,o,l=new D.Byte(this.getPublicExtData()),u=0,h=0,c=0,d=0,f=0,_=0,C=0,A=0,P=0,O=l.getInt32(),F=l.readUTFString(),U=F.split("\n");for(e=0;e<O;e++){if(s=this._mainTexture,o=this._path+U[2*e],F=U[2*e+1],null==this._mainTexture&&(s=this._textureDic[o]),!s)return this.event(B.Event.ERROR,this),void(this.isParseFail=!0);u=l.getFloat32(),h=l.getFloat32(),c=l.getFloat32(),d=l.getFloat32(),P=l.getFloat32(),f=isNaN(P)?0:P,P=l.getFloat32(),_=isNaN(P)?0:P,P=l.getFloat32(),C=isNaN(P)?c:P,P=l.getFloat32(),A=isNaN(P)?d:P,this.subTextureDic[F]=R.Texture.create(s,u,h,c,d,-f,-_,C,A)}this._mainTexture=s;var N,G,H,W,V,Y=l.getUint16();for(e=0;e<Y;e++)(N=[]).push(l.getUint16()),N.push(l.getUint16()),N.push(l.getUint16()),N.push(l.getUint16()),this.aniSectionDic[e]=N;var X,z=l.getInt16(),K={};for(e=0;e<z;e++)G=new v.Bone,0==e?X=G:G.root=X,G.d=t?-1:1,W=l.readUTFString(),V=l.readUTFString(),G.length=l.getFloat32(),1==l.getByte()&&(G.inheritRotation=!1),1==l.getByte()&&(G.inheritScale=!1),G.name=W,V&&((H=K[V])?H.addChild(G):this.mRootBone=G),K[W]=G,this.mBoneArr.push(G);this.tMatrixDataLen=l.getUint16();var j,q,Z=l.getUint16(),Q=Math.floor(Z/this.tMatrixDataLen),$=this.srcBoneMatrixArr;for(e=0;e<Q;e++)(j=new b.Transform).scX=l.getFloat32(),j.skX=l.getFloat32(),j.skY=l.getFloat32(),j.scY=l.getFloat32(),j.x=l.getFloat32(),j.y=l.getFloat32(),8===this.tMatrixDataLen&&(j.skewX=l.getFloat32(),j.skewY=l.getFloat32()),$.push(j),(G=this.mBoneArr[e]).transform=j;var J,tt,et=l.getUint16();for(e=0;e<et;e++){for(q=new I.IkConstraintData,J=l.getUint16(),i=0;i<J;i++)q.boneNames.push(l.readUTFString()),q.boneIndexs.push(l.getInt16());q.name=l.readUTFString(),q.targetBoneName=l.readUTFString(),q.targetBoneIndex=l.getInt16(),q.bendDirection=l.getFloat32(),q.mix=l.getFloat32(),q.isSpine=t,this.ikArr.push(q)}var it,nt,at=l.getUint16();for(e=0;e<at;e++){for(tt=new y.TfConstraintData,it=l.getUint16(),i=0;i<it;i++)tt.boneIndexs.push(l.getInt16());tt.name=l.getUTFString(),tt.targetIndex=l.getInt16(),tt.rotateMix=l.getFloat32(),tt.translateMix=l.getFloat32(),tt.scaleMix=l.getFloat32(),tt.shearMix=l.getFloat32(),tt.offsetRotation=l.getFloat32(),tt.offsetX=l.getFloat32(),tt.offsetY=l.getFloat32(),tt.offsetScaleX=l.getFloat32(),tt.offsetScaleY=l.getFloat32(),tt.offsetShearY=l.getFloat32(),this.tfArr.push(tt)}var rt,st,ot,lt,ut,ht,ct,dt,ft,_t,vt=l.getUint16();for(e=0;e<vt;e++){for((nt=new p.PathConstraintData).name=l.readUTFString(),rt=l.getUint16(),i=0;i<rt;i++)nt.bones.push(l.getInt16());nt.target=l.readUTFString(),nt.positionMode=l.readUTFString(),nt.spacingMode=l.readUTFString(),nt.rotateMode=l.readUTFString(),nt.offsetRotation=l.getFloat32(),nt.position=l.getFloat32(),nt.spacing=l.getFloat32(),nt.rotateMix=l.getFloat32(),nt.translateMix=l.getFloat32(),this.pathArr.push(nt)}var yt,pt=l.getInt16();for(e=0;e<pt;e++){var gt=l.getUint8(),mt={};this.deformAniArr.push(mt);for(var xt=0;xt<gt;xt++)for((ct=new g.DeformAniData).skinName=l.getUTFString(),mt[ct.skinName]=ct,st=l.getInt16(),i=0;i<st;i++)for(dt=new m.DeformSlotData,ct.deformSlotDataList.push(dt),ot=l.getInt16(),n=0;n<ot;n++)for(ft=new x.DeformSlotDisplayData,dt.deformSlotDisplayList.push(ft),ft.slotIndex=l.getInt16(),ft.attachment=l.getUTFString(),lt=l.getInt16(),a=0;a<lt;a++)for(1==l.getByte()?ft.tweenKeyList.push(!0):ft.tweenKeyList.push(!1),ut=l.getFloat32(),ft.timeList.push(ut),_t=[],ft.vectices.push(_t),ht=l.getInt16(),r=0;r<ht;r++)_t.push(l.getFloat32())}var Tt,kt,Ct,St,Et=l.getInt16();for(e=0;e<Et;e++){for(Tt=l.getInt16(),yt=[],i=0;i<Tt;i++){for((kt=new T.DrawOrderData).time=l.getFloat32(),Ct=l.getInt16(),n=0;n<Ct;n++)kt.drawOrder.push(l.getInt16());yt.push(kt)}this.drawOrderAniArr.push(yt)}var Mt,Lt,bt=l.getInt16();for(e=0;e<bt;e++){for(Mt=l.getInt16(),St=[],i=0;i<Mt;i++)(Lt=new k.EventData).name=l.getUTFString(),this._isParseAudio&&(Lt.audioValue=l.getUTFString()),Lt.intValue=l.getInt32(),Lt.floatValue=l.getFloat32(),Lt.stringValue=l.getUTFString(),Lt.time=l.getFloat32(),St.push(Lt);this.eventAniArr.push(St)}var It=l.getInt16();if(It>0)for(this.attachmentNames=[],e=0;e<It;e++)this.attachmentNames.push(l.getUTFString());var Rt,wt,At=l.getInt16();for(e=0;e<At;e++)(Rt=new S.BoneSlot).name=l.readUTFString(),Rt.parent=l.readUTFString(),Rt.attachmentName=l.readUTFString(),Rt.srcDisplayIndex=Rt.displayIndex=l.getInt16(),Rt.templet=this,this.boneSlotDic[Rt.name]=Rt,null==(wt=this.bindBoneBoneSlotDic[Rt.parent])&&(this.bindBoneBoneSlotDic[Rt.parent]=wt=[]),wt.push(Rt),this.boneSlotArray.push(Rt);var Bt,Dt,Pt,Ot,Ft,Ut,Nt,Gt,Ht,Wt,Vt=l.readUTFString().split("\n"),Yt=0,Xt=l.getUint8();for(e=0;e<Xt;e++){for((Bt=new E.SkinData).name=Vt[Yt++],Ot=l.getUint8(),i=0;i<Ot;i++){for((Dt=new L.SlotData).name=Vt[Yt++],Rt=this.boneSlotDic[Dt.name],Ft=l.getUint8(),n=0;n<Ft;n++){if(Pt=new M.SkinSlotDisplayData,this.skinSlotDisplayDataArr.push(Pt),Pt.name=Vt[Yt++],Pt.attachmentName=Vt[Yt++],Pt.transform=new b.Transform,Pt.transform.scX=l.getFloat32(),Pt.transform.skX=l.getFloat32(),Pt.transform.skY=l.getFloat32(),Pt.transform.scY=l.getFloat32(),Pt.transform.x=l.getFloat32(),Pt.transform.y=l.getFloat32(),Dt.displayArr.push(Pt),Pt.width=l.getFloat32(),Pt.height=l.getFloat32(),Pt.type=l.getUint8(),Pt.verLen=l.getUint16(),(z=l.getUint16())>0)for(Pt.bones=[],a=0;a<z;a++){var zt=l.getUint16();Pt.bones.push(zt)}if((Ut=l.getUint16())>0)for(Pt.uvs=[],a=0;a<Ut;a++)Pt.uvs.push(l.getFloat32());if((Nt=l.getUint16())>0)for(Pt.weights=[],a=0;a<Nt;a++)Pt.weights.push(l.getFloat32());if((Gt=l.getUint16())>0)for(Pt.triangles=[],a=0;a<Gt;a++)Pt.triangles.push(l.getUint16());if((Ht=l.getUint16())>0)for(Pt.vertices=[],a=0;a<Ht;a++)Pt.vertices.push(l.getFloat32());if((Wt=l.getUint16())>0)for(Pt.lengths=[],a=0;a<Wt;a++)Pt.lengths.push(l.getFloat32())}Bt.slotArr.push(Dt)}this.skinDic[Bt.name]=Bt,this.skinDataArray.push(Bt)}1==l.getUint8()?(this.yReverseMatrix=new w.Matrix(1,0,0,-1,0,0),X&&X.setTempMatrix(this.yReverseMatrix)):X&&X.setTempMatrix(new w.Matrix),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event(B.Event.COMPLETE,this)}},{key:"getTexture",value:function(t){var e=this.subTextureDic[t];return e||(e=this.subTextureDic[t.substr(0,t.length-1)]),null==e?this._mainTexture:e}},{key:"showSkinByIndex",value:function(t,e){var i,n,a,r,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e<0&&e>=this.skinDataArray.length)return!1;var o=this.skinDataArray[e];if(o){for(i=0,n=o.slotArr.length;i<n;i++)(r=o.slotArr[i])&&(a=t[r.name])&&(a.showSlotData(r,s),s&&"undefined"!=a.attachmentName&&"null"!=a.attachmentName?a.showDisplayByName(a.attachmentName):a.showDisplayByIndex(a.displayIndex));return!0}return!1}},{key:"getSkinIndexByName",value:function(t){for(var e=0,i=this.skinDataArray.length;e<i;e++)if(this.skinDataArray[e].name==t)return e;return-1}},{key:"getGrahicsDataWithCache",value:function(t,e){return this._graphicsCache[t]&&this._graphicsCache[t][e]?this._graphicsCache[t][e]:null}},{key:"_setCreateURL",value:function(t){this._skBufferUrl=this._relativeUrl=t,(0,c.default)((0,_.default)(i.prototype),"_setCreateURL",this).call(this,t)}},{key:"setGrahicsDataWithCache",value:function(t,e,i){this._graphicsCache[t][e]=i}},{key:"deleteAniData",value:function(t){if(this._anis[t]){var e=this._anis[t];e.bone3DMap=null,e.nodes=null}}},{key:"destroy",value:function(){var t;for(t in this._isDestroyed=!0,this.subTextureDic)t&&this.subTextureDic[t].destroy();for(t in this._textureDic)t&&this._textureDic[t].destroy();for(var e=0,n=this.skinSlotDisplayDataArr.length;e<n;e++)this.skinSlotDisplayDataArr[e].destory();this.skinSlotDisplayDataArr.length=0,this._relativeUrl&&delete i.TEMPLET_DICTIONARY[this._relativeUrl],(0,c.default)((0,_.default)(i.prototype),"destroy",this).call(this),F.ILaya.loader.clearRes(this._skBufferUrl)}},{key:"getAniNameByIndex",value:function(t){var e=this.getAnimation(t);return e?e.name:null}},{key:"rate",get:function(){return this._rate},set:function(t){this._rate=t}}]),i}(C.AnimationTemplet);e.Templet=N,N.LAYA_ANIMATION_160_VISION="LAYAANIMATION:1.6.0",N.LAYA_ANIMATION_VISION="LAYAANIMATION:1.7.0",P.IAniLib.Templet=N},950:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TfConstraint=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(e,i){var n,a;for((0,r.default)(this,t),this._temp=[],this._data=e,null==this._bones&&(this._bones=[]),this.target=i[e.targetIndex],n=0,a=e.boneIndexs.length;n<a;n++)this._bones.push(i[e.boneIndexs[n]]);this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix}return(0,s.default)(t,[{key:"apply",value:function(){for(var t,e=this.target.resultMatrix.a,i=this.target.resultMatrix.b,n=this.target.resultMatrix.c,a=this.target.resultMatrix.d,r=0,s=this._bones.length;r<s;r++){if(t=this._bones[r],this.rotateMix>0){var o=t.resultMatrix.a,l=t.resultMatrix.b,u=t.resultMatrix.c,h=t.resultMatrix.d,c=Math.atan2(n,e)-Math.atan2(u,o)+this._data.offsetRotation*Math.PI/180;c>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c*=this.rotateMix;var d=Math.cos(c),f=Math.sin(c);t.resultMatrix.a=d*o-f*u,t.resultMatrix.b=d*l-f*h,t.resultMatrix.c=f*o+d*u,t.resultMatrix.d=f*l+d*h}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),t.resultMatrix.tx+=(this._temp[0]-t.resultMatrix.tx)*this.translateMix,t.resultMatrix.ty+=(this._temp[1]-t.resultMatrix.ty)*this.translateMix,t.updateChild()),this.scaleMix>0){var _=Math.sqrt(t.resultMatrix.a*t.resultMatrix.a+t.resultMatrix.c*t.resultMatrix.c),v=Math.sqrt(e*e+n*n),y=_>1e-5?(_+(v-_+this._data.offsetScaleX)*this.scaleMix)/_:0;t.resultMatrix.a*=y,t.resultMatrix.c*=y,_=Math.sqrt(t.resultMatrix.b*t.resultMatrix.b+t.resultMatrix.d*t.resultMatrix.d),v=Math.sqrt(i*i+a*a),y=_>1e-5?(_+(v-_+this._data.offsetScaleY)*this.scaleMix)/_:0,t.resultMatrix.b*=y,t.resultMatrix.d*=y}if(this.shearMix>0){l=t.resultMatrix.b,h=t.resultMatrix.d;var p=Math.atan2(h,l);(c=Math.atan2(a,i)-Math.atan2(n,e)-(p-Math.atan2(t.resultMatrix.c,t.resultMatrix.a)))>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c=p+(c+this._data.offsetShearY*Math.PI/180)*this.shearMix,y=Math.sqrt(l*l+h*h),t.resultMatrix.b=Math.cos(c)*y,t.resultMatrix.d=Math.sin(c)*y}}}}]),t}();e.TfConstraint=o},87338:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TfConstraintData=void 0;var r=a(i(15375));e.TfConstraintData=function t(){(0,r.default)(this,t),this.boneIndexs=[]}},81097:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Transform=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=function(){function t(){(0,r.default)(this,t),this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0}return(0,s.default)(t,[{key:"initData",value:function(t){null!=t.x&&(this.x=t.x),null!=t.y&&(this.y=t.y),null!=t.skX&&(this.skX=t.skX),null!=t.skY&&(this.skY=t.skY),null!=t.scX&&(this.scX=t.scX),null!=t.scY&&(this.scY=t.scY)}},{key:"getMatrix",value:function(){var t;return(t=this.mMatrix?this.mMatrix:this.mMatrix=new o.Matrix).identity(),t.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(t,this.skewX*Math.PI/180,this.skewY*Math.PI/180),t.rotate(this.skX*Math.PI/180),t.translate(this.x,this.y),t}},{key:"skew",value:function(t,e,i){var n=Math.sin(i),a=Math.cos(i),r=Math.sin(e),s=Math.cos(e);return t.setTo(t.a*s-t.b*n,t.a*r+t.b*a,t.c*s-t.d*n,t.c*r+t.d*a,t.tx*s-t.ty*n,t.tx*r+t.ty*a),t}}]),t}();e.Transform=l},69616:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.UVTools=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(56083),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getRelativeUV",value:function(t,e){var i,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t[0],s=t[2]-t[0],o=t[1],l=t[5]-t[1];a||(a=[]),a.length=e.length,n=a.length;var u=1/s,h=1/l;for(i=0;i<n;i+=2)a[i]=(e[i]-r)*u,a[i+1]=(e[i+1]-o)*h;return a}},{key:"getAbsoluteUV",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0==t[0]&&0==t[1]&&1==t[4]&&1==t[5])return i?(o.Utils.copyArray(i,e),i):e;var n,a,r=t[0],s=t[2]-t[0],l=t[1],u=t[5]-t[1];for(i||(i=[]),i.length=e.length,a=i.length,n=0;n<a;n+=2)i[n]=e[n]*s+r,i[n+1]=e[n+1]*u+l;return i}}]),t}();e.UVTools=l},48160:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.MeshData=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(98693),l=function(){function t(){(0,r.default)(this,t),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=new Float32Array([0,0,100,0,100,100,0,100]),this.indexes=new Uint16Array([0,1,3,3,1,2]),this.useUvTransform=!1,this.canvasPadding=1}return(0,s.default)(t,[{key:"getBounds",value:function(){return o.Rectangle._getWrapRec(this.vertices)}}]),t}();e.MeshData=l},59514:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.SkinMeshForGraphic=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305));function c(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var d=function(t){(0,l.default)(i,t);var e=c(i);function i(){return(0,s.default)(this,i),e.call(this)}return(0,o.default)(i,[{key:"init2",value:function(t,e,i,n){this.transform&&(this.transform=null);var a=e||[0,1,3,3,1,2];this.texture=t,this.indexes=new Uint16Array(a),this.vertices=new Float32Array(i),this.uvs=new Float32Array(n)}}]),i}(i(48160).MeshData);e.SkinMeshForGraphic=d},67988:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BezierLerp=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(93062),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getBezierRate",value:function(e,i,n,a,r){var s=t._getBezierParamKey(i,n,a,r),o=100*s+e;if(t._bezierResultCache[o])return t._bezierResultCache[o];var l,u,h=t._getBezierPoints(i,n,a,r,s);for(u=h.length,l=0;l<u;l+=2)if(e<=h[l])return t._bezierResultCache[o]=h[l+1],h[l+1];return t._bezierResultCache[o]=1,1}},{key:"_getBezierParamKey",value:function(t,e,i,n){return 100*(100*(100*(100*t+e)+i)+n)}},{key:"_getBezierPoints",value:function(e,i,n,a,r){return t._bezierPointsCache[r]?t._bezierPointsCache[r]:(s=[0,0,e,i,n,a,1,1],l=(new o.Bezier).getBezierPoints(s,100,3),t._bezierPointsCache[r]=l,l);var s,l}}]),t}();e.BezierLerp=l,l._bezierResultCache={},l._bezierPointsCache={}},42255:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Component=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=i(56083),u=function(){function t(){(0,r.default)(this,t),this._id=l.Utils.getGID(),this._resetComp()}return(0,s.default)(t,[{key:"id",get:function(){return this._id}},{key:"enabled",get:function(){return this._enabled},set:function(t){this._enabled!=t&&(this._enabled=t,this.owner&&(t?this.owner.activeInHierarchy&&this._onEnable():this.owner.activeInHierarchy&&this._onDisable()))}},{key:"isSingleton",get:function(){return!0}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_isScript",value:function(){return!1}},{key:"_resetComp",value:function(){this._indexInList=-1,this._enabled=!0,this._awaked=!1,this.owner=null}},{key:"_getIndexInList",value:function(){return this._indexInList}},{key:"_setIndexInList",value:function(t){this._indexInList=t}},{key:"_onAdded",value:function(){}},{key:"_onAwake",value:function(){}},{key:"_onEnable",value:function(){}},{key:"_onDisable",value:function(){}},{key:"_onDestroy",value:function(){}},{key:"onReset",value:function(){}},{key:"_parse",value:function(t){}},{key:"_parseInteractive",value:function(){}},{key:"_cloneTo",value:function(t){}},{key:"_setActive",value:function(t){t?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable()}},{key:"destroy",value:function(){this.owner&&this.owner._destroyComponent(this)}},{key:"_destroy",value:function(){this.owner.activeInHierarchy&&this._enabled&&this._setActive(!1),this._onDestroy(),this._destroyed=!0,this.onReset!==t.prototype.onReset?(this.onReset(),this._resetComp(),o.Pool.recoverByClass(this)):this._resetComp()}}]),t}();e.Component=u},72643:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Prefab=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(92493),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"create",value:function(){return this.json?o.ILaya.SceneUtils.createByData(null,this.json):null}}]),t}();e.Prefab=l},31249:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Animation=void 0;var s=r(i(81643)),o=r(i(15375)),l=r(i(17061)),u=r(i(89395)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(68817),v=i(72276),y=i(85096),p=i(22847),g=i(41107),m=i(56083),x=i(92493),T=i(23835);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var C=function(t){(0,c.default)(i,t);var e=k(i);function i(){var t;return(0,o.default)(this,i),(t=e.call(this))._setControlNode((0,u.default)(t)),t}return(0,l.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stop(),(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this,t),this._frames=null,this._labels=null}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n&&this._setFramesFromCache(n,!0),(0,h.default)((0,f.default)(i.prototype),"play",this).call(this,t,e,n)}},{key:"_setFramesFromCache",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._url&&(t=this._url+"#"+t),t&&i.framesMap[t]){var n=i.framesMap[t];return n instanceof Array?(this._frames=i.framesMap[t],this._count=this._frames.length):(n.nodeRoot&&(i.framesMap[t]=p.GraphicAnimation.parseAnimationByData(n),n=i.framesMap[t]),this._frames=n.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=n.interval),this._labels=this._copyLabels(n.labels)),!0}return e&&console.log("ani not found:",t),!1}},{key:"_copyLabels",value:function(t){if(!t)return null;var e,i;for(i in e={},t)e[i]=m.Utils.copyArray([],t[i]);return e}},{key:"_frameLoop",value:function(){this._visible&&this._style.alpha>.01&&this._frames&&(0,h.default)((0,f.default)(i.prototype),"_frameLoop",this).call(this)}},{key:"_displayToIndex",value:function(t){this._frames&&(this.graphics=this._frames[t])}},{key:"frames",get:function(){return this._frames},set:function(t){this._frames=t,t&&(this._count=t.length,this._actionName&&this._setFramesFromCache(this._actionName,!0),this.index=this._index)}},{key:"source",set:function(t){(0,s.default)(t).call(t,".ani")>-1?this.loadAnimation(t):(0,s.default)(t).call(t,".json")>-1||(0,s.default)(t).call(t,"als")>-1||(0,s.default)(t).call(t,"atlas")>-1?this.loadAtlas(t):this.loadImages(t.split(","))}},{key:"autoAnimation",set:function(t){this.play(0,!0,t)}},{key:"autoPlay",set:function(t){t?this.play():this.stop()}},{key:"clear",value:function(){return(0,h.default)((0,f.default)(i.prototype),"clear",this).call(this),this.stop(),this.graphics=null,this._frames=null,this._labels=null,this}},{key:"loadImages",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this._url="",this._setFramesFromCache(e)||(this.frames=i.framesMap[e]?i.framesMap[e]:i.createFrames(t,e)),this}},{key:"loadAtlas",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._url="";var a=this;if(!a._setFramesFromCache(n)){var r=function(r){t===r&&(a.frames=i.framesMap[n]?i.framesMap[n]:i.createFrames(t,n),e&&e.run())};y.Loader.getAtlas(t)?r(t):x.ILaya.loader.load(t,g.Handler.create(null,r,[t]),null,y.Loader.ATLAS)}return this}},{key:"loadAnimation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._url=t;var n=this;return this._actionName||(this._actionName=""),n._setFramesFromCache(this._actionName)?(n._setFramesFromCache(this._actionName,!0),this.index=0,e&&e.run()):!i||y.Loader.getAtlas(i)?this._loadAnimationData(t,e,i):x.ILaya.loader.load(i,g.Handler.create(this,this._loadAnimationData,[t,e,i]),null,y.Loader.ATLAS),this}},{key:"_loadAnimationData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!n||y.Loader.getAtlas(n)){var a=this;y.Loader.getRes(t)?r(t):x.ILaya.loader.load(t,g.Handler.create(null,r,[t]),null,y.Loader.JSON)}else console.warn("atlas load fail:"+n);function r(n){if(y.Loader.getRes(n)){if(t===n){var r;if(i.framesMap[t+"#"])a._setFramesFromCache(a._actionName,!0),a.index=0,a._resumePlay();else{var s=p.GraphicAnimation.parseAnimationData(y.Loader.getRes(t));if(!s)return;var o,l,u=s.animationList,h=u.length;for(o=0;o<h;o++)r=u[o],i.framesMap[t+"#"+r.name]=r,l||(l=r);l&&(i.framesMap[t+"#"]=l,a._setFramesFromCache(a._actionName,!0),a.index=0),a._resumePlay()}e&&e.run()}y.Loader.clearRes(t)}else i.framesMap[t+"#"]&&(a._setFramesFromCache(a._actionName,!0),a.index=0,a._resumePlay(),e&&e.run())}}}],[{key:"createFrames",value:function(t,e){var n;if("string"==typeof t){var a=y.Loader.getAtlas(t);if(a&&a.length){n=[];for(var r=0,s=a.length;r<s;r++){var o=new v.Graphics;o.drawImage(y.Loader.getRes(a[r]),0,0),n.push(o)}}}else if(t instanceof Array)for(n=[],r=0,s=t.length;r<s;r++)(o=new v.Graphics).loadImage(t[r],0,0),n.push(o);return e&&(i.framesMap[e]=n),n}},{key:"clearCache",value:function(t){var e,n=i.framesMap,a=t+"#";for(e in n)e!==t&&0!==(0,s.default)(e).call(e,a)||delete i.framesMap[e]}}]),i}(_.AnimationBase);e.Animation=C,C.framesMap={},x.ILaya.regClass(C),T.ClassUtils.regClass("laya.display.Animation",C),T.ClassUtils.regClass("Laya.Animation",C)},68817:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.AnimationBase=void 0;var s=r(i(81643)),o=r(i(92762)),l=r(i(15375)),u=r(i(17061)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(78362),v=i(80340),y=i(13407),p=i(89662),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var x=function(t){(0,c.default)(i,t);var e=m(i);function i(){var t;return(0,l.default)(this,i),(t=e.call(this)).wrapMode=0,t._interval=v.Config.animationInterval,t._isReverse=!1,t._frameRateChanged=!1,t._setBitUp(y.Const.DISPLAY),t}return(0,u.default)(i,[{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._isPlaying=!0,this._actionName=n,this.index="string"==typeof t?this._getFrameByLabel(t):t,this.loop=e,this._isReverse=this.wrapMode===i.WRAP_REVERSE,0==this.index&&this._isReverse&&(this.index=this.count-1),this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)}},{key:"interval",get:function(){return this._interval},set:function(t){this._interval!=t&&(this._frameRateChanged=!0,this._interval=t,this._isPlaying&&t>0&&this.timerLoop(t,this,this._frameLoop,null,!0,!0))}},{key:"_getFrameByLabel",value:function(t){for(var e=0;e<this._count;e++){var i=this._labels[e];if(i&&(0,s.default)(i).call(i,t)>-1)return e}return 0}},{key:"_frameLoop",value:function(){if(this._controlNode&&!this._controlNode.destroyed){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event(p.Event.COMPLETE);this.wrapMode==i.WRAP_PINGPONG?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event(p.Event.COMPLETE)}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event(p.Event.COMPLETE);this.wrapMode==i.WRAP_PINGPONG?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event(p.Event.COMPLETE)}this.index=this._index}else this.clearTimer(this,this._frameLoop)}},{key:"_setControlNode",value:function(t){this._controlNode&&(this._controlNode.off(p.Event.DISPLAY,this,this._resumePlay),this._controlNode.off(p.Event.UNDISPLAY,this,this._resumePlay)),this._controlNode=t,t&&t!=this&&(t.on(p.Event.DISPLAY,this,this._resumePlay),t.on(p.Event.UNDISPLAY,this,this._resumePlay))}},{key:"_setDisplay",value:function(t){(0,h.default)((0,f.default)(i.prototype),"_setDisplay",this).call(this,t),this._resumePlay()}},{key:"_resumePlay",value:function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))}},{key:"stop",value:function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"addLabel",value:function(t,e){this._labels||(this._labels={}),this._labels[e]||(this._labels[e]=[]),this._labels[e].push(t)}},{key:"removeLabel",value:function(t){if(t){if(this._labels)for(var e in this._labels)this._removeLabelFromList(this._labels[e],t)}else this._labels=null}},{key:"_removeLabelFromList",value:function(t,e){if(t)for(var i=t.length-1;i>=0;i--)t[i]==e&&(0,o.default)(t).call(t,i,1)}},{key:"gotoAndStop",value:function(t){this.index="string"==typeof t?this._getFrameByLabel(t):t,this.stop()}},{key:"index",get:function(){return this._index},set:function(t){if(this._index=t,this._displayToIndex(t),this._labels&&this._labels[t])for(var e=this._labels[t],i=0,n=e.length;i<n;i++)this.event(p.Event.LABEL,e[i])}},{key:"_displayToIndex",value:function(t){}},{key:"count",get:function(){return this._count}},{key:"clear",value:function(){return this.stop(),this._labels=null,this}}]),i}(_.Sprite);e.AnimationBase=x,x.WRAP_POSITIVE=0,x.WRAP_REVERSE=1,x.WRAP_PINGPONG=2,g.ClassUtils.regClass("laya.display.AnimationBase",x),g.ClassUtils.regClass("Laya.AnimationBase",x)},60397:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var r=a(i(81643)),s=a(i(94198)),o=a(i(15375)),l=a(i(17061)),u=i(98693),h=i(54598),c=i(41107),d=i(92493),f=i(23835),_=function(){function t(){(0,o.default)(this,t),this._fontCharDic={},this._fontWidthMap={},this._maxWidth=0,this._spaceWidth=10,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}return(0,l.default)(t,[{key:"loadFont",value:function(t,e){this._path=t,this._complete=e,t&&-1!==(0,r.default)(t).call(t,".fnt")?d.ILaya.loader.load([{url:t,type:d.ILaya.Loader.XML},{url:t.replace(".fnt",".png"),type:d.ILaya.Loader.IMAGE}],c.Handler.create(this,this._onLoaded)):console.error('Bitmap font configuration information must be a ".fnt" file')}},{key:"_onLoaded",value:function(){this.parseFont(d.ILaya.Loader.getRes(this._path),d.ILaya.Loader.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()}},{key:"parseFont",value:function(t,e){if(null!=t&&null!=e){this._texture=e;var i=t.getElementsByTagName("info");if(!i[0].getAttributeNode)return this.parseFont2(t,e);this.fontSize=(0,s.default)(i[0].getAttributeNode("size").nodeValue);var n=i[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[(0,s.default)(n[0]),(0,s.default)(n[1]),(0,s.default)(n[2]),(0,s.default)(n[3])];var a=t.getElementsByTagName("char"),r=0;for(r=0;r<a.length;r++){var o=a[r],l=(0,s.default)(o.getAttributeNode("id").nodeValue),c=(0,s.default)(o.getAttributeNode("xoffset").nodeValue)/1,d=(0,s.default)(o.getAttributeNode("yoffset").nodeValue)/1,f=(0,s.default)(o.getAttributeNode("xadvance").nodeValue)/1,_=new u.Rectangle;_.x=(0,s.default)(o.getAttributeNode("x").nodeValue),_.y=(0,s.default)(o.getAttributeNode("y").nodeValue),_.width=(0,s.default)(o.getAttributeNode("width").nodeValue),_.height=(0,s.default)(o.getAttributeNode("height").nodeValue);var v=h.Texture.create(e,_.x,_.y,_.width,_.height,c,d);this._maxWidth=Math.max(this._maxWidth,f+this.letterSpacing),this._fontCharDic[l]=v,this._fontWidthMap[l]=f}}}},{key:"parseFont2",value:function(t,e){if(null!=t&&null!=e){this._texture=e;var i=t.getElementsByTagName("info");this.fontSize=(0,s.default)(i[0].attributes.size.nodeValue);var n=i[0].attributes.padding.nodeValue.split(",");this._padding=[(0,s.default)(n[0]),(0,s.default)(n[1]),(0,s.default)(n[2]),(0,s.default)(n[3])];var a=t.getElementsByTagName("char"),r=0;for(r=0;r<a.length;r++){var o=a[r].attributes,l=(0,s.default)(o.id.nodeValue),c=(0,s.default)(o.xoffset.nodeValue)/1,d=(0,s.default)(o.yoffset.nodeValue)/1,f=(0,s.default)(o.xadvance.nodeValue)/1,_=new u.Rectangle;_.x=(0,s.default)(o.x.nodeValue),_.y=(0,s.default)(o.y.nodeValue),_.width=(0,s.default)(o.width.nodeValue),_.height=(0,s.default)(o.height.nodeValue);var v=h.Texture.create(e,_.x,_.y,_.width,_.height,c,d);this._maxWidth=Math.max(this._maxWidth,f+this.letterSpacing),this._fontCharDic[l]=v,this._fontWidthMap[l]=f}}}},{key:"getCharTexture",value:function(t){return this._fontCharDic[t.charCodeAt(0)]}},{key:"destroy",value:function(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];e&&e.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null,this._complete=null,this._padding=null}}},{key:"setSpaceWidth",value:function(t){this._spaceWidth=t}},{key:"getCharWidth",value:function(t){var e=t.charCodeAt(0);return this._fontWidthMap[e]?this._fontWidthMap[e]+this.letterSpacing:" "===t?this._spaceWidth+this.letterSpacing:0}},{key:"getTextWidth",value:function(t){for(var e=0,i=0,n=t.length;i<n;i++)e+=this.getCharWidth(t.charAt(i));return e}},{key:"getMaxWidth",value:function(){return this._maxWidth}},{key:"getMaxHeight",value:function(){return this.fontSize}},{key:"_drawText",value:function(t,e,i,n,a,r){var s,o=this.getTextWidth(t),l=0;"center"===a&&(l=(r-o)/2),"right"===a&&(l=r-o);for(var u=0,h=0,c=t.length;h<c;h++)(s=this.getCharTexture(t.charAt(h)))&&(e.graphics.drawImage(s,i+u+l,n),u+=this.getCharWidth(t.charAt(h)))}}]),t}();e.BitmapFont=_,f.ClassUtils.regClass("laya.display.BitmapFont",_),f.ClassUtils.regClass("Laya.BitmapFont",_)},24288:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.FrameAnimation=void 0;var s=r(i(69301)),o=r(i(81643)),l=r(i(47302)),u=r(i(15375)),h=r(i(17061)),c=r(i(45408)),d=r(i(97709)),f=r(i(38191)),_=r(i(52305)),v=i(68817),y=i(64968),p=i(45840),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,_.default)(t);if(e){var r=(0,_.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,f.default)(this,i)}}var x=function(t){(0,d.default)(i,t);var e=m(i);function i(){var t;return(0,u.default)(this,i),t=e.call(this),void 0===i._sortIndexFun&&(i._sortIndexFun=y.MathUtil.sortByKey("index",!1,!0)),t}return(0,h.default)(i,[{key:"_setUp",value:function(t,e){this._targetDic=t,this._animationData=e,this.interval=1e3/e.frameRate,e.parsed?(this._count=e.count,this._labels=e.labels,this._usedFrames=e.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),e.parsed=!0,e.labels=this._labels,e.count=this._count,e.animationNewFrames=this._usedFrames)}},{key:"clear",value:function(){return(0,c.default)((0,_.default)(i.prototype),"clear",this).call(this),this._targetDic=null,this._animationData=null,this}},{key:"_displayToIndex",value:function(t){if(this._animationData){t<0&&(t=0),t>this._count&&(t=this._count);var e,i=this._animationData.nodes,n=i.length;for(e=0;e<n;e++)this._displayNodeToFrame(i[e],t)}}},{key:"_displayNodeToFrame",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i||(i=this._targetDic);var n=i[t.target];if(n){var a,r,o,l,u=t.frames,h=(0,s.default)(t),c=h.length;for(l=0;l<c;l++)o=(r=u[a=h[l]]).length>e?r[e]:r[r.length-1],n[a]=o;var d,f=t.funkeys;if(0!=(c=f.length))for(l=0;l<c;l++)void 0!==(d=u[a=f[l]])[e]&&n[a]&&n[a].apply(n,d[e])}}},{key:"_calculateDatas",value:function(){if(this._animationData){var t,e,i=this._animationData.nodes,n=i.length;for(this._count=0,t=0;t<n;t++)e=i[t],this._calculateKeyFrames(e);this._count+=1}}},{key:"_calculateKeyFrames",value:function(t){var e,n,a=t.keyframes,r=t.target;for(e in t.frames||(t.frames={}),(0,s.default)(t)?(0,s.default)(t).length=0:t.keys=[],t.funkeys?t.funkeys.length=0:t.funkeys=[],t.initValues||(t.initValues={}),a){var u=-1!=(0,o.default)(e).call(e,"()");if(n=a[e],u&&(e=e.substr(0,e.length-2)),t.frames[e]||(t.frames[e]=[]),u){t.funkeys.push(e);for(var h=t.frames[e],c=0;c<n.length;c++){var d=n[c];h[d.index]=d.value,d.index>this._count&&(this._count=d.index)}}else this._targetDic&&this._targetDic[r]&&(t.initValues[e]=this._targetDic[r][e]),(0,l.default)(n).call(n,i._sortIndexFun),(0,s.default)(t).push(e),this._calculateNodePropFrames(n,t.frames[e],e,r)}}},{key:"resetNodes",value:function(){if(this._targetDic&&this._animationData){var t,e,i,n=this._animationData.nodes,a=n.length;for(t=0;t<a;t++)if(i=(e=n[t]).initValues){var r,s=this._targetDic[e.target];if(s)for(r in i)s[r]=i[r]}}}},{key:"_calculateNodePropFrames",value:function(t,e,i,n){var a,r=t.length-1;for(e.length=t[r].index+1,a=0;a<r;a++)this._dealKeyFrame(t[a]),this._calculateFrameValues(t[a],t[a+1],e);0==r&&(e[0]=t[0].value,this._usedFrames&&(this._usedFrames[t[0].index]=!0)),this._dealKeyFrame(t[a])}},{key:"_dealKeyFrame",value:function(t){t.label&&""!=t.label&&this.addLabel(t.label,t.index)}},{key:"_calculateFrameValues",value:function(t,e,i){var n,a,r=t.index,s=e.index,o=t.value,l=e.value-t.value,u=s-r,h=this._usedFrames;if(s>this._count&&(this._count=s),t.tween)for(null==(a=p.Ease[t.tweenMethod])&&(a=p.Ease.linearNone),n=r;n<s;n++)i[n]=a(n-r,o,l,u),h&&(h[n]=!0);else for(n=r;n<s;n++)i[n]=o;h&&(h[t.index]=!0,h[e.index]=!0),i[e.index]=e.value}}],[{key:"_sortIndexFun",value:function(t,e){return t.index-e.index}}]),i}(v.AnimationBase);e.FrameAnimation=x,g.ClassUtils.regClass("laya.display.FrameAnimation",x),g.ClassUtils.regClass("Laya.FrameAnimation",x)},72276:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Graphics=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(93697),l=i(43745),u=i(23578),h=i(95518),c=i(94317),d=i(26531),f=i(95923),_=i(40120),v=i(65419),y=i(57073),p=i(9897),g=i(81844),m=i(91813),x=i(65955),T=i(82994),k=i(65849),C=i(47303),S=i(4501),E=i(99777),M=i(88720),L=i(7862),b=i(95538),I=i(37187),R=i(9047),w=i(44449),A=i(89662),B=i(85399),D=i(85136),P=i(54598),O=i(56083),F=i(25670),U=i(92493),N=function(){function t(){(0,r.default)(this,t),this._sp=null,this._one=null,this._render=this._renderEmpty,this._cmds=null,this._vectorgraphArray=null,this._graphicBounds=null,this.autoDestroy=!1,this._createData()}return(0,s.default)(t,[{key:"_createData",value:function(){}},{key:"_clearData",value:function(){}},{key:"_destroyData",value:function(){}},{key:"destroy",value:function(){this.clear(!0),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null),this._destroyData()}},{key:"clear",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){var e=this._one;if(this._cmds){var i,n=this._cmds.length;for(i=0;i<n;i++)(e=this._cmds[i]).recover();this._cmds.length=0}else e&&e.recover()}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._clearData(),this._sp&&(this._sp._renderType&=~l.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._repaint(),this._vectorgraphArray){for(i=0,n=this._vectorgraphArray.length;i<n;i++)F.VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);this._vectorgraphArray.length=0}}},{key:"_clearBoundsCache",value:function(){this._graphicBounds&&this._graphicBounds.reset()}},{key:"_initGraphicBounds",value:function(){this._graphicBounds||(this._graphicBounds=o.GraphicsBounds.create(),this._graphicBounds._graphics=this)}},{key:"_repaint",value:function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()}},{key:"_isOnlyOne",value:function(){return!this._cmds||0===this._cmds.length}},{key:"cmds",get:function(){return this._cmds},set:function(t){this._sp&&(this._sp._renderType|=l.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._cmds=t,this._render=this._renderAll,this._repaint()}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBounds(t)}},{key:"getBoundPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBoundPoints(t)}},{key:"drawImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!t)return null;if(n||(n=t.sourceWidth),a||(a=t.sourceHeight),t.getIsReady()){var r=n/t.sourceWidth,s=a/t.sourceHeight;if(n=t.width*r,a=t.height*s,n<=0||a<=0)return null;e+=t.offsetX*r,i+=t.offsetY*s}this._sp&&(this._sp._renderType|=l.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var o=_.DrawImageCmd.create.call(this,t,e,i,n,a);return null==this._one?(this._one=o,this._render=this._renderOneImg):this._saveToCmd(null,o),this._repaint(),o}},{key:"drawTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9?arguments[9]:void 0;if(!t||s<.01)return null;if(!t.getIsReady())return null;if(n||(n=t.sourceWidth),a||(a=t.sourceHeight),t.getIsReady()){var c=n/t.sourceWidth,d=a/t.sourceHeight;if(n=t.width*c,a=t.height*d,n<=0||a<=0)return null;e+=t.offsetX*c,i+=t.offsetY*d}this._sp&&(this._sp._renderType|=l.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var f=T.DrawTextureCmd.create.call(this,t,e,i,n,a,r,s,o,u,h);return this._repaint(),this._saveToCmd(null,f)}},{key:"drawTextures",value:function(t,e){return t?this._saveToCmd(D.Render._context.drawTextures,k.DrawTexturesCmd.create.call(this,t,e)):null}},{key:"drawTriangles",value:function(t,e,i,n,a,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:4294967295;return this._saveToCmd(D.Render._context.drawTriangles,C.DrawTrianglesCmd.create.call(this,t,e,i,n,a,r,s,o,l,u,h))}},{key:"fillTexture",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"repeat",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return t&&t.getIsReady()?this._saveToCmd(D.Render._context._fillTexture,E.FillTextureCmd.create.call(this,t,e,i,n,a,r,s||B.Point.EMPTY,{})):null}},{key:"_saveToCmd",value:function(t,e){return this._sp&&(this._sp._renderType|=l.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),null==this._one?(this._one=e,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(e)),this._repaint(),e}},{key:"clipRect",value:function(t,e,i,n){return this._saveToCmd(D.Render._context.clipRect,h.ClipRectCmd.create.call(this,t,e,i,n))}},{key:"fillText",value:function(t,e,i,n,a,r){return this._saveToCmd(D.Render._context.fillText,S.FillTextCmd.create.call(this,t,null,e,i,n||U.ILaya.Text.defaultFontStr(),a,r,0,""))}},{key:"fillBorderText",value:function(t,e,i,n,a,r,s,o){return this._saveToCmd(D.Render._context.fillText,S.FillTextCmd.create.call(this,t,null,e,i,n||U.ILaya.Text.defaultFontStr(),a,r,s,o))}},{key:"fillWords",value:function(t,e,i,n,a){return this._saveToCmd(D.Render._context.fillText,S.FillTextCmd.create.call(this,null,t,e,i,n||U.ILaya.Text.defaultFontStr(),a,"",0,null))}},{key:"fillBorderWords",value:function(t,e,i,n,a,r,s){return this._saveToCmd(D.Render._context.fillText,S.FillTextCmd.create.call(this,null,t,e,i,n||U.ILaya.Text.defaultFontStr(),a,"",s,r))}},{key:"strokeText",value:function(t,e,i,n,a,r,s){return this._saveToCmd(D.Render._context.fillText,S.FillTextCmd.create.call(this,t,null,e,i,n||U.ILaya.Text.defaultFontStr(),null,s,r,a))}},{key:"alpha",value:function(t){return this._saveToCmd(D.Render._context.alpha,u.AlphaCmd.create.call(this,t))}},{key:"transform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._saveToCmd(D.Render._context._transform,R.TransformCmd.create.call(this,t,e,i))}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._saveToCmd(D.Render._context._rotate,L.RotateCmd.create.call(this,t,e,i))}},{key:"scale",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this._saveToCmd(D.Render._context._scale,I.ScaleCmd.create.call(this,t,e,i,n))}},{key:"translate",value:function(t,e){return this._saveToCmd(D.Render._context.translate,w.TranslateCmd.create.call(this,t,e))}},{key:"save",value:function(){return this._saveToCmd(D.Render._context._save,b.SaveCmd.create.call(this))}},{key:"restore",value:function(){return this._saveToCmd(D.Render._context.restore,M.RestoreCmd.create.call(this))}},{key:"replaceText",value:function(t){this._repaint();var e=this._cmds;if(e){for(var i=e.length-1;i>-1;i--)if(this._isTextCmd(e[i]))return e[i].text=t,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=t,!0;return!1}},{key:"_isTextCmd",value:function(t){return t.cmdID==S.FillTextCmd.ID}},{key:"replaceTextColor",value:function(t){this._repaint();var e=this._cmds;if(e)for(var i=e.length-1;i>-1;i--)this._isTextCmd(e[i])&&this._setTextCmdColor(e[i],t);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,t)}},{key:"_setTextCmdColor",value:function(t,e){if(t.cmdID===S.FillTextCmd.ID)t.color=e}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=U.ILaya.Loader.getRes(t);s?s.getIsReady()?this.drawImage(s,e,i,n,a):s.once(A.Event.READY,this,this.drawImage,[s,e,i,n,a]):((s=new P.Texture).load(t),U.ILaya.Loader.cacheTexture(t,s),s.once(A.Event.READY,this,this.drawImage,[s,e,i,n,a])),null!=r&&(s.getIsReady()?r.call(this._sp):s.on(A.Event.READY,this._sp,r))}},{key:"_renderEmpty",value:function(t,e,i,n){}},{key:"_renderAll",value:function(t,e,i,n){for(var a=this._cmds,r=0,s=a.length;r<s;r++)a[r].run(e,i,n)}},{key:"_renderOne",value:function(t,e,i,n){e.sprite=t,this._one.run(e,i,n)}},{key:"_renderOneImg",value:function(t,e,i,n){e.sprite=t,this._one.run(e,i,n)}},{key:"drawLine",value:function(t,e,i,n,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=r<1||r%2==0?0:.5;return this._saveToCmd(D.Render._context._drawLine,v.DrawLineCmd.create.call(this,t+s,e+s,i+s,n+s,a,r,0))}},{key:"drawLines",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(!i||i.length<4)return null;var r=a<1||a%2==0?0:.5;return this._saveToCmd(D.Render._context._drawLines,y.DrawLinesCmd.create.call(this,t+r,e+r,i,n,a,0))}},{key:"drawCurves",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return this._saveToCmd(D.Render._context.drawCurves,f.DrawCurvesCmd.create.call(this,t,e,i,n,a))}},{key:"drawRect",value:function(t,e,i,n,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=s>=1&&r?s/2:0,l=r?s:0;return this._saveToCmd(D.Render._context.drawRect,x.DrawRectCmd.create.call(this,t+o,e+o,i-l,n-l,a,r,s))}},{key:"drawCircle",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=r>=1&&a?r/2:0;return this._saveToCmd(D.Render._context._drawCircle,d.DrawCircleCmd.create.call(this,t,e,i-s,n,a,r,0))}},{key:"drawPie",value:function(t,e,i,n,a,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=o>=1&&s?o/2:0,u=s?o:0;return this._saveToCmd(D.Render._context._drawPie,g.DrawPieCmd.create.call(this,t+l,e+l,i-u,O.Utils.toRadian(n),O.Utils.toRadian(a),r,s,o,0))}},{key:"drawPoly",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=!1;s=!(i.length>6);var o=r>=1&&a?r%2==0?0:.5:0;return this._saveToCmd(D.Render._context._drawPoly,m.DrawPolyCmd.create.call(this,t+o,e+o,i,n,a,r,s,0))}},{key:"drawPath",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return this._saveToCmd(D.Render._context._drawPath,p.DrawPathCmd.create.call(this,t,e,i,n,a))}},{key:"draw9Grid",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5?arguments[5]:void 0;this._saveToCmd(null,c.Draw9GridTexture.create(t,e,i,n,a,r))}}]),t}();e.Graphics=N},93697:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.GraphicsBounds=void 0;var r=a(i(77766)),s=a(i(15375)),o=a(i(17061)),l=i(23578),u=i(26531),h=i(95923),c=i(40120),d=i(65419),f=i(57073),_=i(9897),v=i(81844),y=i(91813),p=i(65955),g=i(82994),m=i(99777),x=i(88720),T=i(7862),k=i(37187),C=i(9047),S=i(44449),E=i(93062),M=i(9686),L=i(18008),b=i(85399),I=i(98693),R=i(85136),w=i(64210),A=i(56083),B=i(47303),D=i(94317),P=i(95538),O=function(){function t(){(0,s.default)(this,t),this._cacheBoundsType=!1}return(0,o.default)(t,[{key:"destroy",value:function(){this._graphics=null,this._cacheBoundsType=!1,this._temp&&(this._temp.length=0),this._rstBoundPoints&&(this._rstBoundPoints.length=0),this._bounds&&this._bounds.recover(),this._bounds=null,w.Pool.recover("GraphicsBounds",this)}},{key:"reset",value:function(){this._temp&&(this._temp.length=0)}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._bounds=I.Rectangle._getWrapRec(this.getBoundPoints(t),this._bounds)),this._cacheBoundsType=t,this._bounds}},{key:"getBoundPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(t)),this._cacheBoundsType=t,this._rstBoundPoints=A.Utils.copyArray(this._rstBoundPoints,this._temp)}},{key:"_getCmdPoints",value:function(){var e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=(R.Render._context,this._graphics.cmds);if((e=this._temp||(this._temp=[])).length=0,n||null==this._graphics._one||(t._tempCmds.length=0,t._tempCmds.push(this._graphics._one),n=t._tempCmds),!n)return e;var a=t._tempMatrixArrays;a.length=0;var s=t._initMatrix;s.identity();for(var o,L,b=t._tempMatrix,w=0,O=n.length;w<O;w++)switch((o=n[w]).cmdID){case l.AlphaCmd.ID:case P.SaveCmd.ID:a.push(s),s=s.clone();break;case x.RestoreCmd.ID:s=a.pop();break;case k.ScaleCmd.ID:b.identity(),b.translate(-o.pivotX,-o.pivotY),b.scale(o.scaleX,o.scaleY),b.translate(o.pivotX,o.pivotY),this._switchMatrix(s,b);break;case T.RotateCmd.ID:b.identity(),b.translate(-o.pivotX,-o.pivotY),b.rotate(o.angle),b.translate(o.pivotX,o.pivotY),this._switchMatrix(s,b);break;case S.TranslateCmd.ID:b.identity(),b.translate(o.tx,o.ty),this._switchMatrix(s,b);break;case C.TransformCmd.ID:b.identity(),b.translate(-o.pivotX,-o.pivotY),(0,r.default)(b).call(b,o.matrix),b.translate(o.pivotX,o.pivotY),this._switchMatrix(s,b);break;case c.DrawImageCmd.ID:case m.FillTextureCmd.ID:t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,o.width,o.height),s);break;case g.DrawTextureCmd.ID:s.copyTo(b),o.matrix&&(0,r.default)(b).call(b,o.matrix),t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,o.width,o.height),b);break;case c.DrawImageCmd.ID:if(L=o.texture,i)o.width&&o.height?t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,o.width,o.height),s):t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,L.width,L.height),s);else{var F=(o.width||L.sourceWidth)/L.width,U=(o.height||L.sourceHeight)/L.height,N=F*L.sourceWidth,G=U*L.sourceHeight,H=L.offsetX>0?L.offsetX:0,W=L.offsetY>0?L.offsetY:0;H*=F,W*=U,t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x-H,o.y-W,N,G),s)}break;case m.FillTextureCmd.ID:o.width&&o.height?t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,o.width,o.height),s):(L=o.texture,t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,L.width,L.height),s));break;case g.DrawTextureCmd.ID:var V;o.matrix?(s.copyTo(b),(0,r.default)(b).call(b,o.matrix),V=b):V=s,i?o.width&&o.height?t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,o.width,o.height),V):(L=o.texture,t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,L.width,L.height),V)):(L=o.texture,F=(o.width||L.sourceWidth)/L.width,U=(o.height||L.sourceHeight)/L.height,N=F*L.sourceWidth,G=U*L.sourceHeight,H=L.offsetX>0?L.offsetX:0,W=L.offsetY>0?L.offsetY:0,H*=F,W*=U,t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x-H,o.y-W,N,G),V));break;case p.DrawRectCmd.ID:t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x,o.y,o.width,o.height),s);break;case u.DrawCircleCmd.ID:t._addPointArrToRst(e,I.Rectangle._getBoundPointS(o.x-o.radius,o.y-o.radius,o.radius+o.radius,o.radius+o.radius),s);break;case d.DrawLineCmd.ID:var Y;t._tempPoints.length=0,Y=.5*o.lineWidth,o.fromX==o.toX?t._tempPoints.push(o.fromX+Y,o.fromY,o.toX+Y,o.toY,o.fromX-Y,o.fromY,o.toX-Y,o.toY):o.fromY==o.toY?t._tempPoints.push(o.fromX,o.fromY+Y,o.toX,o.toY+Y,o.fromX,o.fromY-Y,o.toX,o.toY-Y):t._tempPoints.push(o.fromX,o.fromY,o.toX,o.toY),t._addPointArrToRst(e,t._tempPoints,s);break;case h.DrawCurvesCmd.ID:t._addPointArrToRst(e,E.Bezier.I.getBezierPoints(o.points),s,o.x,o.y);break;case f.DrawLinesCmd.ID:case y.DrawPolyCmd.ID:t._addPointArrToRst(e,o.points,s,o.x,o.y);break;case _.DrawPathCmd.ID:t._addPointArrToRst(e,this._getPathPoints(o.paths),s,o.x,o.y);break;case v.DrawPieCmd.ID:t._addPointArrToRst(e,this._getPiePoints(o.x,o.y,o.radius,o.startAngle,o.endAngle),s);break;case B.DrawTrianglesCmd.ID:t._addPointArrToRst(e,this._getTriAngBBXPoints(o.vertices),s);break;case D.Draw9GridTexture.ID:t._addPointArrToRst(e,this._getDraw9GridBBXPoints(o),s)}return e.length>200?e=A.Utils.copyArray(e,I.Rectangle._getWrapRec(e)._getBoundPoints()):e.length>8&&(e=M.GrahamScan.scanPList(e)),e}},{key:"_switchMatrix",value:function(t,e){(0,r.default)(e).call(e,t),e.copyTo(t)}},{key:"_getPiePoints",value:function(e,i,n,a,r){var s=t._tempPoints;t._tempPoints.length=0;var o=Math.PI/180,l=r-a;if(l>=360||l<=-360)return s.push(e-n,i-n),s.push(e+n,i-n),s.push(e+n,i+n),s.push(e-n,i+n),s;s.push(e,i);var u=l%360;u<0&&(u+=360);var h=a+u,c=a*o,d=h*o;s.push(e+n*Math.cos(c),i+n*Math.sin(c)),s.push(e+n*Math.cos(d),i+n*Math.sin(d));for(var f=90*Math.ceil(a/90),_=90*Math.floor(h/90),v=f;v<=_;v+=90){var y=v*o;s.push(e+n*Math.cos(y),i+n*Math.sin(y))}return s}},{key:"_getTriAngBBXPoints",value:function(t){var e=t.length;if(e<2)return[];for(var i=t[0],n=t[1],a=i,r=n,s=2;s<e;){var o=t[s++],l=t[s++];i>o&&(i=o),n>l&&(n=l),a<o&&(a=o),r<l&&(r=l)}return[i,n,a,n,a,r,i,r]}},{key:"_getDraw9GridBBXPoints",value:function(t){var e=t.width,i=t.height;return[0,0,e,0,e,i,0,i]}},{key:"_getPathPoints",value:function(e){var i,n,a,r=t._tempPoints;for(r.length=0,n=e.length,i=0;i<n;i++)(a=e[i]).length>1&&(r.push(a[1],a[2]),a.length>3&&r.push(a[3],a[4]));return r}}],[{key:"create",value:function(){return w.Pool.getItemByClass("GraphicsBounds",t)}},{key:"_addPointArrToRst",value:function(e,i,n){var a,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;for(r=i.length,a=0;a<r;a+=2)t._addPointToRst(e,i[a]+s,i[a+1]+o,n)}},{key:"_addPointToRst",value:function(t,e,i,n){var a=b.Point.TEMP;a.setTo(e||0,i||0),n.transformPoint(a),t.push(a.x,a.y)}}]),t}();e.GraphicsBounds=O,O._tempMatrix=new L.Matrix,O._initMatrix=new L.Matrix,O._tempPoints=[],O._tempMatrixArrays=[],O._tempCmds=[]},61891:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Input=void 0;var s=r(i(81643)),o=r(i(15375)),l=r(i(17061)),u=r(i(89395)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(81870),v=i(89662),y=i(56083),p=i(92493),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var x=function(t){(0,c.default)(i,t);var e=m(i);function i(){var t;return(0,o.default)(this,i),(t=e.call(this))._multiline=!1,t._editable=!0,t._maxChars=1e5,t._type="text",t._prompt="",t._promptColor="#A9A9A9",t._originColor="#000000",t._content="",i.IOS_IFRAME=p.ILaya.Browser.onIOS&&p.ILaya.Browser.window.top!=p.ILaya.Browser.window.self,t._width=100,t._height=20,t.multiline=!1,t.overflow=_.Text.SCROLL,t.on(v.Event.MOUSE_DOWN,(0,u.default)(t),t._onMouseDown),t.on(v.Event.UNDISPLAY,(0,u.default)(t),t._onUnDisplay),t}return(0,l.default)(i,[{key:"setSelection",value:function(t,e){this.focus=!0,i.inputElement.selectionStart=t,i.inputElement.selectionEnd=e}},{key:"multiline",get:function(){return this._multiline},set:function(t){this._multiline=t,this.valign=t?"top":"middle"}},{key:"nativeInput",get:function(){return this._multiline?i.area:i.input}},{key:"_onUnDisplay",value:function(){this.focus=!1}},{key:"_onMouseDown",value:function(t){this.focus=!0}},{key:"_syncInputTransform",value:function(){var t=this.nativeInput,e=y.Utils.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),n=this._width-this.padding[1]-this.padding[3],a=this._height-this.padding[0]-this.padding[2];p.ILaya.Render.isConchApp?(t.setScale(e.scaleX,e.scaleY),t.setSize(n,a),t.setPos(e.x,e.y)):(i.inputContainer.style.transform=i.inputContainer.style.webkitTransform="scale("+e.scaleX+","+e.scaleY+") rotate("+p.ILaya.stage.canvasDegree+"deg)",t.style.width=n+"px",t.style.height=a+"px",i.inputContainer.style.left=e.x+"px",i.inputContainer.style.top=e.y+"px")}},{key:"select",value:function(){this.nativeInput.select()}},{key:"focus",get:function(){return this._focus},set:function(t){var e=this.nativeInput;this._focus!==t&&(t?(e.target?e.target._focusOut():this._setInputMethod(),(e=this.nativeInput).target=this,this._focusIn()):(e.target=null,this._focusOut(),p.ILaya.Browser.document.body.scrollTop=0,e.blur(),p.ILaya.Render.isConchApp?e.setPos(-1e4,-1e4):i.inputContainer.contains(e)&&i.inputContainer.removeChild(e)))}},{key:"_setInputMethod",value:function(){i.input.parentElement&&i.inputContainer.removeChild(i.input),i.area.parentElement&&i.inputContainer.removeChild(i.area),p.ILaya.Browser.onAndroid&&(i.input=i.inputElement=p.ILaya.Browser.createElement("input"),i._initInput(i.input)),i.inputElement=this._multiline?i.area:i.input,i.inputContainer.appendChild(i.inputElement),_.Text.RightToLeft&&(i.inputElement.style.direction="rtl")}},{key:"_focusIn",value:function(){i.isInputting=!0;var t=this.nativeInput;i.input&&(i.input.type=this._type),this._focus=!0;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),t.readOnly=!this._editable,p.ILaya.Render.isConchApp&&(t.setType(this._type),t.setForbidEdit(!this._editable)),t.maxLength=this._maxChars,t.value=this._content,t.placeholder=this._prompt,p.ILaya.stage.off(v.Event.KEY_DOWN,this,this._onKeyDown),p.ILaya.stage.on(v.Event.KEY_DOWN,this,this._onKeyDown),p.ILaya.stage.focus=this,this.event(v.Event.FOCUS),p.ILaya.Browser.onPC&&t.focus(),p.ILaya.Browser.onMiniGame||p.ILaya.Browser.onBDMiniGame||p.ILaya.Browser.onQGMiniGame||p.ILaya.Browser.onKGMiniGame||p.ILaya.Browser.onVVMiniGame||p.ILaya.Browser.onAlipayMiniGame||p.ILaya.Browser.onQQMiniGame||p.ILaya.Browser.onBLMiniGame||p.ILaya.Browser.onTTMiniGame||p.ILaya.Browser.onHWMiniGame||p.ILaya.Browser.onTBMiniGame||(this._text=null),this.typeset(),t.setColor(this._originColor),t.setFontSize(this.fontSize),t.setFontFace(p.ILaya.Browser.onIPhone&&_.Text.fontFamilyMap[this.font]||this.font),p.ILaya.Render.isConchApp&&t.setMultiAble&&t.setMultiAble(this._multiline),e.lineHeight=this.leading+this.fontSize+"px",e.fontStyle=this.italic?"italic":"normal",e.fontWeight=this.bold?"bold":"normal",e.textAlign=this.align,e.padding="0 0",this._syncInputTransform(),!p.ILaya.Render.isConchApp&&p.ILaya.Browser.onPC&&p.ILaya.systemTimer.frameLoop(1,this,this._syncInputTransform)}},{key:"_setPromptColor",value:function(){i.promptStyleDOM=p.ILaya.Browser.getElementById("promptStyle"),i.promptStyleDOM||(i.promptStyleDOM=p.ILaya.Browser.createElement("style"),i.promptStyleDOM.setAttribute("id","promptStyle"),p.ILaya.Browser.document.head.appendChild(i.promptStyleDOM)),i.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"}},{key:"_focusOut",value:function(){i.isInputting&&(i.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?((0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,this._content),(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this._originColor)):((0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,this._prompt),(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this._promptColor)),p.ILaya.stage.off(v.Event.KEY_DOWN,this,this._onKeyDown),p.ILaya.stage.focus=null,this.event(v.Event.BLUR),this.event(v.Event.CHANGE),p.ILaya.Render.isConchApp&&this.nativeInput.blur(),p.ILaya.Browser.onPC&&p.ILaya.systemTimer.clear(this,this._syncInputTransform))}},{key:"_onKeyDown",value:function(t){13===t.keyCode&&(p.ILaya.Browser.onMobile&&!this._multiline&&(this.focus=!1),this.event(v.Event.ENTER))}},{key:"miniGameTxt",value:function(t){(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this._originColor),t+="",this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?(0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,t):((0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,this._prompt),(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this.promptColor))}},{key:"text",get:function(){return this._focus?this.nativeInput.value:this._content||""},set:function(t){(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this._originColor),t+="",this._focus?(this.nativeInput.value=t||"",this.event(v.Event.CHANGE)):(this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?(0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,t):((0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,this._prompt),(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this.promptColor)))}},{key:"changeText",value:function(t){this._content=t,this._focus?(this.nativeInput.value=t||"",this.event(v.Event.CHANGE)):(0,h.default)((0,f.default)(i.prototype),"changeText",this).call(this,t)}},{key:"color",get:function(){return(0,h.default)((0,f.default)(i.prototype),"color",this)},set:function(t){this._focus&&this.nativeInput.setColor(t),(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this._content?t:this._promptColor),this._originColor=t}},{key:"bgColor",get:function(){return(0,h.default)((0,f.default)(i.prototype),"bgColor",this)},set:function(t){(0,h.default)((0,f.default)(i.prototype),"set_bgColor",this).call(this,t),p.ILaya.Render.isConchApp&&this.nativeInput.setBgColor(t)}},{key:"restrict",get:function(){return this._restrictPattern?this._restrictPattern.source:""},set:function(t){t?(t="[^"+t+"]",(0,s.default)(t).call(t,"^^")>-1&&(t=t.replace("^^","")),this._restrictPattern=new RegExp(t,"g")):this._restrictPattern=null}},{key:"editable",get:function(){return this._editable},set:function(t){this._editable=t,p.ILaya.Render.isConchApp&&i.input.setForbidEdit(!t)}},{key:"maxChars",get:function(){return this._maxChars},set:function(t){t<=0&&(t=1e5),this._maxChars=t}},{key:"prompt",get:function(){return this._prompt},set:function(t){!this._text&&t&&(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,this._promptColor),this.promptColor=this._promptColor,this._text?(0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,this._text==this._prompt?t:this._text):(0,h.default)((0,f.default)(i.prototype),"set_text",this).call(this,t),this._prompt=_.Text.langPacks&&_.Text.langPacks[t]?_.Text.langPacks[t]:t}},{key:"promptColor",get:function(){return this._promptColor},set:function(t){this._promptColor=t,this._content||(0,h.default)((0,f.default)(i.prototype),"set_color",this).call(this,t)}},{key:"type",get:function(){return this._type},set:function(t){this._getTextStyle().asPassword="password"===t,this._type=t}}],[{key:"__init__",value:function(){if(i._createInputElement(),p.ILaya.Browser.onMobile){var t=!1;(p.ILaya.Browser.onMiniGame||p.ILaya.Browser.onBDMiniGame||p.ILaya.Browser.onQGMiniGame||p.ILaya.Browser.onKGMiniGame||p.ILaya.Browser.onVVMiniGame||p.ILaya.Browser.onAlipayMiniGame||p.ILaya.Browser.onQQMiniGame||p.ILaya.Browser.onBLMiniGame||p.ILaya.Browser.onTTMiniGame||p.ILaya.Browser.onHWMiniGame||p.ILaya.Browser.onTBMiniGame)&&(t=!0),p.ILaya.Render.canvas.addEventListener(i.IOS_IFRAME?t?"touchend":"click":"touchend",i._popupInputMethod)}}},{key:"_popupInputMethod",value:function(t){i.isInputting&&i.inputElement.focus()}},{key:"_createInputElement",value:function(){i._initInput(i.area=p.ILaya.Browser.createElement("textarea")),i._initInput(i.input=p.ILaya.Browser.createElement("input")),i.inputContainer=p.ILaya.Browser.createElement("div"),i.inputContainer.style.position="absolute",i.inputContainer.style.zIndex="1E5",p.ILaya.Browser.container.appendChild(i.inputContainer),i.inputContainer.setPos=function(t,e){i.inputContainer.style.left=t+"px",i.inputContainer.style.top=e+"px"}}},{key:"_initInput",value:function(t){var e=t.style;e.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",e.resize="none",e.backgroundColor="transparent",e.border="none",e.outline="none",e.zIndex="1",t.addEventListener("input",i._processInputting),t.addEventListener("mousemove",i._stopEvent),t.addEventListener("mousedown",i._stopEvent),t.addEventListener("touchmove",i._stopEvent),t.setFontFace=function(e){t.style.fontFamily=e},p.ILaya.Render.isConchApp||(t.setColor=function(e){t.style.color=e},t.setFontSize=function(e){t.style.fontSize=e+"px"})}},{key:"_processInputting",value:function(t){var e=i.inputElement.target;if(e){var n=i.inputElement.value;e._restrictPattern&&(n=n.replace(/\u2006|\x27/g,""),e._restrictPattern.test(n)&&(n=n.replace(e._restrictPattern,""),i.inputElement.value=n)),e._text=n,e.event(v.Event.INPUT)}}},{key:"_stopEvent",value:function(t){"touchmove"==t.type&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}}]),i}(_.Text);e.Input=x,x.TYPE_TEXT="text",x.TYPE_PASSWORD="password",x.TYPE_EMAIL="email",x.TYPE_URL="url",x.TYPE_NUMBER="number",x.TYPE_RANGE="range",x.TYPE_DATE="date",x.TYPE_MONTH="month",x.TYPE_WEEK="week",x.TYPE_TIME="time",x.TYPE_DATE_TIME="datetime",x.TYPE_DATE_TIME_LOCAL="datetime-local",x.TYPE_SEARCH="search",x.IOS_IFRAME=!1,x.inputHeight=45,x.isInputting=!1,g.ClassUtils.regClass("laya.display.Input",x),g.ClassUtils.regClass("Laya.Input",x)},54190:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Node=void 0;var s=r(i(92762)),o=r(i(81643)),l=r(i(15375)),u=r(i(17061)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(13407),_=i(89662),v=i(48856),y=i(64210),p=i(683),g=i(92493),m=i(23835);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var T=function(t){(0,h.default)(i,t);var e=x(i);function i(){var t;return(0,l.default)(this,i),(t=e.call(this))._bits=0,t._children=i.ARRAY_EMPTY,t._extUIChild=i.ARRAY_EMPTY,t._parent=null,t.name="",t.destroyed=!1,t.createGLBuffer(),t}return(0,u.default)(i,[{key:"createGLBuffer",value:function(){}},{key:"_setBit",value:function(t,e){t===f.Const.DISPLAY&&(this._getBit(t)!=e&&this._updateDisplayedInstage());e?this._bits|=t:this._bits&=~t}},{key:"_getBit",value:function(t){return 0!=(this._bits&t)}},{key:"_setUpNoticeChain",value:function(){this._getBit(f.Const.DISPLAY)&&this._setBitUp(f.Const.DISPLAY)}},{key:"_setBitUp",value:function(t){var e=this;for(e._setBit(t,!0),e=e._parent;e;){if(e._getBit(t))return;e._setBit(t,!0),e=e._parent}}},{key:"on",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t!==_.Event.DISPLAY&&t!==_.Event.UNDISPLAY||this._getBit(f.Const.DISPLAY)||this._setBitUp(f.Const.DISPLAY),this._createListener(t,e,i,n,!1)}},{key:"once",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t!==_.Event.DISPLAY&&t!==_.Event.UNDISPLAY||this._getBit(f.Const.DISPLAY)||this._setBitUp(f.Const.DISPLAY),this._createListener(t,e,i,n,!0)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.destroyed=!0,this._destroyAllComponent(),this._parent&&this._parent.removeChild(this),this._children&&(t?this.destroyChildren():this.removeChildren()),this.onDestroy(),this._children=null,this.offAll()}},{key:"onDestroy",value:function(){}},{key:"destroyChildren",value:function(){if(this._children)for(var t=0,e=this._children.length;t<e;t++)this._children[0].destroy(!0)}},{key:"addChild",value:function(t){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(f.Const.HAS_ZORDER,!0),t._parent===this){var e,n=this.getChildIndex(t);if(n!==this._children.length-1)(0,s.default)(e=this._children).call(e,n,1),this._children.push(t),this._childChanged()}else t._parent&&t._parent.removeChild(t),this._children===i.ARRAY_EMPTY&&(this._children=[]),this._children.push(t),t._setParent(this),this._childChanged();return t}},{key:"addInputChild",value:function(t){if(this._extUIChild==i.ARRAY_EMPTY)this._extUIChild=[t];else{var e;if((0,o.default)(e=this._extUIChild).call(e,t)>=0)return null;this._extUIChild.push(t)}return null}},{key:"removeInputChild",value:function(t){var e,i,n=(0,o.default)(e=this._extUIChild).call(e,t);n>=0&&(0,s.default)(i=this._extUIChild).call(i,n,1)}},{key:"addChildren",value:function(){for(var t=0,e=arguments.length;t<e;){var i;this.addChild((i=t++)<0||arguments.length<=i?void 0:arguments[i])}}},{key:"addChildAt",value:function(t,e){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(f.Const.HAS_ZORDER,!0),e>=0&&e<=this._children.length){if(t._parent===this){var n,a,r=this.getChildIndex(t);(0,s.default)(n=this._children).call(n,r,1),(0,s.default)(a=this._children).call(a,e,0,t),this._childChanged()}else{var o;t._parent&&t._parent.removeChild(t),this._children===i.ARRAY_EMPTY&&(this._children=[]),(0,s.default)(o=this._children).call(o,e,0,t),t._setParent(this)}return t}throw new Error("appendChildAt:The index is out of bounds")}},{key:"getChildIndex",value:function(t){var e;return(0,o.default)(e=this._children).call(e,t)}},{key:"getChildByName",value:function(t){var e=this._children;if(e)for(var i=0,n=e.length;i<n;i++){var a=e[i];if(a.name===t)return a}return null}},{key:"getChildAt",value:function(t){return this._children[t]||null}},{key:"setChildIndex",value:function(t,e){var i=this._children;if(e<0||e>=i.length)throw new Error("setChildIndex:The index is out of bounds.");var n=this.getChildIndex(t);if(n<0)throw new Error("setChildIndex:node is must child of this object.");return(0,s.default)(i).call(i,n,1),(0,s.default)(i).call(i,e,0,t),this._childChanged(),t}},{key:"_childChanged",value:function(){}},{key:"removeChild",value:function(t){var e;if(!this._children)return t;var i=(0,o.default)(e=this._children).call(e,t);return this.removeChildAt(i)}},{key:"removeSelf",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"removeChildByName",value:function(t){var e=this.getChildByName(t);return e&&this.removeChild(e),e}},{key:"removeChildAt",value:function(t){var e,i=this.getChildAt(t);i&&((0,s.default)(e=this._children).call(e,t,1),i._setParent(null));return i}},{key:"removeChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2147483647;if(this._children&&this._children.length>0){var n=this._children;if(0===t&&e>=n.length-1){var a=n;this._children=i.ARRAY_EMPTY}else a=(0,s.default)(n).call(n,t,e-t+1);for(var r=0,o=a.length;r<o;r++)a[r]._setParent(null)}return this}},{key:"replaceChild",value:function(t,e){var i,n,a=(0,o.default)(i=this._children).call(i,e);return a>-1?((0,s.default)(n=this._children).call(n,a,1,t),e._setParent(null),t._setParent(this),t):null}},{key:"numChildren",get:function(){return this._children.length}},{key:"parent",get:function(){return this._parent}},{key:"_setParent",value:function(t){this._parent!==t&&(t?(this._parent=t,this._onAdded(),this.event(_.Event.ADDED),this._getBit(f.Const.DISPLAY)&&(this._setUpNoticeChain(),t.displayedInStage&&this._displayChild(this,!0)),t._childChanged(this)):(this._onRemoved(),this.event(_.Event.REMOVED),this._parent._childChanged(),this._getBit(f.Const.DISPLAY)&&this._displayChild(this,!1),this._parent=t))}},{key:"displayedInStage",get:function(){return this._getBit(f.Const.DISPLAY)||this._setBitUp(f.Const.DISPLAY),this._getBit(f.Const.DISPLAYED_INSTAGE)}},{key:"_updateDisplayedInstage",value:function(){var t;t=this;for(var e=g.ILaya.stage,i=!1;t;){if(t._getBit(f.Const.DISPLAY)){i=t._getBit(f.Const.DISPLAYED_INSTAGE);break}if(t===e||t._getBit(f.Const.DISPLAYED_INSTAGE)){i=!0;break}t=t._parent}this._setBit(f.Const.DISPLAYED_INSTAGE,i)}},{key:"_setDisplay",value:function(t){this._getBit(f.Const.DISPLAYED_INSTAGE)!==t&&(this._setBit(f.Const.DISPLAYED_INSTAGE,t),t?this.event(_.Event.DISPLAY):this.event(_.Event.UNDISPLAY))}},{key:"_displayChild",value:function(t,e){var i=t._children;if(i)for(var n=0,a=i.length;n<a;n++){var r=i[n];r._getBit(f.Const.DISPLAY)&&(r._children.length>0?this._displayChild(r,e):r._setDisplay(e))}t._setDisplay(e)}},{key:"contains",value:function(t){if(t===this)return!0;for(;t;){if(t._parent===this)return!0;t=t._parent}return!1}},{key:"timerLoop",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=this.scene?this.scene.timer:g.ILaya.timer;s.loop(t,e,i,n,a,r)}},{key:"timerOnce",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.scene?this.scene.timer:g.ILaya.timer;r._create(!1,!1,t,e,i,n,a)}},{key:"frameLoop",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.scene?this.scene.timer:g.ILaya.timer;r._create(!0,!0,t,e,i,n,a)}},{key:"frameOnce",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.scene?this.scene.timer:g.ILaya.timer;r._create(!0,!1,t,e,i,n,a)}},{key:"clearTimer",value:function(t,e){(this.scene?this.scene.timer:g.ILaya.timer).clear(t,e)}},{key:"callLater",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.scene?this.scene.timer:g.ILaya.timer;i.callLater(this,t,e)}},{key:"runCallLater",value:function(t){(this.scene?this.scene.timer:g.ILaya.timer).runCallLater(this,t)}},{key:"scene",get:function(){return this._scene}},{key:"active",get:function(){return!this._getBit(f.Const.NOT_READY)&&!this._getBit(f.Const.NOT_ACTIVE)},set:function(t){if(t=!!t,!this._getBit(f.Const.NOT_ACTIVE)!==t){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw t?"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.":"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._setBit(f.Const.NOT_ACTIVE,!t),this._parent&&this._parent.activeInHierarchy&&(t?this._processActive():this._processInActive())}}},{key:"activeInHierarchy",get:function(){return this._getBit(f.Const.ACTIVE_INHIERARCHY)}},{key:"_onActive",value:function(){p.Stat.spriteCount++}},{key:"_onInActive",value:function(){p.Stat.spriteCount--}},{key:"_onActiveInScene",value:function(){}},{key:"_onInActiveInScene",value:function(){}},{key:"_parse",value:function(t,e){}},{key:"_setBelongScene",value:function(t){if(!this._scene){this._scene=t,this._onActiveInScene();for(var e=0,i=this._children.length;e<i;e++)this._children[e]._setBelongScene(t)}}},{key:"_setUnBelongScene",value:function(){if(this._scene!==this){this._onInActiveInScene(),this._scene=null;for(var t=0,e=this._children.length;t<e;t++)this._children[t]._setUnBelongScene()}}},{key:"onAwake",value:function(){}},{key:"onEnable",value:function(){}},{key:"_processActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._activeHierarchy(this._activeChangeScripts),this._activeScripts()}},{key:"_activeHierarchy",value:function(t){if(this._setBit(f.Const.ACTIVE_INHIERARCHY,!0),this._components)for(var e=0,i=this._components.length;e<i;e++){var n=this._components[e];n._isScript()?n._enabled&&t.push(n):n._setActive(!0)}for(this._onActive(),e=0,i=this._children.length;e<i;e++){var a=this._children[e];!a._getBit(f.Const.NOT_ACTIVE)&&!a._getBit(f.Const.NOT_READY)&&a._activeHierarchy(t)}this._getBit(f.Const.AWAKED)||(this._setBit(f.Const.AWAKED,!0),this.onAwake()),this.onEnable()}},{key:"_activeScripts",value:function(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++){var i=this._activeChangeScripts[t];i._awaked||(i._awaked=!0,i._onAwake()),i._onEnable()}this._activeChangeScripts.length=0}},{key:"_processInActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._inActiveHierarchy(this._activeChangeScripts),this._inActiveScripts()}},{key:"_inActiveHierarchy",value:function(t){if(this._onInActive(),this._components)for(var e=0,i=this._components.length;e<i;e++){var n=this._components[e];!n._isScript()&&n._setActive(!1),n._isScript()&&n._enabled&&t.push(n)}for(this._setBit(f.Const.ACTIVE_INHIERARCHY,!1),e=0,i=this._children.length;e<i;e++){var a=this._children[e];a&&!a._getBit(f.Const.NOT_ACTIVE)&&a._inActiveHierarchy(t)}this.onDisable()}},{key:"_inActiveScripts",value:function(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].owner&&this._activeChangeScripts[t]._onDisable();this._activeChangeScripts.length=0}},{key:"onDisable",value:function(){}},{key:"_onAdded",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";var t=this._parent.scene;t&&this._setBelongScene(t),this._parent.activeInHierarchy&&this.active&&this._processActive()}},{key:"_onRemoved",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._parent.activeInHierarchy&&this.active&&this._processInActive(),this._parent.scene&&this._setUnBelongScene()}},{key:"_addComponentInstance",value:function(t){this._components=this._components||[],this._components.push(t),t.owner=this,t._onAdded(),this.activeInHierarchy&&t._setActive(!0)}},{key:"_destroyComponent",value:function(t){if(this._components)for(var e=0,i=this._components.length;e<i;e++){var n=this._components[e];if(n===t){var a;n._destroy(),(0,s.default)(a=this._components).call(a,e,1);break}}}},{key:"_destroyAllComponent",value:function(){if(this._components){for(var t=0,e=this._components.length;t<e;t++){var i=this._components[t];i&&i._destroy()}this._components.length=0}}},{key:"_cloneTo",value:function(t,e,i){var n=t;if(this._components)for(var a=0,r=this._components.length;a<r;a++){var s=n.addComponent(this._components[a].constructor);this._components[a]._cloneTo(s)}}},{key:"addComponentIntance",value:function(t){if(t.owner)throw"Node:the component has belong to other node.";if(t.isSingleton&&this.getComponent(t.constructor))throw"Node:the component is singleton,can't add the second one.";return this._addComponentInstance(t),t}},{key:"addComponent",value:function(t){var e=y.Pool.createByClass(t);if(!e)throw t.toString()+"组件不存在";if(e._destroyed=!1,e.isSingleton&&this.getComponent(t))throw"无法实例"+t+"组件，"+t+"组件已存在！";return this._addComponentInstance(e),e}},{key:"getComponent",value:function(t){if(this._components)for(var e=0,i=this._components.length;e<i;e++){var n=this._components[e];if(n instanceof t)return n}return null}},{key:"getComponents",value:function(t){var e;if(this._components)for(var i=0,n=this._components.length;i<n;i++){var a=this._components[i];a instanceof t&&(e=e||[]).push(a)}return e}},{key:"timer",get:function(){return this.scene?this.scene.timer:g.ILaya.timer}}]),i}(v.EventDispatcher);e.Node=T,T.ARRAY_EMPTY=[],m.ClassUtils.regClass("laya.display.Node",T),m.ClassUtils.regClass("Laya.Node",T)},28294:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Scene=void 0;var s=r(i(81643)),o=r(i(92762)),l=r(i(77766)),u=r(i(15375)),h=r(i(17061)),c=r(i(89395)),d=r(i(45408)),f=r(i(97709)),_=r(i(38191)),v=r(i(52305)),y=i(54190),p=i(13407),g=i(78362),m=i(89662),x=i(8863),T=i(25883),k=i(41107),C=i(21383),S=i(92493),E=i(23835),M=i(84935);function L(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,v.default)(t);if(e){var r=(0,v.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,_.default)(this,i)}}var b=function(t){(0,f.default)(i,t);var e=L(i);function i(){var t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,u.default)(this,i),(t=e.call(this)).autoDestroyAtClosed=!1,t.url=null,t._viewCreated=!1,t._idMap=null,t._$componentType="Scene",i.unDestroyedScenes.push((0,c.default)(t)),t._scene=(0,c.default)(t),n&&t.createChildren(),t}return(0,h.default)(i,[{key:"createChildren",value:function(){}},{key:"loadScene",value:function(t){var e=(0,s.default)(t).call(t,".")>-1?t:t+".scene",i=S.ILaya.loader.getRes(e);if(i)this.createView(i);else{this._setBit(p.Const.NOT_READY,!0),S.ILaya.loader.resetProgress();var n=new x.SceneLoader;n.on(m.Event.COMPLETE,this,this._onSceneLoaded,[e]),n.load(e)}}},{key:"_onSceneLoaded",value:function(t){this.createView(S.ILaya.Loader.getRes(t))}},{key:"createView",value:function(t){t&&!this._viewCreated&&(this._viewCreated=!0,C.SceneUtils.createByData(this,t))}},{key:"getNodeByID",value:function(t){return this._idMap?this._idMap[t]:null}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&i.closeAll(),i.root.addChild(this),this.onOpened(e)}},{key:"onOpened",value:function(t){}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onClosed(t),this.autoDestroyAtClosed?this.destroy():this.removeSelf()}},{key:"onClosed",value:function(){}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._idMap=null,(0,d.default)((0,v.default)(i.prototype),"destroy",this).call(this,t);for(var e=i.unDestroyedScenes,n=e.length-1;n>-1;n--)if(e[n]===this)return void(0,o.default)(e).call(e,n,1)}},{key:"scaleX",get:function(){return(0,d.default)((0,v.default)(i.prototype),"scaleX",this)},set:function(t){(0,d.default)((0,v.default)(i.prototype),"get_scaleX",this).call(this)!=t&&((0,d.default)((0,v.default)(i.prototype),"set_scaleX",this).call(this,t),this.event(m.Event.RESIZE))}},{key:"scaleY",get:function(){return(0,d.default)((0,v.default)(i.prototype),"scaleY",this)},set:function(t){(0,d.default)((0,v.default)(i.prototype),"get_scaleY",this).call(this)!=t&&((0,d.default)((0,v.default)(i.prototype),"set_scaleY",this).call(this,t),this.event(m.Event.RESIZE))}},{key:"width",get:function(){if(this._width)return this._width;for(var t=0,e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t},set:function(t){(0,d.default)((0,v.default)(i.prototype),"get_width",this).call(this)!=t&&((0,d.default)((0,v.default)(i.prototype),"set_width",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"height",get:function(){if(this._height)return this._height;for(var t=0,e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t},set:function(t){(0,d.default)((0,v.default)(i.prototype),"get_height",this).call(this)!=t&&((0,d.default)((0,v.default)(i.prototype),"set_height",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){this.event(m.Event.RESIZE)}},{key:"timer",get:function(){return this._timer||S.ILaya.timer},set:function(t){this._timer=t}}],[{key:"setUIMap",value:function(t){var e=S.ILaya.loader.getRes(t);if(!e)throw"请提前加载uimap的json，再使用该接口设置！";for(var i in e)S.ILaya.Loader.loadedMap[M.URL.formatURL(i+".scene")]=e[i]}},{key:"root",get:function(){return i._root||(i._root=S.ILaya.stage.addChild(new g.Sprite),i._root.name="root",S.ILaya.stage.on("resize",null,(function(){i._root.size(S.ILaya.stage.width,S.ILaya.stage.height),i._root.event(m.Event.RESIZE)})),i._root.size(S.ILaya.stage.width,S.ILaya.stage.height),i._root.event(m.Event.RESIZE)),i._root}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;S.ILaya.loader.resetProgress();var a=new x.SceneLoader;function r(t){i._loadPage&&i._loadPage.event("progress",t),n&&n.runWith(t)}function s(){a.off(m.Event.PROGRESS,null,r);var n=S.ILaya.Loader.getRes(t);if(!n)throw"Can not find scene:"+t;if(!n.props)throw"Scene data is error:"+t;var s=n.props.runtime?n.props.runtime:n.type,o=S.ILaya.ClassUtils.getClass(s);if("instance"==n.props.renderType)var l=o.instance||(o.instance=new o);else l=new o;if(!(l&&l instanceof y.Node))throw"Can not find scene:"+s;l.url=t,l._viewCreated?e&&e.runWith(l):(l.on("onViewCreated",null,(function(){e&&e.runWith(l)})),l.createView(n)),i.hideLoadingPage()}a.on(m.Event.PROGRESS,null,r),a.once(m.Event.COMPLETE,null,s),a.load(t)}},{key:"open",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(n instanceof k.Handler){var s=a;a=n,n=s}i.showLoadingPage(),i.load(t,k.Handler.create(null,this._onSceneLoaded,[e,a,n]),r)}},{key:"_onSceneLoaded",value:function(t,e,i,n){n.open(t,i),e&&e.runWith(n)}},{key:"close",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!1,a=i.unDestroyedScenes,r=0,s=a.length;r<s;r++){var o=a[r];o&&o.parent&&o.url===t&&o.name==e&&(o.close(),n=!0)}return n}},{key:"closeAll",value:function(){for(var t=i.root,e=0,n=t.numChildren;e<n;e++){var a=t.getChildAt(0);a instanceof i?a.close():a.removeSelf()}}},{key:"destroy",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=!1,r=(0,l.default)(e=[]).call(e,i.unDestroyedScenes),s=0,o=r.length;s<o;s++){var u=r[s];u.url!==t||u.name!=n||u.destroyed||(u.destroy(),a=!0)}return a}},{key:"gc",value:function(){T.Resource.destroyUnusedResources()}},{key:"setLoadingPage",value:function(t){i._loadPage!=t&&(i._loadPage=t)}},{key:"showLoadingPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;i._loadPage&&(S.ILaya.systemTimer.clear(null,i._showLoading),S.ILaya.systemTimer.clear(null,i._hideLoading),S.ILaya.systemTimer.once(e,null,i._showLoading,[t],!1))}},{key:"_showLoading",value:function(t){S.ILaya.stage.addChild(i._loadPage),i._loadPage.onOpened(t)}},{key:"_hideLoading",value:function(){i._loadPage.close()}},{key:"hideLoadingPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;i._loadPage&&(S.ILaya.systemTimer.clear(null,i._showLoading),S.ILaya.systemTimer.clear(null,i._hideLoading),S.ILaya.systemTimer.once(t,null,i._hideLoading))}}]),i}(g.Sprite);e.Scene=b,b.unDestroyedScenes=[],S.ILaya.regClass(b),E.ClassUtils.regClass("laya.display.Scene",b),E.ClassUtils.regClass("Laya.Scene",b)},78362:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Sprite=void 0;var s=r(i(3649)),o=r(i(31238)),l=r(i(15375)),u=r(i(17061)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(92493),v=i(13407),y=i(89662),p=i(20084),g=i(81114),m=i(9686),x=i(18008),T=i(85399),k=i(98693),C=i(8272),S=i(79741),E=i(26776),M=i(54598),L=i(23835),b=i(56083),I=i(22805),R=i(6872),w=i(54216),A=i(72276),B=i(54190),D=i(43745),P=i(84935);function O(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var F=function(t){(0,c.default)(i,t);var e=O(i);function i(){var t;return(0,l.default)(this,i),(t=e.call(this))._x=0,t._y=0,t._width=0,t._height=0,t._visible=!0,t._mouseState=0,t._zOrder=0,t._renderType=0,t._transform=null,t._tfChanged=!1,t._repaint=D.SpriteConst.REPAINT_NONE,t._texture=null,t._style=w.SpriteStyle.EMPTY,t._cacheStyle=R.CacheStyle.EMPTY,t._boundStyle=null,t._graphics=null,t.mouseThrough=!1,t.autoSize=!1,t.hitTestPrior=!1,t}return(0,u.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this,t),this._style&&this._style.recover(),this._cacheStyle&&this._cacheStyle.recover(),this._boundStyle&&this._boundStyle.recover(),this._transform&&this._transform.recover(),this._style=null,this._cacheStyle=null,this._boundStyle=null,this._transform=null,this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy(),this._graphics=null,this.texture=null}},{key:"updateZOrder",value:function(){b.Utils.updateOrder(this._children)&&this.repaint()}},{key:"_getBoundsStyle",value:function(){return this._boundStyle||(this._boundStyle=I.BoundsStyle.create()),this._boundStyle}},{key:"_setCustomRender",value:function(){}},{key:"customRenderEnable",set:function(t){t&&(this._renderType|=D.SpriteConst.CUSTOM,this._setRenderType(this._renderType),this._setCustomRender())}},{key:"cacheAs",get:function(){return this._cacheStyle.cacheAs},set:function(t){t!==this._cacheStyle.userSetCache&&(this.mask&&"normal"===t||(this._setCacheAs(t),this._getCacheStyle().userSetCache=t,this._checkCanvasEnable(),this.repaint()))}},{key:"_setCacheAs",value:function(t){}},{key:"_checkCanvasEnable",value:function(){var t=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=t,t?(this._cacheStyle.needBitmapCache()?this._cacheStyle.cacheAs="bitmap":this._cacheStyle.cacheAs=this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=D.SpriteConst.CANVAS):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=~D.SpriteConst.CANVAS),this._setCacheAs(this._cacheStyle.cacheAs),this._setRenderType(this._renderType)}},{key:"staticCache",get:function(){return this._cacheStyle.staticCache},set:function(t){this._getCacheStyle().staticCache=t,t||this.reCache()}},{key:"reCache",value:function(){this._cacheStyle.reCache=!0,this._repaint|=D.SpriteConst.REPAINT_CACHE}},{key:"getRepaint",value:function(){return this._repaint}},{key:"_setX",value:function(t){this._x=t}},{key:"_setY",value:function(t){this._y=t}},{key:"_setWidth",value:function(t,e){}},{key:"_setHeight",value:function(t,e){}},{key:"x",get:function(){return this._x},set:function(t){if(!this.destroyed&&this._x!==t){this._setX(t),this.parentRepaint(D.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(D.SpriteConst.REPAINT_CACHE)}}},{key:"y",get:function(){return this._y},set:function(t){if(!this.destroyed&&this._y!==t){this._setY(t),this.parentRepaint(D.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(D.SpriteConst.REPAINT_CACHE)}}},{key:"width",get:function(){return this.get_width()},set:function(t){this.set_width(t)}},{key:"set_width",value:function(t){this._width!==t&&(this._width=t,this._setWidth(this.texture,t),this._setTranformChange())}},{key:"get_width",value:function(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)}},{key:"height",get:function(){return this.get_height()},set:function(t){this.set_height(t)}},{key:"set_height",value:function(t){this._height!==t&&(this._height=t,this._setHeight(this.texture,t),this._setTranformChange())}},{key:"get_height",value:function(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)}},{key:"displayWidth",get:function(){return this.width*this.scaleX}},{key:"displayHeight",get:function(){return this.height*this.scaleY}},{key:"setSelfBounds",value:function(t){this._getBoundsStyle().userBounds=t}},{key:"getBounds",value:function(){return this._getBoundsStyle().bounds=k.Rectangle._getWrapRec(this._boundPointsToParent())}},{key:"getSelfBounds",value:function(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=k.Rectangle._getWrapRec(this._getBoundPointsM(!1)):k.Rectangle.TEMP.setTo(0,0,this.width,this.height)}},{key:"_boundPointsToParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0,i=0;this._style&&(e=this.pivotX,i=this.pivotY,t=t||0!==this._style.rotation,this._style.scrollRect&&(e+=this._style.scrollRect.x,i+=this._style.scrollRect.y));var n=this._getBoundPointsM(t);if(!n||n.length<1)return n;if(8!=n.length&&(n=t?m.GrahamScan.scanPList(n):k.Rectangle._getWrapRec(n,k.Rectangle.TEMP)._getBoundPoints()),!this.transform)return b.Utils.transPointList(n,this._x-e,this._y-i),n;var a,r=T.Point.TEMP,s=n.length;for(a=0;a<s;a+=2)r.x=n[a],r.y=n[a+1],this.toParentPoint(r),n[a]=r.x,n[a+1]=r.y;return n}},{key:"getGraphicBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._graphics?this._graphics.getBounds(t):k.Rectangle.TEMP.setTo(0,0,0,0)}},{key:"_getBoundPointsM",value:function(){var t,e,n,a,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(this._boundStyle||this._getBoundsStyle(),this._boundStyle.temBM||(this._boundStyle.temBM=[]),this._style.scrollRect){var s=b.Utils.clearArray(this._boundStyle.temBM),o=k.Rectangle.TEMP;return o.copyFrom(this._style.scrollRect),b.Utils.concatArray(s,o._getBoundPoints()),s}t=this._graphics?this._graphics.getBoundPoints():b.Utils.clearArray(this._boundStyle.temBM),this._texture&&((o=k.Rectangle.TEMP).setTo(0,0,this.width||this._texture.width,this.height||this._texture.height),b.Utils.concatArray(t,o._getBoundPoints()));for(var l=0,u=(a=this._children).length;l<u;l++)(e=a[l])instanceof i&&!0===e._visible&&(n=e._boundPointsToParent(r))&&(t=t?b.Utils.concatArray(t,n):n);return t}},{key:"_getCacheStyle",value:function(){return this._cacheStyle===R.CacheStyle.EMPTY&&(this._cacheStyle=R.CacheStyle.create()),this._cacheStyle}},{key:"getStyle",value:function(){return this._style===w.SpriteStyle.EMPTY&&(this._style=w.SpriteStyle.create()),this._style}},{key:"setStyle",value:function(t){this._style=t}},{key:"scaleX",get:function(){return this._style.scaleX},set:function(t){this.set_scaleX(t)}},{key:"_setScaleX",value:function(t){this._style.scaleX=t}},{key:"scaleY",get:function(){return this._style.scaleY},set:function(t){this.set_scaleY(t)}},{key:"_setScaleY",value:function(t){this._style.scaleY=t}},{key:"set_scaleX",value:function(t){this.getStyle().scaleX!==t&&(this._setScaleX(t),this._setTranformChange())}},{key:"get_scaleX",value:function(){return this._style.scaleX}},{key:"set_scaleY",value:function(t){this.getStyle().scaleY!==t&&(this._setScaleY(t),this._setTranformChange())}},{key:"get_scaleY",value:function(){return this._style.scaleY}},{key:"rotation",get:function(){return this._style.rotation},set:function(t){this.getStyle().rotation!==t&&(this._setRotation(t),this._setTranformChange())}},{key:"_setRotation",value:function(t){this._style.rotation=t}},{key:"skewX",get:function(){return this._style.skewX},set:function(t){this.getStyle().skewX!==t&&(this._setSkewX(t),this._setTranformChange())}},{key:"_setSkewX",value:function(t){this._style.skewX=t}},{key:"skewY",get:function(){return this._style.skewY},set:function(t){this.getStyle().skewY!==t&&(this._setSkewY(t),this._setTranformChange())}},{key:"_setSkewY",value:function(t){this._style.skewY=t}},{key:"_createTransform",value:function(){return x.Matrix.create()}},{key:"_adjustTransform",value:function(){this._tfChanged=!1;var t=this._style,e=t.scaleX,i=t.scaleY,n=t.skewX,a=t.skewY,r=t.rotation,s=this._transform||(this._transform=this._createTransform());if(r||1!==e||1!==i||0!==n||0!==a){s._bTransform=!0;var o=.0174532922222222*(r-n),l=.0174532922222222*(r+a),u=Math.cos(l),h=Math.sin(l),c=Math.sin(o),d=Math.cos(o);s.a=e*u,s.b=e*h,s.c=-i*c,s.d=i*d,s.tx=s.ty=0}else s.identity(),this._renderType&=~D.SpriteConst.TRANSFORM,this._setRenderType(this._renderType);return s}},{key:"_setTransform",value:function(t){}},{key:"transform",get:function(){return this._tfChanged?this._adjustTransform():this._transform},set:function(t){this.set_transform(t)}},{key:"get_transform",value:function(){return this._tfChanged?this._adjustTransform():this._transform}},{key:"set_transform",value:function(t){this._tfChanged=!1;var e=this._transform||(this._transform=this._createTransform());t.copyTo(e),this._setTransform(e),t&&(this._x=e.tx,this._y=e.ty,e.tx=e.ty=0),t?this._renderType|=D.SpriteConst.TRANSFORM:this._renderType&=~D.SpriteConst.TRANSFORM,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"_setPivotX",value:function(t){this.getStyle().pivotX=t}},{key:"_getPivotX",value:function(){return this._style.pivotX}},{key:"_setPivotY",value:function(t){this.getStyle().pivotY=t}},{key:"_getPivotY",value:function(){return this._style.pivotY}},{key:"pivotX",get:function(){return this._getPivotX()},set:function(t){this._setPivotX(t),this.repaint()}},{key:"pivotY",get:function(){return this._getPivotY()},set:function(t){this._setPivotY(t),this.repaint()}},{key:"_setAlpha",value:function(t){this._style.alpha!==t&&(this.getStyle().alpha=t,1!==t?this._renderType|=D.SpriteConst.ALPHA:this._renderType&=~D.SpriteConst.ALPHA,this._setRenderType(this._renderType),this.parentRepaint())}},{key:"_getAlpha",value:function(){return this._style.alpha}},{key:"alpha",get:function(){return this._getAlpha()},set:function(t){t=t<0?0:t>1?1:t,this._setAlpha(t)}},{key:"visible",get:function(){return this.get_visible()},set:function(t){this.set_visible(t)}},{key:"get_visible",value:function(){return this._visible}},{key:"set_visible",value:function(t){this._visible!==t&&(this._visible=t,this.parentRepaint(D.SpriteConst.REPAINT_ALL))}},{key:"_setBlendMode",value:function(t){}},{key:"blendMode",get:function(){return this._style.blendMode},set:function(t){this._setBlendMode(t),this.getStyle().blendMode=t,t&&"source-over"!=t?this._renderType|=D.SpriteConst.BLEND:this._renderType&=~D.SpriteConst.BLEND,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"graphics",get:function(){return this._graphics||(this.graphics=new A.Graphics,this._graphics.autoDestroy=!0),this._graphics},set:function(t){this._graphics&&(this._graphics._sp=null),this._graphics=t,t?(this._setGraphics(t),this._renderType|=D.SpriteConst.GRAPHICS,t._sp=this):this._renderType&=~D.SpriteConst.GRAPHICS,this._setRenderType(this._renderType),this.repaint()}},{key:"_setGraphics",value:function(t){}},{key:"_setGraphicsCallBack",value:function(){}},{key:"scrollRect",get:function(){return this._style.scrollRect},set:function(t){this.getStyle().scrollRect=t,this._setScrollRect(t),this.repaint(),t?this._renderType|=D.SpriteConst.CLIP:this._renderType&=~D.SpriteConst.CLIP,this._setRenderType(this._renderType)}},{key:"_setScrollRect",value:function(t){}},{key:"pos",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._x!==t||this._y!==e){if(this.destroyed)return this;if(i){this._setX(t),this._setY(e),this.parentRepaint(D.SpriteConst.REPAINT_CACHE);var n=this._cacheStyle.maskParent;n&&n.repaint(D.SpriteConst.REPAINT_CACHE)}else this.x=t,this.y=e}return this}},{key:"pivot",value:function(t,e){return this.pivotX=t,this.pivotY=e,this}},{key:"size",value:function(t,e){return this.width=t,this.height=e,this}},{key:"scale",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.getStyle();if(n.scaleX!=t||n.scaleY!=e){if(this.destroyed)return this;i?(this._setScaleX(t),this._setScaleY(e),this._setTranformChange()):(this.scaleX=t,this.scaleY=e)}return this}},{key:"skew",value:function(t,e){return this.skewX=t,this.skewY=e,this}},{key:"render",value:function(t,e,i){C.RenderSprite.renders[this._renderType]._fun(this,t,e+this._x,i+this._y),this._repaint=0}},{key:"drawToCanvas",value:function(t,e,n,a){return i.drawToCanvas(this,this._renderType,t,e,n,a)}},{key:"drawToTexture",value:function(t,e,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return i.drawToTexture(this,this._renderType,t,e,n,a,r)}},{key:"drawToTexture3D",value:function(t,e,i){throw"not implement"}},{key:"customRender",value:function(t,e,i){this._repaint=D.SpriteConst.REPAINT_ALL}},{key:"_applyFilters",value:function(){}},{key:"filters",get:function(){return this._cacheStyle.filters},set:function(t){t&&0===t.length&&(t=null),this._cacheStyle.filters!=t&&(this._getCacheStyle().filters=t?(0,s.default)(t).call(t):null,t&&t.length?(this._setColorFilter(t[0]),this._renderType|=D.SpriteConst.FILTERS):(this._setColorFilter(null),this._renderType&=~D.SpriteConst.FILTERS),this._setRenderType(this._renderType),t&&t.length>0?(this._getBit(v.Const.DISPLAY)||this._setBitUp(v.Const.DISPLAY),1==t.length&&t[0]instanceof p.ColorFilter||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())}},{key:"_setColorFilter",value:function(t){}},{key:"_isHaveGlowFilter",value:function(){var t,e;if(this.filters)for(t=0;t<this.filters.length;t++)if(this.filters[t].type==g.Filter.GLOW)return!0;for(t=0,e=this._children.length;t<e;t++)if(this._children[t]._isHaveGlowFilter())return!0;return!1}},{key:"localToGlobal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!0===e&&(t=new T.Point(t.x,t.y));var n=this;for(i=i||_.ILaya.stage;n&&!n.destroyed&&n!=i;)t=n.toParentPoint(t),n=n.parent;return t}},{key:"globalToLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e&&(t=new T.Point(t.x,t.y));var n=this,a=[];for(i=i||_.ILaya.stage;n&&!n.destroyed&&n!=i;)a.push(n),n=n.parent;for(var r=a.length-1;r>=0;)t=(n=a[r]).fromParentPoint(t),r--;return t}},{key:"toParentPoint",value:function(t){if(!t)return t;t.x-=this.pivotX,t.y-=this.pivotY,this.transform&&this._transform.transformPoint(t),t.x+=this._x,t.y+=this._y;var e=this._style.scrollRect;return e&&(t.x-=e.x,t.y-=e.y),t}},{key:"fromParentPoint",value:function(t){if(!t)return t;t.x-=this._x,t.y-=this._y;var e=this._style.scrollRect;return e&&(t.x+=e.x,t.y+=e.y),this.transform&&this._transform.invertTransformPoint(t),t.x+=this.pivotX,t.y+=this.pivotY,t}},{key:"fromStagePoint",value:function(t){return t}},{key:"on",value:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(v.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,n,a,!1)):(0,h.default)((0,f.default)(i.prototype),"on",this).call(this,t,e,n,a)}},{key:"once",value:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(v.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,n,a,!0)):(0,h.default)((0,f.default)(i.prototype),"once",this).call(this,t,e,n,a)}},{key:"_onDisplay",value:function(t){if(1!==this._mouseState){var e=this;for(e=e.parent;e&&1!==e._mouseState&&!e._getBit(v.Const.HAS_MOUSE);)e.mouseEnabled=!0,e._setBit(v.Const.HAS_MOUSE,!0),e=e.parent}}},{key:"_setParent",value:function(t){(0,h.default)((0,f.default)(i.prototype),"_setParent",this).call(this,t),t&&this._getBit(v.Const.HAS_MOUSE)&&this._onDisplay()}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){var i=_.ILaya.Loader.textureMap[P.URL.formatURL(t)];i||((i=new M.Texture).load(t),_.ILaya.Loader.cacheTexture(t,i)),this.texture=i,i.getIsReady()?n.call(this):i.once(y.Event.READY,this,n)}else this.texture=null,n.call(this);function n(){this.repaint(D.SpriteConst.REPAINT_ALL),e&&e.run()}return this}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D.SpriteConst.REPAINT_CACHE;this._repaint&t||(this._repaint|=t,this.parentRepaint(t)),this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(t)}},{key:"_needRepaint",value:function(){return this._repaint&D.SpriteConst.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache}},{key:"_childChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._children.length?this._renderType|=D.SpriteConst.CHILDS:this._renderType&=~D.SpriteConst.CHILDS,this._setRenderType(this._renderType),t&&this._getBit(v.Const.HAS_ZORDER)&&_.ILaya.systemTimer.callLater(this,this.updateZOrder),this.repaint(D.SpriteConst.REPAINT_ALL)}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D.SpriteConst.REPAINT_CACHE,e=this._parent;!e||e._repaint&t||(e._repaint|=t,e.parentRepaint(t))}},{key:"stage",get:function(){return _.ILaya.stage}},{key:"hitArea",get:function(){return this._style.hitArea},set:function(t){this.getStyle().hitArea=t}},{key:"_setMask",value:function(t){}},{key:"mask",get:function(){return this._cacheStyle.mask},set:function(t){t&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=t,this._setMask(t),this._checkCanvasEnable(),t?t._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=D.SpriteConst.MASK,this._setRenderType(this._renderType),this.parentRepaint(D.SpriteConst.REPAINT_ALL))}},{key:"mouseEnabled",get:function(){return this._mouseState>1},set:function(t){this._mouseState=t?2:1}},{key:"startDrag",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.92;this._style.dragging||(this.getStyle().dragging=new _.ILaya.Dragging),this._style.dragging.start(this,t,e,i,n,a,r,s)}},{key:"stopDrag",value:function(){this._style.dragging&&this._style.dragging.stop()}},{key:"_setDisplay",value:function(t){t||this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1)),(0,h.default)((0,f.default)(i.prototype),"_setDisplay",this).call(this,t)}},{key:"hitTestPoint",value:function(t,e){var i=this.globalToLocal(T.Point.TEMP.setTo(t,e));return t=i.x,e=i.y,(this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?k.Rectangle.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(t,e)}},{key:"getMousePoint",value:function(){return this.globalToLocal(T.Point.TEMP.setTo(_.ILaya.stage.mouseX,_.ILaya.stage.mouseY))}},{key:"globalScaleX",get:function(){for(var t=1,e=this;e&&e!==_.ILaya.stage;)t*=e.scaleX,e=e.parent;return t}},{key:"globalRotation",get:function(){for(var t=0,e=this;e&&e!==_.ILaya.stage;)t+=e.rotation,e=e.parent;return t}},{key:"globalScaleY",get:function(){for(var t=1,e=this;e&&e!==_.ILaya.stage;)t*=e.scaleY,e=e.parent;return t}},{key:"mouseX",get:function(){return this.getMousePoint().x}},{key:"mouseY",get:function(){return this.getMousePoint().y}},{key:"zOrder",get:function(){return this._zOrder},set:function(t){this._zOrder!=t&&(this._zOrder=t,this._parent&&(t&&this._parent._setBit(v.Const.HAS_ZORDER,!0),_.ILaya.systemTimer.callLater(this._parent,this.updateZOrder)))}},{key:"texture",get:function(){return this._texture},set:function(t){"string"==typeof t?this.loadImage(t):this._texture!=t&&(this._texture&&this._texture._removeReference(),this._texture=t,t&&t._addReference(),this._setTexture(t),this._setWidth(this._texture,this.width),this._setHeight(this._texture,this.height),t?this._renderType|=D.SpriteConst.TEXTURE:this._renderType&=~D.SpriteConst.TEXTURE,this._setRenderType(this._renderType),this.repaint())}},{key:"_setTexture",value:function(t){}},{key:"viewport",get:function(){return this._style.viewport},set:function(t){var e;"string"==typeof t&&((e=t.split(",")).length>3&&(t=new k.Rectangle((0,o.default)(e[0]),(0,o.default)(e[1]),(0,o.default)(e[2]),(0,o.default)(e[3]))));this.getStyle().viewport=t}},{key:"_setRenderType",value:function(t){}},{key:"_setTranformChange",value:function(){this._tfChanged=!0,this._renderType|=D.SpriteConst.TRANSFORM,this.parentRepaint(D.SpriteConst.REPAINT_CACHE)}},{key:"_setBgStyleColor",value:function(t,e,i,n,a){}},{key:"_setBorderStyleColor",value:function(t,e,i,n,a,r){}},{key:"captureMouseEvent",value:function(t){_.ILaya.MouseManager.instance.setCapture(this,t)}},{key:"releaseMouseEvent",value:function(){_.ILaya.MouseManager.instance.releaseCapture()}},{key:"drawCallOptimize",get:function(){return this._getBit(v.Const.DRAWCALL_OPTIMIZE)},set:function(t){this._setBit(v.Const.DRAWCALL_OPTIMIZE,t)}}],[{key:"drawToCanvas",value:function(t,e,i,n,a,r){a-=t.x,r-=t.y,a|=0,r|=0,i|=0,n|=0;var s=new S.Context;s.size(i,n),s.asBitmap=!0,s._targets.start(),s._targets.clear(0,0,0,0),C.RenderSprite.renders[e]._fun(t,s,a,r),s.flush(),s._targets.end(),s._targets.restore();var o=s._targets.getData(0,0,i,n);s.destroy();for(var l=new ImageData(i,n),u=4*i,h=(new Uint8Array(u),l.data),c=n-1,d=c*u,f=0;c>=0;c--)h.set(o.subarray(f,f+u),d),d-=u,f+=u;var _=new E.HTMLCanvas(!0);return _.size(i,n),_.getContext("2d").putImageData(l,0,0),_}},{key:"drawToTexture",value:function(t,e,n,a,r,s){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;i.drawtocanvCtx||(i.drawtocanvCtx=new S.Context),r-=t.x,s-=t.y,r|=0,s|=0,n|=0,a|=0;var l=o?i.drawtocanvCtx:new S.Context;if(l.clear(),l.size(n,a),o?l._targets=o:l.asBitmap=!0,l._targets&&(l._targets.start(),l._targets.clear(0,0,0,0),C.RenderSprite.renders[e]._fun(t,l,r,s),l.flush(),l._targets.end(),l._targets.restore()),!o){var u=new M.Texture(l._targets,M.Texture.INV_UV);return l.destroy(!0),u}return t._repaint=0,o}},{key:"fromImage",value:function(t){return(new i).loadImage(t)}}]),i}(B.Node);e.Sprite=F,L.ClassUtils.regClass("laya.display.Sprite",F),L.ClassUtils.regClass("Laya.Sprite",F)},43745:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SpriteConst=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.SpriteConst=s,s.ALPHA=1,s.TRANSFORM=2,s.BLEND=4,s.CANVAS=8,s.FILTERS=16,s.MASK=32,s.CLIP=64,s.STYLE=128,s.TEXTURE=256,s.GRAPHICS=512,s.LAYAGL3D=1024,s.CUSTOM=2048,s.ONECHILD=4096,s.CHILDS=8192,s.REPAINT_NONE=0,s.REPAINT_NODE=1,s.REPAINT_CACHE=2,s.REPAINT_ALL=3},77590:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Stage=void 0;var s=r(i(94198)),o=r(i(81643)),l=r(i(92762)),u=r(i(15375)),h=r(i(17061)),c=r(i(89395)),d=r(i(97709)),f=r(i(38191)),_=r(i(45408)),v=r(i(52305)),y=i(78362),p=i(80340),g=i(61891),m=i(43745),x=i(13407),T=i(89662),k=i(47002),C=i(18008),S=i(85399),E=i(85136),M=i(12596),L=i(79741),b=i(93568),I=i(38022),R=i(13104),w=i(14400),A=i(25670),B=i(56161),D=i(683),P=i(92493),O=i(33873),F=i(23835),U=i(23877);function N(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,v.default)(t);if(e){var r=(0,v.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,f.default)(this,i)}}var G=function(t){(0,d.default)(i,t);var e=N(i);function i(){var t,n;(0,u.default)(this,i),(n=e.call(this)).offset=new S.Point,n._frameRate="fast",n.designWidth=0,n.designHeight=0,n.canvasRotation=!1,n.canvasDegree=0,n.renderingEnabled=!0,n.screenAdaptationEnabled=!0,n._canvasTransform=new C.Matrix,n._screenMode="none",n._scaleMode="noscale",n._alignV="top",n._alignH="left",n._bgColor="black",n._mouseMoveTime=0,n._renderCount=0,n._safariOffsetY=0,n._frameStartTime=0,n._previousOrientation=b.Browser.window.orientation,n._wgColor=[0,0,0,1],n._scene3Ds=[],n._globalRepaintSet=!1,n._globalRepaintGet=!1,n._3dUI=[],n._curUIBase=null,n.useRetinalCanvas=!1,(0,_.default)((t=(0,c.default)(n),(0,v.default)(i.prototype)),"set_transform",t).call(t,n._createTransform()),n.mouseEnabled=!0,n.hitTestPrior=!0,n.autoSize=!1,n._setBit(x.Const.DISPLAYED_INSTAGE,!0),n._setBit(x.Const.ACTIVE_INHIERARCHY,!0),n._isFocused=!0,n._isVisibility=!0,n.useRetinalCanvas=p.Config.useRetinalCanvas;var a=b.Browser.window;a.addEventListener("focus",(function(){n._isFocused=!0,n.event(T.Event.FOCUS),n.event(T.Event.FOCUS_CHANGE)})),a.addEventListener("blur",(function(){n._isFocused=!1,n.event(T.Event.BLUR),n.event(T.Event.FOCUS_CHANGE),n._isInputting()&&(g.Input.inputElement.target.focus=!1)}));var r="visibilityState",s="visibilitychange",o=a.document;return void 0!==o.hidden?(s="visibilitychange",r="visibilityState"):void 0!==o.mozHidden?(s="mozvisibilitychange",r="mozVisibilityState"):void 0!==o.msHidden?(s="msvisibilitychange",r="msVisibilityState"):void 0!==o.webkitHidden&&(s="webkitvisibilitychange",r="webkitVisibilityState"),a.document.addEventListener(s,(function(){"hidden"==b.Browser.document[r]?(n._isVisibility=!1,n._isInputting()&&(g.Input.inputElement.target.focus=!1)):n._isVisibility=!0,n.renderingEnabled=n._isVisibility,n.event(T.Event.VISIBILITY_CHANGE)})),a.addEventListener("resize",(function(){var t=b.Browser.window.orientation;null!=t&&t!=n._previousOrientation&&n._isInputting()&&(g.Input.inputElement.target.focus=!1),n._previousOrientation=t,n._isInputting()||(b.Browser.onSafari&&(n._safariOffsetY=(b.Browser.window.__innerHeight||b.Browser.document.body.clientHeight||b.Browser.document.documentElement.clientHeight)-b.Browser.window.innerHeight),n._resetCanvas())})),a.addEventListener("orientationchange",(function(t){n._resetCanvas()})),n.on(T.Event.MOUSE_MOVE,(0,c.default)(n),n._onmouseMove),b.Browser.onMobile&&n.on(T.Event.MOUSE_DOWN,(0,c.default)(n),n._onmouseMove),n}return(0,h.default)(i,[{key:"_isInputting",value:function(){return b.Browser.onMobile&&g.Input.isInputting}},{key:"width",get:function(){return(0,_.default)((0,v.default)(i.prototype),"get_width",this).call(this)},set:function(t){this.designWidth=t,(0,_.default)((0,v.default)(i.prototype),"set_width",this).call(this,t),P.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"height",get:function(){return(0,_.default)((0,v.default)(i.prototype),"get_height",this).call(this)},set:function(t){this.designHeight=t,(0,_.default)((0,v.default)(i.prototype),"set_height",this).call(this,t),P.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"transform",get:function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||this._createTransform()},set:function(t){(0,_.default)((0,v.default)(i.prototype),"set_transform",this).call(this,t)}},{key:"isFocused",get:function(){return this._isFocused}},{key:"isVisibility",get:function(){return this._isVisibility}},{key:"_changeCanvasSize",value:function(){this.setScreenSize(b.Browser.clientWidth*b.Browser.pixelRatio,b.Browser.clientHeight*b.Browser.pixelRatio)}},{key:"_resetCanvas",value:function(){this.screenAdaptationEnabled&&this._changeCanvasSize()}},{key:"setScreenSize",value:function(t,e){var n=!1;if(this._screenMode!==i.SCREEN_NONE&&(n=(t/e<1?i.SCREEN_VERTICAL:i.SCREEN_HORIZONTAL)!==this._screenMode)){var a=e;e=t,t=a}this.canvasRotation=n;var r=E.Render._mainCanvas,o=r.source.style,l=this._canvasTransform.identity(),u=this._scaleMode,h=t/this.designWidth,c=e/this.designHeight,d=this.useRetinalCanvas?t:this.designWidth,f=this.useRetinalCanvas?e:this.designHeight,y=t,p=e,g=b.Browser.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,u){case i.SCALE_NOSCALE:h=c=1,y=this.designWidth,p=this.designHeight;break;case i.SCALE_SHOWALL:h=c=Math.min(h,c),d=y=Math.round(this.designWidth*h),f=p=Math.round(this.designHeight*c);break;case i.SCALE_NOBORDER:h=c=Math.max(h,c),y=Math.round(this.designWidth*h),p=Math.round(this.designHeight*c);break;case i.SCALE_FULL:h=c=1,this._width=d=t,this._height=f=e;break;case i.SCALE_FIXED_WIDTH:c=h,this._height=f=Math.round(e/h);break;case i.SCALE_FIXED_HEIGHT:h=c,this._width=d=Math.round(t/c);break;case i.SCALE_FIXED_AUTO:t/e<this.designWidth/this.designHeight?(c=h,this._height=f=Math.round(e/h)):(h=c,this._width=d=Math.round(t/c))}this.useRetinalCanvas&&(y=d=t,p=f=e),h*=this.scaleX,c*=this.scaleY,1===h&&1===c?this.transform.identity():(this.transform.a=this._formatData(h/(y/d)),this.transform.d=this._formatData(c/(p/f))),r.size(d,f),w.RunDriver.changeWebGLSize(d,f),l.scale(y/d/g,p/f/g),this._alignH===i.ALIGN_LEFT?this.offset.x=0:this._alignH===i.ALIGN_RIGHT?this.offset.x=t-y:this.offset.x=.5*(t-y)/g,this._alignV===i.ALIGN_TOP?this.offset.y=0:this._alignV===i.ALIGN_BOTTOM?this.offset.y=e-p:this.offset.y=.5*(e-p)/g,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),l.translate(this.offset.x,this.offset.y),this._safariOffsetY&&l.translate(0,this._safariOffsetY),this.canvasDegree=0,n&&(this._screenMode===i.SCREEN_HORIZONTAL?(l.rotate(Math.PI/2),l.translate(e/g,0),this.canvasDegree=90):(l.rotate(-Math.PI/2),l.translate(0,t/g),this.canvasDegree=-90)),l.a=this._formatData(l.a),l.d=this._formatData(l.d),l.tx=this._formatData(l.tx),l.ty=this._formatData(l.ty),(0,_.default)((0,v.default)(i.prototype),"set_transform",this).call(this,this.transform),o.transformOrigin=o.webkitTransformOrigin=o.msTransformOrigin=o.mozTransformOrigin=o.oTransformOrigin="0px 0px 0px",o.transform=o.webkitTransform=o.msTransform=o.mozTransform=o.oTransform="matrix("+l.toString()+")",o.width=d,o.height=f,this._safariOffsetY&&l.translate(0,-this._safariOffsetY),l.translate((0,s.default)(o.left)||0,(0,s.default)(o.top)||0),this.visible=!0,this._repaint|=m.SpriteConst.REPAINT_CACHE,this.event(T.Event.RESIZE)}},{key:"_formatData",value:function(t){return Math.abs(t)<1e-6?0:Math.abs(1-t)<.001?t>0?1:-1:t}},{key:"scaleMode",get:function(){return this._scaleMode},set:function(t){this._scaleMode=t,P.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignH",get:function(){return this._alignH},set:function(t){this._alignH=t,P.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignV",get:function(){return this._alignV},set:function(t){this._alignV=t,P.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,this._wgColor=t?R.ColorUtils.create(t).arrColor:null,E.Render.canvas.style.background=t||"none"}},{key:"mouseX",get:function(){return Math.round(k.MouseManager.instance.mouseX/this.clientScaleX)}},{key:"mouseY",get:function(){return Math.round(k.MouseManager.instance.mouseY/this.clientScaleY)}},{key:"getMousePoint",value:function(){return S.Point.TEMP.setTo(this.mouseX,this.mouseY)}},{key:"clientScaleX",get:function(){return this._transform?this._transform.getScaleX():1}},{key:"clientScaleY",get:function(){return this._transform?this._transform.getScaleY():1}},{key:"screenMode",get:function(){return this._screenMode},set:function(t){this._screenMode=t}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.SpriteConst.REPAINT_CACHE;this._repaint|=t}},{key:"parentRepaint",value:function(){arguments.length>0&&void 0!==arguments[0]||m.SpriteConst.REPAINT_CACHE}},{key:"_loop",value:function(){return this._globalRepaintGet=this._globalRepaintSet,this._globalRepaintSet=!1,this.render(E.Render._context,0,0),!0}},{key:"getFrameTm",value:function(){return this._frameStartTime}},{key:"_onmouseMove",value:function(t){this._mouseMoveTime=b.Browser.now()}},{key:"getTimeFromFrameStart",value:function(){return b.Browser.now()-this._frameStartTime}},{key:"visible",get:function(){return(0,_.default)((0,v.default)(i.prototype),"visible",this)},set:function(t){this.visible!==t&&((0,_.default)((0,v.default)(i.prototype),"set_visible",this).call(this,t),E.Render._mainCanvas.source.style.visibility=t?"visible":"hidden")}},{key:"render",value:function(t,e,n){if(window.conch)this.renderToNative(t,e,n);else{if(this._frameRate===i.FRAME_SLEEP){var a=b.Browser.now();if(!(a-this._frameStartTime>=1e3))return;this._frameStartTime=a}else{if(!this._visible)return this._renderCount++,void(this._renderCount%5==0&&(I.CallLater.I._update(),D.Stat.loopCount++,M.RenderInfo.loopCount=D.Stat.loopCount,this._updateTimers()));this._frameStartTime=b.Browser.now(),M.RenderInfo.loopStTm=this._frameStartTime}this._renderCount++;var r=(this._frameRate===i.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2e3?i.FRAME_FAST:i.FRAME_SLOW:this._frameRate)!==i.FRAME_SLOW,s=this._renderCount%2==0;if(D.Stat.renderSlow=!r,r||s){if(I.CallLater.I._update(),D.Stat.loopCount++,M.RenderInfo.loopCount=D.Stat.loopCount,U.PerformancePlugin.begainSample(U.PerformancePlugin.PERFORMANCE_LAYA),this.renderingEnabled){for(var o=0,l=this._scene3Ds.length;o<l;o++)this._scene3Ds[o]._update();t.clear(),(0,_.default)((0,v.default)(i.prototype),"render",this).call(this,t,e,n),D.Stat._StatRender.renderNotCanvas(t,e,n)}this.renderingEnabled&&(i.clear(this._bgColor),t.flush(),A.VectorGraphManager.instance&&A.VectorGraphManager.getInstance().endDispose()),this._updateTimers(),U.PerformancePlugin.endSample(U.PerformancePlugin.PERFORMANCE_LAYA)}}}},{key:"renderToNative",value:function(t,e,n){if(this._renderCount++,this._visible){if(this._frameStartTime=b.Browser.now(),I.CallLater.I._update(),D.Stat.loopCount++,M.RenderInfo.loopCount=D.Stat.loopCount,this.renderingEnabled){for(var a=0,r=this._scene3Ds.length;a<r;a++)this._scene3Ds[a]._update();t.clear(),(0,_.default)((0,v.default)(i.prototype),"render",this).call(this,t,e,n),D.Stat._StatRender.renderNotCanvas(t,e,n)}this.renderingEnabled&&(i.clear(this._bgColor),t.flush(),A.VectorGraphManager.instance&&A.VectorGraphManager.getInstance().endDispose()),this._updateTimers()}else this._renderCount%5==0&&(I.CallLater.I._update(),D.Stat.loopCount++,M.RenderInfo.loopCount=D.Stat.loopCount,this._updateTimers())}},{key:"_updateTimers",value:function(){P.ILaya.systemTimer._update(),P.ILaya.startTimer._update(),P.ILaya.physicsTimer._update(),P.ILaya.updateTimer._update(),P.ILaya.lateTimer._update(),P.ILaya.timer._update()}},{key:"fullScreenEnabled",set:function(t){var e=b.Browser.document,i=E.Render.canvas;t?(i.addEventListener("mousedown",this._requestFullscreen),i.addEventListener("touchstart",this._requestFullscreen),e.addEventListener("fullscreenchange",this._fullScreenChanged),e.addEventListener("mozfullscreenchange",this._fullScreenChanged),e.addEventListener("webkitfullscreenchange",this._fullScreenChanged),e.addEventListener("msfullscreenchange",this._fullScreenChanged)):(i.removeEventListener("mousedown",this._requestFullscreen),i.removeEventListener("touchstart",this._requestFullscreen),e.removeEventListener("fullscreenchange",this._fullScreenChanged),e.removeEventListener("mozfullscreenchange",this._fullScreenChanged),e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),e.removeEventListener("msfullscreenchange",this._fullScreenChanged))}},{key:"frameRate",get:function(){return P.ILaya.Render.isConchApp?this._frameRateNative:this._frameRate},set:function(t){if(P.ILaya.Render.isConchApp){var e=window.conch;switch(t){case i.FRAME_FAST:e.config.setLimitFPS(60);break;case i.FRAME_MOUSE:e.config.setMouseFrame(2e3);break;case i.FRAME_SLOW:e.config.setSlowFrame(!0);break;case i.FRAME_SLEEP:e.config.setLimitFPS(1)}this._frameRateNative=t}else this._frameRate=t}},{key:"_requestFullscreen",value:function(){var t=b.Browser.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},{key:"_fullScreenChanged",value:function(){P.ILaya.stage.event(T.Event.FULL_SCREEN_CHANGE)}},{key:"exitFullscreen",value:function(){var t=b.Browser.document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}},{key:"isGlobalRepaint",value:function(){return this._globalRepaintGet}},{key:"setGlobalRepaint",value:function(){this._globalRepaintSet=!0}},{key:"add3DUI",value:function(t){var e,i=t.rootView;(0,o.default)(e=this._3dUI).call(e,i)>=0||this._3dUI.push(i)}},{key:"remove3DUI",value:function(t){var e,i,n=t.rootView,a=(0,o.default)(e=this._3dUI).call(e,n);return a>=0&&((0,l.default)(i=this._3dUI).call(i,a,1),!0)}}]),i}(y.Sprite);e.Stage=G,G.SCALE_NOSCALE="noscale",G.SCALE_EXACTFIT="exactfit",G.SCALE_SHOWALL="showall",G.SCALE_NOBORDER="noborder",G.SCALE_FULL="full",G.SCALE_FIXED_WIDTH="fixedwidth",G.SCALE_FIXED_HEIGHT="fixedheight",G.SCALE_FIXED_AUTO="fixedauto",G.ALIGN_LEFT="left",G.ALIGN_RIGHT="right",G.ALIGN_CENTER="center",G.ALIGN_TOP="top",G.ALIGN_MIDDLE="middle",G.ALIGN_BOTTOM="bottom",G.SCREEN_NONE="none",G.SCREEN_HORIZONTAL="horizontal",G.SCREEN_VERTICAL="vertical",G.FRAME_FAST="fast",G.FRAME_SLOW="slow",G.FRAME_MOUSE="mouse",G.FRAME_SLEEP="sleep",G.clear=function(t){L.Context.set2DRenderConfig();var e=O.LayaGL.instance;B.RenderState2D.worldScissorTest&&e.disable(e.SCISSOR_TEST);var i=E.Render.context,n=0==i._submits._length||p.Config.preserveDrawingBuffer?R.ColorUtils.create(t).arrColor:P.ILaya.stage._wgColor;n?i.clearBG(n[0],n[1],n[2],n[3]):i.clearBG(0,0,0,0),B.RenderState2D.clear()},F.ClassUtils.regClass("laya.display.Stage",G),F.ClassUtils.regClass("Laya.Stage",G)},81870:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Text=void 0;var s=r(i(78914)),o=r(i(31238)),l=r(i(15375)),u=r(i(17061)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(78362),v=i(43745),y=i(33176),p=i(89662),g=i(85399),m=i(98693),x=i(80651),T=i(92493),k=i(23835);function C(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var S=function(t){(0,c.default)(i,t);var e=C(i);function i(){var t;return(0,l.default)(this,i),(t=e.call(this))._textWidth=0,t._textHeight=0,t._lines=[],t._lineWidths=[],t._startX=0,t._startY=0,t._charSize={},t._valign="top",t._fontSize=i.defaultFontSize,t._font=i.defaultFont,t._color="#000000",t._singleCharRender=!1,t.overflow=i.VISIBLE,t._style=y.TextStyle.EMPTY,t}return(0,u.default)(i,[{key:"getStyle",value:function(){return this._style===y.TextStyle.EMPTY&&(this._style=y.TextStyle.create()),this._style}},{key:"_getTextStyle",value:function(){return this._style===y.TextStyle.EMPTY&&(this._style=y.TextStyle.create()),this._style}},{key:"destroy",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this,e),this._clipPoint=null,this._lines=null,this._lineWidths=null,this._words&&(0,s.default)(t=this._words).call(t,(function(t){t.cleanCache()})),this._words=null,this._charSize=null}},{key:"_getBoundPointsM",value:function(){var t=m.Rectangle.TEMP;return t.setTo(0,0,this.width,this.height),t._getBoundPoints()}},{key:"getGraphicBounds",value:function(){var t=m.Rectangle.TEMP;return t.setTo(0,0,this.width,this.height),t}},{key:"width",get:function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},set:function(t){t!=this._width&&((0,h.default)((0,f.default)(i.prototype),"set_width",this).call(this,t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"height",get:function(){return this._height?this._height:this.textHeight},set:function(t){t!=this._height&&((0,h.default)((0,f.default)(i.prototype),"set_height",this).call(this,t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"textWidth",get:function(){return this._isChanged&&T.ILaya.systemTimer.runCallLater(this,this.typeset),this._textWidth}},{key:"textHeight",get:function(){return this._isChanged&&T.ILaya.systemTimer.runCallLater(this,this.typeset),this._textHeight}},{key:"text",get:function(){return this._text||""},set:function(t){this.set_text(t)}},{key:"get_text",value:function(){return this._text||""}},{key:"set_text",value:function(t){this._text!==t&&(this.lang(t+""),this.isChanged=!0,this.event(p.Event.CHANGE),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"lang",value:function(t){if(t=i.langPacks&&i.langPacks[t]?i.langPacks[t]:t,arguments.length<2)this._text=t;else{for(var e=0,n=arguments.length;e<n;e++)t=t.replace("{"+e+"}",arguments[e+1]);this._text=t}}},{key:"font",get:function(){return this._font},set:function(t){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1)),i._bitmapFonts&&i._bitmapFonts[t]&&(this._getTextStyle().currBitmapFont=i._bitmapFonts[t]),this._font=t,this.isChanged=!0}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!=t&&(this._fontSize=t,this.isChanged=!0)}},{key:"bold",get:function(){return this._style.bold},set:function(t){this._getTextStyle().bold=t,this.isChanged=!0}},{key:"color",get:function(){return this._color},set:function(t){this.set_color(t)}},{key:"get_color",value:function(){return this._color}},{key:"set_color",value:function(t){this._color!=t&&(this._color=t,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}},{key:"italic",get:function(){return this._style.italic},set:function(t){this._getTextStyle().italic=t,this.isChanged=!0}},{key:"align",get:function(){return this._style.align},set:function(t){this._getTextStyle().align=t,this.isChanged=!0}},{key:"valign",get:function(){return this._valign},set:function(t){this._valign=t,this.isChanged=!0}},{key:"wordWrap",get:function(){return this._style.wordWrap},set:function(t){this._getTextStyle().wordWrap=t,this.isChanged=!0}},{key:"leading",get:function(){return this._style.leading},set:function(t){this._getTextStyle().leading=t,this.isChanged=!0}},{key:"padding",get:function(){return this._style.padding},set:function(t){if("string"==typeof t){var e,i,n;for(n=(e=t.split(",")).length;e.length<4;)e.push(0);for(i=0;i<n;i++)e[i]=(0,o.default)(e[i])||0;t=e}this._getTextStyle().padding=t,this.isChanged=!0}},{key:"bgColor",get:function(){return this._style.bgColor},set:function(t){this.set_bgColor(t)}},{key:"set_bgColor",value:function(t){this._getTextStyle().bgColor=t,this._renderType|=v.SpriteConst.STYLE,this._setBgStyleColor(0,0,this.width,this.height,t),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"get_bgColor",value:function(){return this._style.bgColor}},{key:"borderColor",get:function(){return this._style.borderColor},set:function(t){this._getTextStyle().borderColor=t,this._renderType|=v.SpriteConst.STYLE,this._setBorderStyleColor(0,0,this.width,this.height,t,1),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"stroke",get:function(){return this._style.stroke},set:function(t){this._getTextStyle().stroke=t,this.isChanged=!0}},{key:"strokeColor",get:function(){return this._style.strokeColor},set:function(t){this._getTextStyle().strokeColor=t,this.isChanged=!0}},{key:"isChanged",set:function(t){this._isChanged!==t&&(this._isChanged=t,t&&T.ILaya.systemTimer.callLater(this,this.typeset))}},{key:"_getContextFont",value:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(T.ILaya.Browser.onIPhone&&i.fontFamilyMap[this.font]||this.font)}},{key:"_isPassWordMode",value:function(){var t=this._style.asPassword;return"prompt"in this&&this.prompt==this._text&&(t=!1),t}},{key:"_getPassWordTxt",value:function(t){var e;e="";for(var i=t.length;i>0;i--)e+="●";return e}},{key:"_renderText",value:function(){var t=this.padding,e=this._lines.length;this.overflow!=i.VISIBLE&&(e=Math.min(e,Math.floor((this.height-t[0]-t[2])/(this.leading+this._charSize.height))+1));var n=this.scrollY/(this._charSize.height+this.leading)|0,a=this.graphics;a.clear(!0);var r=this._getContextFont();T.ILaya.Browser.context.font=r;var s=t[3],o="left",l=this._lines,u=this.leading+this._charSize.height,h=this._style.currBitmapFont;h&&(u=this.leading+h.getMaxHeight());var c=t[0];!h&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(o="right",s=this._width-t[1]):"center"==this.align&&(o="center",s=.5*this._width+t[3]-t[1]));var d=1;if(h&&h.autoScaleSize&&(d=h.fontSize/this.fontSize),this._height>0){var f=this._textHeight>this._height?"top":this.valign;"middle"===f?c=.5*(this._height-e/d*u)+t[0]-t[2]:"bottom"===f&&(c=this._height-e/d*u-t[2])}if(this._clipPoint){var _,v;if(a.save(),h&&h.autoScaleSize)_=this._width?this._width-t[3]-t[1]:this._textWidth,v=this._height?this._height-t[0]-t[2]:this._textHeight,_*=d,v*=d,a.clipRect(t[3],t[0],_,v);else a.clipRect(t[3],t[0],this._width?this._width-t[3]-t[1]:this._textWidth,this._height?this._height-t[0]-t[2]:this._textHeight);this.repaint()}var y=this._style,p=y.asPassword;"prompt"in this&&this.prompt==this._text&&(p=!1);for(var g=0,m=0,k=Math.min(this._lines.length,e+n)||1,C=n;C<k;C++){var S,E=l[C];if(p){var M=E.length;E="";for(var L=M;L>0;L--)E+="●"}if(null==E&&(E=""),g=s-(this._clipPoint?this._clipPoint.x:0),m=c+u*C-(this._clipPoint?this._clipPoint.y:0),this.underline&&this._drawUnderline(o,g,m,C),h){var b=this.width;h.autoScaleSize&&(b=this.width*d,g*=d,m*=d),h._drawText(E,this,g,m,this.align,b)}else this._words||(this._words=[]),this._words.length>C-n?S=this._words[C-n]:(S=new x.WordText,this._words.push(S)),S.setText(E),S.splitRender=this._singleCharRender,y.stroke?a.fillBorderText(S,g,m,r,this.color,o,y.stroke,y.strokeColor):a.fillText(S,g,m,r,this.color,o)}if(h&&h.autoScaleSize){var I=1/d;this.scale(I,I)}this._clipPoint&&a.restore(),this._startX=s,this._startY=c}},{key:"_drawUnderline",value:function(t,e,i,n){var a=this._lineWidths[n];switch(t){case"center":e-=a/2;break;case"right":e-=a}i+=this._charSize.height,this._graphics.drawLine(e,i,e+a,i,this.underlineColor||this.color,1)}},{key:"typeset",value:function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);T.ILaya.Render.isConchApp?window.conchTextCanvas.font=this._getContextFont():T.ILaya.Browser.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new g.Point(0,0)):this._clipPoint=null,this._renderText()}},{key:"_evalTextSize",value:function(){var t,e;t=Math.max.apply(this,this._lineWidths);var i=this._style.currBitmapFont;if(i){var n=i.getMaxHeight();i.autoScaleSize&&(n=this.fontSize),e=this._lines.length*(n+this.leading)+this.padding[0]+this.padding[2]}else e=this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],this._lines.length&&(e-=this.leading);t==this._textWidth&&e==this._textHeight||(this._textWidth=t,this._textHeight=e)}},{key:"_checkEnabledViewportOrNot",value:function(){return this.overflow==i.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)}},{key:"changeText",value:function(t){this._text!==t&&(this.lang(t+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())}},{key:"_parseLines",value:function(t){var e=this.wordWrap||this.overflow==i.HIDDEN;if(e)var n=this._getWordWrapWidth();var a=this._style.currBitmapFont;if(a)this._charSize.width=a.getMaxWidth(),this._charSize.height=a.getMaxHeight();else{var r=null;(r=T.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(i._testWord):T.ILaya.Browser.context.measureText(i._testWord))||(r={width:100}),this._charSize.width=r.width,this._charSize.height=r.height||this.fontSize}for(var s=t.replace(/\r\n/g,"\n").split("\n"),o=0,l=s.length;o<l;o++){var u=s[o];e?this._parseLine(u,n):(this._lineWidths.push(this._getTextWidth(u)),this._lines.push(u))}}},{key:"_parseLine",value:function(t,e){var n=this._lines,a=0,r=0,s=0,o=0;if((r=this._getTextWidth(t))<=e)return n.push(t),void this._lineWidths.push(r);r=this._charSize.width,0==(a=Math.floor(e/r))&&(a=1),s=r=this._getTextWidth(t.substring(0,a));for(var l=a,u=t.length;l<u;l++)if((s+=r=this._getTextWidth(t.charAt(l)))>e)if(this.wordWrap){var h=t.substring(o,l),c=h.charCodeAt(h.length-1);if(c<19968||c>40869){var d=/(?:[^\s\!-\/])+$/.exec(h);d&&(l=d.index+o,0==d.index?l+=h.length:h=t.substring(o,l))}if(n.push(h),this._lineWidths.push(s-r),o=l,!(l+a<u)){n.push(t.substring(o,u)),this._lineWidths.push(this._getTextWidth(n[n.length-1])),o=-1;break}l+=a,s=r=this._getTextWidth(t.substring(o,l)),l--}else if(this.overflow==i.HIDDEN)return n.push(t.substring(0,l)),void this._lineWidths.push(this._getTextWidth(n[n.length-1]));this.wordWrap&&-1!=o&&(n.push(t.substring(o,u)),this._lineWidths.push(this._getTextWidth(n[n.length-1])))}},{key:"_getTextWidth",value:function(t){var e=this._style.currBitmapFont;return e?e.getTextWidth(t):T.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(t).width:(T.ILaya.Browser.context.measureText(t)||{width:100}).width}},{key:"_getWordWrapWidth",value:function(){var t,e=this.padding,i=this._style.currBitmapFont;return(t=i&&i.autoScaleSize?this._width*(i.fontSize/this.fontSize):this._width)<=0&&(t=this.wordWrap?100:T.ILaya.Browser.width),t<=0&&(t=100),t-e[3]-e[1]}},{key:"getCharPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._isChanged&&T.ILaya.systemTimer.runCallLater(this,this.typeset);for(var i=0,n=this._lines,a=0,r=0,s=n.length;r<s;r++){if(t<(i+=n[r].length)){var o=r;break}a=i}var l=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;T.ILaya.Browser.context.font=l;var u=this._getTextWidth(this._text.substring(a,t)),h=e||new g.Point;return h.setTo(this._startX+u-(this._clipPoint?this._clipPoint.x:0),this._startY+o*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))}},{key:"scrollX",get:function(){return this._clipPoint?this._clipPoint.x:0},set:function(t){if(!(this.overflow!=i.SCROLL||this.textWidth<this._width)&&this._clipPoint){t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t,this._clipPoint.x=t,this._renderText()}}},{key:"scrollY",get:function(){return this._clipPoint?this._clipPoint.y:0},set:function(t){if(!(this.overflow!=i.SCROLL||this.textHeight<this._height)&&this._clipPoint){t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t,this._clipPoint.y=t,this._renderText()}}},{key:"maxScrollX",get:function(){return this.textWidth<this._width?0:this._textWidth-this._width}},{key:"maxScrollY",get:function(){return this.textHeight<this._height?0:this._textHeight-this._height}},{key:"lines",get:function(){return this._isChanged&&this.typeset(),this._lines}},{key:"underlineColor",get:function(){return this._style.underlineColor},set:function(t){this._getTextStyle().underlineColor=t,this._isChanged||this._renderText()}},{key:"underline",get:function(){return this._style.underline},set:function(t){this._getTextStyle().underline=t}},{key:"singleCharRender",get:function(){return this._singleCharRender},set:function(t){this._singleCharRender=t}}],[{key:"defaultFontStr",value:function(){return i.defaultFontSize+"px "+i.defaultFont}},{key:"registerBitmapFont",value:function(t,e){i._bitmapFonts||(i._bitmapFonts={}),i._bitmapFonts[t]=e}},{key:"unregisterBitmapFont",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(i._bitmapFonts&&i._bitmapFonts[t]){var n=i._bitmapFonts[t];e&&n.destroy(),delete i._bitmapFonts[t]}}}]),i}(_.Sprite);e.Text=S,S.VISIBLE="visible",S.SCROLL="scroll",S.HIDDEN="hidden",S.defaultFontSize=12,S.defaultFont="Arial",S.isComplexText=!1,S.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"},S._testWord="游",S.CharacterCache=!0,S.RightToLeft=!1,T.ILaya.regClass(S),k.ClassUtils.regClass("laya.display.Text",S),k.ClassUtils.regClass("Laya.Text",S)},23578:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AlphaCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("AlphaCmd",this)}},{key:"run",value:function(t,e,i){t.alpha(this.alpha)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e){var i=o.Pool.getItemByClass("AlphaCmd",t);return i.alpha=e,i}}]),t}();e.AlphaCmd=l,l.ID="Alpha"},95518:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ClipRectCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("ClipRectCmd",this)}},{key:"run",value:function(t,e,i){t.clipRect(this.x+e,this.y+i,this.width,this.height)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a){var r=o.Pool.getItemByClass("ClipRectCmd",t);return r.x=e,r.y=i,r.width=n,r.height=a,r}}]),t}();e.ClipRectCmd=l,l.ID="ClipRect"},94317:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Draw9GridTexture=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture._removeReference(),o.Pool.recover("Draw9GridTexture",this)}},{key:"run",value:function(t,e,i){t.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,e,i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s){var l=o.Pool.getItemByClass("Draw9GridTexture",t);return l.texture=e,e._addReference(),l.x=i,l.y=n,l.width=a,l.height=r,l.sizeGrid=s,l}}]),t}();e.Draw9GridTexture=l,l.ID="Draw9GridTexture"},26531:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawCircleCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawCircleCmd",this)}},{key:"run",value:function(t,e,i){t._drawCircle(this.x+e,this.y+i,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,l){var u=o.Pool.getItemByClass("DrawCircleCmd",t);return u.x=e,u.y=i,u.radius=n,u.fillColor=a,u.lineColor=r,u.lineWidth=s,u.vid=l,u}}]),t}();e.DrawCircleCmd=l,l.ID="DrawCircle"},95923:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawCurvesCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.points=null,this.lineColor=null,o.Pool.recover("DrawCurvesCmd",this)}},{key:"run",value:function(t,e,i){this.points&&t.drawCurves(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r){var s=o.Pool.getItemByClass("DrawCurvesCmd",t);return s.x=e,s.y=i,s.points=n,s.lineColor=a,s.lineWidth=r,s}}]),t}();e.DrawCurvesCmd=l,l.ID="DrawCurves"},40120:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawImageCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,o.Pool.recover("DrawImageCmd",this)}},{key:"run",value:function(t,e,i){this.texture&&t.drawTexture(this.texture,this.x+e,this.y+i,this.width,this.height)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r){var s=o.Pool.getItemByClass("DrawImageCmd",t);return s.texture=e,e._addReference(),s.x=i,s.y=n,s.width=a,s.height=r,s}}]),t}();e.DrawImageCmd=l,l.ID="DrawImage"},65419:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawLineCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("DrawLineCmd",this)}},{key:"run",value:function(t,e,i){t._drawLine(e,i,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,l){var u=o.Pool.getItemByClass("DrawLineCmd",t);return u.fromX=e,u.fromY=i,u.toX=n,u.toY=a,u.lineColor=r,u.lineWidth=s,u.vid=l,u}}]),t}();e.DrawLineCmd=l,l.ID="DrawLine"},57073:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawLinesCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.points=null,this.lineColor=null,o.Pool.recover("DrawLinesCmd",this)}},{key:"run",value:function(t,e,i){this.points&&t._drawLines(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s){var l=o.Pool.getItemByClass("DrawLinesCmd",t);return l.x=e,l.y=i,l.points=n,l.lineColor=a,l.lineWidth=r,l.vid=s,l}}]),t}();e.DrawLinesCmd=l,l.ID="DrawLines"},9897:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawPathCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.paths=null,this.brush=null,this.pen=null,o.Pool.recover("DrawPathCmd",this)}},{key:"run",value:function(t,e,i){this.paths&&t._drawPath(this.x+e,this.y+i,this.paths,this.brush,this.pen)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r){var s=o.Pool.getItemByClass("DrawPathCmd",t);return s.x=e,s.y=i,s.paths=n,s.brush=a,s.pen=r,s}}]),t}();e.DrawPathCmd=l,l.ID="DrawPath"},81844:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawPieCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawPieCmd",this)}},{key:"run",value:function(t,e,i){t._drawPie(this.x+e,this.y+i,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}},{key:"startAngle",get:function(){return 180*this._startAngle/Math.PI},set:function(t){this._startAngle=t*Math.PI/180}},{key:"endAngle",get:function(){return 180*this._endAngle/Math.PI},set:function(t){this._endAngle=t*Math.PI/180}}],[{key:"create",value:function(e,i,n,a,r,s,l,u,h){var c=o.Pool.getItemByClass("DrawPieCmd",t);return c.x=e,c.y=i,c.radius=n,c._startAngle=a,c._endAngle=r,c.fillColor=s,c.lineColor=l,c.lineWidth=u,c.vid=h,c}}]),t}();e.DrawPieCmd=l,l.ID="DrawPie"},91813:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawPolyCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.points=null,this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawPolyCmd",this)}},{key:"run",value:function(t,e,i){this.points&&t._drawPoly(this.x+e,this.y+i,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,l,u){var h=o.Pool.getItemByClass("DrawPolyCmd",t);return h.x=e,h.y=i,h.points=n,h.fillColor=a,h.lineColor=r,h.lineWidth=s,h.isConvexPolygon=l,h.vid=u,h}}]),t}();e.DrawPolyCmd=l,l.ID="DrawPoly"},65955:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawRectCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawRectCmd",this)}},{key:"run",value:function(t,e,i){t.drawRect(this.x+e,this.y+i,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,l){var u=o.Pool.getItemByClass("DrawRectCmd",t);return u.x=e,u.y=i,u.width=n,u.height=a,u.fillColor=r,u.lineColor=s,u.lineWidth=l,u}}]),t}();e.DrawRectCmd=l,l.ID="DrawRect"},82994:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawTextureCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(20084),l=i(64210),u=function(){function t(){(0,r.default)(this,t),this.colorFlt=null,this.uv=null}return(0,s.default)(t,[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,this.matrix=null,l.Pool.recover("DrawTextureCmd",this)}},{key:"run",value:function(t,e,i){this.texture&&t.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,e,i,this.alpha,this.blendMode,this.colorFlt,this.uv)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,u,h,c,d){var f=l.Pool.getItemByClass("DrawTextureCmd",t);return f.texture=e,e._addReference(),f.x=i,f.y=n,f.width=a,f.height=r,f.matrix=s,f.alpha=u,f.color=h,f.blendMode=c,f.uv=null==d?null:d,h&&(f.colorFlt=new o.ColorFilter,f.colorFlt.setColor(h)),f}}]),t}();e.DrawTextureCmd=u,u.ID="DrawTexture"},65849:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawTexturesCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture._removeReference(),this.texture=null,this.pos=null,o.Pool.recover("DrawTexturesCmd",this)}},{key:"run",value:function(t,e,i){t.drawTextures(this.texture,this.pos,e,i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i){var n=o.Pool.getItemByClass("DrawTexturesCmd",t);return n.texture=e,e._addReference(),n.pos=i,n}}]),t}();e.DrawTexturesCmd=l,l.ID="DrawTextures"},47303:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawTrianglesCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(20084),l=i(13104),u=i(64210),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture=null,this.vertices=null,this.uvs=null,this.indices=null,this.matrix=null,u.Pool.recover("DrawTrianglesCmd",this)}},{key:"run",value:function(t,e,i){t.drawTriangles(this.texture,this.x+e,this.y+i,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode,this.colorNum)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,h,c,d,f,_){var v=u.Pool.getItemByClass("DrawTrianglesCmd",t);if(v.texture=e,v.x=i,v.y=n,v.vertices=a,v.uvs=r,v.indices=s,v.matrix=h,v.alpha=c,d){v.color=new o.ColorFilter;var y=l.ColorUtils.create(d).arrColor;v.color.color(255*y[0],255*y[1],255*y[2],255*y[3])}return v.blendMode=f,v.colorNum=_,v}}]),t}();e.DrawTrianglesCmd=h,h.ID="DrawTriangles"},4501:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.FillTextCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(79741),l=i(13104),u=i(75494),h=i(64210),c=i(80651),d=i(92493),f=function(){function t(){(0,r.default)(this,t),this._textIsWorldText=!1,this._fontColor=4294967295,this._strokeColor=0,this._fontObj=t._defFontObj,this._nTexAlign=0}return(0,s.default)(t,[{key:"recover",value:function(){h.Pool.recover("FillTextCmd",this)}},{key:"run",value:function(t,e,i){d.ILaya.stage.isGlobalRepaint()&&this._textIsWorldText&&this._text.cleanCache(),this._words?o.Context._textRender.fillWords(t,this._words,this.x+e,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth):this._textIsWorldText?t._fast_filltext(this._text,this.x+e,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth,this._nTexAlign,0):o.Context._textRender.filltext(t,this._text,this.x+e,this.y+i,this.font,this.color,this._borderColor,this._lineWidth,this._textAlign)}},{key:"cmdID",get:function(){return t.ID}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this._textIsWorldText=t instanceof c.WordText,this._textIsWorldText&&this._text.cleanCache()}},{key:"font",get:function(){return this._font},set:function(t){this._font=t,this._fontObj=u.FontInfo.Parse(t),this._textIsWorldText&&this._text.cleanCache()}},{key:"color",get:function(){return this._color},set:function(t){this._color=t,this._fontColor=l.ColorUtils.create(t).numColor,this._textIsWorldText&&this._text.cleanCache()}},{key:"textAlign",get:function(){return this._textAlign},set:function(t){switch(this._textAlign=t,t){case"center":this._nTexAlign=d.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=d.ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=d.ILaya.Context.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}}],[{key:"create",value:function(e,i,n,a,r,s,o,l,u){var d=h.Pool.getItemByClass("FillTextCmd",t);return d.text=e,d._textIsWorldText=e instanceof c.WordText,d._words=i,d.x=n,d.y=a,d.font=r,d.color=s,d.textAlign=o,d._lineWidth=l,d._borderColor=u,d}}]),t}();e.FillTextCmd=f,f.ID="FillText",f._defFontObj=new u.FontInfo(null)},99777:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.FillTextureCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture=null,this.offset=null,this.other=null,o.Pool.recover("FillTextureCmd",this)}},{key:"run",value:function(t,e,i){t.fillTexture(this.texture,this.x+e,this.y+i,this.width,this.height,this.type,this.offset,this.other)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a,r,s,l,u){var h=o.Pool.getItemByClass("FillTextureCmd",t);return h.texture=e,h.x=i,h.y=n,h.width=a,h.height=r,h.type=s,h.offset=l,h.other=u,h}}]),t}();e.FillTextureCmd=l,l.ID="FillTexture"},88720:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.RestoreCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("RestoreCmd",this)}},{key:"run",value:function(t,e,i){t.restore()}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(){return o.Pool.getItemByClass("RestoreCmd",t)}}]),t}();e.RestoreCmd=l,l.ID="Restore"},7862:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.RotateCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("RotateCmd",this)}},{key:"run",value:function(t,e,i){t._rotate(this.angle,this.pivotX+e,this.pivotY+i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n){var a=o.Pool.getItemByClass("RotateCmd",t);return a.angle=e,a.pivotX=i,a.pivotY=n,a}}]),t}();e.RotateCmd=l,l.ID="Rotate"},95538:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SaveCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("SaveCmd",this)}},{key:"run",value:function(t,e,i){t.save()}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(){return o.Pool.getItemByClass("SaveCmd",t)}}]),t}();e.SaveCmd=l,l.ID="Save"},37187:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ScaleCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("ScaleCmd",this)}},{key:"run",value:function(t,e,i){t._scale(this.scaleX,this.scaleY,this.pivotX+e,this.pivotY+i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n,a){var r=o.Pool.getItemByClass("ScaleCmd",t);return r.scaleX=e,r.scaleY=i,r.pivotX=n,r.pivotY=a,r}}]),t}();e.ScaleCmd=l,l.ID="Scale"},9047:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TransformCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.matrix=null,o.Pool.recover("TransformCmd",this)}},{key:"run",value:function(t,e,i){t._transform(this.matrix,this.pivotX+e,this.pivotY+i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,n){var a=o.Pool.getItemByClass("TransformCmd",t);return a.matrix=e,a.pivotX=i,a.pivotY=n,a}}]),t}();e.TransformCmd=l,l.ID="Transform"},44449:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TranslateCmd=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("TranslateCmd",this)}},{key:"run",value:function(t,e,i){t.translate(this.tx,this.ty)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i){var n=o.Pool.getItemByClass("TranslateCmd",t);return n.tx=e,n.ty=i,n}}]),t}();e.TranslateCmd=l,l.ID="Translate"},22805:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BoundsStyle=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"reset",value:function(){return this.bounds&&this.bounds.recover(),this.userBounds&&this.userBounds.recover(),this.bounds=null,this.userBounds=null,this.temBM=null,this}},{key:"recover",value:function(){o.Pool.recover("BoundsStyle",this.reset())}}],[{key:"create",value:function(){return o.Pool.getItemByClass("BoundsStyle",t)}}]),t}();e.BoundsStyle=l},6872:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.CacheStyle=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(85399),l=i(98693),u=i(26776),h=i(64210),c=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"needBitmapCache",value:function(){return this.cacheForFilters||!!this.mask}},{key:"needEnableCanvasRender",value:function(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask}},{key:"releaseContext",value:function(){if(this.canvas&&this.canvas.size){h.Pool.recover("CacheCanvas",this.canvas),this.canvas.size(0,0);try{this.canvas.width=0,this.canvas.height=0}catch(t){}}this.canvas=null}},{key:"createContext",value:function(){if(!this.canvas){this.canvas=h.Pool.getItem("CacheCanvas")||new u.HTMLCanvas(!1);var t=this.canvas.context;t||(t=this.canvas.getContext("2d"))}}},{key:"releaseFilterCache",value:function(){var t=this.filterCache;t&&(t.destroy(),t.recycle(),this.filterCache=null)}},{key:"recover",value:function(){this!==t.EMPTY&&h.Pool.recover("SpriteCache",this.reset())}},{key:"reset",value:function(){return this.releaseContext(),this.releaseFilterCache(),this.cacheAs="none",this.enableCanvasRender=!1,this.userSetCache="none",this.cacheForFilters=!1,this.staticCache=!1,this.reCache=!0,this.mask=null,this.maskParent=null,this.filterCache=null,this.filters=null,this.hasGlowFilter=!1,this.cacheRect&&this.cacheRect.recover(),this.cacheRect=null,this}},{key:"_calculateCacheRect",value:function(e,i,n,a){var r,s=e._cacheStyle;if(s.cacheRect||(s.cacheRect=l.Rectangle.create()),"bitmap"===i?((r=e.getSelfBounds()).width=r.width+2*t.CANVAS_EXTEND_EDGE,r.height=r.height+2*t.CANVAS_EXTEND_EDGE,r.x=r.x-e.pivotX,r.y=r.y-e.pivotY,r.x=r.x-t.CANVAS_EXTEND_EDGE,r.y=r.y-t.CANVAS_EXTEND_EDGE,r.x=Math.floor(r.x+n)-n,r.y=Math.floor(r.y+a)-a,r.width=Math.floor(r.width),r.height=Math.floor(r.height),s.cacheRect.copyFrom(r)):s.cacheRect.setTo(-e._style.pivotX,-e._style.pivotY,1,1),r=s.cacheRect,e._style.scrollRect){var o=e._style.scrollRect;r.x-=o.x,r.y-=o.y}return t._scaleInfo.setTo(1,1),t._scaleInfo}}],[{key:"create",value:function(){return h.Pool.getItemByClass("SpriteCache",t)}}]),t}();e.CacheStyle=c,c.EMPTY=new c,c._scaleInfo=new o.Point,c.CANVAS_EXTEND_EDGE=16},54216:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SpriteStyle=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){return this.scaleX=this.scaleY=1,this.skewX=this.skewY=0,this.pivotX=this.pivotY=this.rotation=0,this.alpha=1,this.scrollRect&&this.scrollRect.recover(),this.scrollRect=null,this.viewport&&this.viewport.recover(),this.viewport=null,this.hitArea=null,this.dragging=null,this.blendMode=null,this}},{key:"recover",value:function(){this!==t.EMPTY&&o.Pool.recover("SpriteStyle",this.reset())}}],[{key:"create",value:function(){return o.Pool.getItemByClass("SpriteStyle",t)}}]),t}();e.SpriteStyle=l,l.EMPTY=new l},33176:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.TextStyle=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(54216),f=i(64210);function _(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var v=function(t){(0,u.default)(i,t);var e=_(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments)).italic=!1,t}return(0,o.default)(i,[{key:"reset",value:function(){return(0,l.default)((0,c.default)(i.prototype),"reset",this).call(this),this.italic=!1,this.align="left",this.wordWrap=!1,this.leading=0,this.padding=[0,0,0,0],this.bgColor=null,this.borderColor=null,this.asPassword=!1,this.stroke=0,this.strokeColor="#000000",this.bold=!1,this.underline=!1,this.underlineColor=null,this.currBitmapFont=null,this}},{key:"recover",value:function(){this!==i.EMPTY&&f.Pool.recover("TextStyle",this.reset())}},{key:"render",value:function(t,e,i,n){(this.bgColor||this.borderColor)&&e.drawRect(i-this.pivotX,n-this.pivotY,t.width,t.height,this.bgColor,this.borderColor,1)}}],[{key:"create",value:function(){return f.Pool.getItemByClass("TextStyle",i)}}]),i}(d.SpriteStyle);e.TextStyle=v,v.EMPTY=new v},89662:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Event=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(85399),l=i(92493),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"setTo",value:function(t,e,i){return this.type=t,this.currentTarget=e,this.target=i,this}},{key:"stopPropagation",value:function(){this._stoped=!0}},{key:"touches",get:function(){if(!this.nativeEvent)return null;var t=this.nativeEvent.touches;if(t)for(var e=l.ILaya.stage,i=0,n=t.length;i<n;i++){var a=t[i],r=o.Point.TEMP;r.setTo(a.clientX,a.clientY),e._canvasTransform.invertTransformPoint(r),e.transform.invertTransformPoint(r),a.stageX=r.x,a.stageY=r.y}return t}},{key:"altKey",get:function(){return this.nativeEvent.altKey}},{key:"ctrlKey",get:function(){return this.nativeEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.nativeEvent.shiftKey}},{key:"charCode",get:function(){return this.nativeEvent.charCode}},{key:"keyLocation",get:function(){return this.nativeEvent.location||this.nativeEvent.keyLocation}},{key:"stageX",get:function(){return l.ILaya.stage.mouseX}},{key:"stageY",get:function(){return l.ILaya.stage.mouseY}}]),t}();e.Event=u,u.EMPTY=new u,u.MOUSE_DOWN="mousedown",u.MOUSE_UP="mouseup",u.CLICK="click",u.RIGHT_MOUSE_DOWN="rightmousedown",u.RIGHT_MOUSE_UP="rightmouseup",u.RIGHT_CLICK="rightclick",u.MOUSE_MOVE="mousemove",u.MOUSE_OVER="mouseover",u.MOUSE_OUT="mouseout",u.MOUSE_WHEEL="mousewheel",u.ROLL_OVER="mouseover",u.ROLL_OUT="mouseout",u.DOUBLE_CLICK="doubleclick",u.CHANGE="change",u.CHANGED="changed",u.RESIZE="resize",u.ADDED="added",u.REMOVED="removed",u.DISPLAY="display",u.UNDISPLAY="undisplay",u.ERROR="error",u.COMPLETE="complete",u.LOADED="loaded",u.READY="ready",u.PROGRESS="progress",u.INPUT="input",u.RENDER="render",u.OPEN="open",u.MESSAGE="message",u.CLOSE="close",u.KEY_DOWN="keydown",u.KEY_PRESS="keypress",u.KEY_UP="keyup",u.FRAME="enterframe",u.DRAG_START="dragstart",u.DRAG_MOVE="dragmove",u.DRAG_END="dragend",u.ENTER="enter",u.SELECT="select",u.BLUR="blur",u.FOCUS="focus",u.VISIBILITY_CHANGE="visibilitychange",u.FOCUS_CHANGE="focuschange",u.PLAYED="played",u.PAUSED="paused",u.STOPPED="stopped",u.START="start",u.END="end",u.COMPONENT_ADDED="componentadded",u.COMPONENT_REMOVED="componentremoved",u.RELEASED="released",u.LINK="link",u.LABEL="label",u.FULL_SCREEN_CHANGE="fullscreenchange",u.DEVICE_LOST="devicelost",u.TRANSFORM_CHANGED="transformchanged",u.ANIMATION_CHANGED="animationchanged",u.TRAIL_FILTER_CHANGE="trailfilterchange",u.TRIGGER_ENTER="triggerenter",u.TRIGGER_STAY="triggerstay",u.TRIGGER_EXIT="triggerexit"},48856:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.EventDispatcher=void 0;var s=r(i(92762)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=r(i(15375)),c=r(i(17061)),d=i(41107);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var _=function(){function t(){(0,h.default)(this,t)}return(0,c.default)(t,[{key:"hasListener",value:function(t){return!!(this._events&&this._events[t])}},{key:"event",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this._events||!this._events[t])return!1;var i=this._events[t];if(i.run)i.once&&delete this._events[t],null!=e?i.runWith(e):i.run();else{for(var n=0,a=i.length;n<a;n++){var r=i[n];r&&(null!=e?r.runWith(e):r.run()),r&&!r.once||((0,s.default)(i).call(i,n,1),n--,a--)}0===i.length&&this._events&&!this._events[t].run&&delete this._events[t]}return!0}},{key:"on",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._createListener(t,e,i,n,!1)}},{key:"once",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._createListener(t,e,i,n,!0)}},{key:"_createListener",value:function(t,e,i,n,a){var r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];r&&this.off(t,e,i,a);var s=v.create(e||this,i,n,a);this._events||(this._events={});var o=this._events;return o[t]?o[t].run?o[t]=[o[t],s]:o[t].push(s):o[t]=s,this}},{key:"off",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this._events||!this._events[t])return this;var a=this._events[t];if(null!=a)if(a.run)e&&a.caller!==e||null!=i&&a.method!==i||n&&!a.once||(delete this._events[t],a.recover());else{for(var r=0,s=0,o=a.length;s<o;s++){var l=a[s];l?!l||e&&l.caller!==e||null!=i&&l.method!==i||n&&!l.once||(r++,a[s]=null,l.recover()):r++}r===o&&delete this._events[t]}return this}},{key:"offAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this._events;if(!e)return this;if(t)this._recoverHandlers(e[t]),delete e[t];else{for(var i in e)this._recoverHandlers(e[i]);this._events=null}return this}},{key:"offAllCaller",value:function(t){if(t&&this._events)for(var e in this._events)this.off(e,t,null);return this}},{key:"_recoverHandlers",value:function(t){if(t)if(t.run)t.recover();else for(var e=t.length-1;e>-1;e--)t[e]&&(t[e].recover(),t[e]=null)}},{key:"isMouseEvent",value:function(e){return t.MOUSE_EVENTS[e]||!1}}]),t}();e.EventDispatcher=_,_.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0};var v=function(t){(0,o.default)(i,t);var e=f(i);function i(t,n,a,r){return(0,h.default)(this,i),e.call(this,t,n,a,r)}return(0,c.default)(i,[{key:"recover",value:function(){this._id>0&&(this._id=0,i._pool.push(this.clear()))}}],[{key:"create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return i._pool.length?i._pool.pop().setTo(t,e,n,a):new i(t,e,n,a)}}]),i}(d.Handler);v._pool=[]},78499:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.KeyBoardManager=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(89662),l=i(92493),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"__init__",value:function(){t._addEvent("keydown"),t._addEvent("keypress"),t._addEvent("keyup")}},{key:"_addEvent",value:function(e){l.ILaya.Browser.document.addEventListener(e,(function(i){t._dispatch(i,e)}),!0)}},{key:"_dispatch",value:function(e,i){if(t.enabled){t._event._stoped=!1,t._event.nativeEvent=e,t._event.keyCode=e.keyCode||e.which||e.charCode,"keydown"===i?t._pressKeys[t._event.keyCode]=!0:"keyup"===i&&(t._pressKeys[t._event.keyCode]=null);for(var n=l.ILaya.stage.focus&&null!=l.ILaya.stage.focus.event&&l.ILaya.stage.focus.displayedInStage?l.ILaya.stage.focus:l.ILaya.stage,a=n;a;)a.event(i,t._event.setTo(i,a,n)),a=a.parent}}},{key:"hasKeyDown",value:function(e){return t._pressKeys[e]}}]),t}();e.KeyBoardManager=u,u._pressKeys={},u.enabled=!0,u._event=new o.Event},47002:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.MouseManager=void 0;var r=a(i(92762)),s=a(i(15375)),o=a(i(17061)),l=i(89662),u=i(69923),h=i(61891),c=i(85399),d=i(98693),f=i(93568),_=i(92493),v=function(){function t(){(0,s.default)(this,t),this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._event=new l.Event,this._captureSp=null,this._captureChain=[],this._captureExlusiveMode=!1,this._hitCaputreSp=!1,this._point=new c.Point,this._rect=new d.Rectangle,this._lastMoveTimer=0,this._prePoint=new c.Point,this._touchIDs={},this._curTouchID=NaN,this._id=1}return(0,o.default)(t,[{key:"__init__",value:function(e,i){this._stage=e;var n=this;i.oncontextmenu=function(e){if(t.enabled)return!1},i.addEventListener("mousedown",(function(e){t.enabled&&(f.Browser.onIE||e.cancelable&&e.preventDefault(),n.mouseDownTime=f.Browser.now(),n.runEvent(e))})),i.addEventListener("mouseup",(function(e){t.enabled&&(e.cancelable&&e.preventDefault(),n.mouseDownTime=-f.Browser.now(),n.runEvent(e))}),!0),i.addEventListener("mousemove",(function(e){if(t.enabled){e.cancelable&&e.preventDefault();var i=f.Browser.now();if(i-n._lastMoveTimer<10)return;n._lastMoveTimer=i,n.runEvent(e)}}),!0),i.addEventListener("mouseout",(function(e){t.enabled&&n.runEvent(e)})),i.addEventListener("mouseover",(function(e){t.enabled&&n.runEvent(e)})),i.addEventListener("touchstart",(function(e){t.enabled&&(t._isFirstTouch||h.Input.isInputting||e.cancelable&&e.preventDefault(),n.mouseDownTime=f.Browser.now(),n.runEvent(e))})),i.addEventListener("touchend",(function(e){t.enabled?(t._isFirstTouch||h.Input.isInputting||e.cancelable&&e.preventDefault(),t._isFirstTouch=!1,n.mouseDownTime=-f.Browser.now(),n.runEvent(e)):n._curTouchID=NaN}),!0),i.addEventListener("touchmove",(function(e){t.enabled&&(e.cancelable&&e.preventDefault(),n.runEvent(e))}),!0),i.addEventListener("touchcancel",(function(e){t.enabled?(e.cancelable&&e.preventDefault(),n.runEvent(e)):n._curTouchID=NaN}),!0),i.addEventListener("mousewheel",(function(e){t.enabled&&n.runEvent(e)})),i.addEventListener("DOMMouseScroll",(function(e){t.enabled&&n.runEvent(e)}))}},{key:"initEvent",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;n._event._stoped=!1,n._event.nativeEvent=i||t,n._target=null,this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY),this._stage._canvasTransform&&(this._stage._canvasTransform.invertTransformPoint(this._point),n.mouseX=this._point.x,n.mouseY=this._point.y),n._event.touchId=t.identifier||0,this._tTouchID=n._event.touchId,(e=u.TouchManager.I._event)._stoped=!1,e.nativeEvent=n._event.nativeEvent,e.touchId=n._event.touchId}},{key:"checkMouseWheel",value:function(t){this._event.delta=t.wheelDelta?.025*t.wheelDelta:-t.detail;for(var e=u.TouchManager.I.getLastOvers(),i=0,n=e.length;i<n;i++){var a=e[i];a.event(l.Event.MOUSE_WHEEL,this._event.setTo(l.Event.MOUSE_WHEEL,a,this._target))}}},{key:"onMouseMove",value:function(t){u.TouchManager.I.onMouseMove(t,this._tTouchID)}},{key:"onMouseDown",value:function(t){if(h.Input.isInputting&&_.ILaya.stage.focus&&_.ILaya.stage.focus.focus&&!_.ILaya.stage.focus.contains(this._target)){var e=_.ILaya.stage.focus._tf||_.ILaya.stage.focus,i=t._tf||t;i instanceof h.Input&&i.multiline==e.multiline?e._focusOut():e.focus=!1}u.TouchManager.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)}},{key:"onMouseUp",value:function(t){u.TouchManager.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)}},{key:"check",value:function(t,e,i,n){this._point.setTo(e,i),t.fromParentPoint(this._point),e=this._point.x,i=this._point.y;var a=t._style.scrollRect;if(a&&(this._rect.setTo(a.x,a.y,a.width,a.height),!this._rect.contains(e,i)))return!1;if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,i))return!1;for(var r=t._children.length-1;r>-1;r--){var s=t._children[r];if(!s.destroyed&&s._mouseState>1&&s._visible&&this.check(s,e,i,n))return!0}for(r=t._extUIChild.length-1;r>=0;r--){var o=t._extUIChild[r];if(!o.destroyed&&o._mouseState>1&&o._visible&&this.check(o,e,i,n))return!0}}var l=!(!t.hitTestPrior||t.mouseThrough||this.disableMouseEvent)||this.hitTest(t,e,i);return l?(this._target=t,n.call(this,t),this._target==this._hitCaputreSp&&(this._hitCaputreSp=!0)):n===this.onMouseUp&&t===this._stage&&(this._target=this._stage,n.call(this,this._target)),l}},{key:"hitTest",value:function(t,e,i){var n=!1;t.scrollRect&&(e-=t._style.scrollRect.x,i-=t._style.scrollRect.y);var a=t._style.hitArea;return a&&a._hit?a.contains(e,i):((t.width>0&&t.height>0||t.mouseThrough||a)&&(n=t.mouseThrough?t.getGraphicBounds().contains(e,i):(a||this._rect.setTo(0,0,t.width,t.height)).contains(e,i)),n)}},{key:"_checkAllBaseUI",value:function(t,e,i){var n=this.handleExclusiveCapture(this.mouseX,this.mouseY,i);return!!n||(n=this.check(this._stage,this.mouseX,this.mouseY,i),this.handleCapture(this.mouseX,this.mouseY,i)||n)}},{key:"check3DUI",value:function(t,e,i){for(var n=this._stage._3dUI,a=0,r=!1;a<n.length;a++){var s=n[a];this._stage._curUIBase=s,!s.destroyed&&s._mouseState>1&&s._visible&&(r=r||this.check(s,this.mouseX,this.mouseY,i))}return this._stage._curUIBase=this._stage,r}},{key:"handleExclusiveCapture",value:function(t,e,i){if(this._captureExlusiveMode&&this._captureSp&&this._captureChain.length>0){var n;this._point.setTo(t,e);for(var a=0;a<this._captureChain.length;a++)(n=this._captureChain[a]).fromParentPoint(this._point);return this._target=n,i.call(this,n),!0}return!1}},{key:"handleCapture",value:function(t,e,i){if(!this._hitCaputreSp&&this._captureSp&&this._captureChain.length>0){var n;this._point.setTo(t,e);for(var a=0;a<this._captureChain.length;a++)(n=this._captureChain[a]).fromParentPoint(this._point);return this._target=n,i.call(this,n),!0}return!1}},{key:"runEvent",value:function(e){var i,n,a;switch("mousemove"!==e.type&&(this._prePoint.x=this._prePoint.y=-1e6),e.type){case"mousedown":this._touchIDs[0]=this._id++,t._isTouchRespond?t._isTouchRespond=!1:(this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-e.clientX)+Math.abs(this._prePoint.y-e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=e.clientX,this._prePoint.y=e.clientY,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":t._isTouchRespond=!0,this._isLeftMouse=!0;var r=e.changedTouches;for(i=0,n=r.length;i<n;i++)a=r[i],(t.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=a.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[a.identifier]=this._id++,this.initEvent(a,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":t._isTouchRespond=!0,this._isLeftMouse=!0;var s=e.changedTouches;for(i=0,n=s.length;i<n;i++){if(a=s[i],t.multiTouchEnabled||a.identifier==this._curTouchID)this._curTouchID=NaN,this.initEvent(a,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var o=e.changedTouches;for(i=0,n=o.length;i<n;i++)a=o[i],(t.multiTouchEnabled||a.identifier==this._curTouchID)&&(this.initEvent(a,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(e);break;case"mouseout":u.TouchManager.I.stageMouseOut();break;case"mouseover":this._stage.event(l.Event.MOUSE_OVER,this._event.setTo(l.Event.MOUSE_OVER,this._stage,this._stage))}}},{key:"setCapture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._captureSp=t,this._captureExlusiveMode=e,this._captureChain.length=0,this._captureChain.push(t);for(var i=t;;){var n;if(i==_.ILaya.stage)break;if(i==_.ILaya.stage._curUIBase)break;if(!(i=i.parent))break;(0,r.default)(n=this._captureChain).call(n,0,0,i)}}},{key:"releaseCapture",value:function(){console.log("release capture"),this._captureSp=null}}]),t}();e.MouseManager=v,v.instance=new v,v.enabled=!0,v.multiTouchEnabled=!0,v._isFirstTouch=!0},69923:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TouchManager=void 0;var r=a(i(92762)),s=a(i(81643)),o=a(i(15375)),l=a(i(17061)),u=i(89662),h=i(93568),c=i(64210),d=i(92493),f=function(){function t(){(0,o.default)(this,t),this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._event=new u.Event,this._lastClickTime=0}return(0,l.default)(t,[{key:"_clearTempArrs",value:function(){t._oldArr.length=0,t._newArr.length=0,t._tEleArr.length=0}},{key:"getTouchFromArr",value:function(t,e){var i,n,a;for(n=e.length,i=0;i<n;i++)if((a=e[i]).id==t)return a;return null}},{key:"removeTouchFromArr",value:function(t,e){var i;for(i=e.length-1;i>=0;i--)e[i].id==t&&(0,r.default)(e).call(e,i,1)}},{key:"createTouchO",value:function(t,e){var i;return(i=c.Pool.getItem("TouchData")||{}).id=e,i.tar=t,i}},{key:"onMouseDown",value:function(e,i){var n,a,r,s,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.enable&&(n=this.getTouchFromArr(i,this.preOvers),r=this.getEles(e,null,t._tEleArr),n?n.tar=e:(a=this.createTouchO(e,i),this.preOvers.push(a)),h.Browser.onMobile&&this.sendEvents(r,u.Event.MOUSE_OVER),s=o?this.preDowns:this.preRightDowns,(n=this.getTouchFromArr(i,s))?n.tar=e:(a=this.createTouchO(e,i),s.push(a)),this.sendEvents(r,o?u.Event.MOUSE_DOWN:u.Event.RIGHT_MOUSE_DOWN),this._clearTempArrs())}},{key:"sendEvents",value:function(t,e){var i,n,a;for(n=t.length,this._event._stoped=!1,a=t[0],i=0;i<n;i++){var r=t[i];if(r.destroyed)return;if(r.event(e,this._event.setTo(e,r,a)),this._event._stoped)break}}},{key:"getEles",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(i?i.length=0:i=[];t&&t!=e;)i.push(t),t=t.parent;return i}},{key:"checkMouseOutAndOverOfMove",value:function(e,i){var n,a,o,l;if(i!=e)if(i.contains(e))a=this.getEles(e,i,t._tEleArr),this.sendEvents(a,u.Event.MOUSE_OVER);else if(e.contains(i))a=this.getEles(i,e,t._tEleArr),this.sendEvents(a,u.Event.MOUSE_OUT);else{var h,c,d;for((a=t._tEleArr).length=0,h=this.getEles(i,null,t._oldArr),c=this.getEles(e,null,t._newArr),l=h.length,o=0;o<l;o++){if(n=h[o],(d=(0,s.default)(c).call(c,n))>=0){(0,r.default)(c).call(c,d,c.length-d);break}a.push(n)}a.length>0&&this.sendEvents(a,u.Event.MOUSE_OUT),c.length>0&&this.sendEvents(c,u.Event.MOUSE_OVER)}}},{key:"onMouseMove",value:function(e,i){var n,a;this.enable&&((n=this.getTouchFromArr(i,this.preOvers))?(this.checkMouseOutAndOverOfMove(e,n.tar),n.tar=e,a=this.getEles(e,null,t._tEleArr)):(a=this.getEles(e,null,t._tEleArr),this.sendEvents(a,u.Event.MOUSE_OVER),this.preOvers.push(this.createTouchO(e,i))),this.sendEvents(a,u.Event.MOUSE_MOVE),this._clearTempArrs())}},{key:"getLastOvers",value:function(){return t._tEleArr.length=0,this.preOvers.length>0&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,t._tEleArr):(t._tEleArr.push(d.ILaya.stage),t._tEleArr)}},{key:"stageMouseOut",value:function(){var t;t=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(t,u.Event.MOUSE_OUT)}},{key:"onMouseUp",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.enable){var a,r,o,l,d,f,_,v,y=h.Browser.onMobile;if(r=this.getEles(e,null,t._tEleArr),this.sendEvents(r,n?u.Event.MOUSE_UP:u.Event.RIGHT_MOUSE_UP),v=n?this.preDowns:this.preRightDowns,a=this.getTouchFromArr(i,v)){var p,g=h.Browser.now();if(p=g-this._lastClickTime<300,this._lastClickTime=g,e==a.tar)_=r;else for(o=this.getEles(a.tar,null,t._oldArr),(_=t._newArr).length=0,d=o.length,l=0;l<d;l++)f=o[l],(0,s.default)(r).call(r,f)>=0&&_.push(f);_.length>0&&this.sendEvents(_,n?u.Event.CLICK:u.Event.RIGHT_CLICK),n&&p&&this.sendEvents(_,u.Event.DOUBLE_CLICK),this.removeTouchFromArr(i,v),a.tar=null,c.Pool.recover("TouchData",a)}else;(a=this.getTouchFromArr(i,this.preOvers))&&y&&((_=this.getEles(a.tar,null,_))&&_.length>0&&this.sendEvents(_,u.Event.MOUSE_OUT),this.removeTouchFromArr(i,this.preOvers),a.tar=null,c.Pool.recover("TouchData",a)),this._clearTempArrs()}}}]),t}();e.TouchManager=f,f.I=new f,f._oldArr=[],f._newArr=[],f._tEleArr=[]},9538:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.BlurFilter=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(81114),d=i(96581);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var _=function(t){(0,l.default)(i,t);var e=f(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return(0,s.default)(this,i),(t=e.call(this)).strength_sig2_2sig2_gauss1=[],t.strength=n,t._glRender=new d.BlurFilterGLRender,t}return(0,o.default)(i,[{key:"type",get:function(){return c.Filter.BLUR}},{key:"getStrenth_sig2_2sig2_native",value:function(){this.strength_sig2_native||(this.strength_sig2_native=new Float32Array(4));var t=this.strength/3,e=t*t;return this.strength_sig2_native[0]=this.strength,this.strength_sig2_native[1]=e,this.strength_sig2_native[2]=2*e,this.strength_sig2_native[3]=1/(2*Math.PI*e),this.strength_sig2_native}}]),i}(c.Filter);e.BlurFilter=_},96581:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BlurFilterGLRender=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(81114),l=i(18008),u=i(43989),h=i(22245),c=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"render",value:function(t,e,i,n,a){var r=h.Value2D.create(u.ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(r,a,t.width,t.height),e.drawTarget(t,0,0,i,n,l.Matrix.EMPTY.identity(),r)}},{key:"setShaderInfo",value:function(e,i,n,a){e.defines.add(o.Filter.BLUR);var r=e;t.blurinfo[0]=n,t.blurinfo[1]=a,r.blurInfo=t.blurinfo;var s=i.strength/3,l=s*s;i.strength_sig2_2sig2_gauss1[0]=i.strength,i.strength_sig2_2sig2_gauss1[1]=l,i.strength_sig2_2sig2_gauss1[2]=2*l,i.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*l),r.strength_sig2_2sig2_gauss1=i.strength_sig2_2sig2_gauss1}}]),t}();e.BlurFilterGLRender=c,c.blurinfo=new Array(2)},20084:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ColorFilter=void 0;var s=r(i(77766)),o=r(i(3649)),l=r(i(15375)),u=r(i(17061)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(81114),_=i(13104);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var y=function(t){(0,h.default)(i,t);var e=v(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,l.default)(this,i),t=e.call(this),n||(n=t._copyMatrix(i.IDENTITY_MATRIX)),t._mat=new Float32Array(16),t._alpha=new Float32Array(4),t.setByMatrix(n),t}return(0,u.default)(i,[{key:"gray",value:function(){return this.setByMatrix(i.GRAY_MATRIX)}},{key:"color",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.setByMatrix([1,0,0,0,t,0,1,0,0,e,0,0,1,0,i,0,0,0,1,n])}},{key:"setColor",value:function(t){var e=_.ColorUtils.create(t).arrColor,i=[0,0,0,0,256*e[0],0,0,0,0,256*e[1],0,0,0,0,256*e[2],0,0,0,1,0];return this.setByMatrix(i)}},{key:"setByMatrix",value:function(t){this._matrix!=t&&this._copyMatrix(t);for(var e=0,i=0,n=0;n<20;n++)n%5!=4?this._mat[e++]=t[n]:this._alpha[i++]=t[n];return this}},{key:"type",get:function(){return f.Filter.COLOR}},{key:"adjustColor",value:function(t,e,i,n){return this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i),this}},{key:"adjustBrightness",value:function(t){return 0==(t=this._clampValue(t,100))||isNaN(t)?this:this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustContrast",value:function(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e,n=(e=t<0?127+t/100*127:127*(e=0==(e=t%1)?i.DELTA_INDEX[t]:i.DELTA_INDEX[t<<0]*(1-e)+i.DELTA_INDEX[1+(t<<0)]*e)+127)/127,a=.5*(127-e);return this._multiplyMatrix([n,0,0,0,a,0,n,0,0,a,0,0,n,0,a,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustSaturation",value:function(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e=1+(t>0?3*t/100:t/100),i=1-e,n=.3086*i,a=.6094*i,r=.082*i;return this._multiplyMatrix([n+e,a,r,0,0,n,a+e,r,0,0,n,a,r+e,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustHue",value:function(t){if(0==(t=this._clampValue(t,180)/180*Math.PI)||isNaN(t))return this;var e=Math.cos(t),i=Math.sin(t),n=.213,a=.715,r=.072;return this._multiplyMatrix([n+e*(1-n)+i*-n,a+e*-a+i*-a,r+e*-r+i*(1-r),0,0,n+e*-n+.143*i,a+e*(1-a)+.14*i,r+e*-r+-.283*i,0,0,n+e*-n+-.787*i,a+e*-a+i*a,r+e*(1-r)+i*r,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"reset",value:function(){return this.setByMatrix(this._copyMatrix(i.IDENTITY_MATRIX))}},{key:"_multiplyMatrix",value:function(t){var e=[];this._matrix=this._fixMatrix(this._matrix);for(var i=0;i<5;i++){for(var n=0;n<5;n++)e[n]=this._matrix[n+5*i];for(n=0;n<5;n++){for(var a=0,r=0;r<5;r++)a+=t[n+5*r]*e[r];this._matrix[n+5*i]=a}}return this.setByMatrix(this._matrix)}},{key:"_clampValue",value:function(t,e){return Math.min(e,Math.max(-e,t))}},{key:"_fixMatrix",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==n?i.IDENTITY_MATRIX:(n.length<i.LENGTH?n=(0,s.default)(t=(0,o.default)(n).call(n,0,n.length)).call(t,(0,o.default)(e=i.IDENTITY_MATRIX).call(e,n.length,i.LENGTH)):n.length>i.LENGTH&&(n=(0,o.default)(n).call(n,0,i.LENGTH)),n)}},{key:"_copyMatrix",value:function(t){var e=i.LENGTH;this._matrix||(this._matrix=[]);for(var n=0;n<e;n++)this._matrix[n]=t[n];return this._matrix}}]),i}(f.Filter);e.ColorFilter=y,y.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],y.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],y.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],y.LENGTH=25},81114:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Filter=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=i(85399),u=i(98693),h=i(93894),c=i(95453),d=i(91700),f=i(43989),_=i(22245),v=i(69153),y=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"type",get:function(){return-1}}]),t}();e.Filter=y,y.BLUR=16,y.COLOR=32,y.GLOW=8,y._filter=function(t,e,i,n){var a=e,r=this._next;if(r){var s=t.filters,p=s.length;if(1==p&&s[0].type==y.COLOR)return e.save(),e.setColorFilter(s[0]),r._fun.call(r,t,e,i,n),void e.restore();var g,m=_.Value2D.create(f.ShaderDefines2D.TEXTURE2D,0),x=l.Point.TEMP,T=a._curMat,k=o.Matrix.create();T.copyTo(k);var C=0,S=0,E=null,M=t._cacheStyle.filterCache||null;if(M&&0==t.getRepaint()){if((t._isHaveGlowFilter()||!1)&&(C=50,S=25),(g=t.getBounds()).width<=0||g.height<=0)return;g.width+=C+8,g.height+=C+8,g.x-=t.pivotX+4,g.y-=t.pivotY+4,x.x=g.x*k.a+g.y*k.c,x.y=g.y*k.d+g.x*k.b,g.x=x.x,g.y=x.y,x.x=g.width*k.a+g.height*k.c,x.y=g.height*k.d+g.width*k.b,g.width=x.x,g.height=x.y}else{t._isHaveGlowFilter()&&(C=50,S=25),(g=new u.Rectangle).copyFrom(t.getSelfBounds()),g.x+=t.x,g.y+=t.y,g.x-=t.pivotX+4,g.y-=t.pivotY+4;var L=g.x,b=g.y;if(g.width+=C+8,g.height+=C+8,x.x=g.x*k.a+g.y*k.c,x.y=g.y*k.d+g.x*k.b,g.x=x.x,g.y=x.y,x.x=g.width*k.a+g.height*k.c,x.y=g.height*k.d+g.width*k.b,g.width=x.x,g.height=x.y,g.width<=0||g.height<=0)return;M&&c.WebGLRTMgr.releaseRT(M),E=c.WebGLRTMgr.getRT(g.width,g.height);var I=M=c.WebGLRTMgr.getRT(g.width,g.height);t._getCacheStyle().filterCache=M,a.pushRT(),a.useRT(E);var R=t.x-L+S,w=t.y-b+S;r._fun.call(r,t,e,R,w),a.useRT(I);for(var A=0;A<p;A++){0!=A&&(a.useRT(E),a.drawTarget(I,0,0,g.width,g.height,o.Matrix.TEMP.identity(),m,null,d.BlendMode.TOINT.overlay),a.useRT(I));var B=s[A];switch(B.type){case y.BLUR:case y.GLOW:B._glRender&&B._glRender.render(E,e,g.width,g.height,B);break;case y.COLOR:a.setColorFilter(B),a.drawTarget(E,0,0,g.width,g.height,o.Matrix.EMPTY.identity(),_.Value2D.create(f.ShaderDefines2D.TEXTURE2D,0)),a.setColorFilter(null)}}a.popRT()}if(i=i-S-t.x,n=n-S-t.y,x.setTo(i,n),k.transformPoint(x),i=x.x+g.x,n=x.y+g.y,a._drawRenderTexture(M,i,n,g.width,g.height,o.Matrix.TEMP.identity(),1,h.RenderTexture2D.defuv),E){var D=v.SubmitCMD.create([E],(function(t){t.destroy()}),this);E=null,e.addRenderObject(D)}k.destroy()}}},12677:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.GlowFilter=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(81114),d=i(63483),f=i(13104),_=i(9538);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var y=function(t){(0,l.default)(i,t);var e=v(i);function i(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return(0,s.default)(this,i),(n=e.call(this))._elements=new Float32Array(9),n._sv_blurInfo1=new Array(4),n._sv_blurInfo2=[0,0,1,0],n._color=new f.ColorUtils(t),n.blur=Math.min(a,20),n.offX=r,n.offY=o,n._sv_blurInfo1[0]=n._sv_blurInfo1[1]=n.blur,n._sv_blurInfo1[2]=r,n._sv_blurInfo1[3]=-o,n._glRender=new d.GlowFilterGLRender,n}return(0,o.default)(i,[{key:"type",get:function(){return _.BlurFilter.GLOW}},{key:"offY",get:function(){return this._elements[6]},set:function(t){this._elements[6]=t,this._sv_blurInfo1[3]=-t}},{key:"offX",get:function(){return this._elements[5]},set:function(t){this._elements[5]=t,this._sv_blurInfo1[2]=t}},{key:"getColor",value:function(){return this._color.arrColor}},{key:"blur",get:function(){return this._elements[4]},set:function(t){this._elements[4]=t,this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=t}},{key:"getColorNative",value:function(){this._color_native||(this._color_native=new Float32Array(4));var t=this.getColor();return this._color_native[0]=t[0],this._color_native[1]=t[1],this._color_native[2]=t[2],this._color_native[3]=t[3],this._color_native}},{key:"getBlurInfo1Native",value:function(){return this._blurInof1_native||(this._blurInof1_native=new Float32Array(4)),this._blurInof1_native[0]=this._blurInof1_native[1]=this.blur,this._blurInof1_native[2]=this.offX,this._blurInof1_native[3]=this.offY,this._blurInof1_native}},{key:"getBlurInfo2Native",value:function(){return this._blurInof2_native||(this._blurInof2_native=new Float32Array(4)),this._blurInof2_native[2]=1,this._blurInof2_native}}]),i}(c.Filter);e.GlowFilter=y},63483:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.GlowFilterGLRender=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=i(43989),u=i(22245),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"setShaderInfo",value:function(t,e,i,n){t.defines.add(n.type);var a=t;a.u_blurInfo1=n._sv_blurInfo1;var r=n._sv_blurInfo2;r[0]=e,r[1]=i,a.u_blurInfo2=r,a.u_color=n.getColor()}},{key:"render",value:function(t,e,i,n,a){var r=i,s=n,h=u.Value2D.create(l.ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(h,r,s,a);var c=u.Value2D.create(l.ShaderDefines2D.TEXTURE2D,0),d=o.Matrix.TEMP.identity();e.drawTarget(t,0,0,r,s,d,h),e.drawTarget(t,0,0,r,s,d,c)}}]),t}();e.GlowFilterGLRender=h},26861:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLBrElement=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(65202),l=i(89364),u=i(64210),h=i(17661),c=i(92493),d=i(23835),f=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"_addToLayout",value:function(t){t.push(this)}},{key:"reset",value:function(){return this}},{key:"destroy",value:function(){u.Pool.recover(o.HTMLElement.getClassName(this),this.reset())}},{key:"_setParent",value:function(t){}},{key:"parent",set:function(t){}},{key:"URI",set:function(t){}},{key:"href",set:function(t){}},{key:"_getCSSStyle",value:function(){return t.brStyle||(t.brStyle=new l.HTMLStyle,t.brStyle.setLineElement(!0),t.brStyle.block=!0),t.brStyle}},{key:"renderSelfToGraphic",value:function(t,e,i,n){}}]),t}();e.HTMLBrElement=f,h.IHtml.HTMLBrElement=f,c.ILaya.regClass(f),d.ClassUtils.regClass("laya.html.dom.HTMLBrElement",f),d.ClassUtils.regClass("Laya.HTMLBrElement",f)},22825:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLDivElement=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(89395)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(79386),_=i(78362),v=i(89662),y=i(41107),p=i(17661),g=i(23216),m=i(23835);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var T=function(t){(0,h.default)(i,t);var e=x(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this))._recList=[],t._repaintState=0,t._element=new f.HTMLDivParser,t._element.repaintHandler=new y.Handler((0,l.default)(t),t._htmlDivRepaint),t.mouseEnabled=!0,t.on(v.Event.CLICK,(0,l.default)(t),t._onMouseClick),t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._element&&this._element.reset(),this._element=null,this._doClears(),(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t)}},{key:"_htmlDivRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this._repaintState<2&&(this._repaintState=2):this._repaintState<1&&(this._repaintState=1),this._repaintState>0&&this._setGraphicDirty()}},{key:"_updateGraphicWork",value:function(){switch(this._repaintState){case 1:this._updateGraphic();break;case 2:this._refresh()}}},{key:"_setGraphicDirty",value:function(){this.callLater(this._updateGraphicWork)}},{key:"_doClears",value:function(){if(this._recList){var t,e=this._recList.length;for(t=0;t<e;t++)this._recList[t].recover();this._recList.length=0}}},{key:"_updateGraphic",value:function(){this._doClears(),this.graphics.clear(!0),this._repaintState=0,this._element.drawToGraphic(this.graphics,-this._element.x,-this._element.y,this._recList);var t=this._element.getBounds();t&&this.setSelfBounds(t),this.size(t.width,t.height)}},{key:"style",get:function(){return this._element.style}},{key:"innerHTML",set:function(t){this._innerHTML!=t&&(this._repaintState=1,this._innerHTML=t,this._element.innerHTML=t,this._setGraphicDirty())}},{key:"_refresh",value:function(){this._repaintState=1,this._innerHTML&&(this._element.innerHTML=this._innerHTML),this._setGraphicDirty()}},{key:"width",get:function(){return this._element.width},set:function(t){this._element.width=t}},{key:"height",get:function(){return this._element.height},set:function(t){this._element.height=t}},{key:"contextWidth",get:function(){return this._element.contextWidth}},{key:"contextHeight",get:function(){return this._element.contextHeight}},{key:"_onMouseClick",value:function(){var t,e,i,n=this.mouseX,a=this.mouseY;for(e=this._recList.length,t=0;t<e;t++)(i=this._recList[t]).rec.contains(n,a)&&this._eventLink(i.href)}},{key:"_eventLink",value:function(t){this.event(v.Event.LINK,[t])}}]),i}(_.Sprite);e.HTMLDivElement=T,p.IHtml.HTMLDivElement=T,p.IHtml.HTMLParse=g.HTMLParse,m.ClassUtils.regClass("laya.html.dom.HTMLDivElement",T),m.ClassUtils.regClass("Laya.HTMLDivElement",T)},79386:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLDivParser=void 0;var s=r(i(78914)),o=r(i(15375)),l=r(i(17061)),u=r(i(49409)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(65202),v=i(61391),y=i(47076),p=i(89364),g=i(211),m=i(98693),x=i(17661),T=i(92493),k=i(23835);function C(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var S=function(t){(0,c.default)(i,t);var e=C(i);function i(){var t;return(0,o.default)(this,i),(t=e.apply(this,arguments)).repaintHandler=null,t}return(0,l.default)(i,[{key:"reset",value:function(){return v.HTMLStyleElement,y.HTMLLinkElement,(0,h.default)((0,f.default)(i.prototype),"reset",this).call(this),this._style.block=!0,this._style.setLineElement(!0),this._style.width=200,this._style.height=200,this.repaintHandler=null,this.contextHeight=0,this.contextWidth=0,this}},{key:"innerHTML",set:function(t){this.destroyChildren(),this.appendHTML(t)}},{key:"width",get:function(){return this._width?this._width:this.contextWidth},set:function(t){var e;e=0===t?t!=this._width:t!=this.width,(0,u.default)((0,f.default)(i.prototype),"width",t,this,!0),e&&this.layout()}},{key:"appendHTML",value:function(t){x.IHtml.HTMLParse.parse(this,t,this.URI),this.layout()}},{key:"_addChildsToLayout",value:function(t){var e=this._getWords();if(null==e&&(!this._children||0==this._children.length))return!1;e&&(0,s.default)(e).call(e,(function(e){t.push(e)}));for(var i=!0,n=0,a=this._children.length;n<a;n++){var r=this._children[n];i?i=!1:t.push(null),r._addToLayout(t)}return!0}},{key:"_addToLayout",value:function(t){this.layout(),!this.style.absolute&&t.push(this)}},{key:"getBounds",value:function(){return this._htmlBounds?(this._boundsRec||(this._boundsRec=m.Rectangle.create()),this._boundsRec.copyFrom(this._htmlBounds)):null}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,h.default)((0,f.default)(i.prototype),"parentRepaint",this).call(this),this.repaintHandler&&this.repaintHandler.runWith(t)}},{key:"layout",value:function(){this.style._type|=p.HTMLStyle.ADDLAYOUTED;var t=g.Layout.layout(this);if(t){this._htmlBounds||(this._htmlBounds=m.Rectangle.create());var e=this._htmlBounds;e.x=e.y=0,e.width=this.contextWidth=t[0],e.height=this.contextHeight=t[1]}}},{key:"height",get:function(){return this._height?this._height:this.contextHeight},set:function(t){(0,u.default)((0,f.default)(i.prototype),"height",t,this,!0)}}]),i}(_.HTMLElement);e.HTMLDivParser=S,x.IHtml.HTMLDivParser=S,T.ILaya.regClass(S),k.ClassUtils.regClass("laya.html.dom.HTMLDivParser",S),k.ClassUtils.regClass("Laya.HTMLDivParser",S)},74412:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLDocument=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(89364),l=i(23835),u=function(){function t(){(0,r.default)(this,t),this.all={},this.styleSheets=o.HTMLStyle.styleSheets}return(0,s.default)(t,[{key:"getElementById",value:function(t){return this.all[t]}},{key:"setElementById",value:function(t,e){this.all[t]=e}}]),t}();e.HTMLDocument=u,u.document=new u,l.ClassUtils.regClass("laya.html.dom.HTMLDocument",u),l.ClassUtils.regClass("Laya.HTMLDocument",u)},65202:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLElementType=e.HTMLElement=void 0;var r,s=a(i(78914)),o=a(i(92762)),l=a(i(31238)),u=a(i(94198)),h=a(i(81643)),c=a(i(15375)),d=a(i(17061)),f=i(74412),_=i(94294),v=i(89364),y=i(211),p=i(84935),g=i(25810),m=i(64210),x=i(92493),T=i(17661),k=i(23835);e.HTMLElementType=r,function(t){t[t.BASE=0]="BASE",t[t.IMAGE=1]="IMAGE"}(r||(e.HTMLElementType=r={}));var C=function(){function t(){(0,c.default)(this,t),this.eletype=r.BASE,this._creates(),this.reset()}return(0,d.default)(t,[{key:"_creates",value:function(){this._style=v.HTMLStyle.create()}},{key:"reset",value:function(){if(this.URI=null,this.parent=null,this._style.reset(),this._style.ower=this,this._style.valign="middle",this._text&&this._text.words){var e,i,n,a=this._text.words;for(i=a.length,e=0;e<i;e++)(n=a[e])&&n.recover()}return this._text=t._EMPTYTEXT,this._children&&(this._children.length=0),this._x=this._y=this._width=this._height=0,this}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"_addChildsToLayout",value:function(t){var e,i=this._getWords();if(null==i&&(!this._children||0==this._children.length))return!1;if(i)for(var n=0,a=i.length;n<a;n++)t.push(i[n]);return this._children&&(0,s.default)(e=this._children).call(e,(function(e,i,n){var a=e._style;a._enableLayout&&a._enableLayout()&&e._addToLayout(t)})),!0}},{key:"_addToLayout",value:function(t){if(this._style){var e=this._style;e.absolute||(e.block?t.push(this):this._addChildsToLayout(t)&&(this.x=this.y=0))}}},{key:"id",set:function(t){f.HTMLDocument.document.setElementById(t,this)}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parentRepaint(t)}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parent&&this.parent.repaint(t)}},{key:"innerTEXT",get:function(){return this._text.text},set:function(e){this._text===t._EMPTYTEXT?this._text={text:e,words:null}:(this._text.text=e,this._text.words&&(this._text.words.length=0)),this.repaint()}},{key:"_setParent",value:function(e){if(e instanceof t){var i=e;this.URI||(this.URI=i.URI),this.style&&this.style.inherit(i.style)}}},{key:"appendChild",value:function(t){return this.addChild(t)}},{key:"addChild",value:function(t){return t.parent&&t.parent.removeChild(t),this._children||(this._children=[]),this._children.push(t),t.parent=this,t._setParent(this),this.repaint(),t}},{key:"removeChild",value:function(t){if(!this._children)return null;var e,i;for(i=this._children.length,e=0;e<i;e++){var n;if(this._children[e]==t)return(0,o.default)(n=this._children).call(n,e,1),t}return null}},{key:"destroy",value:function(){this._children&&(this.destroyChildren(),this._children.length=0),m.Pool.recover(t.getClassName(this),this.reset())}},{key:"destroyChildren",value:function(){if(this._children){for(var t=this._children.length-1;t>-1;t--)this._children[t].destroy();this._children.length=0}}},{key:"style",get:function(){return this._style}},{key:"_getWords",value:function(){if(!this._text)return null;var t=this._text.text;if(!t||0===t.length)return null;var e,i=this._text.words;if(i&&i.length===t.length)return i;null===i&&(this._text.words=i=[]),i.length=t.length;for(var n=this.style,a=n.font,r=0,s=t.length;r<s;r++)e=x.ILaya.Browser.measureText(t.charAt(r),a),i[r]=g.HTMLChar.create().setData(t.charAt(r),e.width,e.height||n.fontSize,n);return i}},{key:"_isChar",value:function(){return!1}},{key:"_layoutLater",value:function(){var t=this.style;t._type&v.HTMLStyle.ADDLAYOUTED||(t.widthed(this)&&(this._children&&this._children.length>0||null!=this._getWords())&&t.block?(y.Layout.later(this),t._type|=v.HTMLStyle.ADDLAYOUTED):this.parent&&this.parent._layoutLater())}},{key:"x",get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.parentRepaint())}},{key:"y",get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.parentRepaint())}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.repaint())}},{key:"height",get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this.repaint())}},{key:"_setAttributes",value:function(t,e){switch(t){case"style":this.style.cssText(e);break;case"class":this.className=e;break;case"x":this.x=(0,l.default)(e);break;case"y":this.y=(0,l.default)(e);break;case"width":this.width=(0,l.default)(e);break;case"height":this.height=(0,l.default)(e);break;default:this[t]=e}}},{key:"href",get:function(){return this._style?this._style.href:null},set:function(t){this._style&&t!=this._style.href&&(this._style.href=t,this.repaint())}},{key:"formatURL",value:function(e){return this.URI?t.formatURL1(e,this.URI?this.URI.path:null):e}},{key:"color",set:function(t){this.style.color=t}},{key:"className",set:function(t){this.style.attrs(f.HTMLDocument.document.styleSheets["."+t])}},{key:"drawToGraphic",value:function(t,e,i,n){e+=this.x,i+=this.y;var a,r,s,o=this.style;if(o.paddingLeft&&(e+=o.paddingLeft),o.paddingTop&&(i+=o.paddingTop),(null!=o.bgColor||o.borderColor)&&t.drawRect(e,i,this.width,this.height,o.bgColor,o.borderColor,1),this.renderSelfToGraphic(t,e,i,n),this._children&&this._children.length>0)for(r=this._children.length,a=0;a<r;a++)null!=(s=this._children[a]).drawToGraphic&&s.drawToGraphic(t,e,i,n)}},{key:"renderSelfToGraphic",value:function(t,e,i,n){var a=this.style,r=this._getWords();if(r&&(r.length,a)){var s=a.font,o=a.color;if(a.stroke){var l=a.stroke;l=(0,u.default)(l);var h=a.strokeColor;t.fillBorderWords(r,e,i,s,o,h,l)}else t.fillWords(r,e,i,s,o);if(this.href){var c=r[r.length-1],d=c.y+c.height;if(c.y==r[0].y){"none"!=a.textDecoration&&t.drawLine(r[0].x,d,c.x+c.width,d,o,1);var f=_.HTMLHitRect.create();f.rec.setTo(r[0].x,c.y,c.x+c.width-r[0].x,c.height),f.href=this.href,n.push(f)}else this.workLines(r,t,n)}}}},{key:"workLines",value:function(t,e,i){var n;n="none"!=this.style.textDecoration;var a,r,s,o=0;if(a=t.length,s=r=t[o],r){var l;for(o=1;o<a;o++)(l=t[o]).y!=r.y?(this.createOneLine(r,s,n,e,i),r=l,s=l):s=l;this.createOneLine(r,s,n,e,i)}}},{key:"createOneLine",value:function(t,e,i,n,a){var r=e.y+e.height;i&&n.drawLine(t.x,r,e.x+e.width,r,this.style.color,1);var s=_.HTMLHitRect.create();s.rec.setTo(t.x,e.y,e.x+e.width-t.x,e.height),s.href=this.href,a.push(s)}}],[{key:"formatURL1",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return"null path";if(e||(e=p.URL.basePath),(0,h.default)(t).call(t,":")>0)return t;if(null!=p.URL.customFormat&&(t=p.URL.customFormat(t)),(0,h.default)(t).call(t,":")>0)return t;var i=t.charAt(0);if("."===i)return p.URL._formatRelativePath(e+t);if("~"===i)return p.URL.rootPath+t.substring(1);if("d"===i){if(0===(0,h.default)(t).call(t,"data:image"))return t}else if("/"===i)return t;return e+t}},{key:"getClassName",value:function(t){return t instanceof Function?t.name:t.constructor.name}}]),t}();e.HTMLElement=C,C._EMPTYTEXT={text:null,words:null},x.ILaya.regClass(C),T.IHtml.HTMLElementType=r,k.ClassUtils.regClass("laya.html.dom.HTMLElement",C),k.ClassUtils.regClass("Laya.HTMLElement",C)},94294:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLHitRect=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(98693),l=i(64210),u=i(23835),h=function(){function t(){(0,r.default)(this,t),this.rec=new o.Rectangle,this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){return this.rec.reset(),this.href=null,this}},{key:"recover",value:function(){l.Pool.recover("HTMLHitRect",this.reset())}}],[{key:"create",value:function(){return l.Pool.getItemByClass("HTMLHitRect",t)}}]),t}();e.HTMLHitRect=h,u.ClassUtils.regClass("laya.html.dom.HTMLHitRect",h),u.ClassUtils.regClass("Laya.HTMLHitRect",h)},32635:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLImageElement=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(65202),f=i(89662),_=i(85096),v=i(54598),y=i(17661),p=i(92493),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var x=function(t){(0,u.default)(i,t);var e=m(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this)).eletype=d.HTMLElementType.IMAGE,t}return(0,o.default)(i,[{key:"reset",value:function(){return(0,l.default)((0,c.default)(i.prototype),"reset",this).call(this),this._tex&&this._tex.off(f.Event.LOADED,this,this.onloaded),this._tex=null,this._url=null,this}},{key:"src",set:function(t){if(t=this.formatURL(t),this._url!==t){this._url=t;var e=this._tex=_.Loader.getRes(t);e||(this._tex=e=new v.Texture,e.load(t),_.Loader.cacheTexture(t,e)),e.getIsReady()?this.onloaded():e.once(f.Event.READY,this,this.onloaded)}}},{key:"onloaded",value:function(){if(this._style){var t=this._style;t.widthed(this)||this._tex.width,t.heighted(this)||this._tex.height;t.widthed(this)||this._width==this._tex.width||(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),t.heighted(this)||this._height==this._tex.height||(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),this.repaint()}}},{key:"_addToLayout",value:function(t){!this._style.absolute&&t.push(this)}},{key:"renderSelfToGraphic",value:function(t,e,i,n){this._tex&&t.drawImage(this._tex,e,i,this.width||this._tex.width,this.height||this._tex.height)}}]),i}(d.HTMLElement);e.HTMLImageElement=x,y.IHtml.HTMLImageElement=x,p.ILaya.regClass(x),g.ClassUtils.regClass("laya.html.dom.HTMLImageElement",x),g.ClassUtils.regClass("Laya.HTMLImageElement",x)},47076:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLLinkElement=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(65202),f=i(85096),_=i(89662),v=i(89364),y=i(84935),p=i(92493),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var x=function(t){(0,u.default)(i,t);var e=m(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"_creates",value:function(){}},{key:"drawToGraphic",value:function(t,e,i,n){}},{key:"reset",value:function(){return this._loader&&this._loader.off(_.Event.COMPLETE,this,this._onload),this._loader=null,this}},{key:"_onload",value:function(t){if(this._loader&&(this._loader=null),"text/css"===this.type)v.HTMLStyle.parseCSS(t,this.URI);this.repaint(!0)}},{key:"href",get:function(){return(0,l.default)((0,c.default)(i.prototype),"href",this)},set:function(t){t&&(t=this.formatURL(t),this.URI=new y.URL(t),this._loader&&this._loader.off(_.Event.COMPLETE,this,this._onload),f.Loader.getRes(t)?"text/css"==this.type&&v.HTMLStyle.parseCSS(f.Loader.getRes(t),this.URI):(this._loader=new f.Loader,this._loader.once(_.Event.COMPLETE,this,this._onload),this._loader.load(t,f.Loader.TEXT)))}}]),i}(d.HTMLElement);e.HTMLLinkElement=x,x._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g"),p.ILaya.regClass(x),g.ClassUtils.regClass("laya.html.dom.HTMLLinkElement",x),g.ClassUtils.regClass("Laya.HTMLLinkElement",x)},61391:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLStyleElement=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(65202),f=i(89364),_=i(92493),v=i(23835);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var p=function(t){(0,u.default)(i,t);var e=y(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"_creates",value:function(){}},{key:"drawToGraphic",value:function(t,e,i,n){}},{key:"reset",value:function(){return this}},{key:"innerTEXT",get:function(){return(0,l.default)((0,c.default)(i.prototype),"innerTEXT",this)},set:function(t){f.HTMLStyle.parseCSS(t,null)}}]),i}(d.HTMLElement);e.HTMLStyleElement=p,_.ILaya.regClass(p),v.ClassUtils.regClass("laya.html.dom.HTMLStyleElement",p),v.ClassUtils.regClass("Laya.HTMLStyleElement",p)},22504:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLExtendStyle=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=i(23835),u=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){return this.stroke=0,this.strokeColor="#000000",this.leading=0,this.lineHeight=0,this.letterSpacing=0,this.href=null,this}},{key:"recover",value:function(){this!=t.EMPTY&&o.Pool.recover("HTMLExtendStyle",this.reset())}}],[{key:"create",value:function(){return o.Pool.getItemByClass("HTMLExtendStyle",t)}}]),t}();e.HTMLExtendStyle=u,u.EMPTY=new u,l.ClassUtils.regClass("laya.html.utils.HTMLExtendStyle",u),l.ClassUtils.regClass("Laya.HTMLExtendStyle",u)},23216:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLParse=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(79386),l=i(65202),u=i(64210),h=i(23835),c=i(56083),d=i(17661),f=i(26861),_=i(61391),v=i(47076),y=i(32635),p=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getInstance",value:function(e){var i=u.Pool.getItem(t._htmlClassMapShort[e]);return i||(i=h.ClassUtils.getInstance(e)),i}},{key:"parse",value:function(e,i,n){i=(i="<root>"+(i=i.replace(/<br>/g,"<br/>"))+"</root>").replace(t.spacePattern,t.char255);var a=c.Utils.parseXMLFromString(i);t._parseXML(e,a.childNodes[0].childNodes,n)}},{key:"_parseXML",value:function(e,i,n){var a,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i.join||i.item)for(a=0,r=i.length;a<r;++a)t._parseXML(e,i[a],n,s);else{var o,u;if(3==i.nodeType){var h;if(e instanceof d.IHtml.HTMLDivParser)null==i.nodeName&&(i.nodeName="#text"),u=i.nodeName.toLowerCase(),(h=i.textContent.replace(/^\s+|\s+$/g,"")).length>0&&(o=t.getInstance(u))&&(e.addChild(o),o.innerTEXT=h.replace(t.char255AndOneSpacePattern," "));else if((h=i.textContent.replace(/^\s+|\s+$/g,"")).length>0){var c=e;if(e instanceof l.HTMLElement&&e.innerTEXT&&e.innerTEXT.length>0){var f=t.getInstance("p");f&&(e.addChild(f),c=f)}c.innerTEXT=h.replace(t.char255AndOneSpacePattern," ")}return}if("#comment"==(u=i.nodeName.toLowerCase()))return;if(o=t.getInstance(u)){"p"==u?(e.addChild(t.getInstance("br")),o=e.addChild(o),e.addChild(t.getInstance("br"))):o=e.addChild(o),o.URI=n,o.href=s;var _=i.attributes;if(_&&_.length>0)for(a=0,r=_.length;a<r;++a){var v=_[a],y=v.nodeName,p=v.value;o._setAttributes(y,p)}t._parseXML(o,i.childNodes,n,o.href)}else t._parseXML(e,i.childNodes,n,s)}}}]),t}();e.HTMLParse=p,p.char255=String.fromCharCode(255),p.spacePattern=/&nbsp;|&#160;/g,p.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),p._htmlClassMapShort={div:o.HTMLDivParser,p:l.HTMLElement,img:y.HTMLImageElement,span:l.HTMLElement,br:f.HTMLBrElement,style:_.HTMLStyleElement,font:l.HTMLElement,a:l.HTMLElement,"#text":l.HTMLElement,link:v.HTMLLinkElement},d.IHtml.HTMLParse=p,h.ClassUtils.regClass("div",o.HTMLDivParser),h.ClassUtils.regClass("p",l.HTMLElement),h.ClassUtils.regClass("img",y.HTMLImageElement),h.ClassUtils.regClass("span",l.HTMLElement),h.ClassUtils.regClass("br",f.HTMLBrElement),h.ClassUtils.regClass("style",_.HTMLStyleElement),h.ClassUtils.regClass("font",l.HTMLElement),h.ClassUtils.regClass("a",l.HTMLElement),h.ClassUtils.regClass("#text",l.HTMLElement),h.ClassUtils.regClass("link",v.HTMLLinkElement),h.ClassUtils.regClass("laya.html.utils.HTMLParse",p),h.ClassUtils.regClass("Laya.HTMLParse",p)},89364:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLStyle=void 0;var r=a(i(81643)),s=a(i(94198)),o=a(i(15375)),l=a(i(17061)),u=i(22504),h=i(92493),c=i(64210),d=i(23835),f=function(){function t(){(0,o.default)(this,t),this.padding=t._PADDING,this.reset()}return(0,l.default)(t,[{key:"_getExtendStyle",value:function(){return this._extendStyle===u.HTMLExtendStyle.EMPTY&&(this._extendStyle=u.HTMLExtendStyle.create()),this._extendStyle}},{key:"href",get:function(){return this._extendStyle.href},set:function(t){t!==this._extendStyle.href&&(this._getExtendStyle().href=t)}},{key:"stroke",get:function(){return this._extendStyle.stroke},set:function(t){this._extendStyle.stroke!==t&&(this._getExtendStyle().stroke=t)}},{key:"strokeColor",get:function(){return this._extendStyle.strokeColor},set:function(t){this._extendStyle.strokeColor!==t&&(this._getExtendStyle().strokeColor=t)}},{key:"leading",get:function(){return this._extendStyle.leading},set:function(t){this._extendStyle.leading!==t&&(this._getExtendStyle().leading=t)}},{key:"lineHeight",get:function(){return this._extendStyle.lineHeight},set:function(t){this._extendStyle.lineHeight!==t&&(this._getExtendStyle().lineHeight=t)}},{key:"align",get:function(){var e=this._type&t._ALIGN;return t.align_Value[e]},set:function(e){e in t.alignVDic&&(this._type&=~t._ALIGN,this._type|=t.alignVDic[e])}},{key:"valign",get:function(){var e=this._type&t._VALIGN;return t.vAlign_Value[e]},set:function(e){e in t.alignVDic&&(this._type&=~t._VALIGN,this._type|=t.alignVDic[e])}},{key:"font",get:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(h.ILaya.Browser.onIPhone&&h.ILaya.Text.fontFamilyMap[this.family]||this.family)},set:function(t){for(var e=t.split(" "),i=0,n=e.length;i<n;i++){var a=e[i];switch(a){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}(0,r.default)(a).call(a,"px")>0&&(this.fontSize=(0,s.default)(a),this.family=e[i+1],i++)}}},{key:"block",get:function(){return 0!=(this._type&t._CSS_BLOCK)},set:function(e){e?this._type|=t._CSS_BLOCK:this._type&=~t._CSS_BLOCK}},{key:"reset",value:function(){return this.ower=null,this._type=0,this.wordWrap=!0,this.fontSize=h.ILaya.Text.defaultFontSize,this.family=h.ILaya.Text.defaultFont,this.color="#000000",this.valign=t.VALIGN_TOP,this.padding=t._PADDING,this.bold=!1,this.italic=!1,this.align=t.ALIGN_LEFT,this.textDecoration=null,this.bgColor=null,this.borderColor=null,this._extendStyle&&this._extendStyle.recover(),this._extendStyle=u.HTMLExtendStyle.EMPTY,this}},{key:"recover",value:function(){c.Pool.recover("HTMLStyle",this.reset())}},{key:"inherit",value:function(e){var i,n,a,r;for(n=(a=t._inheritProps).length,i=0;i<n;i++)this[r=a[i]]=e[r]}},{key:"wordWrap",get:function(){return 0==(this._type&t._NOWARP)},set:function(e){e?this._type&=~t._NOWARP:this._type|=t._NOWARP}},{key:"bold",get:function(){return 0!=(this._type&t._BOLD)},set:function(e){e?this._type|=t._BOLD:this._type&=~t._BOLD}},{key:"fontWeight",get:function(){return this._type&t._BOLD?"bold":"none"},set:function(e){"bold"==e?this._type|=t._BOLD:this._type&=~t._BOLD}},{key:"italic",get:function(){return 0!=(this._type&t._ITALIC)},set:function(e){e?this._type|=t._ITALIC:this._type&=~t._ITALIC}},{key:"_widthAuto",value:function(){return 0!=(this._type&t._WIDTHAUTO)}},{key:"widthed",value:function(e){return 0!=(this._type&t._WIDTH_SET)}},{key:"whiteSpace",get:function(){return this._type&t._NOWARP?"nowrap":""},set:function(e){"nowrap"===e&&(this._type|=t._NOWARP),"none"===e&&(this._type&=~t._NOWARP)}},{key:"_calculation",value:function(t,e){return!1}},{key:"width",set:function(e){if(this._type|=t._WIDTH_SET,"string"==typeof e){var i=(0,r.default)(e).call(e,"auto");if(i>=0&&(this._type|=t._WIDTHAUTO,e=e.substr(0,i)),this._calculation("width",e))return;e=(0,s.default)(e)}this.size(e,-1)}},{key:"height",set:function(e){if(this._type|=t._HEIGHT_SET,"string"==typeof e){if(this._calculation("height",e))return;e=(0,s.default)(e)}this.size(-1,e)}},{key:"heighted",value:function(e){return 0!=(this._type&t._HEIGHT_SET)}},{key:"size",value:function(e,i){var n=this.ower,a=!1;-1!==e&&e!=n.width&&(this._type|=t._WIDTH_SET,n.width=e,a=!0),-1!==i&&i!=n.height&&(this._type|=t._HEIGHT_SET,n.height=i,a=!0),a&&n._layoutLater()}},{key:"getLineElement",value:function(){return 0!=(this._type&t._LINE_ELEMENT)}},{key:"setLineElement",value:function(e){e?this._type|=t._LINE_ELEMENT:this._type&=~t._LINE_ELEMENT}},{key:"_enableLayout",value:function(){return 0==(this._type&t._DISPLAY_NONE)&&0==(this._type&t._ABSOLUTE)}},{key:"letterSpacing",get:function(){return this._extendStyle.letterSpacing},set:function(t){"string"==typeof t&&(t=(0,s.default)(t+"")),t!=this._extendStyle.letterSpacing&&(this._getExtendStyle().letterSpacing=t)}},{key:"cssText",value:function(e){this.attrs(t.parseOneCSS(e,";"))}},{key:"attrs",value:function(t){if(t)for(var e=0,i=t.length;e<i;e++){var n=t[e];this[n[0]]=n[1]}}},{key:"position",get:function(){return this._type&t._ABSOLUTE?"absolute":""},set:function(e){"absolute"===e?this._type|=t._ABSOLUTE:this._type&=~t._ABSOLUTE}},{key:"absolute",get:function(){return 0!=(this._type&t._ABSOLUTE)}},{key:"paddingLeft",get:function(){return this.padding[3]}},{key:"paddingTop",get:function(){return this.padding[0]}}],[{key:"create",value:function(){return c.Pool.getItemByClass("HTMLStyle",t)}},{key:"parseOneCSS",value:function(e,i){for(var n,a=[],o=e.split(i),l=0,u=o.length;l<u;l++){var h=o[l],c=(0,r.default)(h).call(h,":"),d=h.substr(0,c).replace(/^\s+|\s+$/g,"");if(0!==d.length){var f=h.substr(c+1).replace(/^\s+|\s+$/g,""),_=[d,f];switch(d){case"italic":case"bold":_[1]="true"==f;break;case"font-weight":"bold"==f&&(_[1]=!0,_[0]="bold");break;case"line-height":_[0]="lineHeight",_[1]=(0,s.default)(f);break;case"font-size":_[0]="fontSize",_[1]=(0,s.default)(f);break;case"stroke":_[0]="stroke",_[1]=(0,s.default)(f);break;case"padding":(n=f.split(" ")).length>1||(n[1]=n[2]=n[3]=n[0]),_[1]=[(0,s.default)(n[0]),(0,s.default)(n[1]),(0,s.default)(n[2]),(0,s.default)(n[3])];break;default:(_[0]=t._CSSTOVALUE[d])||(_[0]=d)}a.push(_)}}return a}},{key:"parseCSS",value:function(e,i){for(var n;null!=(n=t._parseCSSRegExp.exec(e));)t.styleSheets[n[1]]=t.parseOneCSS(n[2],";")}}]),t}();e.HTMLStyle=f,f._CSSTOVALUE={"letter-spacing":"letterSpacing","white-space":"whiteSpace","line-height":"lineHeight","font-family":"family","vertical-align":"valign","text-decoration":"textDecoration","background-color":"bgColor","border-color":"borderColor"},f._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),f._inheritProps=["italic","align","valign","leading","letterSpacing","stroke","strokeColor","bold","fontWeight","fontSize","lineHeight","wordWrap","color"],f.ALIGN_LEFT="left",f.ALIGN_CENTER="center",f.ALIGN_RIGHT="right",f.VALIGN_TOP="top",f.VALIGN_MIDDLE="middle",f.VALIGN_BOTTOM="bottom",f.styleSheets={},f.ADDLAYOUTED=512,f._PADDING=[0,0,0,0],f._HEIGHT_SET=8192,f._LINE_ELEMENT=65536,f._NOWARP=131072,f._WIDTHAUTO=262144,f._BOLD=1024,f._ITALIC=2048,f._CSS_BLOCK=1,f._DISPLAY_NONE=2,f._ABSOLUTE=4,f._WIDTH_SET=8,f.alignVDic={left:0,center:16,right:32,top:0,middle:64,bottom:128},f.align_Value={0:"left",16:"center",32:"right"},f.vAlign_Value={0:"top",64:"middle",128:"bottom"},f._ALIGN=48,f._VALIGN=192,d.ClassUtils.regClass("laya.html.utils.HTMLStyle",f),d.ClassUtils.regClass("Laya.HTMLStyle",f)},17661:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.IHtml=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.IHtml=s,s.HTMLDivElement=null,s.HTMLImageElement=null,s.HTMLBrElement=null,s.HTMLDivParser=null,s.HTMLParse=null,s.HTMLElementType=null},211:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Layout=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(89364),l=i(92493),u=i(93891),h=i(17661),c=i(23835),d=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"later",value:function(e){null==t._will&&(t._will=[],l.ILaya.stage.frameLoop(1,null,(function(){if(!(t._will.length<1)){for(var e=0;e<t._will.length;e++)t.layout(t._will[e]);t._will.length=0}}))),t._will.push(e)}},{key:"layout",value:function(e){return e&&e._style?0==(e._style._type&o.HTMLStyle.ADDLAYOUTED)?null:(e.style._type&=~o.HTMLStyle.ADDLAYOUTED,t._multiLineLayout(e)):null}},{key:"_multiLineLayout",value:function(e){var i=[];e._addChildsToLayout(i);var n,a,r,s,l,c,d,f=i.length,_=e._getCSSStyle(),v=_.letterSpacing,y=_.leading,p=_.lineHeight,g=_._widthAuto()||!_.wordWrap,m=g?999999:e.width,x=(e.height,0),T=_.italic?_.fontSize/3:0,k=_.align,C=_.valign,S=C!==o.HTMLStyle.VALIGN_TOP||k!==o.HTMLStyle.ALIGN_LEFT||0!=p,E=0,M=0,L=0,b=0,I=[],R=I[0]=new u.LayoutLine,w=!1;R.h=0,_.italic&&(m-=_.fontSize/3);var A=0,B=!0;function D(){R.y=M,M+=R.h+y,R.mWidth=A,A=0,R=new u.LayoutLine,I.push(R),R.h=0,E=0,B=!0,l=!1}for(n=0;n<f;n++)if(null!=(a=i[n]))if(B=!1,a instanceof h.IHtml.HTMLBrElement)D(),R.y=M,R.h=p;else{if(a._isChar()){if(L=(c=a).width+c.style.letterSpacing,b=c.height,c.isWord)l=w||"\n"===c.char,R.wordStartIndex=R.elements.length;else{if(I.length>0&&E+L>m&&R.wordStartIndex>0){var P;P=R.elements.length-R.wordStartIndex+1,R.elements.length=R.wordStartIndex,n-=P,D();continue}l=!1,A+=c.width}w=!1,(l=l||E+L>m)&&D(),R.minTextHeight=Math.min(R.minTextHeight,a.height)}else r=a._getCSSStyle(),d=a,s=r.padding,l=w||r.getLineElement(),L=d.width+s[1]+s[3]+r.letterSpacing,b=d.height+s[0]+s[2],w=r.getLineElement(),(l=l||E+L>m&&r.wordWrap)&&D();R.elements.push(a),R.h=Math.max(R.h,b),a.x=E,a.y=M,E+=L,R.w=E-v,R.y=M,x=Math.max(E+T,x)}else B||(E+=t.DIV_ELEMENT_PADDING),R.wordStartIndex=R.elements.length;if(M=R.y+R.h,S){var O=0,F=m;for(g&&e.width>0&&(F=e.width),n=0,f=I.length;n<f;n++)I[n].updatePos(0,F,n,O,k,C,p),O+=Math.max(p,I[n].h+y);M=O}return g&&(e.width=x),M>e.height&&(e.height=M),[x,M]}}]),t}();e.Layout=d,d.DIV_ELEMENT_PADDING=0,c.ClassUtils.regClass("laya.html.utils.Layout",d),c.ClassUtils.regClass("Laya.Layout",d)},93891:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.LayoutLine=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(89364),l=i(17661),u=i(23835),h=function(){function t(){(0,r.default)(this,t),this.elements=[],this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0}return(0,s.default)(t,[{key:"updatePos",value:function(t,e,i,n,a,r,s){var u,h=0;this.elements.length>0&&(h=(u=this.elements[this.elements.length-1]).x+u.width-this.elements[0].x),s=s||this.h;var c,d=0;a===o.HTMLStyle.ALIGN_CENTER&&(d=(e-h)/2),a===o.HTMLStyle.ALIGN_RIGHT&&(d=e-h);for(var f=0,_=this.elements.length;f<_;f++){var v=(u=this.elements[f])._getCSSStyle();switch(0!==d&&(u.x+=d),v.valign){case"top":u.y=n;break;case"middle":var y=0;99999!=this.minTextHeight&&(y=this.minTextHeight);var p=(y+s)/2;p=Math.max(p,this.h),c=(u.eletype,l.IHtml.HTMLElementType.IMAGE,n+p-u.height),u.y=c;break;case"bottom":u.y=n+(s-u.height)}}}}]),t}();e.LayoutLine=h,u.ClassUtils.regClass("laya.html.utils.LayoutLine",h),u.ClassUtils.regClass("Laya.LayoutLine",h)},33873:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.LayaGL=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.LayaGL=s,s.ARRAY_BUFFER_TYPE_DATA=0,s.ARRAY_BUFFER_TYPE_CMD=1,s.ARRAY_BUFFER_REF_REFERENCE=0,s.ARRAY_BUFFER_REF_COPY=1,s.UPLOAD_SHADER_UNIFORM_TYPE_ID=0,s.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1},93062:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Bezier=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(85399),l=function(){function t(){(0,r.default)(this,t),this._controlPoints=[new o.Point,new o.Point,new o.Point],this._calFun=this.getPoint2}return(0,s.default)(t,[{key:"_switchPoint",value:function(t,e){var i=this._controlPoints.shift();i.setTo(t,e),this._controlPoints.push(i)}},{key:"getPoint2",value:function(t,e){var i=this._controlPoints[0],n=this._controlPoints[1],a=this._controlPoints[2],r=Math.pow(1-t,2)*i.x+2*t*(1-t)*n.x+Math.pow(t,2)*a.x,s=Math.pow(1-t,2)*i.y+2*t*(1-t)*n.y+Math.pow(t,2)*a.y;e.push(r,s)}},{key:"getPoint3",value:function(t,e){var i=this._controlPoints[0],n=this._controlPoints[1],a=this._controlPoints[2],r=this._controlPoints[3],s=Math.pow(1-t,3)*i.x+3*n.x*t*(1-t)*(1-t)+3*a.x*t*t*(1-t)+r.x*Math.pow(t,3),o=Math.pow(1-t,3)*i.y+3*n.y*t*(1-t)*(1-t)+3*a.y*t*t*(1-t)+r.y*Math.pow(t,3);e.push(s,o)}},{key:"insertPoints",value:function(t,e){var i,n;for(n=1/(t=t>0?t:5),i=0;i<=1;i+=n)this._calFun(i,e)}},{key:"getBezierPoints",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if((i=t.length)<2*(a+1))return[];var r=[];switch(a){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=a;)this._controlPoints.push(o.Point.create());for(e=0;e<2*a;e+=2)this._switchPoint(t[e],t[e+1]);for(e=2*a;e<i;e+=2)this._switchPoint(t[e],t[e+1]),e/2%a==0&&this.insertPoints(n,r);return r}}]),t}();e.Bezier=l,l.I=new l},9686:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.GrahamScan=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(85399),l=i(56083),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"multiply",value:function(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)}},{key:"dis",value:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}},{key:"_getPoints",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(t._mPointList||(t._mPointList=[]);t._mPointList.length<e;)t._mPointList.push(new o.Point);return n||(n=[]),n.length=0,i?t.getFrom(n,t._mPointList,e):t.getFromR(n,t._mPointList,e),n}},{key:"getFrom",value:function(t,e,i){var n;for(n=0;n<i;n++)t.push(e[n]);return t}},{key:"getFromR",value:function(t,e,i){var n;for(n=0;n<i;n++)t.push(e.pop());return t}},{key:"pListToPointList",value:function(e){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.length/2,r=t._getPoints(a,n,t._tempPointList);for(i=0;i<a;i++)r[i].setTo(e[i+i],e[i+i+1]);return r}},{key:"pointListToPlist",value:function(e){var i,n,a=e.length,r=t._temPList;for(r.length=0,i=0;i<a;i++)n=e[i],r.push(n.x,n.y);return r}},{key:"scanPList",value:function(e){return l.Utils.copyArray(e,t.pointListToPlist(t.scan(t.pListToPointList(e,!0))))}},{key:"scan",value:function(e){var i,n,a,r,s,o=0,u=e.length,h={};for((r=t._temArr).length=0,i=(u=e.length)-1;i>=0;i--)(s=(a=e[i]).x+"_"+a.y)in h||(h[s]=!0,r.push(a));for(u=r.length,l.Utils.copyArray(e,r),i=1;i<u;i++)(e[i].y<e[o].y||e[i].y==e[o].y&&e[i].x<e[o].x)&&(o=i);for(a=e[0],e[0]=e[o],e[o]=a,i=1;i<u-1;i++){for(o=i,n=i+1;n<u;n++)(t.multiply(e[n],e[o],e[0])>0||0==t.multiply(e[n],e[o],e[0])&&t.dis(e[0],e[n])<t.dis(e[0],e[o]))&&(o=n);a=e[i],e[i]=e[o],e[o]=a}if((r=t._temArr).length=0,e.length<3)return l.Utils.copyArray(r,e);for(r.push(e[0],e[1],e[2]),i=3;i<u;i++){for(;r.length>=2&&t.multiply(e[i],r[r.length-1],r[r.length-2])>=0;)r.pop();e[i]&&r.push(e[i])}return r}}]),t}();e.GrahamScan=u,u._tempPointList=[],u._temPList=[],u._temArr=[]},64968:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.MathUtil=void 0;var r=a(i(31238)),s=a(i(15375)),o=a(i(17061)),l=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"subtractVector3",value:function(t,e,i){i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2]}},{key:"lerp",value:function(t,e,i){return t*(1-i)+e*i}},{key:"scaleVector3",value:function(t,e,i){i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e}},{key:"lerpVector3",value:function(t,e,i,n){var a=t[0],r=t[1],s=t[2];n[0]=a+i*(e[0]-a),n[1]=r+i*(e[1]-r),n[2]=s+i*(e[2]-s)}},{key:"lerpVector4",value:function(t,e,i,n){var a=t[0],r=t[1],s=t[2],o=t[3];n[0]=a+i*(e[0]-a),n[1]=r+i*(e[1]-r),n[2]=s+i*(e[2]-s),n[3]=o+i*(e[3]-o)}},{key:"slerpQuaternionArray",value:function(t,e,i,n,a,r,s){var o,l,u,h,c,d=t[e+0],f=t[e+1],_=t[e+2],v=t[e+3],y=i[n+0],p=i[n+1],g=i[n+2],m=i[n+3];return(l=d*y+f*p+_*g+v*m)<0&&(l=-l,y=-y,p=-p,g=-g,m=-m),1-l>1e-6?(o=Math.acos(l),u=Math.sin(o),h=Math.sin((1-a)*o)/u,c=Math.sin(a*o)/u):(h=1-a,c=a),r[s+0]=h*d+c*y,r[s+1]=h*f+c*p,r[s+2]=h*_+c*g,r[s+3]=h*v+c*m,r}},{key:"getRotation",value:function(t,e,i,n){return Math.atan2(n-e,i-t)/Math.PI*180}},{key:"sortBigFirst",value:function(t,e){return t==e?0:e>t?1:-1}},{key:"sortSmallFirst",value:function(t,e){return t==e?0:e>t?-1:1}},{key:"sortNumBigFirst",value:function(t,e){return(0,r.default)(e)-(0,r.default)(t)}},{key:"sortNumSmallFirst",value:function(t,e){return(0,r.default)(t)-(0,r.default)(e)}},{key:"sortByKey",value:function(e){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i=n?a?t.sortNumBigFirst:t.sortBigFirst:a?t.sortNumSmallFirst:t.sortSmallFirst,function(t,n){return i(t[e],n[e])}}}]),t}();e.MathUtil=l},18008:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Matrix=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if((0,r.default)(this,t),this._bTransform=!1,null!=t._createFun)return t._createFun(e,i,n,a,s,o,l);this.a=e,this.b=i,this.c=n,this.d=a,this.tx=s,this.ty=o,this._checkTransform()}return(0,s.default)(t,[{key:"identity",value:function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this._bTransform=!1,this}},{key:"_checkTransform",value:function(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d}},{key:"setTranslate",value:function(t,e){return this.tx=t,this.ty=e,this}},{key:"translate",value:function(t,e){return this.tx+=t,this.ty+=e,this}},{key:"scale",value:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this._bTransform=!0,this}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,a=this.c,r=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=a*e-this.d*i,this.d=a*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this._bTransform=!0,this}},{key:"skew",value:function(t,e){var i=Math.tan(t),n=Math.tan(e),a=this.a,r=this.b;return this.a+=n*this.c,this.b+=n*this.d,this.c+=i*a,this.d+=i*r,this}},{key:"invertTransformPoint",value:function(t){var e=this.a,i=this.b,n=this.c,a=this.d,r=this.tx,s=e*a-i*n,o=a/s,l=-i/s,u=-n/s,h=e/s,c=(n*this.ty-a*r)/s,d=-(e*this.ty-i*r)/s;return t.setTo(o*t.x+u*t.y+c,l*t.x+h*t.y+d)}},{key:"transformPoint",value:function(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)}},{key:"transformPointN",value:function(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)}},{key:"getScaleX",value:function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)}},{key:"getScaleY",value:function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)}},{key:"invert",value:function(){var t=this.a,e=this.b,i=this.c,n=this.d,a=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*a)/r,this.ty=-(t*this.ty-e*a)/r,this}},{key:"setTo",value:function(t,e,i,n,a,r){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=a,this.ty=r,this}},{key:"concat",value:function(t){var e=this.a,i=this.c,n=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d,this.tx=n*t.a+this.ty*t.c+t.tx,this.ty=n*t.b+this.ty*t.d+t.ty,this}},{key:"scaleEx",value:function(t,e){var i=this.a,n=this.b,a=this.c,r=this.d;0!==n||0!==a?(this.a=t*i,this.b=t*n,this.c=e*a,this.d=e*r):(this.a=t*i,this.b=0*r,this.c=0*i,this.d=e*r),this._bTransform=!0}},{key:"rotateEx",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,a=this.b,r=this.c,s=this.d;0!==a||0!==r?(this.a=e*n+i*r,this.b=e*a+i*s,this.c=-i*n+e*r,this.d=-i*a+e*s):(this.a=e*n,this.b=i*s,this.c=-i*n,this.d=e*s),this._bTransform=!0}},{key:"clone",value:function(){var e=t.create();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e._bTransform=this._bTransform,e}},{key:"copyTo",value:function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t._bTransform=this._bTransform,t}},{key:"toString",value:function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty}},{key:"destroy",value:function(){this.recover()}},{key:"recover",value:function(){o.Pool.recover("Matrix",this.identity())}}],[{key:"mul",value:function(t,e,i){var n=t.a,a=t.b,r=t.c,s=t.d,o=t.tx,l=t.ty,u=e.a,h=e.b,c=e.c,d=e.d,f=e.tx,_=e.ty;return 0!==h||0!==c?(i.a=n*u+a*c,i.b=n*h+a*d,i.c=r*u+s*c,i.d=r*h+s*d,i.tx=u*o+c*l+f,i.ty=h*o+d*l+_):(i.a=n*u,i.b=a*d,i.c=r*u,i.d=s*d,i.tx=u*o+f,i.ty=d*l+_),i}},{key:"mul16",value:function(t,e,i){var n=t.a,a=t.b,r=t.c,s=t.d,o=t.tx,l=t.ty,u=e.a,h=e.b,c=e.c,d=e.d,f=e.tx,_=e.ty;return 0!==h||0!==c?(i[0]=n*u+a*c,i[1]=n*h+a*d,i[4]=r*u+s*c,i[5]=r*h+s*d,i[12]=u*o+c*l+f,i[13]=h*o+d*l+_):(i[0]=n*u,i[1]=a*d,i[4]=r*u,i[5]=s*d,i[12]=u*o+f,i[13]=d*l+_),i}},{key:"create",value:function(){return o.Pool.getItemByClass("Matrix",t)}}]),t}();e.Matrix=l,l.EMPTY=new l,l.TEMP=new l,l._createFun=null},85399:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Point=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,r.default)(this,t),this.x=e,this.y=i}return(0,s.default)(t,[{key:"setTo",value:function(t,e){return this.x=t,this.y=e,this}},{key:"reset",value:function(){return this.x=this.y=0,this}},{key:"recover",value:function(){o.Pool.recover("Point",this.reset())}},{key:"distance",value:function(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))}},{key:"toString",value:function(){return this.x+","+this.y}},{key:"normalize",value:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e,this.y*=e}}},{key:"copy",value:function(t){return this.setTo(t.x,t.y)}}],[{key:"create",value:function(){return o.Pool.getItemByClass("Point",t)}}]),t}();e.Point=l,l.TEMP=new l,l.EMPTY=new l},98693:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Rectangle=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=i(85399),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.default)(this,t),this.x=e,this.y=i,this.width=n,this.height=a}return(0,s.default)(t,[{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"setTo",value:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this}},{key:"recover",value:function(){this!=t.TEMP&&this!=t.EMPTY?o.Pool.recover("Rectangle",this.reset()):console.log("recover Temp or Empty:",this)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.right&&e>=this.y&&e<this.bottom)}},{key:"intersects",value:function(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)}},{key:"intersection",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.intersects(e)?(i||(i=new t),i.x=Math.max(this.x,e.x),i.y=Math.max(this.y,e.y),i.width=Math.min(this.right,e.right)-i.x,i.height=Math.min(this.bottom,e.bottom)-i.y,i):null}},{key:"union",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i||(i=new t),this.clone(i),e.width<=0||e.height<=0?i:(i.addPoint(e.x,e.y),i.addPoint(e.right,e.bottom),this)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=new t),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}},{key:"toString",value:function(){return this.x+","+this.y+","+this.width+","+this.height}},{key:"equals",value:function(t){return!(!t||t.x!==this.x||t.y!==this.y||t.width!==this.width||t.height!==this.height)}},{key:"addPoint",value:function(t,e){return this.x>t&&(this.width+=this.x-t,this.x=t),this.y>e&&(this.height+=this.y-e,this.y=e),this.width<t-this.x&&(this.width=t-this.x),this.height<e-this.y&&(this.height=e-this.y),this}},{key:"_getBoundPoints",value:function(){var e=t._temB;return e.length=0,0==this.width||0==this.height||e.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),e}},{key:"isEmpty",value:function(){return this.width<=0||this.height<=0}}],[{key:"create",value:function(){return o.Pool.getItemByClass("Rectangle",t)}},{key:"_getBoundPointS",value:function(e,i,n,a){var r=t._temA;return r.length=0,0==n||0==a||r.push(e,i,e+n,i,e,i+a,e+n,i+a),r}},{key:"_getWrapRec",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||e.length<1)return i?i.setTo(0,0,0,0):t.TEMP.setTo(0,0,0,0);i=i||t.create();var n,a,r,s,o,u=e.length,h=l.Point.TEMP;for(r=o=-(a=s=99999),n=0;n<u;n+=2)h.x=e[n],h.y=e[n+1],a=a<h.x?a:h.x,s=s<h.y?s:h.y,r=r>h.x?r:h.x,o=o>h.y?o:h.y;return i.setTo(a,s,r-a,o-s)}}]),t}();e.Rectangle=u,u.EMPTY=new u,u.TEMP=new u,u._temB=[],u._temA=[]},96088:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.SoundChannel=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305));function c(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var d=function(t){(0,l.default)(i,t);var e=c(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments)).isStopped=!1,t}return(0,o.default)(i,[{key:"volume",get:function(){return 1},set:function(t){}},{key:"position",get:function(){return 0}},{key:"duration",get:function(){return 0}},{key:"play",value:function(){}},{key:"stop",value:function(){this.completeHandler&&this.completeHandler.runWith(!1)}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"__runComplete",value:function(t){t&&t.runWith(!0)}}]),i}(i(48856).EventDispatcher);e.SoundChannel=d},17886:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SoundManager=void 0;var r=a(i(81643)),s=a(i(92762)),o=a(i(15375)),l=a(i(17061)),u=i(89662),h=i(16313),c=i(30690),d=i(84935),f=i(56083),_=i(92493),v=i(93568),y=function(){function t(){(0,o.default)(this,t)}return(0,l.default)(t,null,[{key:"__init__",value:function(){var e=_.ILaya.Browser.window,i=!!(e.AudioContext||e.webkitAudioContext||e.mozAudioContext);return i&&c.WebAudioSound.initWebAudio(),t._soundClass=i?c.WebAudioSound:h.AudioSound,v.Browser.onTBMiniGame||h.AudioSound._initMusicAudio(),t._musicClass=h.AudioSound,i}},{key:"addChannel",value:function(e){var i;(0,r.default)(i=t._channels).call(i,e)>=0||t._channels.push(e)}},{key:"removeChannel",value:function(e){var i;for(i=t._channels.length-1;i>=0;i--){var n;if(t._channels[i]==e)(0,s.default)(n=t._channels).call(n,i,1)}}},{key:"disposeSoundLater",value:function(e){t._lastSoundUsedTimeDic[e]=_.ILaya.Browser.now(),t._isCheckingDispose||(t._isCheckingDispose=!0,_.ILaya.timer.loop(5e3,null,t._checkDisposeSound))}},{key:"_checkDisposeSound",value:function(){var e,i=_.ILaya.Browser.now(),n=!1;for(e in t._lastSoundUsedTimeDic)i-t._lastSoundUsedTimeDic[e]>3e4?(delete t._lastSoundUsedTimeDic[e],t.disposeSoundIfNotUsed(e)):n=!0;n||(t._isCheckingDispose=!1,_.ILaya.timer.clear(null,t._checkDisposeSound))}},{key:"disposeSoundIfNotUsed",value:function(e){var i;for(i=t._channels.length-1;i>=0;i--)if(t._channels[i].url==e)return;t.destroySound(e)}},{key:"autoStopMusic",get:function(){return t._autoStopMusic},set:function(e){_.ILaya.stage.off(u.Event.BLUR,null,t._stageOnBlur),_.ILaya.stage.off(u.Event.FOCUS,null,t._stageOnFocus),_.ILaya.stage.off(u.Event.VISIBILITY_CHANGE,null,t._visibilityChange),t._autoStopMusic=e,e&&(_.ILaya.stage.on(u.Event.BLUR,null,t._stageOnBlur),_.ILaya.stage.on(u.Event.FOCUS,null,t._stageOnFocus),_.ILaya.stage.on(u.Event.VISIBILITY_CHANGE,null,t._visibilityChange))}},{key:"_visibilityChange",value:function(){_.ILaya.stage.isVisibility?t._stageOnFocus():t._stageOnBlur()}},{key:"_stageOnBlur",value:function(){t._isActive=!1,t._musicChannel&&(t._musicChannel.isStopped||(t._blurPaused=!0,t._musicChannel.pause())),t.stopAllSound(),_.ILaya.stage.once(u.Event.MOUSE_DOWN,null,t._stageOnFocus)}},{key:"_recoverWebAudio",value:function(){c.WebAudioSound.ctx&&"running"!=c.WebAudioSound.ctx.state&&c.WebAudioSound.ctx.resume&&c.WebAudioSound.ctx.resume()}},{key:"_stageOnFocus",value:function(){t._isActive=!0,t._recoverWebAudio(),_.ILaya.stage.off(u.Event.MOUSE_DOWN,null,t._stageOnFocus),t._blurPaused&&t._musicChannel&&t._musicChannel.isStopped&&(t._blurPaused=!1,t._musicChannel.resume())}},{key:"muted",get:function(){return t._muted},set:function(e){e!=t._muted&&(e&&t.stopAllSound(),t.musicMuted=e,t._muted=e)}},{key:"soundMuted",get:function(){return t._soundMuted},set:function(e){t._soundMuted=e}},{key:"musicMuted",get:function(){return t._musicMuted},set:function(e){e!=t._musicMuted&&(e?(t._bgMusic&&t._musicChannel&&!t._musicChannel.isStopped?_.ILaya.Render.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!0):t._musicChannel.pause():t._musicChannel=null,t._musicMuted=e):(t._musicMuted=e,t._bgMusic&&t._musicChannel&&(_.ILaya.Render.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!1):t._musicChannel.resume())))}},{key:"useAudioMusic",get:function(){return t._useAudioMusic},set:function(e){t._useAudioMusic=e,t._musicClass=e?h.AudioSound:null}},{key:"playSound",value:function(e){var i,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!t._isActive||!e)return null;if(t._muted)return null;if(t._recoverWebAudio(),(e=d.URL.formatURL(e))==t._bgMusic){if(t._musicMuted)return null}else{if(_.ILaya.Render.isConchApp){var l=f.Utils.getFileExtension(e);if("wav"!=l&&"ogg"!=l)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(t._soundMuted)return null}return v.Browser._isMiniGame||(i=_.ILaya.loader.getRes(e)),s||(s=t._soundClass),i||((i=new s).load(e),v.Browser._isMiniGame||_.ILaya.Loader.cacheRes(e,i)),(n=i.play(o,a))?(n.url=e,n.volume=e==t._bgMusic?t.musicVolume:t.soundVolume,n.completeHandler=r,n):null}},{key:"destroySound",value:function(t){var e=_.ILaya.loader.getRes(t);e&&(_.ILaya.Loader.clearRes(t),e.dispose())}},{key:"playMusic",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e=d.URL.formatURL(e),t._bgMusic=e,t._musicChannel&&t._musicChannel.stop(),t._musicChannel=t.playSound(e,i,n,t._musicClass,a)}},{key:"stopSound",value:function(e){var i,n;for(e=d.URL.formatURL(e),i=t._channels.length-1;i>=0;i--)(n=t._channels[i]).url==e&&n.stop()}},{key:"stopAll",value:function(){var e;for(t._bgMusic=null,e=t._channels.length-1;e>=0;e--)t._channels[e].stop()}},{key:"stopAllSound",value:function(){var e,i;for(e=t._channels.length-1;e>=0;e--)(i=t._channels[e]).url!=t._bgMusic&&i.stop()}},{key:"stopMusic",value:function(){t._musicChannel&&t._musicChannel.stop(),t._bgMusic=null}},{key:"setSoundVolume",value:function(e){var i,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(a)a=d.URL.formatURL(a),t._setVolume(a,e);else for(t.soundVolume=e,i=t._channels.length-1;i>=0;i--)(n=t._channels[i]).url!=t._bgMusic&&(n.volume=e)}},{key:"setMusicVolume",value:function(e){t.musicVolume=e,t._setVolume(t._bgMusic,e)}},{key:"_setVolume",value:function(e,i){var n,a;for(e=d.URL.formatURL(e),n=t._channels.length-1;n>=0;n--)(a=t._channels[n]).url==e&&(a.volume=i)}}]),t}();e.SoundManager=y,y.musicVolume=1,y.soundVolume=1,y.playbackRate=1,y._useAudioMusic=!0,y._muted=!1,y._soundMuted=!1,y._musicMuted=!1,y._bgMusic=null,y._musicChannel=null,y._channels=[],y._blurPaused=!1,y._isActive=!0,y._lastSoundUsedTimeDic={},y._isCheckingDispose=!1,y.autoReleaseSound=!0},16313:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.AudioSound=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(31111),d=i(89662),f=i(48856),_=i(84935),v=i(85136),y=i(93568),p=i(64210),g=i(92493);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var x=function(t){(0,l.default)(i,t);var e=m(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments)).loaded=!1,t}return(0,o.default)(i,[{key:"dispose",value:function(){var t=i._audioCache[this.url];p.Pool.clearBySign("audio:"+this.url),t&&(v.Render.isConchApp||(t.src=""),delete i._audioCache[this.url])}},{key:"load",value:function(t){var e;if(t=_.URL.formatURL(t),this.url=t,t==g.ILaya.SoundManager._bgMusic?(i._initMusicAudio(),(e=i._musicAudio).src!=t&&(delete i._audioCache[e.src],e=null)):e=i._audioCache[t],e&&e.readyState>=2)this.event(d.Event.COMPLETE);else{e||(t==g.ILaya.SoundManager._bgMusic?(i._initMusicAudio(),e=i._musicAudio):e=y.Browser.createElement("audio"),i._audioCache[t]=e,e.src=t),e.addEventListener("canplaythrough",a),e.addEventListener("error",r);var n=this;this.audio=e,e.load?e.load():r()}function a(){s(),n.loaded=!0,n.event(d.Event.COMPLETE)}function r(){e.load=null,s(),n.event(d.Event.ERROR)}function s(){e.removeEventListener("canplaythrough",a),e.removeEventListener("error",r)}}},{key:"play",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.url)return null;if(this.url==g.ILaya.SoundManager._bgMusic?""!=(t=i._musicAudio).src&&t.src!=this.url&&(delete i._audioCache[t.src],i._audioCache[this.url]=t):t=i._audioCache[this.url],!t)return null;e=p.Pool.getItem("audio:"+this.url),v.Render.isConchApp?e||((e=y.Browser.createElement("audio")).src=this.url):this.url==g.ILaya.SoundManager._bgMusic?(i._initMusicAudio(),(e=i._musicAudio).src=this.url):e=e||t.cloneNode(!0);var r=new c.AudioSoundChannel(e);return r.url=this.url,r.loops=a,r.startTime=n,r.play(),g.ILaya.SoundManager.addChannel(r),r}},{key:"duration",get:function(){var t;return(t=i._audioCache[this.url])?t.duration:0}}],[{key:"_initMusicAudio",value:function(){i._musicAudio||(i._musicAudio||(i._musicAudio=y.Browser.createElement("audio")),v.Render.isConchApp||y.Browser.document.addEventListener("mousedown",i._makeMusicOK))}},{key:"_makeMusicOK",value:function(){y.Browser.document.removeEventListener("mousedown",i._makeMusicOK),i._musicAudio.src?i._musicAudio.play():(i._musicAudio.src="",i._musicAudio.load())}}]),i}(f.EventDispatcher);e.AudioSound=x,x._audioCache={}},31111:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.AudioSoundChannel=void 0;var s=r(i(54103)),o=r(i(15375)),l=r(i(17061)),u=r(i(89395)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(89662),v=i(96088),y=i(93568),p=i(92493);function g(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var m=function(t){(0,c.default)(i,t);var e=g(i);function i(t){var n,a,r;return(0,o.default)(this,i),(r=e.call(this))._audio=null,r._onEnd=(0,s.default)(n=r.__onEnd).call(n,(0,u.default)(r)),r._resumePlay=(0,s.default)(a=r.__resumePlay).call(a,(0,u.default)(r)),t.addEventListener("ended",r._onEnd),r._audio=t,r}return(0,l.default)(i,[{key:"__onEnd",value:function(t){if(1==this.loops)return this.completeHandler&&(p.ILaya.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(_.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}},{key:"__resumePlay",value:function(){if(this._audio&&this._audio.removeEventListener("canplay",this._resumePlay),!this.isStopped)try{this._audio.currentTime=this.startTime,y.Browser.container.appendChild(this._audio),this._audio.play()}catch(t){this.event(_.Event.ERROR)}}},{key:"play",value:function(){this.isStopped=!1;try{this._audio.playbackRate=p.ILaya.SoundManager.playbackRate,this._audio.currentTime=this.startTime}catch(t){return void this._audio.addEventListener("canplay",this._resumePlay)}p.ILaya.SoundManager.addChannel(this),y.Browser.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()}},{key:"position",get:function(){return this._audio?this._audio.currentTime:0}},{key:"duration",get:function(){return this._audio?this._audio.duration:0}},{key:"stop",value:function(){(0,h.default)((0,f.default)(i.prototype),"stop",this).call(this),this.isStopped=!0,p.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&p.ILaya.Render.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),p.ILaya.Browser.onIE||this._audio!=p.ILaya.AudioSound._musicAudio&&p.ILaya.Pool.recover("audio:"+this.url,this._audio),y.Browser.removeElement(this._audio),this._audio=null,p.ILaya.SoundManager.autoReleaseSound&&p.ILaya.SoundManager.disposeSoundLater(this.url))}},{key:"pause",value:function(){this.isStopped=!0,p.ILaya.SoundManager.removeChannel(this),this._audio&&("pause"in this._audio&&this._audio.pause(),p.ILaya.SoundManager.autoReleaseSound&&p.ILaya.SoundManager.disposeSoundLater(this.url))}},{key:"resume",value:function(){var t=this._audio;t&&(this.isStopped=!1,0==t.readyState&&(t.src=this.url,t.addEventListener("canplay",this._resumePlay),t.load&&t.load()),p.ILaya.SoundManager.addChannel(this),"play"in t&&t.play())}},{key:"volume",get:function(){return this._audio?this._audio.volume:1},set:function(t){this._audio&&(this._audio.volume=t)}}]),i}(v.SoundChannel);e.AudioSoundChannel=m},30690:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.WebAudioSound=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(96250),d=i(89662),f=i(48856),_=i(84935),v=i(92493);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var p=function(t){(0,l.default)(i,t);var e=y(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments)).loaded=!1,t._disposed=!1,t}return(0,o.default)(i,[{key:"load",value:function(t){var e=this;if(t=_.URL.formatURL(t),this.url=t,this.audioBuffer=i._dataCache[t],this.audioBuffer)this._loaded(this.audioBuffer);else if(i.e.on("loaded:"+t,this,this._loaded),i.e.on("err:"+t,this,this._err),!i.__loadingSound[t]){i.__loadingSound[t]=!0;var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){e._disposed?e._removeLoadEvents():(e.data=n.response,i.buffs.push({buffer:e.data,url:e.url}),i.decode())},n.onerror=function(t){e._err()},n.send()}}},{key:"_err",value:function(){this._removeLoadEvents(),i.__loadingSound[this.url]=!1,this.event(d.Event.ERROR)}},{key:"_loaded",value:function(t){this._removeLoadEvents(),this._disposed||(this.audioBuffer=t,i._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event(d.Event.COMPLETE))}},{key:"_removeLoadEvents",value:function(){i.e.off("loaded:"+this.url,this,this._loaded),i.e.off("err:"+this.url,this,this._err)}},{key:"__playAfterLoaded",value:function(){if(this.__toPlays){var t,e,i,n;for(e=(i=this.__toPlays).length,t=0;t<e;t++)(n=i[t])[2]&&!n[2].isStopped&&this.play(n[0],n[1],n[2]);this.__toPlays.length=0}}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return i=i||new c.WebAudioSoundChannel,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([t,e,i]),this.once(d.Event.COMPLETE,this,this.__playAfterLoaded),this.load(this.url)),i.url=this.url,i.loops=e,i.audioBuffer=this.audioBuffer,i.startTime=t,i.play(),v.ILaya.SoundManager.addChannel(i),i}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"dispose",value:function(){this._disposed=!0,delete i._dataCache[this.url],delete i.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]}}],[{key:"decode",value:function(){i.buffs.length<=0||i.isDecoding||(i.isDecoding=!0,i.tInfo=i.buffs.shift(),i.ctx.decodeAudioData(i.tInfo.buffer,i._done,i._fail))}},{key:"_done",value:function(t){i.e.event("loaded:"+i.tInfo.url,t),i.isDecoding=!1,i.decode()}},{key:"_fail",value:function(){i.e.event("err:"+i.tInfo.url,null),i.isDecoding=!1,i.decode()}},{key:"_playEmptySound",value:function(){if(null!=i.ctx){var t=i.ctx.createBufferSource();t.buffer=i._miniBuffer,t.connect(i.ctx.destination),t.start(0,0,0)}}},{key:"_unlock",value:function(){i._unlocked||(i._playEmptySound(),"running"==i.ctx.state&&(window.document.removeEventListener("mousedown",i._unlock,!0),window.document.removeEventListener("touchend",i._unlock,!0),window.document.removeEventListener("touchstart",i._unlock,!0),i._unlocked=!0))}},{key:"initWebAudio",value:function(){"running"!=i.ctx.state&&(i._unlock(),window.document.addEventListener("mousedown",i._unlock,!0),window.document.addEventListener("touchend",i._unlock,!0),window.document.addEventListener("touchstart",i._unlock,!0))}}]),i}(f.EventDispatcher);e.WebAudioSound=p,p._dataCache={},p.webAudioEnabled=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,p.ctx=p.webAudioEnabled?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0,p.buffs=[],p.isDecoding=!1,p._miniBuffer=p.ctx?p.ctx.createBuffer(1,1,22050):void 0,p.e=new f.EventDispatcher,p._unlocked=!1,p.__loadingSound={}},96250:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.WebAudioSoundChannel=void 0;var s=r(i(54103)),o=r(i(15375)),l=r(i(17061)),u=r(i(89395)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(89662),v=i(96088),y=i(93568),p=i(56083),g=i(92493);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var x=function(t){(0,c.default)(i,t);var e=m(i);function i(){var t;return(0,o.default)(this,i),(t=e.call(this)).bufferSource=null,t._currentTime=0,t._volume=1,t._startTime=0,t._pauseTime=0,t.context=g.ILaya.WebAudioSound.ctx,t._onPlayEnd=(0,s.default)(p.Utils).call(p.Utils,t.__onPlayEnd,(0,u.default)(t)),t.context.createGain?t.gain=t.context.createGain():t.gain=t.context.createGainNode(),t}return(0,l.default)(i,[{key:"play",value:function(){if(g.ILaya.SoundManager.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){if(this.startTime>=this.duration)return this.stop();var t=this.context,e=this.gain,n=t.createBufferSource();this.bufferSource=n,n.buffer=this.audioBuffer,n.connect(e),e&&e.disconnect(),e.connect(t.destination),n.onended=this._onPlayEnd,this._startTime=y.Browser.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,i.SetTargetDelay):this.gain.gain.value=this._volume,0==this.loops&&(n.loop=!0),n.playbackRate.setTargetAtTime?n.playbackRate.setTargetAtTime(g.ILaya.SoundManager.playbackRate,this.context.currentTime,i.SetTargetDelay):n.playbackRate.value=g.ILaya.SoundManager.playbackRate,n.start(0,this.startTime),this._currentTime=0}}},{key:"__onPlayEnd",value:function(){if(1==this.loops)return this.completeHandler&&(g.ILaya.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(_.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}},{key:"position",get:function(){return this.bufferSource?(y.Browser.now()-this._startTime)/1e3+this.startTime:0}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"_clearBufferSource",value:function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.disconnect(0),t.onended=null,i._tryCleanFailed||this._tryClearBuffer(t),this.bufferSource=null}}},{key:"_tryClearBuffer",value:function(t){try{t.buffer=null}catch(t){i._tryCleanFailed=!0}}},{key:"stop",value:function(){(0,h.default)((0,f.default)(i.prototype),"stop",this).call(this),this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,g.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,g.ILaya.SoundManager.autoReleaseSound&&g.ILaya.SoundManager.disposeSoundLater(this.url)}},{key:"pause",value:function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,g.ILaya.SoundManager.removeChannel(this),g.ILaya.SoundManager.autoReleaseSound&&g.ILaya.SoundManager.disposeSoundLater(this.url)}},{key:"resume",value:function(){this.startTime=this._pauseTime,this.play()}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t,this.isStopped||(this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(t,this.context.currentTime,i.SetTargetDelay):this.gain.gain.value=t)}}]),i}(v.SoundChannel);e.WebAudioSoundChannel=x,x._tryCleanFailed=!1,x.SetTargetDelay=.001},68291:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AtlasInfoManager=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(41107),l=i(92493),u=i(85096),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"enable",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l.ILaya.loader.load(e,o.Handler.create(null,t._onInfoLoaded,[i]),null,u.Loader.JSON)}},{key:"_onInfoLoaded",value:function(e,i){var n,a,r,s,o;for(n in i)for(a=(r=i[n])[0],o=(r=r[1]).length,s=0;s<o;s++)t._fileLoadDic[a+r[s]]=n;e&&e.run()}},{key:"getFileLoadPath",value:function(e){return t._fileLoadDic[e]||e}}]),t}();e.AtlasInfoManager=h,h._fileLoadDic={}},46785:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HttpRequest=void 0;var s=r(i(59340)),o=r(i(15375)),l=r(i(17061)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(89662),f=i(48856),_=i(56083),v=i(93568);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var p=function(t){(0,u.default)(i,t);var e=y(i);function i(){var t;return(0,o.default)(this,i),(t=e.apply(this,arguments))._http=new XMLHttpRequest,t}return(0,l.default)(i,[{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._responseType=a,this._data=null,(v.Browser.onVVMiniGame||v.Browser.onQGMiniGame||v.Browser.onQQMiniGame||v.Browser.onAlipayMiniGame||v.Browser.onBLMiniGame||v.Browser.onHWMiniGame||v.Browser.onTTMiniGame||v.Browser.onTBMiniGame)&&(t=i._urlEncode(t)),this._url=t;var o=this,l=this._http;l.open(n,t,!0);var u=!1;if(r)for(var h=0;h<r.length;h++)l.setRequestHeader(r[h++],r[h]);else window.conch||(e&&"string"!=typeof e?(l.setRequestHeader("Content-Type","application/json"),e instanceof ArrayBuffer||"string"==typeof e||(u=!0)):l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var c="arraybuffer"!==a?"text":"arraybuffer";l.responseType=c,l.dataType&&(l.dataType=c),l.onerror=function(t){o._onError(t)},l.onabort=function(t){o._onAbort(t)},l.onprogress=function(t){o._onProgress(t)},l.onload=function(t){o._onLoad(t)},v.Browser.onBLMiniGame&&v.Browser.onAndroid&&!e&&(e={}),l.send(u?(0,s.default)(e):e)}},{key:"_onProgress",value:function(t){t&&t.lengthComputable&&this.event(d.Event.PROGRESS,t.loaded/t.total)}},{key:"_onAbort",value:function(t){this.error("Request was aborted by user")}},{key:"_onError",value:function(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}},{key:"_onLoad",value:function(t){var e=this._http,i=void 0!==e.status?e.status:200;200===i||204===i||0===i?this.complete():this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}},{key:"error",value:function(t){this.clear(),console.warn(this.url,t),this.event(d.Event.ERROR,t)}},{key:"complete",value:function(){this.clear();var t=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=_.Utils.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(e){t=!1,this.error(e.message)}t&&this.event(d.Event.COMPLETE,this._data instanceof Array?[this._data]:this._data)}},{key:"clear",value:function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}},{key:"url",get:function(){return this._url}},{key:"data",get:function(){return this._data}},{key:"http",get:function(){return this._http}}]),i}(f.EventDispatcher);e.HttpRequest=p,p._urlEncode=encodeURI},85096:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Loader=void 0;var s=r(i(81643)),o=r(i(23054)),l=r(i(97093)),u=r(i(31238)),h=r(i(78914)),c=r(i(15375)),d=r(i(17061)),f=r(i(97709)),_=r(i(38191)),v=r(i(52305)),y=i(92493),p=i(72643),g=i(81870),m=i(89662),x=i(48856),T=i(17886),k=i(54598),C=i(87035),S=i(93568),E=i(14002),M=i(41107),L=i(56083),b=i(60397),I=i(46785),R=i(84935),w=i(73972),A=i(69176);function B(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,v.default)(t);if(e){var r=(0,v.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,_.default)(this,i)}}var D=function(t){(0,f.default)(i,t);var e=B(i);function i(){var t;return(0,c.default)(this,i),(t=e.apply(this,arguments))._customParse=!1,t}return(0,d.default)(i,[{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:y.ILaya.WorkerLoader.enable;if(t){var l;if(i.setGroup(t,"666"),this._url=t,0!==(0,s.default)(t).call(t,"data:image")||e?t=R.URL.formatURL(t):e=i.IMAGE,this._type=e||(e=i.getTypeFromUrl(this._url)),this._cache=n,this._useWorkerLoader=o,this._data=null,o&&y.ILaya.WorkerLoader.enableWorkerLoader(),e==i.IMAGE?(l=i.textureMap[t])&&(!l.bitmap||l.bitmap&&l.bitmap.destroyed)&&(l=null):l=i.loadedMap[t],!r&&l)return this._data=l,this.event(m.Event.PROGRESS,1),void this.event(m.Event.COMPLETE,this._data);if(a&&i.setGroup(t,a),null!=i.parserMap[e])return this._customParse=!0,void(i.parserMap[e]instanceof M.Handler?i.parserMap[e].runWith(this):i.parserMap[e].call(null,this));this._loadResourceFilter(e,t)}else this.onLoaded(null)}},{key:"_loadResourceFilter",value:function(t,e){this._loadResource(t,e)}},{key:"_loadResource",value:function(t,e){switch(t){case i.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(e);break;case i.SOUND:this._loadSound(e);break;case i.TTF:this._loadTTF(e);break;case i.ATLAS:case i.PREFAB:case i.PLF:this._loadHttpRequestWhat(e,i.JSON);break;case i.FONT:this._loadHttpRequestWhat(e,i.XML);break;case i.PLFB:this._loadHttpRequestWhat(e,i.BUFFER);break;default:this._loadHttpRequestWhat(e,t)}}},{key:"_loadHttpRequest",value:function(t,e,i,n,a,r,s,o){S.Browser.onVVMiniGame||S.Browser.onHWMiniGame?this._http=new I.HttpRequest:this._http||(this._http=new I.HttpRequest),r&&this._http.on(m.Event.PROGRESS,a,r),n&&this._http.on(m.Event.COMPLETE,i,n),this._http.on(m.Event.ERROR,s,o),this._http.send(t,null,"get",e)}},{key:"_loadHtmlImage",value:function(t,e,n,a,r){var s;function o(){var e=s;e.onload=null,e.onerror=null,delete i._imgCache[t]}(s=new S.Browser.window.Image).crossOrigin="",s.onload=function(){o(),n.call(e,s)},s.onerror=function(){o(),r.call(a)},s.src=t,i._imgCache[t]=s}},{key:"_loadHttpRequestWhat",value:function(t,e){i.preLoadedMap[t]?this.onLoaded(i.preLoadedMap[t]):this._loadHttpRequest(t,e,this,this.onLoaded,this,this.onProgress,this,this.onError)}},{key:"_loadTTF",value:function(t){t=R.URL.formatURL(t);var e=new y.ILaya.TTFLoader;e.complete=M.Handler.create(this,this.onLoaded),e.load(t)}},{key:"_loadImage",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;e&&(t=R.URL.formatURL(t));var a=function(){n.event(m.Event.ERROR,"Load image failed")};if("nativeimage"===this._type)this._loadHtmlImage(t,this,this.onLoaded,this,a);else{var r=L.Utils.getFileExtension(t);"bin"==r&&this._url&&(r=L.Utils.getFileExtension(this._url)),"ktx"===r||"pvr"===r?this._loadHttpRequest(t,i.BUFFER,this,this.onLoaded,this,this.onProgress,this,this.onError):this._loadHtmlImage(t,this,this.onLoaded,this,a)}}},{key:"_loadSound",value:function(t){var e=new T.SoundManager._soundClass,i=this;function n(){e.offAll()}e.on(m.Event.COMPLETE,this,(function(){n(),i.onLoaded(e)})),e.on(m.Event.ERROR,this,(function(){n(),e.dispose(),i.event(m.Event.ERROR,"Load sound failed")})),e.load(t)}},{key:"onProgress",value:function(t){this._type===i.ATLAS?this.event(m.Event.PROGRESS,.3*t):this._originType==i.HIERARCHY?this.event(m.Event.PROGRESS,t/3):this.event(m.Event.PROGRESS,t)}},{key:"onError",value:function(t){this.event(m.Event.ERROR,t)}},{key:"onLoaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if((I=this._type)==i.PLFB)this.parsePLFBData(t),this.complete(t);else if(I==i.PLF)this.parsePLFData(t),this.complete(t);else if(I===i.IMAGE){var e;if(t instanceof ArrayBuffer){var n;switch(M=L.Utils.getFileExtension(this._url)){case"ktx":n=w.TextureFormat.ETC1RGB;break;case"pvr":n=w.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",M)}(e=new C.Texture2D(0,0,n,!1,!1)).wrapModeU=A.WarpMode.Clamp,e.wrapModeV=A.WarpMode.Clamp,e.setCompressData(t),e._setCreateURL(this.url)}else t instanceof C.Texture2D?e=t:((e=new C.Texture2D(t.width,t.height,1,!1,!1)).wrapModeU=A.WarpMode.Clamp,e.wrapModeV=A.WarpMode.Clamp,e.loadImageSource(t,!0),e._setCreateURL(t.src));var a=new k.Texture(e);a.url=this._url,this.complete(a)}else if(I===i.SOUND||"nativeimage"===I)this.complete(t);else if("htmlimage"===I){var r=new C.Texture2D(t.width,t.height,1,!1,!1);r.wrapModeU=A.WarpMode.Clamp,r.wrapModeV=A.WarpMode.Clamp,r.loadImageSource(t,!0),r._setCreateURL(t.src),this.complete(r)}else if(I===i.ATLAS){if(t.frames){var h=[];if(!this._data){if(this._data=t,t.meta&&t.meta.image){var c,d;h=t.meta.image.split(",");var f=(0,s.default)(c=this._url).call(c,"/")>=0?"/":"\\",_=(0,o.default)(d=this._url).call(d,f),v=_>=0?this._url.substr(0,_+1):"",y=null;S.Browser.onAndroid&&t.meta.compressTextureAndroid&&(y=".ktx"),S.Browser.onIOS&&t.meta.compressTextureIOS&&(y=t.meta.astc?".ktx":".pvr");for(var x=0,T=h.length;x<T;x++)h[x]=y?v+h[x].replace(".png",y):v+h[x]}else h=[this._url.replace(".json",".png")];(0,l.default)(h).call(h),t.toLoads=h,t.pics=[]}this.event(m.Event.PROGRESS,.3+1/h.length*.6);var E=R.URL.formatURL(h.pop()),M=L.Utils.getFileExtension(E),I=i.IMAGE;return"pvr"!=M&&"ktx"!=M||(I=i.BUFFER),this._loadResourceFilter(I,E)}if(!(t instanceof C.Texture2D))if(t instanceof ArrayBuffer){var B;switch(E=this._http?this._http.url:this._url,M=L.Utils.getFileExtension(E)){case"ktx":B=w.TextureFormat.ETC1RGB;break;case"pvr":B=w.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",M)}var D=new C.Texture2D(0,0,B,!1,!1);D.wrapModeU=A.WarpMode.Clamp,D.wrapModeV=A.WarpMode.Clamp,D.setCompressData(t),D._setCreateURL(E),t=D}else{var P=new C.Texture2D(t.width,t.height,1,!1,!1);P.wrapModeU=A.WarpMode.Clamp,P.wrapModeV=A.WarpMode.Clamp,P.loadImageSource(t,!0),P._setCreateURL(t.src),t=P}if(this._data.pics.push(t),this._data.toLoads.length>0){this.event(m.Event.PROGRESS,.3+1/this._data.toLoads.length*.6);E=R.URL.formatURL(this._data.toLoads.pop()),M=L.Utils.getFileExtension(E),I=i.IMAGE;return"pvr"!=M&&"ktx"!=M||(I=i.BUFFER),this._loadResourceFilter(I,E)}var O=this._data.frames,F=this._url.split("?")[0],U=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:F.substring(0,(0,o.default)(F).call(F,"."))+"/",N=this._data.pics,G=R.URL.formatURL(this._url),H=i.atlasMap[G]||(i.atlasMap[G]=[]);H.dir=U;var W=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var V in W=(0,u.default)(this._data.meta.scale),O){var Y,X=O[V],z=N[X.frame.idx?X.frame.idx:0];E=U+V,z.scaleRate=W,Y=k.Texture._create(z,X.frame.x,X.frame.y,X.frame.w,X.frame.h,X.spriteSourceSize.x,X.spriteSourceSize.y,X.sourceSize.w,X.sourceSize.h,i.getRes(E)),i.cacheTexture(E,Y),Y.url=E,H.push(E)}else for(V in O)z=N[(X=O[V]).frame.idx?X.frame.idx:0],E=U+V,Y=k.Texture._create(z,X.frame.x,X.frame.y,X.frame.w,X.frame.h,X.spriteSourceSize.x,X.spriteSourceSize.y,X.sourceSize.w,X.sourceSize.h,i.getRes(E)),i.cacheTexture(E,Y),Y.url=E,H.push(E);delete this._data.pics,this.complete(this._data)}else if(I===i.FONT){if(!t._source)return this._data=t,this.event(m.Event.PROGRESS,.5),this._loadResourceFilter(i.IMAGE,this._url.replace(".fnt",".png"));var K=new b.BitmapFont;K.parseFont(this._data,new k.Texture(t));var j=this._url.split(".fnt")[0].split("/"),q=j[j.length-1];g.Text.registerBitmapFont(q,K),this._data=K,this.complete(this._data)}else if(I===i.PREFAB){var Z=new p.Prefab;Z.json=t,this.complete(Z)}else this.complete(t)}},{key:"parsePLFData",value:function(t){var e,n,a;for(e in t)for(n in a=t[e])i.preLoadedMap[R.URL.formatURL(n)]=a[n]}},{key:"parsePLFBData",value:function(t){var e,i,n;for(n=(e=new E.Byte(t)).getInt32(),i=0;i<n;i++)this.parseOnePLFBFile(e)}},{key:"parseOnePLFBFile",value:function(t){var e,n,a;n=t.getUTFString(),e=t.getInt32(),a=t.readArrayBuffer(e),i.preLoadedMap[R.URL.formatURL(n)]=a}},{key:"complete",value:function(t){this._data=t,this._customParse?this.event(m.Event.LOADED,t instanceof Array?[t]:t):(i._loaders.push(this),i._isWorking||i.checkNext())}},{key:"endLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this._data=t),this._cache&&i.cacheRes(this._url,this._data),this.event(m.Event.PROGRESS,1),this.event(m.Event.COMPLETE,this.data instanceof Array?[this.data]:this.data)}},{key:"url",get:function(){return this._url}},{key:"type",get:function(){return this._type}},{key:"cache",get:function(){return this._cache}},{key:"data",get:function(){return this._data}}],[{key:"getTypeFromUrl",value:function(t){var e=L.Utils.getFileExtension(t);return e?i.typeMap[e]:(console.warn("Not recognize the resources suffix",t),"text")}},{key:"checkNext",value:function(){i._isWorking=!0;for(var t=S.Browser.now();i._startIndex<i._loaders.length;)if(i._loaders[i._startIndex].endLoad(),i._startIndex++,S.Browser.now()-t>i.maxTimeOut)return console.warn("loader callback cost a long time:"+(S.Browser.now()-t)+" url="+i._loaders[i._startIndex-1].url),void y.ILaya.systemTimer.frameOnce(1,null,i.checkNext);i._loaders.length=0,i._startIndex=0,i._isWorking=!1}},{key:"clearRes",value:function(t){t=R.URL.formatURL(t);var e=i.getAtlas(t);if(e){for(var n=0,a=e.length;n<a;n++){var r=e[n],s=i.getRes(r);delete i.textureMap[r],s&&s.destroy()}e.length=0,delete i.atlasMap[t]}var o=i.textureMap[t];o&&(o.destroy(),delete i.textureMap[t]),i.loadedMap[t]&&delete i.loadedMap[t]}},{key:"clearTextureRes",value:function(t){t=R.URL.formatURL(t);var e=i.getAtlas(t);if(e&&e.length>0)(0,h.default)(e).call(e,(function(t){var e=i.getRes(t);e instanceof k.Texture&&e.disposeBitmap()}));else{var n=i.getRes(t);n instanceof k.Texture&&n.disposeBitmap()}}},{key:"getRes",value:function(t){var e=i.textureMap[R.URL.formatURL(t)];return e||i.loadedMap[R.URL.formatURL(t)]}},{key:"getAtlas",value:function(t){return i.atlasMap[R.URL.formatURL(t)]}},{key:"cacheRes",value:function(t,e){t=R.URL.formatURL(t),null!=i.loadedMap[t]?console.warn("Resources already exist,is repeated loading:",t):e instanceof k.Texture?(i.loadedMap[t]=e.bitmap,i.textureMap[t]=e):i.loadedMap[t]=e}},{key:"cacheResForce",value:function(t,e){i.loadedMap[t]=e}},{key:"cacheTexture",value:function(t,e){t=R.URL.formatURL(t),null!=i.textureMap[t]?console.warn("Resources already exist,is repeated loading:",t):i.textureMap[t]=e}},{key:"setGroup",value:function(t,e){i.groupMap[e]||(i.groupMap[e]=[]),i.groupMap[e].push(t)}},{key:"clearResByGroup",value:function(t){if(i.groupMap[t]){var e,n=i.groupMap[t],a=n.length;for(e=0;e<a;e++)i.clearRes(n[e]);n.length=0}}}]),i}(x.EventDispatcher);e.Loader=D,D.TEXT="text",D.JSON="json",D.PREFAB="prefab",D.XML="xml",D.BUFFER="arraybuffer",D.IMAGE="image",D.SOUND="sound",D.ATLAS="atlas",D.FONT="font",D.TTF="ttf",D.PLF="plf",D.PLFB="plfb",D.HIERARCHY="HIERARCHY",D.MESH="MESH",D.MATERIAL="MATERIAL",D.TEXTURE2D="TEXTURE2D",D.TEXTURECUBE="TEXTURECUBE",D.ANIMATIONCLIP="ANIMATIONCLIP",D.AVATAR="AVATAR",D.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA",D.TERRAINRES="TERRAIN",D.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer",wasm:"arraybuffer"},D.parserMap={},D.maxTimeOut=100,D.groupMap={},D.loadedMap={},D.atlasMap={},D.textureMap={},D.preLoadedMap={},D._imgCache={},D._loaders=[],D._isWorking=!1,D._startIndex=0},33063:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.LoaderManager=void 0;var s=r(i(81643)),o=r(i(15375)),l=r(i(17061)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(92493),f=i(89662),_=i(48856),v=i(84935),y=i(25883),p=i(54598),g=i(41107),m=i(56083),x=i(68291),T=i(85096);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var C=function(t){(0,u.default)(i,t);var e=k(i);function i(){var t;(0,o.default)(this,i),(t=e.call(this)).retryNum=1,t.retryDelay=0,t.maxLoader=5,t._loaders=[],t._loaderCount=0,t._resInfos=[],t._infoPool=[],t._maxPriority=5,t._failRes={},t._statInfo={count:1,loaded:1};for(var n=0;n<t._maxPriority;n++)t._resInfos[n]=[];return t}return(0,l.default)(i,[{key:"getProgress",value:function(){return this._statInfo.loaded/this._statInfo.count}},{key:"resetProgress",value:function(){this._statInfo.count=this._statInfo.loaded=1}},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];this._create(t,!0,e,i,n,a,r,s,o)}},{key:"_create",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];if(t instanceof Array){var u=!0,h=t,c=h.length,d=0;if(n)var f=g.Handler.create(n.caller,n?n.method:null,n.args,!1);for(var _=0;_<c;_++){var v=h[_];"string"==typeof v&&(v=h[_]={url:v}),v.progress=0}for(_=0;_<c;_++){v=h[_];var y=n?g.Handler.create(null,(function(t,e){t.progress=e;for(var i=0,n=0;n<c;n++){i+=h[n].progress}var a=i/c;f.runWith(a)}),[v],!1):null,p=n||i?g.Handler.create(null,(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;d++,t.progress=1,e||(u=!1),d===c&&i&&i.runWith(u)}),[v]):null;this._createOne(v.url,e,p,y,v.type||a,v.constructParams||r,v.propertyParams||s,v.priority||o,l)}}else this._createOne(t,e,i,n,a,r,s,o,l)}},{key:"_createOne",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],h=this.getRes(t);if(h)!e&&h instanceof y.Resource&&h._addReference(),a&&a.runWith(1),n&&n.runWith(h);else{var c=i.createMap[m.Utils.getFilecompatibleExtension(t)]?m.Utils.getFilecompatibleExtension(t):m.Utils.getFileExtension(t);if(r||(r=i.createMap[c]?i.createMap[c][0]:null),!r)return void this.load(t,n,a,r,l,u);var f=T.Loader.parserMap;if(!f[r])return void this.load(t,n,a,r,l,u);this._createLoad(t,g.Handler.create(null,(function(i){i&&(!e&&i instanceof y.Resource&&i._addReference(),i._setCreateURL(t)),n&&n.runWith(i),d.ILaya.loader.event(t)})),a,r,s,o,l,u,!0)}}},{key:"load",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:d.ILaya.WorkerLoader.enable;if(t instanceof Array)return this._loadAssets(t,n,a,r,o,l,u);if(r||(r=0===(0,s.default)(t).call(t,"data:image")?T.Loader.IMAGE:T.Loader.getTypeFromUrl(t)),r===T.Loader.IMAGE?(e=T.Loader.textureMap[v.URL.formatURL(t)])&&(!e.bitmap||e.bitmap&&e.bitmap.destroyed)&&(e=null):e=T.Loader.loadedMap[v.URL.formatURL(t)],h||null==e){var _;_=t,(t=x.AtlasInfoManager.getFileLoadPath(t))!=_&&"nativeimage"!==r?r=T.Loader.ATLAS:_=null;var y=i._resMap[t];y?(n&&(_?n&&y._createListener(f.Event.COMPLETE,this,this._resInfoLoaded,[_,n],!1,!1):n&&y._createListener(f.Event.COMPLETE,n.caller,n.method,n.args,!1,!1)),a&&y._createListener(f.Event.PROGRESS,a.caller,a.method,a.args,!1,!1)):((y=this._infoPool.length?this._infoPool.pop():new S).url=t,y.type=r,y.cache=l,y.group=u,y.ignoreCache=h,y.useWorkerLoader=c,y.originalUrl=_,n&&y.on(f.Event.COMPLETE,n.caller,n.method,n.args),a&&y.on(f.Event.PROGRESS,a.caller,a.method,a.args),i._resMap[t]=y,o=o<this._maxPriority?o:this._maxPriority-1,this._resInfos[o].push(y),this._statInfo.count++,this.event(f.Event.PROGRESS,this.getProgress()),this._next())}else d.ILaya.systemTimer.callLater(this,(function(){a&&a.runWith(1),n&&n.runWith(e instanceof Array?[e]:e),this._loaderCount||this.event(f.Event.COMPLETE)}));return this}},{key:"_resInfoLoaded",value:function(t,e){e.runWith(T.Loader.getRes(t))}},{key:"_createLoad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(t instanceof Array)return this._loadAssets(t,e,n,a,o,l);var h=T.Loader.getRes(t);if(null!=h)d.ILaya.systemTimer.frameOnce(1,this,(function(){n&&n.runWith(1),e&&e.runWith(h),this._loaderCount||this.event(f.Event.COMPLETE)}));else{var c=i._resMap[t];c?(e&&c._createListener(f.Event.COMPLETE,e.caller,e.method,e.args,!1,!1),n&&c._createListener(f.Event.PROGRESS,n.caller,n.method,n.args,!1,!1)):((c=this._infoPool.length?this._infoPool.pop():new S).url=t,c.type=a,c.cache=!1,c.ignoreCache=u,c.originalUrl=null,c.group=null,c.createCache=l,c.createConstructParams=r,c.createPropertyParams=s,e&&c.on(f.Event.COMPLETE,e.caller,e.method,e.args),n&&c.on(f.Event.PROGRESS,n.caller,n.method,n.args),i._resMap[t]=c,o=o<this._maxPriority?o:this._maxPriority-1,this._resInfos[o].push(c),this._statInfo.count++,this.event(f.Event.PROGRESS,this.getProgress()),this._next())}return this}},{key:"_next",value:function(){if(!(this._loaderCount>=this.maxLoader)){for(var t=0;t<this._maxPriority;t++)for(var e=this._resInfos[t];e.length>0;){var i=e.shift();if(i)return this._doLoad(i)}this._loaderCount||this.event(f.Event.COMPLETE)}}},{key:"_doLoad",value:function(t){this._loaderCount++;var e=this._loaders.length?this._loaders.pop():new T.Loader;e.on(f.Event.COMPLETE,null,n),e.on(f.Event.PROGRESS,null,(function(e){t.event(f.Event.PROGRESS,e)})),e.on(f.Event.ERROR,null,(function(t){n(null)}));var i=this;function n(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.offAll(),e._data=null,e._customParse=!1,i._loaders.push(e),i._endLoad(t,n instanceof Array?[n]:n),i._loaderCount--,i._next()}e._constructParams=t.createConstructParams,e._propertyParams=t.createPropertyParams,e._createCache=t.createCache,e.load(t.url,t.type,t.cache,t.group,t.ignoreCache,t.useWorkerLoader)}},{key:"_endLoad",value:function(t,e){var n=t.url;if(null==e){var a=this._failRes[n]||0;if(a<this.retryNum)return console.warn("[warn]Retry to load:",n),this._failRes[n]=a+1,void d.ILaya.systemTimer.once(this.retryDelay,this,this._addReTry,[t],!1);T.Loader.clearRes(n),console.warn("[error]Failed to load:",n),this.event(f.Event.ERROR,n)}this._failRes[n]&&(this._failRes[n]=0),delete i._resMap[n],t.originalUrl&&(e=T.Loader.getRes(t.originalUrl)),t.event(f.Event.COMPLETE,e),t.offAll(),this._infoPool.push(t),this._statInfo.loaded++,this.event(f.Event.PROGRESS,this.getProgress())}},{key:"_addReTry",value:function(t){this._resInfos[this._maxPriority-1].push(t),this._next()}},{key:"clearRes",value:function(t){T.Loader.clearRes(t)}},{key:"clearTextureRes",value:function(t){T.Loader.clearTextureRes(t)}},{key:"getRes",value:function(t){return T.Loader.getRes(t)}},{key:"cacheRes",value:function(t,e){T.Loader.cacheRes(t,e)}},{key:"setGroup",value:function(t,e){T.Loader.setGroup(t,e)}},{key:"clearResByGroup",value:function(t){T.Loader.clearResByGroup(t)}},{key:"clearUnLoaded",value:function(){for(var t=0;t<this._maxPriority;t++){for(var e=this._resInfos[t],n=e.length-1;n>-1;n--){var a=e[n];a&&(a.offAll(),this._infoPool.push(a))}e.length=0}this._loaderCount=0,i._resMap={}}},{key:"cancelLoadByUrls",value:function(t){if(t)for(var e=0,i=t.length;e<i;e++)this.cancelLoadByUrl(t[e])}},{key:"cancelLoadByUrl",value:function(t){for(var e=0;e<this._maxPriority;e++)for(var n=this._resInfos[e],a=n.length-1;a>-1;a--){var r=n[a];r&&r.url===t&&(n[a]=null,r.offAll(),this._infoPool.push(r))}i._resMap[t]&&delete i._resMap[t]}},{key:"_loadAssets",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=t.length,l=0,u=0,h=[],c=!0,d=0;d<o;d++){var f=t[d],_=void 0;(_="string"==typeof f?{url:f,type:n,size:1,priority:a}:f).size||(_.size=1),_.progress=0,u+=_.size,h.push(_);var v=i?g.Handler.create(null,m,[_],!1):null,y=e||i?g.Handler.create(null,p,[_]):null;this.load(_.url,y,v,_.type,_.priority||1,r,_.group||s,!1,_.useWorkerLoader)}function p(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l++,t.progress=1,i||(c=!1),l===o&&e&&e.runWith(c)}function m(t,e){if(null!=i){t.progress=e;for(var n=0,a=0;a<h.length;a++){var r=h[a];if(r){var s=null==r.progress?0:r.progress;n+=null==r.size?0:r.size*s}}var o=n/u;i.runWith(o)}}return this}},{key:"decodeBitmaps",value:function(t){var e,i,n=t.length;for(i=d.ILaya.Render._context,e=0;e<n;e++){var a,r;if(a=T.Loader.getAtlas(t[e]))this._decodeTexture(a[0],i);else(r=this.getRes(t[e]))&&r instanceof p.Texture&&this._decodeTexture(r,i)}}},{key:"_decodeTexture",value:function(t,e){var i=t.bitmap;if(t&&i){var n=i.source||i.image;if(n&&n instanceof HTMLImageElement){e.drawImage(n,0,0,1,1);e.getImageData(0,0,1,1)}}}}],[{key:"cacheRes",value:function(t,e){T.Loader.cacheRes(t,e)}}]),i}(_.EventDispatcher);e.LoaderManager=C,C._resMap={},C.createMap={atlas:[null,T.Loader.ATLAS]};var S=function(t){(0,u.default)(i,t);var e=k(i);function i(){return(0,o.default)(this,i),e.apply(this,arguments)}return i}(_.EventDispatcher)},20966:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.LocalStorage=void 0;var r=a(i(59340)),s=a(i(15375)),o=a(i(17061)),l=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"__init__",value:function(){return t._baseClass||(t._baseClass=u,u.init()),t.items=t._baseClass.items,t.support=t._baseClass.support,t.support}},{key:"setItem",value:function(e,i){t._baseClass.setItem(e,i)}},{key:"getItem",value:function(e){return t._baseClass.getItem(e)}},{key:"setJSON",value:function(e,i){t._baseClass.setJSON(e,i)}},{key:"getJSON",value:function(e){return t._baseClass.getJSON(e)}},{key:"removeItem",value:function(e){t._baseClass.removeItem(e)}},{key:"clear",value:function(){t._baseClass.clear()}}]),t}();e.LocalStorage=l,l.support=!1;var u=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"init",value:function(){try{t.support=!0,t.items=window.localStorage,t.setItem("laya","1"),t.removeItem("laya")}catch(e){t.support=!1}t.support||console.log("LocalStorage is not supprot or browser is private mode.")}},{key:"setItem",value:function(e,i){try{t.support&&t.items.setItem(e,i)}catch(t){console.warn("set localStorage failed",t)}}},{key:"getItem",value:function(e){return t.support?t.items.getItem(e):null}},{key:"setJSON",value:function(e,i){try{t.support&&t.items.setItem(e,(0,r.default)(i))}catch(t){console.warn("set localStorage failed",t)}}},{key:"getJSON",value:function(e){try{return JSON.parse(t.support?t.items.getItem(e):null)}catch(i){return t.items.getItem(e)}}},{key:"removeItem",value:function(e){t.support&&t.items.removeItem(e)}},{key:"clear",value:function(){t.support&&t.items.clear()}}]),t}();u.support=!1},8863:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.SceneLoader=void 0;var s=r(i(81643)),o=r(i(15375)),l=r(i(17061)),u=r(i(89395)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(85096),_=i(92493),v=i(68291),y=i(33063),p=i(72643),g=i(89662),m=i(48856),x=i(41107),T=i(56083);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var C=function(t){(0,h.default)(i,t);var e=k(i);function i(){var t;return(0,o.default)(this,i),(t=e.call(this))._completeHandler=new x.Handler((0,u.default)(t),t.onOneLoadComplete),t.reset(),t}return(0,l.default)(i,[{key:"reset",value:function(){this._toLoadList=[],this._isLoading=!1,this.totalCount=0}},{key:"leftCount",get:function(){return this._isLoading?this._toLoadList.length+1:this._toLoadList.length}},{key:"loadedCount",get:function(){return this.totalCount-this.leftCount}},{key:"load",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t instanceof Array)for(i=t.length,e=0;e<i;e++)this._addToLoadList(t[e],n);else this._addToLoadList(t,n);a&&this._checkNext()}},{key:"_addToLoadList",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,s.default)(e=this._toLoadList).call(e,t)>=0||f.Loader.getRes(t)||(i?this._toLoadList.push({url:t}):this._toLoadList.push(t),this.totalCount++)}},{key:"_checkNext",value:function(){if(!this._isLoading){if(0==this._toLoadList.length)return void this.event(g.Event.COMPLETE);var t;"string"==typeof(t=this._toLoadList.pop())?this.loadOne(t):this.loadOne(t.url,!0)}}},{key:"loadOne",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._curUrl=t;var n=T.Utils.getFileExtension(this._curUrl);e?_.ILaya.loader.create(t,this._completeHandler):i.LoadableExtensions[n]?_.ILaya.loader.load(t,this._completeHandler,null,i.LoadableExtensions[n]):t!=v.AtlasInfoManager.getFileLoadPath(t)||i.No3dLoadTypes[n]||!y.LoaderManager.createMap[n]?_.ILaya.loader.load(t,this._completeHandler):_.ILaya.loader.create(t,this._completeHandler)}},{key:"onOneLoadComplete",value:function(){this._isLoading=!1,f.Loader.getRes(this._curUrl)||console.log("Fail to load:",this._curUrl);var t,e=T.Utils.getFileExtension(this._curUrl);i.LoadableExtensions[e]&&((t=f.Loader.getRes(this._curUrl))&&t instanceof p.Prefab&&(t=t.json),t&&(t.loadList&&this.load(t.loadList,!1,!1),t.loadList3D&&this.load(t.loadList3D,!0,!1)));"sk"==e&&this.load(this._curUrl.replace(".sk",".png"),!1,!1),this.event(g.Event.PROGRESS,this.getProgress()),this._checkNext()}},{key:"getProgress",value:function(){return this.loadedCount/this.totalCount}}]),i}(m.EventDispatcher);e.SceneLoader=C,C.LoadableExtensions={scene:f.Loader.JSON,scene3d:f.Loader.JSON,ani:f.Loader.JSON,ui:f.Loader.JSON,prefab:f.Loader.PREFAB},C.No3dLoadTypes={png:!0,jpg:!0,txt:!0}},65356:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TTFLoader=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(92493),l=i(89662),u=i(93568),h=i(46785),c=i(85096),d=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"load",value:function(t){this._url=t;var e=t.toLowerCase().split(".ttf")[0].split("/");this.fontName=e[e.length-1],o.ILaya.Render.isConchApp?this._loadConch():window.FontFace?this._loadWithFontFace():this._loadWithCSS()}},{key:"_loadConch",value:function(){this._http=new h.HttpRequest,this._http.on(l.Event.ERROR,this,this._onErr),this._http.on(l.Event.COMPLETE,this,this._onHttpLoaded),this._http.send(this._url,null,"get",c.Loader.BUFFER)}},{key:"_onHttpLoaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,t),this._clearHttp(),this._complete()}},{key:"_clearHttp",value:function(){this._http&&(this._http.off(l.Event.ERROR,this,this._onErr),this._http.off(l.Event.COMPLETE,this,this._onHttpLoaded),this._http=null)}},{key:"_onErr",value:function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)}},{key:"_complete",value:function(){o.ILaya.systemTimer.clear(this,this._complete),o.ILaya.systemTimer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)}},{key:"_checkComplete",value:function(){o.ILaya.Browser.measureText(t._testString,this._fontTxt).width!=this._txtWidth&&this._complete()}},{key:"_loadWithFontFace",value:function(){var t=new window.FontFace(this.fontName,"url('"+this._url+"')");document.fonts.add(t);var e=this;t.loaded.then((function(){e._complete()})),t.load()}},{key:"_createDiv",value:function(){this._div=u.Browser.createElement("div"),this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName,t.position="absolute",t.left="-100px",t.top="-100px",document.body.appendChild(this._div)}},{key:"_loadWithCSS",value:function(){var e=u.Browser.createElement("style");e.type="text/css",document.body.appendChild(e),e.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=u.Browser.measureText(t._testString,this._fontTxt).width;var i=this;e.onload=function(){o.ILaya.systemTimer.once(1e4,i,i._complete)},o.ILaya.systemTimer.loop(20,this,this._checkComplete),this._createDiv()}}]),t}();e.TTFLoader=d,d._testString="LayaTTFFont"},84935:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.URL=void 0;var r=a(i(81643)),s=a(i(92762)),o=a(i(23054)),l=a(i(15375)),u=a(i(17061)),h=i(92493),c=function(){function t(e){(0,l.default)(this,t),this._url=t.formatURL(e),this._path=t.getPath(e)}return(0,u.default)(t,[{key:"url",get:function(){return this._url}},{key:"path",get:function(){return this._path}}],[{key:"basePath",get:function(){return t._basePath},set:function(e){t._basePath=h.ILaya.Laya._getUrlPath(),t._basePath=t.formatURL(e)}},{key:"formatURL",value:function(e){if(!e)return"null path";if((0,r.default)(e).call(e,":")>0)return e;t.exportSceneToJson&&(e=t.getAdptedFilePath(e)),null!=t.customFormat&&(e=t.customFormat(e));var i=e.charAt(0);if("."===i)return t._formatRelativePath(t._basePath+e);if("~"===i)return t.rootPath+e.substring(1);if("d"===i){if(0===(0,r.default)(e).call(e,"data:image"))return e}else if("/"===i)return e;return t._basePath+e}},{key:"_formatRelativePath",value:function(t){for(var e=t.split("/"),i=0,n=e.length;i<n;i++)".."==e[i]&&((0,s.default)(e).call(e,i-1,2),i-=2);return e.join("/")}},{key:"getPath",value:function(t){var e=(0,o.default)(t).call(t,"/");return e>0?t.substr(0,e+1):""}},{key:"getFileName",value:function(t){var e=(0,o.default)(t).call(t,"/");return e>0?t.substr(e+1):t}},{key:"getAdptedFilePath",value:function(e){if(!t.exportSceneToJson||!e)return e;var i,n,a;for(n=t._adpteTypeList.length,i=0;i<n;i++)a=t._adpteTypeList[i],e=e.replace(a[0],a[1]);return e}}]),t}();e.URL=c,c.version={},c.exportSceneToJson=!1,c._basePath="",c.rootPath="",c.customFormat=function(t){var e=c.version[t];return!window.conch&&e&&(t+="?v="+e),t},c._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]]},37397:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.WorkerLoader=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(89395)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(85096),f=i(84935),_=i(48856),v=i(87035),y=i(69176);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var g=function(t){(0,u.default)(i,t);var e=p(i);function i(){var t;(0,s.default)(this,i),(t=e.call(this)).worker=new Worker(i.workerPath);var n=(0,l.default)(t);return t.worker.onmessage=function(t){n.workerMessage(t.data)},t}return(0,o.default)(i,[{key:"workerMessage",value:function(t){if(t)switch(t.type){case"Image":this.imageLoaded(t);break;case"Disable":i.enable=!1}}},{key:"imageLoaded",value:function(t){if(t.dataType&&"imageBitmap"==t.dataType){var e=t.imageBitmap;console.log("load:",t.url),this.event(t.url,e)}else this.event(t.url,null)}},{key:"loadImage",value:function(t){this.worker.postMessage(t)}},{key:"_loadImage",value:function(t){var e=this,n=e.type;if(this._useWorkerLoader&&i._enable){t=f.URL.formatURL(t);var a=function(a){if(r(),a){var s=a;"nativeimage"!==n&&((s=new v.Texture2D).wrapModeU=y.WarpMode.Clamp,s.wrapModeV=y.WarpMode.Clamp,s.loadImageSource(a,!0)),e.onLoaded(s)}else i._preLoadFun.call(e,t)};i.I.on(t,e,a),i.I.loadImage(t)}else i._preLoadFun.call(e,t);function r(){i.I.off(t,e,a)}}}],[{key:"__init__",value:function(){return null==i._preLoadFun&&(!!Worker&&(i._preLoadFun=d.Loader.prototype._loadImage,d.Loader.prototype._loadImage=i.prototype._loadImage,i.I||(i.I=new i),!0))}},{key:"workerSupported",value:function(){return!!Worker}},{key:"enableWorkerLoader",value:function(){i._tryEnabled||(i.enable=!0,i._tryEnabled=!0)}},{key:"enable",get:function(){return i._enable},set:function(t){i._enable!=t&&(i._enable=t,t&&null==i._preLoadFun&&(i._enable=i.__init__()))}}]),i}(_.EventDispatcher);e.WorkerLoader=g,g.workerPath="libs/workerloader.js",g._enable=!1,g._tryEnabled=!1},64469:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.LayaGLQuickRunner=void 0;var r=a(i(2991)),s=a(i(15375)),o=a(i(17061)),l=i(13407),u=i(43745),h=i(18008),c=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"__init__",value:function(){(0,r.default)(t)[u.SpriteConst.ALPHA|u.SpriteConst.TRANSFORM|u.SpriteConst.GRAPHICS]=t.alpha_transform_drawLayaGL,(0,r.default)(t)[u.SpriteConst.ALPHA|u.SpriteConst.GRAPHICS]=t.alpha_drawLayaGL,(0,r.default)(t)[u.SpriteConst.TRANSFORM|u.SpriteConst.GRAPHICS]=t.transform_drawLayaGL,(0,r.default)(t)[u.SpriteConst.TRANSFORM|u.SpriteConst.CHILDS]=t.transform_drawNodes,(0,r.default)(t)[u.SpriteConst.ALPHA|u.SpriteConst.TRANSFORM|u.SpriteConst.TEXTURE]=t.alpha_transform_drawTexture,(0,r.default)(t)[u.SpriteConst.ALPHA|u.SpriteConst.TEXTURE]=t.alpha_drawTexture,(0,r.default)(t)[u.SpriteConst.TRANSFORM|u.SpriteConst.TEXTURE]=t.transform_drawTexture,(0,r.default)(t)[u.SpriteConst.GRAPHICS|u.SpriteConst.CHILDS]=t.drawLayaGL_drawNodes}},{key:"transform_drawTexture",value:function(e,i,n,a){e._style;var r=e.texture;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,a);var s=e._width||r.sourceWidth,o=e._height||r.sourceHeight,l=s/r.sourceWidth,u=o/r.sourceHeight;if(s=r.width*l,o=r.height*u,s<=0||o<=0)return null;var h=-e.pivotX+r.offsetX*l,c=-e.pivotY+r.offsetY*u;i.drawTexture(r,h,c,s,o),i.restoreTransform(t.curMat)}},{key:"alpha_drawTexture",value:function(t,e,i,n){var a,r=t._style,s=t.texture;if((a=r.alpha)>.01||t._needRepaint()){var o=e.globalAlpha;e.globalAlpha*=a;var l=t._width||s.width,u=t._height||s.height,h=l/s.sourceWidth,c=u/s.sourceHeight;if(l=s.width*h,u=s.height*c,l<=0||u<=0)return null;var d=i-r.pivotX+s.offsetX*h,f=n-r.pivotY+s.offsetY*c;e.drawTexture(s,d,f,l,u),e.globalAlpha=o}}},{key:"alpha_transform_drawTexture",value:function(e,i,n,a){var r,s=e._style,o=e.texture;if((r=s.alpha)>.01||e._needRepaint()){var l=i.globalAlpha;i.globalAlpha*=r,i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,a);var u=e._width||o.sourceWidth,h=e._height||o.sourceHeight,c=u/o.sourceWidth,d=h/o.sourceHeight;if(u=o.width*c,h=o.height*d,u<=0||h<=0)return null;var f=-s.pivotX+o.offsetX*c,_=-s.pivotY+o.offsetY*d;i.drawTexture(o,f,_,u,h),i.restoreTransform(t.curMat),i.globalAlpha=l}}},{key:"alpha_transform_drawLayaGL",value:function(e,i,n,a){var r,s=e._style;if((r=s.alpha)>.01||e._needRepaint()){var o=i.globalAlpha;i.globalAlpha*=r,i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,a),e._graphics&&e._graphics._render(e,i,-s.pivotX,-s.pivotY),i.restoreTransform(t.curMat),i.globalAlpha=o}}},{key:"alpha_drawLayaGL",value:function(t,e,i,n){var a,r=t._style;if((a=r.alpha)>.01||t._needRepaint()){var s=e.globalAlpha;e.globalAlpha*=a,t._graphics&&t._graphics._render(t,e,i-r.pivotX,n-r.pivotY),e.globalAlpha=s}}},{key:"transform_drawLayaGL",value:function(e,i,n,a){var r=e._style;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,a),e._graphics&&e._graphics._render(e,i,-r.pivotX,-r.pivotY),i.restoreTransform(t.curMat)}},{key:"transform_drawNodes",value:function(e,i,n,a){var r=e._getBit(l.Const.DRAWCALL_OPTIMIZE)&&i.drawCallOptimize(!0),s=e._style;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,n,a),n=-s.pivotX,a=-s.pivotY;var o,u=e._children,h=u.length;if(s.viewport){var c,d,f=s.viewport,_=f.x,v=f.y,y=f.right,p=f.bottom;for(g=0;g<h;++g)(o=u[g])._visible&&(c=o._x)<y&&c+o.width>_&&(d=o._y)<p&&d+o.height>v&&o.render(i,n,a)}else for(var g=0;g<h;++g)(o=u[g])._visible&&o.render(i,n,a);i.restoreTransform(t.curMat),r&&i.drawCallOptimize(!1)}},{key:"drawLayaGL_drawNodes",value:function(t,e,i,n){var a=t._getBit(l.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0),r=t._style;i-=r.pivotX,n-=r.pivotY,t._graphics&&t._graphics._render(t,e,i,n);var s,o=t._children,u=o.length;if(r.viewport){var h,c,d=r.viewport,f=d.x,_=d.y,v=d.right,y=d.bottom;for(p=0;p<u;++p)(s=o[p])._visible&&(h=s._x)<v&&h+s.width>f&&(c=s._y)<y&&c+s.height>_&&s.render(e,i,n)}else for(var p=0;p<u;++p)(s=o[p])._visible&&s.render(e,i,n);a&&e.drawCallOptimize(!1)}}]),t}();e.LayaGLQuickRunner=c,c.map=[],c.curMat=new h.Matrix},85136:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Render=void 0;var r=a(i(31581)),s=a(i(15375)),o=a(i(17061)),l=i(92493),u=i(80340),h=i(33873),c=i(79741),d=i(62285),f=i(61266),_=i(91700),v=i(97246),y=i(43989),p=i(22245),g=i(15323),m=i(93055),x=i(46996),T=i(93568),k=i(12596),C=function(){function t(e,i,n){(0,s.default)(this,t),this._timeId=0,t._mainCanvas=n;var a=t._mainCanvas.source;a.id="layaCanvas",a.width=e,a.height=i,t.isConchApp&&document.body.appendChild(a),this.initRender(t._mainCanvas,e,i),window.requestAnimationFrame((function t(e){l.ILaya.stage._loop(),window.requestAnimationFrame(t)})),l.ILaya.stage.on("visibilitychange",this,this._onVisibilitychange)}return(0,o.default)(t,[{key:"_onVisibilitychange",value:function(){l.ILaya.stage.isVisibility?0!=this._timeId&&window.clearInterval(this._timeId):this._timeId=(0,r.default)(this._enterFrame,1e3)}},{key:"initRender",value:function(e,i,n){var a=h.LayaGL.instance=f.WebGLContext.mainContext=function(t){var e,i=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];u.Config.useWebGL2&&!T.Browser.onBDMiniGame||i.shift();for(var n=0;n<i.length;n++){try{e=t.getContext(i[n],{stencil:u.Config.isStencil,alpha:u.Config.isAlpha,antialias:u.Config.isAntialias,premultipliedAlpha:u.Config.premultipliedAlpha,preserveDrawingBuffer:u.Config.preserveDrawingBuffer})}catch(t){}if(e)return"webgl2"===i[n]&&(d.WebGL._isWebGL2=!0),new h.LayaGL,e}return null}(t._mainCanvas.source);if(u.Config.printWebglOrder&&this._replaceWebglcall(a),!a)return!1;h.LayaGL.instance=a,h.LayaGL.layaGPUInstance=new x.LayaGPU(a,d.WebGL._isWebGL2),e.size(i,n),c.Context.__init__(),m.SubmitBase.__init__();var r=new c.Context;return r.isMain=!0,t._context=r,e._setContext(r),y.ShaderDefines2D.__init__(),p.Value2D.__init__(),v.Shader2D.__init__(),g.Buffer2D.__int__(a),_.BlendMode._init_(a),!0}},{key:"_replaceWebglcall",value:function(t){var e={},i=function(i){"function"==typeof t[i]&&"getError"!=i&&"__SPECTOR_Origin_getError"!=i&&"__proto__"!=i&&(e[i]=t[i],t[i]=function(){for(var n=[],a=0;a<arguments.length;a++)n.push(arguments[a]);var r=e[i].apply(t,n);console.log(k.RenderInfo.loopCount+":gl."+i+":"+n);var s=t.getError();return s&&console.log(s),r})};for(var n in t)i(n)}},{key:"_enterFrame",value:function(){l.ILaya.stage._loop()}}],[{key:"context",get:function(){return t._context}},{key:"canvas",get:function(){return t._mainCanvas.source}}]),t}();e.Render=C,C.supportWebGLPlusAnimation=!1,C.supportWebGLPlusRendering=!1,C.isConchApp=!1,C.isConchApp=null!=window.conch,(C.isConchApp||null!=window.qq&&null!=window.qq.webglPlus)&&(C.supportWebGLPlusRendering=!1)},12596:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.RenderInfo=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.RenderInfo=s,s.loopStTm=0,s.loopCount=0},8272:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.RenderSprite=void 0;var r=a(i(2991)),s=a(i(15375)),o=a(i(17061)),l=i(13407),u=i(43745),h=i(81114),c=i(18008),d=i(98693),f=i(54598),_=i(95453),v=i(683),y=i(91700),p=i(37560),g=i(43989),m=i(22245),x=i(69153),T=i(61266),k=i(64469),C=i(92493),S=function(){function t(e,i){if((0,s.default)(this,t),(0,r.default)(k.LayaGLQuickRunner)[e])return this._fun=(0,r.default)(k.LayaGLQuickRunner)[e],void(this._next=t.NORENDER);switch(this._next=i||t.NORENDER,e){case 0:return void(this._fun=this._no);case u.SpriteConst.ALPHA:return void(this._fun=this._alpha);case u.SpriteConst.TRANSFORM:return void(this._fun=this._transform);case u.SpriteConst.BLEND:return void(this._fun=this._blend);case u.SpriteConst.CANVAS:return void(this._fun=this._canvas);case u.SpriteConst.MASK:return void(this._fun=this._mask);case u.SpriteConst.CLIP:return void(this._fun=this._clip);case u.SpriteConst.STYLE:return void(this._fun=this._style);case u.SpriteConst.GRAPHICS:return void(this._fun=this._graphics);case u.SpriteConst.CHILDS:return void(this._fun=this._children);case u.SpriteConst.CUSTOM:return void(this._fun=this._custom);case u.SpriteConst.TEXTURE:return void(this._fun=this._texture);case u.SpriteConst.FILTERS:return void(this._fun=h.Filter._filter);case t.INIT:return void(this._fun=t._initRenderFun)}this.onCreate(e)}return(0,o.default)(t,[{key:"onCreate",value:function(t){}},{key:"_style",value:function(t,e,i,n){var a=t._style;null!=a.render&&a.render(t,e,i,n);var r=this._next;r._fun.call(r,t,e,i,n)}},{key:"_no",value:function(t,e,i,n){}},{key:"_custom",value:function(t,e,i,n){t.customRender(e,i,n),this._next._fun.call(this._next,t,e,0,0)}},{key:"_clip",value:function(e,i,n,a){var r=this._next;if(r!=t.NORENDER){var s=e._style.scrollRect,o=s.width,l=s.height;0!==o&&0!==l&&(i.save(),i.clipRect(n,a,o,l),r._fun.call(r,e,i,n-s.x,a-s.y),i.restore())}}},{key:"_texture",value:function(e,i,n,a){var r=e.texture;if(r._getSource()){var s=e._width||r.sourceWidth,o=e._height||r.sourceHeight,l=s/r.sourceWidth,u=o/r.sourceHeight;if(s=r.width*l,o=r.height*u,s<=0||o<=0)return;var h=n-e.pivotX+r.offsetX*l,c=a-e.pivotY+r.offsetY*u;i.drawTexture(r,h,c,s,o)}var d=this._next;d!=t.NORENDER&&d._fun.call(d,e,i,n,a)}},{key:"_graphics",value:function(e,i,n,a){var r=e._style,s=e._graphics;s&&s._render(e,i,n-r.pivotX,a-r.pivotY);var o=this._next;o!=t.NORENDER&&o._fun.call(o,e,i,n,a)}},{key:"_image",value:function(t,e,i,n){var a=t._style;e.drawTexture2(i,n,a.pivotX,a.pivotY,t.transform,t._graphics._one)}},{key:"_image2",value:function(t,e,i,n){var a=t._style;e.drawTexture2(i,n,a.pivotX,a.pivotY,t.transform,t._graphics._one)}},{key:"_alpha",value:function(t,e,i,n){var a;if((a=t._style.alpha)>.01||t._needRepaint()){var r=e.globalAlpha;e.globalAlpha*=a;var s=this._next;s._fun.call(s,t,e,i,n),e.globalAlpha=r}}},{key:"_transform",value:function(e,i,n,a){var r=e.transform,s=this._next;e._style;r&&s!=t.NORENDER?(i.save(),i.transform(r.a,r.b,r.c,r.d,r.tx+n,r.ty+a),s._fun.call(s,e,i,0,0),i.restore()):s!=t.NORENDER&&s._fun.call(s,e,i,n,a)}},{key:"_children",value:function(t,e,i,n){var a,r=t._style,s=t._children,o=s.length;i-=t.pivotX,n-=t.pivotY;var u=t._getBit(l.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0);if(r.viewport){var h,c,d=r.viewport,f=d.x,_=d.y,v=d.right,y=d.bottom;for(p=0;p<o;++p)(a=s[p])._visible&&(h=a._x)<v&&h+a.width>f&&(c=a._y)<y&&c+a.height>_&&a.render(e,i,n)}else for(var p=0;p<o;++p)(a=s[p])._visible&&a.render(e,i,n);u&&e.drawCallOptimize(!1)}},{key:"_canvas",value:function(t,e,i,n){var a=t._cacheStyle,r=this._next;if(a.enableCanvasRender){"bitmap"===a.cacheAs?v.Stat.canvasBitmap++:v.Stat.canvasNormal++;var s=!1,o=!1;if(a.canvas){var l=a.canvas,u=(l.context,l.touches);if(u)for(var h=0;h<u.length;h++)if(u[h].deleted){o=!0;break}s=l.isCacheValid&&!l.isCacheValid()}if(t._needRepaint()||!a.canvas||o||s||C.ILaya.stage.isGlobalRepaint())if("normal"===a.cacheAs){if(e._targets)return void r._fun.call(r,t,e,i,n);this._canvas_webgl_normal_repaint(t,e)}else this._canvas_repaint(t,e,i,n);var c=a.cacheRect;e.drawCanvas(a.canvas,i+c.x,n+c.y,c.width,c.height)}else r._fun.call(r,t,e,i,n)}},{key:"_canvas_repaint",value:function(t,e,i,n){var a,r,s,o,l,u,h,c,d,f=t._cacheStyle,_=this._next,y=f.canvas,p=f.cacheAs;if(h=(d=f._calculateCacheRect(t,p,i,n)).x,c=d.y,l=(o=f.cacheRect).width*h,u=o.height*c,r=o.x,s=o.y,"bitmap"===p&&(l>2048||u>2048))return console.warn("cache bitmap size larger than 2048,cache ignored"),f.releaseContext(),void _._fun.call(_,t,e,i,n);if(y||(f.createContext(),y=f.canvas),(a=y.context).sprite=t,(y.width!=l||y.height!=u)&&y.size(l,u),"bitmap"===p?a.asBitmap=!0:"normal"===p&&(a.asBitmap=!1),a.clear(),1!=h||1!=c){var g=a;g.save(),g.scale(h,c),_._fun.call(_,t,a,-r,-s),g.restore(),t._applyFilters()}else g=a,_._fun.call(_,t,a,-r,-s),t._applyFilters();f.staticCache&&(f.reCache=!1),v.Stat.canvasReCache++}},{key:"_canvas_webgl_normal_repaint",value:function(t,e){var i=t._cacheStyle,n=this._next,a=i.canvas,r=i.cacheAs;i._calculateCacheRect(t,r,0,0),a||(a=new p.WebGLCacheAsNormalCanvas(e,t),i.canvas=a);var s=a.context;a.startRec(),n._fun.call(n,t,s,t.pivotX,t.pivotY),t._applyFilters(),v.Stat.canvasReCache++,a.endRec()}},{key:"_blend",value:function(t,e,i,n){var a=t._style,r=this._next;a.blendMode?(e.save(),e.globalCompositeOperation=a.blendMode,r._fun.call(r,t,e,i,n),e.restore()):r._fun.call(r,t,e,i,n)}},{key:"_mask",value:function(e,i,n,a){var r=this._next,s=e.mask,o=i;if(s){o.save();var l=o.globalCompositeOperation,u=new d.Rectangle;if(u.copyFrom(s.getBounds()),u.width=Math.round(u.width),u.height=Math.round(u.height),u.x=Math.round(u.x),u.y=Math.round(u.y),u.width>0&&u.height>0){var h=u.width,v=u.height,y=_.WebGLRTMgr.getRT(h,v);o.breakNextMerge(),o.pushRT(),o.addRenderObject(x.SubmitCMD.create([o,y,h,v],t.tmpTarget,this)),s.render(o,-u.x,-u.y),o.breakNextMerge(),o.popRT(),o.save();var p=.1;o.clipRect(n+u.x-e.getStyle().pivotX+p,a+u.y-e.getStyle().pivotY+p,h-.2,v-.2),r._fun.call(r,e,o,n,a),o.restore(),l=o.globalCompositeOperation,o.addRenderObject(x.SubmitCMD.create(["mask"],t.setBlendMode,this));var T=m.Value2D.create(g.ShaderDefines2D.TEXTURE2D,0),k=f.Texture.INV_UV;o.drawTarget(y,n+u.x-e.getStyle().pivotX,a+u.y-e.getStyle().pivotY,h,v,c.Matrix.TEMP.identity(),T,k,6),o.addRenderObject(x.SubmitCMD.create([y],t.recycleTarget,this)),o.addRenderObject(x.SubmitCMD.create([l],t.setBlendMode,this))}o.restore()}else r._fun.call(r,e,i,n,a)}}],[{key:"__init__",value:function(){var e,i,n;for(k.LayaGLQuickRunner.__init__(),n=new t(t.INIT,null),i=t.renders.length=2*u.SpriteConst.CHILDS,e=0;e<i;e++)t.renders[e]=n;t.renders[0]=new t(0,null)}},{key:"_initRenderFun",value:function(e,i,n,a){var r=e._renderType;(t.renders[r]=t._getTypeRender(r))._fun(e,i,n,a)}},{key:"_getTypeRender",value:function(e){if((0,r.default)(k.LayaGLQuickRunner)[e])return new t(e,null);for(var i=null,n=u.SpriteConst.CHILDS;n>0;)n&e&&(i=new t(n,i)),n>>=1;return i}},{key:"tmpTarget",value:function(t,e,i,n){e.start(),e.clear(0,0,0,0)}},{key:"recycleTarget",value:function(t){_.WebGLRTMgr.releaseRT(t)}},{key:"setBlendMode",value:function(t){var e=T.WebGLContext.mainContext;y.BlendMode.targetFns[y.BlendMode.TOINT[t]](e)}}]),t}();e.RenderSprite=S,S.INIT=69905,S.renders=[],S.NORENDER=new S(0,null),S.tempUV=new Array(8)},69534:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.BaseTexture=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(33873),d=i(61266),f=i(8944),_=i(69432),v=i(73972),y=i(69176);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var g=function(t){(0,l.default)(i,t);var e=p(i);function i(t,n){var a;return(0,s.default)(this,i),(a=e.call(this))._wrapModeU=y.WarpMode.Repeat,a._wrapModeV=y.WarpMode.Repeat,a._filterMode=_.FilterMode.Bilinear,a._readyed=!1,a._width=-1,a._height=-1,a._format=t,a._mipmap=n,a._anisoLevel=1,a._glTexture=c.LayaGL.instance.createTexture(),a}return(0,o.default)(i,[{key:"mipmap",get:function(){return this._mipmap}},{key:"format",get:function(){return this._format}},{key:"wrapModeU",get:function(){return this._wrapModeU},set:function(t){this._wrapModeU!==t&&(this._wrapModeU=t,-1!==this._width&&this._setWarpMode(c.LayaGL.instance.TEXTURE_WRAP_S,t))}},{key:"wrapModeV",get:function(){return this._wrapModeV},set:function(t){this._wrapModeV!==t&&(this._wrapModeV=t,-1!==this._height&&this._setWarpMode(c.LayaGL.instance.TEXTURE_WRAP_T,t))}},{key:"filterMode",get:function(){return this._filterMode},set:function(t){t!==this._filterMode&&(this._filterMode=t,-1!==this._width&&-1!==this._height&&this._setFilterMode(t))}},{key:"anisoLevel",get:function(){return this._anisoLevel},set:function(t){t!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,t)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(t))}},{key:"mipmapCount",get:function(){return this._mipmapCount},set:function(t){this._mipmapCount=t}},{key:"defaulteTexture",get:function(){throw"BaseTexture:must override it."}},{key:"_getFormatByteCount",value:function(){switch(this._format){case v.TextureFormat.R8G8B8:return 3;case v.TextureFormat.R8G8B8A8:return 4;case v.TextureFormat.R5G6B5:case v.TextureFormat.Alpha8:return 1;case v.TextureFormat.R16G16B16A16:return 2;case v.TextureFormat.R32G32B32A32:return 4;default:throw"Texture2D: unknown format."}}},{key:"_isPot",value:function(t){return 0==(t&t-1)}},{key:"_getGLFormat",value:function(){var t,e=c.LayaGL.instance,i=c.LayaGL.layaGPUInstance;switch(this._format){case v.TextureFormat.R8G8B8:case v.TextureFormat.R5G6B5:t=e.RGB;break;case v.TextureFormat.R8G8B8A8:t=e.RGBA;break;case v.TextureFormat.Alpha8:t=e.ALPHA;break;case v.TextureFormat.R32G32B32A32:case v.TextureFormat.R16G16B16A16:t=e.RGBA;break;case v.TextureFormat.DXT1:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";t=i._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case v.TextureFormat.DXT5:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";t=i._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case v.TextureFormat.ETC1RGB:if(!i._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";t=i._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case v.TextureFormat.ETC2RGB:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2RGB format.";t=i._compressedTextureETC.COMPRESSED_RGB8_ETC2;break;case v.TextureFormat.ETC2RGBA:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2RGBA format.";t=i._compressedTextureETC.COMPRESSED_RGBA8_ETC2_EAC;break;case v.TextureFormat.ETC2RGB_Alpha8:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2SRGB_Alpha8 format.";t=i._compressedTextureETC.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;break;case v.TextureFormat.ETC2SRGB:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2SRGB format.";t=i._compressedTextureETC.COMPRESSED_SRGB8_ETC2;break;case v.TextureFormat.PVRTCRGB_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case v.TextureFormat.PVRTCRGBA_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case v.TextureFormat.PVRTCRGB_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case v.TextureFormat.PVRTCRGBA_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case v.TextureFormat.ASTC4x4:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC4x4 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_4x4_KHR;break;case v.TextureFormat.ASTC4x4SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC4x4_KHR format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case v.TextureFormat.ASTC6x6:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC6x6 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_6x6_KHR;break;case v.TextureFormat.ASTC6x6SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC6x6_KHR format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR;break;case v.TextureFormat.ASTC8x8:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC8x8 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_8x8_KHR;break;case v.TextureFormat.ASTC8x8SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC8x8 format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR;break;case v.TextureFormat.ASTC10x10:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC10x10 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_10x10_KHR;break;case v.TextureFormat.ASTC10x10SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC10x10 format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR;break;case v.TextureFormat.ASTC12x12:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC12x12 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_12x12_KHR;break;case v.TextureFormat.ASTC12x12SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC12x12 format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR;break;default:throw"BaseTexture: unknown texture format."}return t}},{key:"_setFilterMode",value:function(t){var e=c.LayaGL.instance;switch(d.WebGLContext.bindTexture(e,this._glTextureType,this._glTexture),t){case _.FilterMode.Point:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.NEAREST);break;case _.FilterMode.Bilinear:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case _.FilterMode.Trilinear:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.")}}},{key:"_setWarpMode",value:function(t,e){var i=c.LayaGL.instance;if(d.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(e){case y.WarpMode.Repeat:i.texParameteri(this._glTextureType,t,i.REPEAT);break;case y.WarpMode.Clamp:i.texParameteri(this._glTextureType,t,i.CLAMP_TO_EDGE);break;case y.WarpMode.Mirrored:i.texParameteri(this._glTextureType,t,i.MIRRORED_REPEAT)}else i.texParameteri(this._glTextureType,t,i.CLAMP_TO_EDGE)}},{key:"_setAnisotropy",value:function(t){var e=c.LayaGL.layaGPUInstance._extTextureFilterAnisotropic;if(e){t=Math.max(t,1);var i=c.LayaGL.instance;d.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture),t=Math.min(i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t),i.texParameterf(this._glTextureType,e.TEXTURE_MAX_ANISOTROPY_EXT,t)}}},{key:"_disposeResource",value:function(){this._glTexture&&(c.LayaGL.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))}},{key:"_getSource",value:function(){return this._readyed?this._glTexture:null}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)&&c.LayaGL.instance.generateMipmap(this._glTextureType)}}]),i}(f.Bitmap);e.BaseTexture=g,g._rgbmRange=5,g.FORMAT_R8G8B8=0,g.FORMAT_R8G8B8A8=1,g.FORMAT_ALPHA8=2,g.FORMAT_DXT1=3,g.FORMAT_DXT5=4,g.FORMAT_ETC1RGB=5,g.FORMAT_PVRTCRGB_2BPPV=9,g.FORMAT_PVRTCRGBA_2BPPV=10,g.FORMAT_PVRTCRGB_4BPPV=11,g.FORMAT_PVRTCRGBA_4BPPV=12,g.RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT=14,g.FORMAT_R32G32B32A32=15,g.FORMAT_DEPTH_16=0,g.FORMAT_STENCIL_8=1,g.FORMAT_DEPTHSTENCIL_16_8=2,g.FORMAT_DEPTHSTENCIL_NONE=3,g.FILTERMODE_POINT=0,g.FILTERMODE_BILINEAR=1,g.FILTERMODE_TRILINEAR=2,g.WARPMODE_REPEAT=0,g.WARPMODE_CLAMP=1},8944:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Bitmap=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305));function c(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var d=function(t){(0,l.default)(i,t);var e=c(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this))._width=-1,t._height=-1,t}return(0,o.default)(i,[{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"_getSource",value:function(){throw"Bitmap: must override it."}}]),i}(i(25883).Resource);e.Bitmap=d},79741:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Context=void 0;var r=a(i(3649)),s=a(i(44494)),o=a(i(77766)),l=a(i(78914)),u=a(i(15375)),h=a(i(17061)),c=i(92493),d=i(33873),f=i(93062),_=i(18008),v=i(85399),y=i(98693),p=i(683),g=i(91700),m=i(4629),x=i(91902),T=i(94961),k=i(64554),C=i(43719),S=i(55307),E=i(87948),M=i(37560),L=i(20541),b=i(97246),I=i(43989),R=i(28434),w=i(22245),A=i(46322),B=i(30347),D=i(36296),P=i(93055),O=i(23800),F=i(69153),U=i(76993),N=i(40113),G=i(95055),H=i(35266),W=i(30875),V=i(94286),Y=i(30966),X=i(86044),z=i(56161),K=i(61266),j=i(93894),q=i(57693),Z=i(54598),Q=i(87035),$=function(){function t(){if((0,u.default)(this,t),this._tmpMatrix=new _.Matrix,this._drawTexToDrawTri_Vert=new Float32Array(8),this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]),this._tempUV=new Float32Array(8),this._drawTriUseAbsMatrix=!1,this._id=++t._COUNT,this._other=null,this._renderNextSubmitIndex=0,this._path=null,this._drawCount=1,this._width=t._MAXSIZE,this._height=t._MAXSIZE,this._renderCount=0,this._submits=null,this._curSubmit=null,this._submitKey=new U.SubmitKey,this._pathMesh=null,this._triangleMesh=null,this.meshlist=[],this._transedPoints=new Array(8),this._temp4Points=new Array(8),this._clipRect=t.MAXCLIPRECT,this._globalClipMatrix=new _.Matrix(t._MAXSIZE,0,0,t._MAXSIZE,0,0),this._clipInCache=!1,this._clipInfoID=0,this._clipID_Gen=0,this._lastMatScaleX=1,this._lastMatScaleY=1,this._lastMat_a=1,this._lastMat_b=0,this._lastMat_c=0,this._lastMat_d=1,this._nBlendType=0,this._save=null,this._targets=null,this._charSubmitCache=null,this._saveMark=null,this._shader2D=new b.Shader2D,this.sprite=null,this._italicDeg=0,this._lastTex=null,this._fillColor=0,this._flushCnt=0,this.defTexture=null,this._colorFiler=null,this.drawTexAlign=!1,this._incache=!1,this.isMain=!1,t._contextcount++,t._textRender=t._textRender||new W.TextRender,!this.defTexture){var e=new Q.Texture2D(2,2);e.setPixels(new Uint8Array(16)),e.lock=!0,this.defTexture=new Z.Texture(e)}this._lastTex=this.defTexture,this.clear()}return(0,h.default)(t,[{key:"drawImage",value:function(){}},{key:"getImageData",value:function(){}},{key:"measureText",value:function(t){return null}},{key:"setTransform",value:function(){}},{key:"$transform",value:function(t,e,i,n,a,r){}},{key:"lineJoin",get:function(){return""},set:function(t){}},{key:"lineCap",get:function(){return""},set:function(t){}},{key:"miterLimit",get:function(){return""},set:function(t){}},{key:"clearRect",value:function(t,e,i,n){}},{key:"_drawRect",value:function(t,e,i,n,a){p.Stat.renderBatches++,a&&(this.fillStyle=a),this.fillRect(t,e,i,n,null)}},{key:"drawTexture2",value:function(t,e,i,n,a,r){}},{key:"transformByMatrix",value:function(t,e,i){this.transform(t.a,t.b,t.c,t.d,t.tx+e,t.ty+i)}},{key:"saveTransform",value:function(t){this.save()}},{key:"restoreTransform",value:function(t){this.restore()}},{key:"drawRect",value:function(t,e,i,n,a,r,s){var o=this;null!=a&&(o.fillStyle=a,o.fillRect(t,e,i,n)),null!=r&&(o.strokeStyle=r,o.lineWidth=s,o.strokeRect(t,e,i,n))}},{key:"alpha",value:function(t){this.globalAlpha*=t}},{key:"_transform",value:function(t,e,i){this.translate(e,i),this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty),this.translate(-e,-i)}},{key:"_rotate",value:function(t,e,i){this.translate(e,i),this.rotate(t),this.translate(-e,-i)}},{key:"_scale",value:function(t,e,i,n){this.translate(i,n),this.scale(t,e),this.translate(-i,-n)}},{key:"_drawLine",value:function(t,e,i,n,a,r,s,o,l){this.beginPath(),this.strokeStyle=s,this.lineWidth=o,this.moveTo(t+i,e+n),this.lineTo(t+a,e+r),this.stroke()}},{key:"_drawLines",value:function(t,e,i,n,a,s){this.beginPath(),this.strokeStyle=n,this.lineWidth=a,this.addPath((0,r.default)(i).call(i),!1,!1,t,e),this.stroke()}},{key:"drawCurves",value:function(t,e,i,n,a){this.beginPath(),this.strokeStyle=n,this.lineWidth=a,this.moveTo(t+i[0],e+i[1]);for(var r=2,s=i.length;r<s;)this.quadraticCurveTo(t+i[r++],e+i[r++],t+i[r++],e+i[r++]);this.stroke()}},{key:"_fillAndStroke",value:function(t,e,i){var n;null!=t&&(this.fillStyle=t,(0,s.default)(n=this).call(n));null!=e&&i>0&&(this.strokeStyle=e,this.lineWidth=i,this.stroke())}},{key:"_drawCircle",value:function(e,i,n,a,r,s,o){p.Stat.renderBatches++,this.beginPath(!0),this.arc(e,i,n,0,t.PI2),this.closePath(),this._fillAndStroke(a,r,s)}},{key:"_drawPie",value:function(t,e,i,n,a,r,s,o,l){this.beginPath(),this.moveTo(t,e),this.arc(t,e,i,n,a),this.closePath(),this._fillAndStroke(r,s,o)}},{key:"_drawPoly",value:function(t,e,i,n,a,s,o,l){this.beginPath(),this.addPath((0,r.default)(i).call(i),!0,o,t,e),this.closePath(),this._fillAndStroke(n,a,s,o)}},{key:"_drawPath",value:function(t,e,i,n,a){this.beginPath();for(var r=0,o=i.length;r<o;r++){var l=i[r];switch(l[0]){case"moveTo":this.moveTo(t+l[1],e+l[2]);break;case"lineTo":this.lineTo(t+l[1],e+l[2]);break;case"arcTo":this.arcTo(t+l[1],e+l[2],t+l[3],e+l[4],l[5]);break;case"closePath":this.closePath()}}null!=n&&(this.fillStyle=n.fillStyle,(0,s.default)(this).call(this));null!=a&&(this.strokeStyle=a.strokeStyle,this.lineWidth=a.lineWidth||1,this.lineJoin=a.lineJoin,this.lineCap=a.lineCap,this.miterLimit=a.miterLimit,this.stroke())}},{key:"clearBG",value:function(t,e,i,n){var a=K.WebGLContext.mainContext;a.clearColor(t,e,i,n),a.clear(a.COLOR_BUFFER_BIT)}},{key:"_getSubmits",value:function(){return this._submits}},{key:"_releaseMem",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._submits){this._curMat&&this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null,this._charSubmitCache.clear();for(var e=0,i=this._submits._length;e<i;e++)this._submits[e].releaseRender();var n;for(this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null,e=0,n=this.meshlist.length;e<n;e++){var a=this.meshlist[e];a.destroy()}this.meshlist.length=0,this.sprite=null,t||(this._targets&&this._targets.destroy(),this._targets=null)}}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];--t._contextcount,this.sprite=null,this._releaseMem(e),this._charSubmitCache&&this._charSubmitCache.destroy(),this._mesh.destroy(),e||(this._targets&&this._targets.destroy(),this._targets=null)}},{key:"clear",value:function(){this._submits||(this._other=J.DEFAULT,this._curMat=_.Matrix.create(),this._charSubmitCache=new H.CharSubmitCache,this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),this._pathMesh=X.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._triangleMesh=Y.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[C.SaveMark.Create(this)],this._save.length=10,this._shader2D=new b.Shader2D),this._submitKey.clear(),this._mesh.clearVB(),this._drawCount=1,this._other=J.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=t.MAXCLIPRECT,this._curSubmit=P.SubmitBase.RENDERBASE,P.SubmitBase.RENDERBASE._ref=16777215,P.SubmitBase.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=m.DrawStyle.DEFAULT;for(var e=0,i=this._submits._length;e<i;e++)this._submits[e].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1}},{key:"size",value:function(t,e){this._width==t&&this._height==e||(this._width=t,this._height=e,this._targets&&(this._targets.destroy(),this._targets=new j.RenderTexture2D(t,e,q.RenderTextureFormat.R8G8B8A8,-1)),this.isMain&&(K.WebGLContext.mainContext.viewport(0,0,t,e),z.RenderState2D.width=t,z.RenderState2D.height=e)),0===t&&0===e&&this._releaseMem()}},{key:"asBitmap",set:function(t){if(t){var e=this._targets;if(!this._width||!this._height)throw Error("asBitmap no size!");e&&e.width==this._width&&e.height==this._height||(e&&e.destroy(),this._targets=new j.RenderTexture2D(this._width,this._height,q.RenderTextureFormat.R8G8B8A8,-1))}else this._targets&&this._targets.destroy(),this._targets=null}},{key:"getMatScaleX",value:function(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b||(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b),this._lastMatScaleX}},{key:"getMatScaleY",value:function(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d||(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d),this._lastMatScaleY}},{key:"setFillColor",value:function(t){this._fillColor=t}},{key:"getFillColor",value:function(){return this._fillColor}},{key:"fillStyle",get:function(){return this._shader2D.fillStyle},set:function(t){this._shader2D.fillStyle.equal(t)||(T.SaveBase.save(this,T.SaveBase.TYPE_FILESTYLE,this._shader2D,!1),this._shader2D.fillStyle=m.DrawStyle.create(t),this._submitKey.other=-this._shader2D.fillStyle.toInt())}},{key:"globalAlpha",get:function(){return this._shader2D.ALPHA},set:function(t){(t=Math.floor(1e3*t)/1e3)!=this._shader2D.ALPHA&&(T.SaveBase.save(this,T.SaveBase.TYPE_ALPHA,this._shader2D,!1),this._shader2D.ALPHA=t)}},{key:"textAlign",get:function(){return this._other.textAlign},set:function(t){this._other.textAlign===t||(this._other=this._other.make(),T.SaveBase.save(this,T.SaveBase.TYPE_TEXTALIGN,this._other,!1),this._other.textAlign=t)}},{key:"textBaseline",get:function(){return this._other.textBaseline},set:function(t){this._other.textBaseline===t||(this._other=this._other.make(),T.SaveBase.save(this,T.SaveBase.TYPE_TEXTBASELINE,this._other,!1),this._other.textBaseline=t)}},{key:"globalCompositeOperation",get:function(){return g.BlendMode.NAMES[this._nBlendType]},set:function(t){var e=g.BlendMode.TOINT[t];null==e||this._nBlendType===e||(T.SaveBase.save(this,T.SaveBase.TYPE_GLOBALCOMPOSITEOPERATION,this,!0),this._curSubmit=P.SubmitBase.RENDERBASE,this._nBlendType=e)}},{key:"strokeStyle",get:function(){return this._shader2D.strokeStyle},set:function(t){this._shader2D.strokeStyle.equal(t)||(T.SaveBase.save(this,T.SaveBase.TYPE_STROKESTYLE,this._shader2D,!1),this._shader2D.strokeStyle=m.DrawStyle.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}},{key:"translate",value:function(t,e){0===t&&0===e||(E.SaveTranslate.save(this),this._curMat._bTransform?(S.SaveTransform.save(this),this._curMat.tx+=t*this._curMat.a+e*this._curMat.c,this._curMat.ty+=t*this._curMat.b+e*this._curMat.d):(this._curMat.tx=t,this._curMat.ty=e))}},{key:"lineWidth",get:function(){return this._other.lineWidth},set:function(t){this._other.lineWidth===t||(this._other=this._other.make(),T.SaveBase.save(this,T.SaveBase.TYPE_LINEWIDTH,this._other,!1),this._other.lineWidth=t)}},{key:"save",value:function(){this._save[this._save._length++]=C.SaveMark.Create(this)}},{key:"restore",value:function(){var t=this._save._length,e=this._nBlendType;if(!(t<1)){for(var i=t-1;i>=0;i--){var n=this._save[i];if(n.restore(this),n.isSaveMark())return void(this._save._length=i)}e!=this._nBlendType&&(this._curSubmit=P.SubmitBase.RENDERBASE)}}},{key:"font",set:function(t){this._other=this._other.make(),T.SaveBase.save(this,T.SaveBase.TYPE_FONT,this._other,!1)}},{key:"fillText",value:function(e,i,n,a,r,s){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";t._textRender.filltext(this,e,i,n,a,r,l,o,s)}},{key:"drawText",value:function(e,i,n,a,r,s){t._textRender.filltext(this,e,i,n,a,r,null,0,s)}},{key:"fillWords",value:function(e,i,n,a,r){t._textRender.fillWords(this,e,i,n,a,r,null,0)}},{key:"strokeWord",value:function(e,i,n,a,r,s,o){t._textRender.filltext(this,e,i,n,a,null,r,s,o)}},{key:"fillBorderText",value:function(e,i,n,a,r,s,o,l){t._textRender.filltext(this,e,i,n,a,r,s,o,l)}},{key:"fillBorderWords",value:function(e,i,n,a,r,s,o){t._textRender.fillWords(this,e,i,n,a,r,s,o)}},{key:"_fast_filltext",value:function(e,i,n,a,r,s,o,l){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;t._textRender._fast_filltext(this,e,null,i,n,a,r,s,o,l,u)}},{key:"_fillRect",value:function(e,i,n,a,r){var s=this._curSubmit,o=s&&s._key.submitType===P.SubmitBase.KEY_DRAWTEXTURE&&s._key.blendShader===this._nBlendType;this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),o=!1),o&&(o=o&&this.isSameClipInfo(s)),this.transformQuad(e,i,n,a,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,Z.Texture.NO_UV,r,!1),o||(s=this._curSubmit=G.SubmitTexture.create(this,this._mesh,w.Value2D.create(I.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=s,this._copyClipInfo(s,this._globalClipMatrix),s.shaderValue.textureHost=this._lastTex,s._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1,s._renderType=P.SubmitBase.TYPE_TEXTURE),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"fillRect",value:function(t,e,i,n,a){var r=a?m.DrawStyle.create(a):this._shader2D.fillStyle,s=this.mixRGBandAlpha(r.toInt());this._fillRect(t,e,i,n,s)}},{key:"fillTexture",value:function(t,e,i,n,a,r,s,o){t._getSource()?this._fillTexture(t,t.width,t.height,t.uvrect,e,i,n,a,r,s.x,s.y):this.sprite&&c.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"_fillTexture",value:function(e,i,n,a,r,s,l,u,h,c,d){var f=this._curSubmit;this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var _=!0,v=!0;switch(h){case"repeat":default:break;case"repeat-x":v=!1;break;case"repeat-y":_=!1;break;case"no-repeat":_=v=!1}var y=this._temp4Points,p=0,g=0,m=0,x=0,T=0,k=0;if(c<0?(m=r,p=-c%i/i):m=r+c,d<0?(x=s,g=-d%n/n):x=s+d,T=r+l,k=s+u,!_&&(T=Math.min(T,r+c+i)),!v&&(k=Math.min(k,s+d+n)),!(T<r||k<s||m>T||x>k)){var C=(T-r-c)/i,S=(k-s-d)/n;if(this.transformQuad(m,x,T-m,k-x,0,this._curMat,this._transedPoints),y[0]=p,y[1]=g,y[2]=C,y[3]=g,y[4]=C,y[5]=S,y[6]=p,y[7]=S,!this.clipedOff(this._transedPoints)){var E=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,y,E,!0);var M=w.Value2D.create(I.ShaderDefines2D.TEXTURE2D,0);M.defines.add(I.ShaderDefines2D.FILLTEXTURE),M.u_TexRange=(0,o.default)(a).call(a),f=this._curSubmit=G.SubmitTexture.create(this,this._mesh,M),this._submits[this._submits._length++]=f,this._copyClipInfo(f,this._globalClipMatrix),f.shaderValue.textureHost=e,f._renderType=P.SubmitBase.TYPE_TEXTURE,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4}this.breakNextMerge()}}},{key:"setColorFilter",value:function(t){T.SaveBase.save(this,T.SaveBase.TYPE_COLORFILTER,this,!0),this._colorFiler=t,this._curSubmit=P.SubmitBase.RENDERBASE}},{key:"drawTexture",value:function(t,e,i,n,a){this._drawTextureM(t,e,i,n,a,null,1,null)}},{key:"drawTextures",value:function(t,e,i,n){if(t._getSource())for(var a=e.length/2,r=0,s=t.bitmap.id,o=0;o<a;o++)this._inner_drawTexture(t,s,e[r++]+i,e[r++]+n,0,0,null,null,1,!1);else this.sprite&&c.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"_drawTextureAddSubmit",value:function(t,e){var i=null;i=G.SubmitTexture.create(this,this._mesh,w.Value2D.create(I.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=i,i.shaderValue.textureHost=e,i._key.other=t,i._renderType=P.SubmitBase.TYPE_TEXTURE,this._curSubmit=i}},{key:"_drawTextureM",value:function(t,e,i,n,a,r,s,o){var l=this.sprite;return!!t._getSource((function(){l&&l.repaint()}))&&this._inner_drawTexture(t,t.bitmap.id,e,i,n,a,r,o,s,!1)}},{key:"_drawRenderTexture",value:function(t,e,i,n,a,r,s,o){return this._inner_drawTexture(t,-1,e,i,n,a,r,o,1,!1)}},{key:"submitDebugger",value:function(){this._submits[this._submits._length++]=F.SubmitCMD.create([],(function(){}),this)}},{key:"_copyClipInfo",value:function(t,e){var i=t.shaderValue.clipMatDir;i[0]=e.a,i[1]=e.b,i[2]=e.c,i[3]=e.d;var n=t.shaderValue.clipMatPos;n[0]=e.tx,n[1]=e.ty,t.clipInfoID=this._clipInfoID,this._clipInCache&&(t.shaderValue.clipOff[0]=1)}},{key:"isSameClipInfo",value:function(t){return t.clipInfoID===this._clipInfoID}},{key:"_useNewTex2DSubmit",value:function(e,i){this._mesh.vertNum+i>t._MAXVERTNUM&&(this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var n=G.SubmitTexture.create(this,this._mesh,w.Value2D.create(I.ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=this._curSubmit=n,n.shaderValue.textureHost=e,this._copyClipInfo(n,this._globalClipMatrix)}},{key:"_drawTexRect",value:function(t,e,i,n,a){this.transformQuad(t,e,i,n,this._italicDeg,this._curMat,this._transedPoints);var r=this._transedPoints;r[0]=r[0]+.5|0,r[1]=r[1]+.5|0,r[2]=r[2]+.5|0,r[3]=r[3]+.5|0,r[4]=r[4]+.5|0,r[5]=r[5]+.5|0,r[6]=r[6]+.5|0,r[7]=r[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,a,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"drawCallOptimize",value:function(t){return this._charSubmitCache.enable(t,this),t}},{key:"_inner_drawTexture",value:function(e,i,n,a,r,s,o,l,u,h){if(r<=0||s<=0)return!1;var c=this._curSubmit._key;if(l=l||e._uv,c.submitType===P.SubmitBase.KEY_TRIANGLES&&c.other===i){var d=this._drawTexToDrawTri_Vert;d[0]=n,d[1]=a,d[2]=n+r,d[3]=a,d[4]=n+r,d[5]=a+s,d[6]=n,d[7]=a+s,this._drawTriUseAbsMatrix=!0;var f=this._tempUV;return f[0]=l[0],f[1]=l[1],f[2]=l[2],f[3]=l[3],f[4]=l[4],f[5]=l[5],f[6]=l[6],f[7]=l[7],this.drawTriangles(e,0,0,d,f,this._drawTexToDrawTri_Index,o||this._curMat,u,null,null),this._drawTriUseAbsMatrix=!1,!0}var _=this._mesh,v=this._curSubmit,y=h?this._charSubmitCache.getPos():this._transedPoints;if(this.transformQuad(n,a,r||e.width,s||e.height,this._italicDeg,o||this._curMat,y),this.drawTexAlign){var p=Math.round;y[0]=p(y[0]),y[1]=p(y[1]),y[2]=p(y[2]),y[3]=p(y[3]),y[4]=p(y[4]),y[5]=p(y[5]),y[6]=p(y[6]),y[7]=p(y[7]),this.drawTexAlign=!1}var g=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*u);if(h)return this._charSubmitCache.add(this,e,i,y,l,g),!0;this._drawCount++;var m=i>=0&&c.submitType===P.SubmitBase.KEY_DRAWTEXTURE&&c.other===i;return m&&(m=m&&this.isSameClipInfo(v)),this._lastTex=e,_.vertNum+4>t._MAXVERTNUM&&(_=this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(_),m=!1),_.addQuad(y,l,g,!0),m||(this._submits[this._submits._length++]=this._curSubmit=v=G.SubmitTexture.create(this,_,w.Value2D.create(I.ShaderDefines2D.TEXTURE2D,0)),v.shaderValue.textureHost=e,v._key.other=i,this._copyClipInfo(v,this._globalClipMatrix)),v._numEle+=6,_.indexNum+=6,_.vertNum+=4,!0}},{key:"transform4Points",value:function(t,e,i){var n=e.tx,a=e.ty,r=e.a,s=e.b,o=e.c,l=e.d,u=t[0],h=t[1],c=t[2],d=t[3],f=t[4],_=t[5],v=t[6],y=t[7];e._bTransform?(i[0]=u*r+h*o+n,i[1]=u*s+h*l+a,i[2]=c*r+d*o+n,i[3]=c*s+d*l+a,i[4]=f*r+_*o+n,i[5]=f*s+_*l+a,i[6]=v*r+y*o+n,i[7]=v*s+y*l+a):(i[0]=u+n,i[1]=h+a,i[2]=c+n,i[3]=d+a,i[4]=f+n,i[5]=_+a,i[6]=v+n,i[7]=y+a)}},{key:"clipedOff",value:function(t){return this._clipRect.width<=0||this._clipRect.height<=0}},{key:"transformQuad",value:function(t,e,i,n,a,r,s){var o=0;0!=a&&(o=Math.tan(a*Math.PI/180)*n);var l=t+i,u=e+n,h=r.tx,c=r.ty,d=r.a,f=r.b,_=r.c,v=r.d,y=t+o,p=e,g=l+o,m=e,x=l,T=u,k=t,C=u;r._bTransform?(s[0]=y*d+p*_+h,s[1]=y*f+p*v+c,s[2]=g*d+m*_+h,s[3]=g*f+m*v+c,s[4]=x*d+T*_+h,s[5]=x*f+T*v+c,s[6]=k*d+C*_+h,s[7]=k*f+C*v+c):(s[0]=y+h,s[1]=p+c,s[2]=g+h,s[3]=m+c,s[4]=x+h,s[5]=T+c,s[6]=k+h,s[7]=C+c)}},{key:"pushRT",value:function(){this.addRenderObject(F.SubmitCMD.create(null,j.RenderTexture2D.pushRT,this))}},{key:"popRT",value:function(){this.addRenderObject(F.SubmitCMD.create(null,j.RenderTexture2D.popRT,this)),this.breakNextMerge()}},{key:"useRT",value:function(t){this.addRenderObject(F.SubmitCMD.create([t],(function(t){if(!t)throw"error useRT";t.start(),t.clear(0,0,0,0)}),this)),this.breakNextMerge()}},{key:"RTRestore",value:function(t){this.addRenderObject(F.SubmitCMD.create([t],(function(t){t.restore()}),this)),this.breakNextMerge()}},{key:"breakNextMerge",value:function(){this._curSubmit=P.SubmitBase.RENDERBASE}},{key:"_repaintSprite",value:function(){this.sprite&&this.sprite.repaint()}},{key:"drawTextureWithTransform",value:function(t,e,i,n,a,r,s,o,l,u){var h,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,d=arguments.length>11?arguments[11]:void 0,f=this._curMat;u&&(h=this.globalCompositeOperation,this.globalCompositeOperation=u);var v=this._colorFiler;if(c&&this.setColorFilter(c),!r)return this._drawTextureM(t,e+s,i+o,n,a,f,l,d),u&&(this.globalCompositeOperation=h),void(c&&this.setColorFilter(v));var y=this._tmpMatrix;y.a=r.a,y.b=r.b,y.c=r.c,y.d=r.d,y.tx=r.tx+s,y.ty=r.ty+o,y._bTransform=r._bTransform,r&&f._bTransform?(_.Matrix.mul(y,f,y),(r=y)._bTransform=!0):(y.tx+=f.tx,y.ty+=f.ty,r=y),this._drawTextureM(t,e,i,n,a,r,l,d),u&&(this.globalCompositeOperation=h),c&&this.setColorFilter(v)}},{key:"_flushToTarget",value:function(t,e){z.RenderState2D.worldScissorTest=!1;var i=d.LayaGL.instance;i.disable(i.SCISSOR_TEST);var n=z.RenderState2D.worldAlpha,a=z.RenderState2D.worldMatrix4,r=z.RenderState2D.worldMatrix;z.RenderState2D.worldShaderDefines;z.RenderState2D.worldMatrix=_.Matrix.EMPTY,z.RenderState2D.restoreTempArray(),z.RenderState2D.worldMatrix4=z.RenderState2D.TEMPMAT4_ARRAY,z.RenderState2D.worldAlpha=1,L.BaseShader.activeShader=null,e.start(),t._submits._length>0&&e.clear(0,0,0,0),t._curSubmit=P.SubmitBase.RENDERBASE,t.flush(),t.clear(),e.restore(),t._curSubmit=P.SubmitBase.RENDERBASE,L.BaseShader.activeShader=null,z.RenderState2D.worldAlpha=n,z.RenderState2D.worldMatrix4=a,z.RenderState2D.worldMatrix=r}},{key:"drawCanvas",value:function(t,e,i,n,a){if(t){var r,s=t.context;if(s._targets)s._submits._length>0&&(r=F.SubmitCMD.create([s,s._targets],this._flushToTarget,this),this._submits[this._submits._length++]=r),this._drawRenderTexture(s._targets,e,i,n,a,null,1,j.RenderTexture2D.flipyuv),this._curSubmit=P.SubmitBase.RENDERBASE;else{var o,u=t;if(u.touches)(0,l.default)(o=u.touches).call(o,(function(t){t.touch()}));r=O.SubmitCanvas.create(t,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=r,r._key.clear();var h=r._matrix;this._curMat.copyTo(h);var c=h.tx,d=h.ty;h.tx=h.ty=0,h.transformPoint(v.Point.TEMP.setTo(e,i)),h.translate(v.Point.TEMP.x+c,v.Point.TEMP.y+d),_.Matrix.mul(u.invMat,h,h),this._curSubmit=P.SubmitBase.RENDERBASE}}}},{key:"drawTarget",value:function(e,i,n,a,r,s,o){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1;this._drawCount++;if(this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh)),this.transformQuad(i,n,a,r,0,s||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,l||Z.Texture.DEF_UV,4294967295,!0);var h=this._curSubmit=N.SubmitTarget.create(this,this._mesh,o,e);return h.blendType=-1==u?this._nBlendType:u,this._copyClipInfo(h,this._globalClipMatrix),h._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._submits[this._submits._length++]=h,this._curSubmit=P.SubmitBase.RENDERBASE,!0}return this._curSubmit=P.SubmitBase.RENDERBASE,!1}},{key:"drawTriangles",value:function(e,i,n,a,r,s,o,l,u,h){var d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:4294967295;if(e._getSource()){var f=null;h&&(f=this.globalCompositeOperation,this.globalCompositeOperation=h),this._drawCount++;var v=this._tmpMatrix,y=this._triangleMesh,p=null,g=!1;u&&(p=this._colorFiler,this._colorFiler=u,this._curSubmit=P.SubmitBase.RENDERBASE,g=p!=u);var m=e.bitmap,x=this._curSubmit._key,T=x.submitType===P.SubmitBase.KEY_TRIANGLES&&x.other===m.id&&x.blendShader==this._nBlendType;if(y.vertNum+a.length/2>t._MAXVERTNUM&&(y=this._triangleMesh=Y.MeshTexture.getAMesh(this.isMain),this.meshlist.push(y),T=!1),!T){var k=this._curSubmit=G.SubmitTexture.create(this,y,w.Value2D.create(I.ShaderDefines2D.TEXTURE2D,0));k.shaderValue.textureHost=e,k._renderType=P.SubmitBase.TYPE_TEXTURE,k._key.submitType=P.SubmitBase.KEY_TRIANGLES,k._key.other=m.id,this._copyClipInfo(k,this._globalClipMatrix),this._submits[this._submits._length++]=k}var C=this._mixRGBandAlpha(d,this._shader2D.ALPHA*l);this._drawTriUseAbsMatrix?y.addData(a,r,s,o,C):(o?(v.a=o.a,v.b=o.b,v.c=o.c,v.d=o.d,v.tx=o.tx+i,v.ty=o.ty+n):(v.a=1,v.b=0,v.c=0,v.d=1,v.tx=i,v.ty=n),_.Matrix.mul(v,this._curMat,v),y.addData(a,r,s,v||this._curMat,C)),this._curSubmit._numEle+=s.length,g&&(this._colorFiler=p,this._curSubmit=P.SubmitBase.RENDERBASE),h&&(this.globalCompositeOperation=f)}else this.sprite&&c.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"transform",value:function(t,e,i,n,a,r){S.SaveTransform.save(this),_.Matrix.mul(_.Matrix.TEMP.setTo(t,e,i,n,a,r),this._curMat,this._curMat),this._curMat._checkTransform()}},{key:"_transformByMatrix",value:function(t,e,i){t.setTranslate(e,i),_.Matrix.mul(t,this._curMat,this._curMat),t.setTranslate(0,0),this._curMat._bTransform=!0}},{key:"setTransformByMatrix",value:function(t){t.copyTo(this._curMat)}},{key:"rotate",value:function(t){S.SaveTransform.save(this),this._curMat.rotateEx(t)}},{key:"scale",value:function(t,e){S.SaveTransform.save(this),this._curMat.scaleEx(t,e)}},{key:"clipRect",value:function(e,i,n,a){k.SaveClipRect.save(this),this._clipRect==t.MAXCLIPRECT?this._clipRect=new y.Rectangle(e,i,n,a):(this._clipRect.width=n,this._clipRect.height=a,this._clipRect.x=e,this._clipRect.y=i),this._clipID_Gen++,this._clipID_Gen%=1e4,this._clipInfoID=this._clipID_Gen;var r=this._globalClipMatrix,s=r.tx,o=r.ty,l=s+r.a,u=o+r.d;if(this._clipRect.width>=t._MAXSIZE?(r.a=r.d=t._MAXSIZE,r.b=r.c=r.tx=r.ty=0):(this._curMat._bTransform?(r.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,r.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,r.a=this._clipRect.width*this._curMat.a,r.b=this._clipRect.width*this._curMat.b,r.c=this._clipRect.height*this._curMat.c,r.d=this._clipRect.height*this._curMat.d):(r.tx=this._clipRect.x+this._curMat.tx,r.ty=this._clipRect.y+this._curMat.ty,r.a=this._clipRect.width,r.b=r.c=0,r.d=this._clipRect.height),this._incache&&(this._clipInCache=!0)),r.a>0&&r.d>0){var h=r.tx+r.a,c=r.ty+r.d;h<=s||c<=o||r.tx>=l||r.ty>=u?(r.a=-.1,r.d=-.1):(r.tx<s&&(r.a-=s-r.tx,r.tx=s),h>l&&(r.a-=h-l),r.ty<o&&(r.d-=o-r.ty,r.ty=o),c>u&&(r.d-=c-u),r.a<=0&&(r.a=-.1),r.d<=0&&(r.d=-.1))}}},{key:"drawMesh",value:function(t,e,i,n,a,r,s,o){}},{key:"addRenderObject",value:function(t){this._submits[this._submits._length++]=t}},{key:"submitElement",value:function(t,e){this.isMain;var i=this._submits,n=i._length;e<0&&(e=i._length);for(var a=P.SubmitBase.RENDERBASE;t<e;)this._renderNextSubmitIndex=t+1,i[t]!==P.SubmitBase.RENDERBASE?(P.SubmitBase.preRender=a,t+=(a=i[t]).renderSubmit()):t++;return n}},{key:"flush",value:function(){this._clipID_Gen=0;var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),R.SkinMeshBuffer.instance&&R.SkinMeshBuffer.getInstance().reset(),this._curSubmit=P.SubmitBase.RENDERBASE;for(var e=0,i=this.meshlist.length;e<i;e++){var n=this.meshlist[e];n.canReuse?n.releaseMesh():n.destroy()}return this.meshlist.length=0,this._mesh=V.MeshQuadTexture.getAMesh(this.isMain),this._pathMesh=X.MeshVG.getAMesh(this.isMain),this._triangleMesh=Y.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%60==0&&this.isMain&&W.TextRender.textRenderInst&&W.TextRender.textRenderInst.GC(),t}},{key:"beginPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._getPath();e.beginPath(t)}},{key:"closePath",value:function(){this._path.closePath()}},{key:"addPath",value:function(t,e,i,n,a){for(var r=0,s=0,o=t.length/2;s<o;s++){var l=t[r]+n,u=t[r+1]+a;t[r]=l,t[r+1]=u,r+=2}this._getPath().push(t,i)}},{key:"fill",value:function(){var e=this._curMat,i=this._getPath(),n=this._curSubmit,a=n._key.submitType===P.SubmitBase.KEY_VG&&n._key.blendShader===this._nBlendType;a&&(a=a&&this.isSameClipInfo(n)),a||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var r,s=this.mixRGBandAlpha(this.fillStyle.toInt()),l=0,u=0,h=i.paths.length;u<h;u++){var c,d=i.paths[u],f=d.path.length/2;if(!(f<3||3==f&&!d.convex)){var _,v,y,p,g=(0,o.default)(c=d.path).call(c),m=0;if(e._bTransform)for(m=0;m<f;m++)v=(_=m<<1)+1,y=g[_],p=g[v],g[_]=e.a*y+e.c*p+e.tx,g[v]=e.b*y+e.d*p+e.ty;else for(m=0;m<f;m++)v=(_=m<<1)+1,y=g[_],p=g[v],g[_]=y+e.tx,g[v]=p+e.ty;this._pathMesh.vertNum+f>t._MAXVERTNUM&&(this._curSubmit._numEle+=l,l=0,this._pathMesh=X.MeshVG.getAMesh(this.isMain),this._curSubmit=this.addVGSubmit(this._pathMesh));var x=this._pathMesh.vertNum;if(d.convex){var T=f-2;r=new Array(3*T);for(var k=0,C=0;C<T;C++)r[k++]=x,r[k++]=C+1+x,r[k++]=C+2+x}else if(r=B.Earcut.earcut(g,null,2),x>0)for(var S=0;S<r.length;S++)r[S]+=x;this._pathMesh.addVertAndIBToMesh(this,g,s,r),l+=r.length}}this._curSubmit._numEle+=l}},{key:"addVGSubmit",value:function(t){var e=D.Submit.createShape(this,t,0,w.Value2D.create(I.ShaderDefines2D.PRIMITIVE,0));return e._key.submitType=P.SubmitBase.KEY_VG,this._submits[this._submits._length++]=e,this._copyClipInfo(e,this._globalClipMatrix),e}},{key:"stroke",value:function(){if(this.lineWidth>0){var e=this.mixRGBandAlpha(this.strokeStyle._color.numColor),i=this._getPath(),n=this._curSubmit,a=n._key.submitType===P.SubmitBase.KEY_VG&&n._key.blendShader===this._nBlendType;a&&(a=a&&this.isSameClipInfo(n)),a||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var r=0,s=0,o=i.paths.length;s<o;s++){var l=i.paths[s];if(!(l.path.length<=0)){var u=[],h=[],c=2*l.path.length;if(!(c<2)){this._pathMesh.vertNum+c>t._MAXVERTNUM&&(this._curSubmit._numEle+=r,r=0,this._pathMesh=X.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),A.BasePoly.createLine2(l.path,u,this.lineWidth,this._pathMesh.vertNum,h,l.loop);var d,f,_,v,y=h.length/2,p=this._curMat,g=0;if(p._bTransform)for(g=0;g<y;g++)f=(d=g<<1)+1,_=h[d],v=h[f],h[d]=p.a*_+p.c*v+p.tx,h[f]=p.b*_+p.d*v+p.ty;else for(g=0;g<y;g++)f=(d=g<<1)+1,_=h[d],v=h[f],h[d]=_+p.tx,h[f]=v+p.ty;this._pathMesh.addVertAndIBToMesh(this,h,e,u),r+=u.length}}}this._curSubmit._numEle+=r}}},{key:"moveTo",value:function(t,e){var i=this._getPath();i.newPath(),i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e)}},{key:"lineTo",value:function(t,e){var i=this._getPath();Math.abs(t-i._lastOriX)<.001&&Math.abs(e-i._lastOriY)<.001||(i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e))}},{key:"arcTo",value:function(e,i,n,a,r){var s=0,o=0,l=0,u=this._path._lastOriX-e,h=this._path._lastOriY-i,c=Math.sqrt(u*u+h*h);if(!(c<=1e-6)){var d=u/c,f=h/c,_=n-e,v=a-i,y=_*_+v*v,p=Math.sqrt(y);if(!(p<=1e-6)){var g=_/p,m=v/p,x=d+g,T=f+m,k=Math.sqrt(x*x+T*T);if(!(k<=1e-6)){var C=x/k,S=T/k,E=Math.acos(C*d+S*f),M=Math.PI/2-E,L=(c=r/Math.tan(M))*d+e,b=c*f+i,I=Math.sqrt(c*c+r*r),R=e+C*I,w=i+S*I,A=0,B=0;if(d*m-f*g>=0){var D=2*M/t.SEGNUM;A=Math.sin(D),B=Math.cos(D)}else D=2*-M/t.SEGNUM,A=Math.sin(D),B=Math.cos(D);var P=this._path._lastOriX,O=this._path._lastOriY,F=L,U=b;(Math.abs(F-this._path._lastOriX)>.1||Math.abs(U-this._path._lastOriY)>.1)&&(o=F,l=U,P=F,O=U,this._path._lastOriX=o,this._path._lastOriY=l,this._path.addPoint(o,l));var N=L-R,G=b-w;for(s=0;s<t.SEGNUM;s++){var H=N*B+G*A,W=-N*A+G*B;o=H+R,l=W+w,(Math.abs(P-o)>.1||Math.abs(O-l)>.1)&&(this._path._lastOriX=o,this._path._lastOriY=l,this._path.addPoint(o,l),P=o,O=l),N=H,G=W}}}}}},{key:"arc",value:function(t,e,i,n,a){var r,s,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=0,u=0,h=0,c=0,d=0,f=0,_=0;if(u=a-n,o)if(Math.abs(u)>=2*Math.PI)u=2*-Math.PI;else for(;u>0;)u-=2*Math.PI;else if(Math.abs(u)>=2*Math.PI)u=2*Math.PI;else for(;u<0;)u+=2*Math.PI;var v=this.getMatScaleX(),y=this.getMatScaleY(),p=i*(v>y?v:y),g=2*Math.PI*p;h=u/(s=0|Math.max(g/10,10))/2,c=Math.abs(4/3*(1-Math.cos(h))/Math.sin(h)),o&&(c=-c);var m=this._getPath();for(r=0;r<=s;r++)l=n+u*(r/s),d=Math.cos(l),_=e+Math.sin(l)*i,(f=t+d*i)==this._path._lastOriX&&_==this._path._lastOriY||m.addPoint(f,_);d=Math.cos(a),_=e+Math.sin(a)*i,(f=t+d*i)==this._path._lastOriX&&_==this._path._lastOriY||m.addPoint(f,_)}},{key:"quadraticCurveTo",value:function(t,e,i,n){for(var a=f.Bezier.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,i,n],30,2),r=0,s=a.length/2;r<s;r++)this.lineTo(a[2*r],a[2*r+1]);this.lineTo(i,n)}},{key:"mixRGBandAlpha",value:function(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)}},{key:"_mixRGBandAlpha",value:function(t,e){if(e>=1)return t;var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24}},{key:"strokeRect",value:function(t,e,i,n,a){if(this.lineWidth>0){var r=this.mixRGBandAlpha(this.strokeStyle._color.numColor),s=this.lineWidth/2;this._fillRect(t-s,e-s,i+this.lineWidth,this.lineWidth,r),this._fillRect(t-s,e-s+n,i+this.lineWidth,this.lineWidth,r),this._fillRect(t-s,e+s,this.lineWidth,n-this.lineWidth,r),this._fillRect(t-s+i,e+s,this.lineWidth,n-this.lineWidth,r)}}},{key:"clip",value:function(){}},{key:"drawParticle",value:function(t,e,i){i.x=t,i.y=e,this._submits[this._submits._length++]=i}},{key:"_getPath",value:function(){return this._path||(this._path=new x.Path)}},{key:"canvas",get:function(){return this._canvas}},{key:"_fillTexture_h",value:function(e,i,n,a,r,s,o,l){a<=0&&console.error("_fillTexture_h error: oriw must>0");for(var u=s,h=Math.floor(l/a),c=l%a,d=0;d<h;d++)this._inner_drawTexture(e,i,u,o,a,r,this._curMat,n,1,!1),u+=a;if(c>0){var f=n[2]-n[0],_=n[0]+f*(c/a),v=t.tmpuv1;v[0]=n[0],v[1]=n[1],v[2]=_,v[3]=n[3],v[4]=_,v[5]=n[5],v[6]=n[6],v[7]=n[7],this._inner_drawTexture(e,i,u,o,c,r,this._curMat,v,1,!1)}}},{key:"_fillTexture_v",value:function(e,i,n,a,r,s,o,l){r<=0&&console.error("_fillTexture_v error: orih must>0");for(var u=o,h=Math.floor(l/r),c=l%r,d=0;d<h;d++)this._inner_drawTexture(e,i,s,u,a,r,this._curMat,n,1,!1),u+=r;if(c>0){var f=n[7]-n[1],_=n[1]+f*(c/r),v=t.tmpuv1;v[0]=n[0],v[1]=n[1],v[2]=n[2],v[3]=n[3],v[4]=n[4],v[5]=_,v[6]=n[6],v[7]=_,this._inner_drawTexture(e,i,s,u,a,c,this._curMat,v,1,!1)}}},{key:"drawTextureWithSizeGrid",value:function(e,i,n,a,r,s,o,l){if(e._getSource()){i+=o,n+=l;var u=e.uv,h=e.bitmap.width,c=e.bitmap.height,d=s[0],f=s[3],_=s[1],v=s[2],y=s[4];a==h&&(f=_=0),r==c&&(d=v=0);var p=d/c,g=f/h,m=_/h,x=v/c,T=e.bitmap.id,k=this._curMat,C=this._tempUV,S=1,E=1;f+_>a&&(S=a/(f+_)),d+v>r&&(E=r/(d+v)),f*=S,_*=S,d*=E,v*=E;var M=u[0],L=u[1],b=u[4],I=u[5],R=M,w=L,A=b,B=I;if(f&&d&&(A=M+g,B=L+p,C[0]=M,C[1]=L,C[2]=A,C[3]=L,C[4]=A,C[5]=B,C[6]=M,C[7]=B,this._inner_drawTexture(e,T,i,n,f,d,k,C,1,!1)),_&&d&&(R=b-m,w=L,A=b,B=L+p,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,this._inner_drawTexture(e,T,a-_+i,0+n,_,d,k,C,1,!1)),f&&v&&(R=M,w=I-x,A=M+g,B=I,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,this._inner_drawTexture(e,T,0+i,r-v+n,f,v,k,C,1,!1)),_&&v&&(R=b-m,w=I-x,A=b,B=I,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,this._inner_drawTexture(e,T,a-_+i,r-v+n,_,v,k,C,1,!1)),d&&(R=M+g,w=L,A=b-m,B=L+p,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,y?this._fillTexture_h(e,T,C,e.width-f-_,d,f+i,n,a-f-_):this._inner_drawTexture(e,T,f+i,n,a-f-_,d,k,C,1,!1)),v&&(R=M+g,w=I-x,A=b-m,B=I,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,y?this._fillTexture_h(e,T,C,e.width-f-_,v,f+i,r-v+n,a-f-_):this._inner_drawTexture(e,T,f+i,r-v+n,a-f-_,v,k,C,1,!1)),f&&(R=M,w=L+p,A=M+g,B=I-x,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,y?this._fillTexture_v(e,T,C,f,e.height-d-v,i,d+n,r-d-v):this._inner_drawTexture(e,T,i,d+n,f,r-d-v,k,C,1,!1)),_&&(R=b-m,w=L+p,A=b,B=I-x,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,y?this._fillTexture_v(e,T,C,_,e.height-d-v,a-_+i,d+n,r-d-v):this._inner_drawTexture(e,T,a-_+i,d+n,_,r-d-v,k,C,1,!1)),R=M+g,w=L+p,A=b-m,B=I-x,C[0]=R,C[1]=w,C[2]=A,C[3]=w,C[4]=A,C[5]=B,C[6]=R,C[7]=B,y){var D=t.tmpUVRect;D[0]=R,D[1]=w,D[2]=A-R,D[3]=B-w,this._fillTexture(e,e.width-f-_,e.height-d-v,D,f+i,d+n,a-f-_,r-d-v,"repeat",0,0)}else this._inner_drawTexture(e,T,f+i,d+n,a-f-_,r-d-v,k,C,1,!1);!1}}}],[{key:"__init__",value:function(){t.MAXCLIPRECT=new y.Rectangle(0,0,t._MAXSIZE,t._MAXSIZE),J.DEFAULT=new J,M.WebGLCacheAsNormalCanvas}},{key:"set2DRenderConfig",value:function(){var t=d.LayaGL.instance;K.WebGLContext.setBlend(t,!0),K.WebGLContext.setBlendEquation(t,t.FUNC_ADD),g.BlendMode.activeBlendFunction=null,K.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA),K.WebGLContext.setDepthTest(t,!1),K.WebGLContext.setCullFace(t,!1),K.WebGLContext.setDepthMask(t,!0),K.WebGLContext.setFrontFace(t,t.CCW),t.viewport(0,0,z.RenderState2D.width,z.RenderState2D.height),t.enable(t.SCISSOR_TEST),t.scissor(0,0,z.RenderState2D.width,z.RenderState2D.height)}}]),t}();e.Context=$,$.ENUM_TEXTALIGN_DEFAULT=0,$.ENUM_TEXTALIGN_CENTER=1,$.ENUM_TEXTALIGN_RIGHT=2,$._SUBMITVBSIZE=32e3,$._MAXSIZE=99999999,$._MAXVERTNUM=65535,$.MAXCLIPRECT=null,$._COUNT=0,$.SEGNUM=32,$._contextcount=0,$.PI2=2*Math.PI,$._textRender=null,$.tmpuv1=[0,0,0,0,0,0,0,0],$.tmpUV=[0,0,0,0,0,0,0,0],$.tmpUVRect=[0,0,0,0];var J=function(){function t(){(0,u.default)(this,t),this.lineWidth=1}return(0,h.default)(t,[{key:"clear",value:function(){this.lineWidth=1,this.textAlign=this.textBaseline=null}},{key:"make",value:function(){return this===t.DEFAULT?new t:this}}]),t}()},69432:function(t,e,i){"use strict";var n;i(63978)(e,"__esModule",{value:!0}),e.FilterMode=void 0,e.FilterMode=n,function(t){t[t.Point=0]="Point",t[t.Bilinear=1]="Bilinear",t[t.Trilinear=2]="Trilinear"}(n||(e.FilterMode=n={}))},26776:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLCanvas=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(89395)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(8944),_=i(54598),v=i(87035),y=i(92493),p=i(93568);function g(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var m=function(t){(0,h.default)(i,t);var e=g(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,s.default)(this,i),(t=e.call(this))._source=n?p.Browser.createElement("canvas"):(0,l.default)(t),t.lock=!0,t}return(0,o.default)(i,[{key:"source",get:function(){return this._source}},{key:"_getSource",value:function(){return this._source}},{key:"clear",value:function(){this._ctx&&(this._ctx.clear?this._ctx.clear():this._ctx.clearRect(0,0,this._width,this._height)),this._texture&&(this._texture.destroy(),this._texture=null)}},{key:"destroy",value:function(){(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this),this._setCPUMemory(0),this._ctx&&this._ctx.destroy&&this._ctx.destroy(),this._ctx=null}},{key:"release",value:function(){}},{key:"context",get:function(){return this._ctx||(this._source==this?this._ctx=new y.ILaya.Context:this._ctx=this._source.getContext(y.ILaya.Render.isConchApp?"layagl":"2d"),this._ctx._canvas=this),this._ctx}},{key:"_setContext",value:function(t){this._ctx=t}},{key:"getContext",value:function(t){return this.context}},{key:"getMemSize",value:function(){return 0}},{key:"size",value:function(t,e){(this._width!=t||this._height!=e||this._source&&(this._source.width!=t||this._source.height!=e))&&(this._width=t,this._height=e,this._setCPUMemory(t*e*4),this._ctx&&this._ctx.size&&this._ctx.size(t,e),this._source&&(this._source.height=e,this._source.width=t),this._texture&&(this._texture.destroy(),this._texture=null))}},{key:"getTexture",value:function(){if(!this._texture){var t=new v.Texture2D;t.loadImageSource(this.source),this._texture=new _.Texture(t)}return this._texture}},{key:"toBase64",value:function(t,e){if(this._source){if(y.ILaya.Render.isConchApp){var i=window;if(2==i.conchConfig.threadMode)throw"native 2 thread mode use toBase64Async";var n=this._ctx._targets.sourceWidth,a=this._ctx._targets.sourceHeight,r=this._ctx._targets.getData(0,0,n,a);return i.conchToBase64FlipY?i.conchToBase64FlipY(t,e,r.buffer,n,a):i.conchToBase64(t,e,r.buffer,n,a)}return this._source.toDataURL(t,e)}return null}},{key:"toBase64Async",value:function(t,e,i){var n=this._ctx._targets.sourceWidth,a=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,n,a,(function(r){var s=window,o=s.conchToBase64FlipY?s.conchToBase64FlipY(t,e,r.buffer,n,a):s.conchToBase64(t,e,r.buffer,n,a);i(o)}))}}]),i}(f.Bitmap);e.HTMLCanvas=m},64178:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HTMLImage=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(8944),c=i(87035),d=i(69176);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var _=function(t){(0,o.default)(i,t);var e=f(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return i}(h.Bitmap);e.HTMLImage=_,_.create=function(t,e,i){var n=new c.Texture2D(t,e,i,!1,!1);return n.wrapModeU=d.WarpMode.Clamp,n.wrapModeV=d.WarpMode.Clamp,n}},93894:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.RenderTexture2D=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(87035),d=i(33873),f=i(69534),_=i(61266),v=i(20541),y=i(56161),p=i(92493),g=i(57693);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var x=function(t){(0,l.default)(i,t);var e=m(i);function i(t,n){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.RenderTextureFormat.R8G8B8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g.RenderTextureDepthFormat.DEPTH_16;return(0,s.default)(this,i),(a=e.call(this,r,!1))._mgrKey=0,a._glTextureType=d.LayaGL.instance.TEXTURE_2D,a._width=t,a._height=n,a._depthStencilFormat=o,a._create(t,n),a.lock=!0,a}return(0,o.default)(i,[{key:"depthStencilFormat",get:function(){return this._depthStencilFormat}},{key:"defaulteTexture",get:function(){return c.Texture2D.grayTexture}},{key:"getIsReady",value:function(){return!0}},{key:"sourceWidth",get:function(){return this._width}},{key:"sourceHeight",get:function(){return this._height}},{key:"offsetX",get:function(){return 0}},{key:"offsetY",get:function(){return 0}},{key:"_create",value:function(t,e){var i=d.LayaGL.instance;this._frameBuffer=i.createFramebuffer(),_.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture);var n=this._getGLFormat();if(i.texImage2D(this._glTextureType,0,n,t,e,0,n,i.UNSIGNED_BYTE,null),this._setGPUMemory(t*e*4),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this._glTexture,0),this._depthStencilFormat!==g.RenderTextureDepthFormat.DEPTHSTENCIL_NONE)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._depthStencilBuffer),this._depthStencilFormat){case g.RenderTextureDepthFormat.DEPTH_16:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case g.RenderTextureDepthFormat.STENCIL_8:i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX8,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case g.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer)}i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindRenderbuffer(i.RENDERBUFFER,null),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,d.LayaGL.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))}},{key:"start",value:function(){var t=d.LayaGL.instance;d.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this._lastRT=i._currentActive,i._currentActive=this,this._readyed=!0,t.viewport(0,0,this._width,this._height),this._lastWidth=y.RenderState2D.width,this._lastHeight=y.RenderState2D.height,y.RenderState2D.width=this._width,y.RenderState2D.height=this._height,v.BaseShader.activeShader=null}},{key:"end",value:function(){var t=d.LayaGL.instance;t.bindFramebuffer(t.FRAMEBUFFER,null),i._currentActive=null,this._readyed=!0}},{key:"restore",value:function(){var t=d.LayaGL.instance;this._lastRT!=i._currentActive&&(d.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null),i._currentActive=this._lastRT),this._readyed=!0,t.viewport(0,0,this._lastWidth,this._lastHeight),y.RenderState2D.width=this._lastWidth,y.RenderState2D.height=this._lastHeight,v.BaseShader.activeShader=null}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=d.LayaGL.instance;a.clearColor(t,e,i,n);var r=a.COLOR_BUFFER_BIT;switch(this._depthStencilFormat){case a.DEPTH_COMPONENT16:r|=a.DEPTH_BUFFER_BIT;break;case a.STENCIL_INDEX8:r|=a.STENCIL_BUFFER_BIT;break;case a.DEPTH_STENCIL:r|=a.DEPTH_BUFFER_BIT,r|=a.STENCIL_BUFFER_BIT}a.clear(r)}},{key:"getData",value:function(t,e,i,n){if(p.ILaya.Render.isConchApp&&2==window.conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var a=d.LayaGL.instance;if(a.bindFramebuffer(a.FRAMEBUFFER,this._frameBuffer),!(a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE))return a.bindFramebuffer(a.FRAMEBUFFER,null),null;var r=new Uint8Array(this._width*this._height*4),s=this._getGLFormat();return a.readPixels(t,e,i,n,s,a.UNSIGNED_BYTE,r),a.bindFramebuffer(a.FRAMEBUFFER,null),r}},{key:"getDataAsync",value:function(t,e,i,n,a){var r=d.LayaGL.instance;r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer),r.readPixelsAsync(t,e,i,n,r.RGBA,r.UNSIGNED_BYTE,(function(t){a(new Uint8Array(t))})),r.bindFramebuffer(r.FRAMEBUFFER,null)}},{key:"recycle",value:function(){}},{key:"_disposeResource",value:function(){if(this._frameBuffer){var t=d.LayaGL.instance;t.deleteTexture(this._glTexture),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0)}}}],[{key:"currentActive",get:function(){return i._currentActive}},{key:"pushRT",value:function(){i.rtStack.push({rt:i._currentActive,w:y.RenderState2D.width,h:y.RenderState2D.height})}},{key:"popRT",value:function(){var t=d.LayaGL.instance,e=i.rtStack.pop();e&&(i._currentActive!=e.rt&&(d.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,e.rt?e.rt._frameBuffer:null),i._currentActive=e.rt),t.viewport(0,0,e.w,e.h),y.RenderState2D.width=e.w,y.RenderState2D.height=e.h)}}]),i}(f.BaseTexture);e.RenderTexture2D=x,x.rtStack=[],x.defuv=[0,0,1,0,1,1,0,1],x.flipyuv=[0,1,1,1,1,0,0,0]},57693:function(t,e,i){"use strict";var n,a,r;i(63978)(e,"__esModule",{value:!0}),e.RenderTextureFormat=e.RenderTextureDepthFormat=e.RTDEPTHATTACHMODE=void 0,e.RenderTextureFormat=n,function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.Alpha8=2]="Alpha8",t[t.R16G16B16A16=14]="R16G16B16A16",t[t.Depth=15]="Depth",t[t.ShadowMap=16]="ShadowMap"}(n||(e.RenderTextureFormat=n={})),e.RenderTextureDepthFormat=a,function(t){t[t.DEPTH_16=0]="DEPTH_16",t[t.STENCIL_8=1]="STENCIL_8",t[t.DEPTHSTENCIL_24_8=2]="DEPTHSTENCIL_24_8",t[t.DEPTHSTENCIL_NONE=3]="DEPTHSTENCIL_NONE",t[t.DEPTH_32=4]="DEPTH_32",t[t.DEPTHSTENCIL_16_8=2]="DEPTHSTENCIL_16_8"}(a||(e.RenderTextureDepthFormat=a={})),e.RTDEPTHATTACHMODE=r,function(t){t[t.RENDERBUFFER=0]="RENDERBUFFER",t[t.TEXTURE=1]="TEXTURE"}(r||(e.RTDEPTHATTACHMODE=r={}))},25883:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Resource=void 0;var s=r(i(92762)),o=r(i(81643)),l=r(i(15375)),u=r(i(17061)),h=r(i(89395)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(92493),v=i(48856),y=i(84935);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var g=function(t){(0,c.default)(i,t);var e=p(i);function i(){var t;return(0,l.default)(this,i),(t=e.call(this))._id=0,t._url=null,t._cpuMemory=0,t._gpuMemory=0,t._destroyed=!1,t._referenceCount=0,t.lock=!1,t.name=null,t._id=++i._uniqueIDCounter,t._destroyed=!1,t._referenceCount=0,i._idResourcesMap[t.id]=(0,h.default)(t),t.lock=!1,t}return(0,u.default)(i,[{key:"id",get:function(){return this._id}},{key:"url",get:function(){return this._url}},{key:"cpuMemory",get:function(){return this._cpuMemory}},{key:"gpuMemory",get:function(){return this._gpuMemory}},{key:"destroyed",get:function(){return this._destroyed}},{key:"referenceCount",get:function(){return this._referenceCount}},{key:"_setCPUMemory",value:function(t){var e=t-this._cpuMemory;this._cpuMemory=t,i._addCPUMemory(e)}},{key:"_setGPUMemory",value:function(t){var e=t-this._gpuMemory;this._gpuMemory=t,i._addGPUMemory(e)}},{key:"_setCreateURL",value:function(t){var e;(t=y.URL.formatURL(t),this._url!==t)&&(this._url&&(e=i._urlResourcesMap[this._url],(0,s.default)(e).call(e,(0,o.default)(e).call(e,this),1),0===e.length&&delete i._urlResourcesMap[this._url]),t&&((e=i._urlResourcesMap[t])||(i._urlResourcesMap[t]=e=[]),e.push(this)),this._url=t)}},{key:"_addReference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._referenceCount+=t}},{key:"_removeReference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._referenceCount-=t}},{key:"_clearReference",value:function(){this._referenceCount=0}},{key:"_recoverResource",value:function(){}},{key:"_disposeResource",value:function(){}},{key:"_activeResource",value:function(){}},{key:"destroy",value:function(){var t;this._destroyed||(this._destroyed=!0,this.lock=!1,this._disposeResource(),delete i._idResourcesMap[this.id],this._url&&((t=i._urlResourcesMap[this._url])&&((0,s.default)(t).call(t,(0,o.default)(t).call(t,this),1),0===t.length&&delete i._urlResourcesMap[this._url]),_.ILaya.Loader.loadedMap[this._url]==this&&delete _.ILaya.Loader.loadedMap[this._url]))}}],[{key:"cpuMemory",get:function(){return i._cpuMemory}},{key:"gpuMemory",get:function(){return i._gpuMemory}},{key:"_addCPUMemory",value:function(t){i._cpuMemory+=t}},{key:"_addGPUMemory",value:function(t){i._gpuMemory+=t}},{key:"_addMemory",value:function(t,e){i._cpuMemory+=t,i._gpuMemory+=e}},{key:"getResourceByID",value:function(t){return i._idResourcesMap[t]}},{key:"getResourceByURL",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return i._urlResourcesMap[t][e]}},{key:"destroyUnusedResources",value:function(){for(var t in i._idResourcesMap){var e=i._idResourcesMap[t];e.lock||0!==e._referenceCount||e.destroy()}}}]),i}(v.EventDispatcher);e.Resource=g,g._uniqueIDCounter=0,g._idResourcesMap={},g._urlResourcesMap={},g._cpuMemory=0,g._gpuMemory=0},54598:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Texture=void 0;var s=r(i(3649)),o=r(i(15375)),l=r(i(17061)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(89662),f=i(48856),_=i(98693),v=i(41107),y=i(92493);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var g=function(t){(0,u.default)(i,t);var e=p(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return(0,o.default)(this,i),(t=e.call(this)).uvrect=[0,0,1,1],t._destroyed=!1,t._referenceCount=0,t.$_GID=0,t.offsetX=0,t.offsetY=0,t._w=0,t._h=0,t.sourceWidth=0,t.sourceHeight=0,t.url=null,t.scaleRate=1,t.setTo(n,a,r,s),t}return(0,l.default)(i,[{key:"uv",get:function(){return this._uv},set:function(t){this.uvrect[0]=Math.min(t[0],t[2],t[4],t[6]),this.uvrect[1]=Math.min(t[1],t[3],t[5],t[7]),this.uvrect[2]=Math.max(t[0],t[2],t[4],t[6])-this.uvrect[0],this.uvrect[3]=Math.max(t[1],t[3],t[5],t[7])-this.uvrect[1],this._uv=t}},{key:"width",get:function(){return this._w?this._w:this.bitmap?this.uv&&this.uv!==i.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0},set:function(t){this._w=t,this.sourceWidth||(this.sourceWidth=t)}},{key:"height",get:function(){return this._h?this._h:this.bitmap?this.uv&&this.uv!==i.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0},set:function(t){this._h=t,this.sourceHeight||(this.sourceHeight=t)}},{key:"bitmap",get:function(){return this._bitmap},set:function(t){this._bitmap&&this._bitmap._removeReference(this._referenceCount),this._bitmap=t,t&&t._addReference(this._referenceCount)}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_addReference",value:function(){this._bitmap&&this._bitmap._addReference(),this._referenceCount++}},{key:"_removeReference",value:function(){this._bitmap&&this._bitmap._removeReference(),this._referenceCount--}},{key:"_getSource",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._destroyed||!this._bitmap?null:(this.recoverBitmap(t),this._bitmap.destroyed?null:this.bitmap._getSource())}},{key:"_onLoaded",value:function(t,e){if(e)if(e==this);else if(e instanceof i){var n=e;i._create(e,0,0,n.width,n.height,0,0,n.sourceWidth,n.sourceHeight,this)}else this.bitmap=e,this.sourceWidth=this._w=e.width,this.sourceHeight=this._h=e.height;else;t&&t.run(),this.event(d.Event.READY,this)}},{key:"getIsReady",value:function(){return!this._destroyed&&!!this._bitmap}},{key:"setTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.bitmap=t,this.sourceWidth=n,this.sourceHeight=a,t&&(this._w=t.width,this._h=t.height,this.sourceWidth=this.sourceWidth||t.width,this.sourceHeight=this.sourceHeight||t.height),this.uv=e||i.DEF_UV}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._destroyed||y.ILaya.loader.load(t,v.Handler.create(this,this._onLoaded,[e]),null,"htmlimage",1,!0)}},{key:"getTexturePixels",value:function(t,e,i,n){var a,r,o,l=this.bitmap,u=this._w,h=this._h,c=this.sourceWidth,d=this.sourceHeight,f=l.width,_=l.height,v=this.offsetX,p=this.offsetY,g=i,m=n;if(t+i>u+v&&(g-=t+i-u-v),t+i>c&&(i-=t+i-c),e+n>h+p&&(m-=e+n-h-p),e+n>d&&(n-=e+n-d),i<=0||n<=0)return null;var x=v>t?v-t:0,T=p>e?p-e:0,k=t>v?t-v:0,C=e>p?e-p:0;g-=x,m-=T;var S=4*i,E=null;try{E=l.getPixels()}catch(t){}if(E){var M;if(0==t&&0==e&&i==f&&n==_)return E;var L=(0,s.default)(M=this._uv).call(M),b=Math.round(L[0]*f),I=Math.round(L[1]*_),R=new Uint8Array(i*n*4);for(a=4*b+4*k+(r=(I+C)*(S=4*f)),o=0;o<m;o++)R.set((0,s.default)(E).call(E,a,a+4*g),4*i*(o+T)+4*x),a+=S;return R}var w=new y.ILaya.Context;w.size(i,n),w.asBitmap=!0;var A=null;if(0!=t||0!=e||i!=f||n!=_){var B,D=(A=(0,s.default)(B=this._uv).call(B))[0],P=A[1],O=(A[2]-D)/u,F=(A[7]-P)/h;A=[D+k*O,P+C*F,D+(k+g)*O,P+C*F,D+(k+g)*O,P+(C+m)*F,D+k*O,P+(C+m)*F]}w._drawTextureM(this,x,T,g,m,null,1,A),w._targets.start(),w.flush(),w._targets.end(),w._targets.restore();var U=w._targets.getData(0,0,i,n);for(w.destroy(),R=new Uint8Array(i*n*4),a=0,r=(n-1)*S,o=n-1;o>=0;o--)R.set((0,s.default)(U).call(U,r,r+S),a),a+=S,r-=S;return R}},{key:"getPixels",value:function(t,e,i,n){return window.conch?this._nativeObj.getImageData(t,e,i,n):this.getTexturePixels(t,e,i,n)}},{key:"recoverBitmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this._bitmap.url;if(!this._destroyed&&(!this._bitmap||this._bitmap.destroyed)&&i){var n=y.ILaya.Loader.loadedMap[i];n?(this.bitmap=n,e&&e()):y.ILaya.loader.load(i,v.Handler.create(this,(function(i){t.bitmap=i,e&&e()})),null,"htmlimage",1,!0)}}},{key:"disposeBitmap",value:function(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._destroyed){this._destroyed=!0;var e=this._bitmap;e&&(e._removeReference(this._referenceCount),(0===e.referenceCount||t)&&e.destroy(),e=null),this.url&&this===y.ILaya.loader.getRes(this.url)&&y.ILaya.Loader.clearRes(this.url)}}}],[{key:"moveUV",value:function(t,e,i){for(var n=0;n<8;n+=2)i[n]+=t,i[n+1]+=e;return i}},{key:"create",value:function(t,e,n,a,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return i._create(t,e,n,a,r,s,o,l,u)}},{key:"_create",value:function(t,e,n,a,r){var s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=t instanceof i,f=d?t.uv:i.DEF_UV,_=d?t.bitmap:t;_.width&&e+a>_.width&&(a=_.width-e),_.height&&n+r>_.height&&(r=_.height-n),c?(s=c).setTo(_,null,u||a,h||r):s=new i(_,null,u||a,h||r),s.width=a,s.height=r,s.offsetX=o,s.offsetY=l;var v=1/_.width,y=1/_.height;e*=v,n*=y,a*=v,r*=y;var p=s.uv[0],g=s.uv[1],m=s.uv[4],x=s.uv[5],T=m-p,k=x-g,C=i.moveUV(f[0],f[1],[e,n,e+a,n,e+a,n+r,e,n+r]);s.uv=new Float32Array([p+C[0]*T,g+C[1]*k,m-(1-C[2])*T,g+C[3]*k,m-(1-C[4])*T,x-(1-C[5])*k,p+C[6]*T,x-(1-C[7])*k]);var S=_.scaleRate;return S&&1!=S?(s.sourceWidth/=S,s.sourceHeight/=S,s.width/=S,s.height/=S,s.scaleRate=S,s.offsetX/=S,s.offsetY/=S):s.scaleRate=1,s}},{key:"createFromTexture",value:function(t,e,n,a,r){var s=t.scaleRate;1!=s&&(e*=s,n*=s,a*=s,r*=s);var o=_.Rectangle.TEMP.setTo(e-t.offsetX,n-t.offsetY,a,r),l=o.intersection(i._rect1.setTo(0,0,t.width,t.height),i._rect2);return l?i.create(t,l.x,l.y,l.width,l.height,l.x-o.x,l.y-o.y,a,r):null}}]),i}(f.EventDispatcher);e.Texture=g,g.DEF_UV=new Float32Array([0,0,1,0,1,1,0,1]),g.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]),g.INV_UV=new Float32Array([0,1,1,1,1,0,0,0]),g._rect1=new _.Rectangle,g._rect2=new _.Rectangle},87035:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Texture2D=void 0;var s=r(i(86029)),o=r(i(15375)),l=r(i(17061)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(92493),f=i(33873),_=i(61266),v=i(69534),y=i(73972),p=i(14002),g=i(69432),m=i(86877),x=i(34277);function T(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var k=function(t){(0,u.default)(i,t);var e=T(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.TextureFormat.R8G8B8A8,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,o.default)(this,i),t=e.call(this,r,l);var h=f.LayaGL.instance;t._glTextureType=h.TEXTURE_2D,t._width=n,t._height=a,t._canRead=u,t._setWarpMode(h.TEXTURE_WRAP_S,t._wrapModeU),t._setWarpMode(h.TEXTURE_WRAP_T,t._wrapModeV),t._setFilterMode(t._filterMode),t._setAnisotropy(t._anisoLevel);var c=t._gpuCompressFormat();if(l){var d=Math.max(Math.ceil((0,s.default)(n))+1,Math.ceil((0,s.default)(a))+1);if(!c)for(var _=0;_<d;_++)t._setPixels(null,_,Math.max(n>>_,1),Math.max(a>>_,1));t._mipmapCount=d,t._setGPUMemory(n*a*4*(1+1/3))}else c||t._setPixels(null,0,n,a),t._mipmapCount=1,t._setGPUMemory(n*a*4);return t}return(0,l.default)(i,[{key:"defaulteTexture",get:function(){return i.grayTexture}},{key:"_gpuCompressFormat",value:function(){return this._format!=y.TextureFormat.R8G8B8A8&&this._format!=y.TextureFormat.R8G8B8&&this._format!=y.TextureFormat.R16G16B16A16&&this._format!=y.TextureFormat.R32G32B32A32&&this._format!=y.TextureFormat.R5G6B5&&this._format!=y.TextureFormat.Alpha8}},{key:"_setPixels",value:function(t,e,i,n){var a=f.LayaGL.instance,r=this._glTextureType,s=this._getGLFormat();switch(_.WebGLContext.bindTexture(a,r,this._glTexture),this.format){case y.TextureFormat.R8G8B8:case y.TextureFormat.R8G8B8A8:a.pixelStorei(a.UNPACK_ALIGNMENT,1),a.texImage2D(r,e,s,i,n,0,s,a.UNSIGNED_BYTE,t),a.pixelStorei(a.UNPACK_ALIGNMENT,4);break;case y.TextureFormat.R5G6B5:a.pixelStorei(a.UNPACK_ALIGNMENT,2),a.texImage2D(r,e,s,i,n,0,s,a.UNSIGNED_SHORT_5_6_5,t),a.pixelStorei(a.UNPACK_ALIGNMENT,4);break;case y.TextureFormat.R32G32B32A32:f.LayaGL.layaGPUInstance._isWebGL2?a.texImage2D(r,e,a.RGBA32F,i,n,0,s,a.FLOAT,t):a.texImage2D(r,e,a.RGBA,i,n,0,s,a.FLOAT,t);break;case y.TextureFormat.R16G16B16A16:f.LayaGL.layaGPUInstance._isWebGL2?a.texImage2D(r,e,a.RGBA16F,i,n,0,s,a.HALF_FLOAT,t):a.texImage2D(r,e,a.RGBA,i,n,0,s,f.LayaGL.layaGPUInstance._oesTextureHalfFloat.HALF_FLOAT_OES,t);break;default:a.texImage2D(r,e,s,i,n,0,s,a.UNSIGNED_BYTE,t)}}},{key:"_calcualatesCompressedDataSize",value:function(t,e,i){switch(t){case y.TextureFormat.DXT1:return(e+3>>2)*(i+3>>2)*8;case y.TextureFormat.DXT5:return(e+3>>2)*(i+3>>2)*16;case y.TextureFormat.PVRTCRGB_4BPPV:case y.TextureFormat.PVRTCRGBA_4BPPV:return Math.floor((Math.max(e,8)*Math.max(i,8)*4+7)/8);case y.TextureFormat.PVRTCRGB_2BPPV:case y.TextureFormat.PVRTCRGBA_2BPPV:return Math.floor((Math.max(e,16)*Math.max(i,8)*2+7)/8);default:return 0}}},{key:"_pharseDDS",value:function(t){var e=new Int32Array(t,0,31);if(542327876!=e[0])throw"Invalid magic number in DDS header";if(!(4&e[20]))throw"Unsupported format, must contain a FourCC code";var i=e[21];switch(this._format){case y.TextureFormat.DXT1:if(827611204!==i)throw"the FourCC code is not same with texture format.";break;case y.TextureFormat.DXT5:if(894720068!==i)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var n=1;if(131072&e[2]){if(n=Math.max(1,e[7]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var a=e[4],r=e[3];this._width=a,this._height=r;var s=e[1]+4;this._upLoadCompressedTexImage2D(t,a,r,n,s,0)}},{key:"_pharseKTX",value:function(t){var e=new Uint8Array(t,0,12);if(171!=e[0]||75!=e[1]||84!=e[2]||88!=e[3]||32!=e[4]||49!=e[5]||49!=e[6]||187!=e[7]||13!=e[8]||10!=e[9]||26!=e[10]||10!=e[11])throw"Invalid fileIdentifier in KTX header";var i=new Int32Array(e.buffer,e.length,13),n=i[4];if(this._format=-1,f.LayaGL.layaGPUInstance._compressedTextureASTC)switch(n){case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_4x4_KHR:this._format=y.TextureFormat.ASTC4x4;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:this._format=y.TextureFormat.ASTC4x4SRGB;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:this._format=y.TextureFormat.ASTC6x6SRGB;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:this._format=y.TextureFormat.ASTC8x8SRGB;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:this._format=y.TextureFormat.ASTC10x10SRGB;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:this._format=y.TextureFormat.ASTC12x12SRGB;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_6x6_KHR:this._format=y.TextureFormat.ASTC6x6;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_8x8_KHR:this._format=y.TextureFormat.ASTC8x8;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_10x10_KHR:this._format=y.TextureFormat.ASTC10x10;break;case f.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_12x12_KHR:this._format=y.TextureFormat.ASTC12x12}if(f.LayaGL.layaGPUInstance._compressedTextureEtc1&&n===f.LayaGL.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL)this._format=y.TextureFormat.ETC1RGB;if(f.LayaGL.layaGPUInstance._compressedTextureETC)switch(n){case f.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_RGBA8_ETC2_EAC:this._format=y.TextureFormat.ETC2RGBA;break;case f.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_RGB8_ETC2:this._format=y.TextureFormat.ETC2RGB;break;case f.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:this._format=y.TextureFormat.ETC2RGB_Alpha8;break;case f.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_SRGB8_ETC2:this._format=y.TextureFormat.ETC2SRGB}if(-1==this._format)throw"unknown texture format.";var a=i[11],r=i[6],s=i[7];this._width=r,this._height=s;var o=64+i[12];this._upLoadKTXCompressedTexImage2D(t,r,s,a,o,4)}},{key:"_pharsePVR",value:function(t){var e=new Int32Array(t,0,13);if(55727696!=e[0])throw"Invalid magic number in PVR header";switch(e[2]){case 0:this._format=y.TextureFormat.PVRTCRGB_2BPPV;break;case 2:this._format=y.TextureFormat.PVRTCRGB_4BPPV;break;case 1:this._format=y.TextureFormat.PVRTCRGBA_2BPPV;break;case 3:this._format=y.TextureFormat.PVRTCRGBA_4BPPV;break;default:throw"Texture2D:unknown PVR format."}var i=e[11],n=e[7],a=e[6];this._width=n,this._height=a;var r=e[12]+52;this._upLoadCompressedTexImage2D(t,n,a,i,r,0)}},{key:"_upLoadCompressedTexImage2D",value:function(t,e,i,n,a,r){var s=f.LayaGL.instance,o=this._glTextureType;_.WebGLContext.bindTexture(s,o,this._glTexture);for(var l=this._getGLFormat(),u=a,h=0;h<n;h++){u+=r;var c=this._calcualatesCompressedDataSize(this._format,e,i),d=new Uint8Array(t,u,c);s.compressedTexImage2D(o,h,l,e,i,0,d),e=Math.max(e>>1,1),i=Math.max(i>>1,1),u+=c}var v=u;this._setGPUMemory(v),this._readyed=!0,this._activeResource()}},{key:"_upLoadKTXCompressedTexImage2D",value:function(t,e,i,n,a,r){var s=f.LayaGL.instance,o=this._glTextureType;_.WebGLContext.bindTexture(s,o,this._glTexture);for(var l=this._getGLFormat(),u=a,h=0;h<n;h++){var c=new Int32Array(t,u,1)[0];u+=r;var d=new Uint8Array(t,u,c);s.compressedTexImage2D(o,h,l,e,i,0,d),e=Math.max(e>>1,1),i=Math.max(i>>1,1),u+=c,u+=3-(c+3)%4}var v=u;this._setGPUMemory(v),this._readyed=!0,this._activeResource()}},{key:"loadImageSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=f.LayaGL.instance,n=t.width,a=t.height;this._width=n,this._height=a,this._isPot(n)&&this._isPot(a)||(this._mipmap=!1),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),_.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture);var r=this._getGLFormat();d.ILaya.Render.isConchApp?(t.setPremultiplyAlpha&&t.setPremultiplyAlpha(e),i.texImage2D(this._glTextureType,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)):(e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.format==y.TextureFormat.R5G6B5?i.texImage2D(this._glTextureType,0,i.RGB,i.RGB,i.UNSIGNED_SHORT_5_6_5,t):i.texImage2D(this._glTextureType,0,r,r,i.UNSIGNED_BYTE,t),e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)),this._mipmap?(i.generateMipmap(this._glTextureType),this._setGPUMemory(n*a*4*(1+1/3))):this._setGPUMemory(n*a*4),this._canRead&&(d.ILaya.Render.isConchApp?this._pixels=new Uint8Array(t._nativeObj.getImageData(0,0,n,a)):(d.ILaya.Browser.canvas.size(n,a),d.ILaya.Browser.canvas.clear(),d.ILaya.Browser.context.drawImage(t,0,0,n,a),this._pixels=new Uint8Array(d.ILaya.Browser.context.getImageData(0,0,n,a).data.buffer))),this._readyed=!0,this._activeResource()}},{key:"setPixels",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!t)throw"Texture2D:pixels can't be null.";var i=Math.max(this._width>>e,1),n=Math.max(this._height>>e,1),a=i*n*this._getFormatByteCount();if(t.length<a)throw"Texture2D:pixels length should at least "+a+".";this._setPixels(t,e,i,n),this._canRead&&(this._pixels=t),this._readyed=!0,this._activeResource()}},{key:"setSubPixels",value:function(t,e,i,n,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!a)throw"Texture2D:pixels can't be null.";var s=f.LayaGL.instance,o=this._glTextureType;_.WebGLContext.bindTexture(s,o,this._glTexture);var l=this._getGLFormat();switch(this.format){case y.TextureFormat.R8G8B8:s.pixelStorei(s.UNPACK_ALIGNMENT,1),s.texSubImage2D(o,r,t,e,i,n,l,s.UNSIGNED_BYTE,a),s.pixelStorei(s.UNPACK_ALIGNMENT,4);break;case y.TextureFormat.R5G6B5:s.pixelStorei(s.UNPACK_ALIGNMENT,2),s.texSubImage2D(o,r,t,e,i,n,l,s.UNSIGNED_SHORT_5_6_5,a),s.pixelStorei(s.UNPACK_ALIGNMENT,4);break;case y.TextureFormat.R32G32B32A32:s.texSubImage2D(o,r,t,e,i,n,l,s.FLOAT,a);break;default:s.texSubImage2D(o,r,t,e,i,n,l,s.UNSIGNED_BYTE,a)}this._readyed=!0,this._activeResource()}},{key:"setCompressData",value:function(t){switch(this._format){case y.TextureFormat.DXT1:case y.TextureFormat.DXT5:this._pharseDDS(t);break;case y.TextureFormat.ETC1RGB:case y.TextureFormat.ETC2RGB:case y.TextureFormat.ETC2RGBA:case y.TextureFormat.ETC2RGB_Alpha8:case y.TextureFormat.ETC2SRGB:case y.TextureFormat.ASTC4x4:case y.TextureFormat.ASTC4x4SRGB:case y.TextureFormat.ASTC6x6:case y.TextureFormat.ASTC6x6SRGB:case y.TextureFormat.ASTC8x8:case y.TextureFormat.ASTC8x8SRGB:case y.TextureFormat.ASTC10x10:case y.TextureFormat.ASTC10x10SRGB:case y.TextureFormat.ASTC12x12:case y.TextureFormat.ASTC12x12SRGB:case y.TextureFormat.KTXTEXTURE:this._pharseKTX(t);break;case y.TextureFormat.PVRTCRGB_2BPPV:case y.TextureFormat.PVRTCRGBA_2BPPV:case y.TextureFormat.PVRTCRGB_4BPPV:case y.TextureFormat.PVRTCRGBA_4BPPV:case y.TextureFormat.PVRTEXTURE:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}1==this.mipmapCount||this.width!=1<<this.mipmapCount-1&&this.height!=1<<this.mipmapCount?this._mipmap=!1:this._mipmap=!0;var e=f.LayaGL.instance;this._setWarpMode(e.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(e.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode)}},{key:"getPixels",value:function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")}}],[{key:"__init__",value:function(){var t=new Uint8Array(3);t[0]=128,t[1]=128,t[2]=128,i.grayTexture=new i(1,1,y.TextureFormat.R8G8B8,!1,!1),i.grayTexture.setPixels(t),i.grayTexture.lock=!0,t[0]=255,t[1]=255,t[2]=255,i.whiteTexture=new i(1,1,y.TextureFormat.R8G8B8,!1,!1),i.whiteTexture.setPixels(t),i.whiteTexture.lock=!0,t[0]=0,t[1]=0,t[2]=0,i.blackTexture=new i(1,1,y.TextureFormat.R8G8B8,!1,!1),i.blackTexture.setPixels(t),i.blackTexture.lock=!0,i.erroTextur=i.whiteTexture}},{key:"_parse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=n?new i(n[0],n[1],n[2],n[3],n[4]):new i(0,0);switch(e&&(a.wrapModeU=e.wrapModeU,a.wrapModeV=e.wrapModeV,a.filterMode=e.filterMode,a.anisoLevel=e.anisoLevel),a._format){case y.TextureFormat.R8G8B8:case y.TextureFormat.R8G8B8A8:a.loadImageSource(t);break;case y.TextureFormat.DXT1:case y.TextureFormat.DXT5:case y.TextureFormat.ETC1RGB:case y.TextureFormat.PVRTCRGB_2BPPV:case y.TextureFormat.PVRTCRGBA_2BPPV:case y.TextureFormat.PVRTCRGB_4BPPV:case y.TextureFormat.PVRTCRGBA_4BPPV:case y.TextureFormat.ETC2RGB:case y.TextureFormat.ETC2RGBA:case y.TextureFormat.ETC2SRGB:case y.TextureFormat.ASTC4x4:case y.TextureFormat.ASTC6x6:case y.TextureFormat.ASTC8x8:case y.TextureFormat.ASTC10x10:case y.TextureFormat.ASTC12x12:case y.TextureFormat.KTXTEXTURE:case y.TextureFormat.PVRTEXTURE:a.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return a}},{key:"_SimpleAnimatorTextureParse",value:function(t){var e,n,a=new p.Byte(t),r=a.readUTFString();switch(r){case"LAYAANIMATORTEXTURE:0000":var s,o=a.readInt32(),l=a.readInt32();e=new Float32Array(o*o*4),n=new Float32Array(a.readArrayBuffer(4*l)),e.set(n,0),(s=new i(o,o,y.TextureFormat.R32G32B32A32,!1,!1)).setPixels(e,0),s.filterMode=g.FilterMode.Point;break;case"LAYACOMPRESSANIMATORTEXTURE:0000":o=a.readInt32(),l=a.readInt32();if(e=new Uint16Array(a.readArrayBuffer(2*l)),m.SystemUtils.supportTextureFormat(y.TextureFormat.R16G16B16A16))(n=new Uint16Array(o*o*4)).set(e,0),(s=new i(o,o,y.TextureFormat.R16G16B16A16,!1,!1)).setPixels(n,0),s.filterMode=g.FilterMode.Point;else{console.log("The platform does not support 16-bit floating-point textures"),m.SystemUtils.supportTextureFormat(y.TextureFormat.R32G32B32A32)||console.error("The platform does not support 32-bit floating-point textures"),n=new Float32Array(o*o*4);for(var u=0,h=e.length;u<h;u++)n[u]=x.HalfFloatUtils.convertToNumber(e[u]);(s=new i(o,o,y.TextureFormat.R32G32B32A32,!1,!1)).setPixels(n,0),s.filterMode=g.FilterMode.Point}break;default:throw"Laya3D:unknow version."}return s}},{key:"load",value:function(t,e){d.ILaya.loader.create(t,e,null,d.ILaya.Loader.TEXTURE2D)}}]),i}(v.BaseTexture);e.Texture2D=k,k.TEXTURE2D="TEXTURE2D",k.grayTexture=null,k.whiteTexture=null,k.blackTexture=null,k.erroTextur=null},73972:function(t,e,i){"use strict";var n;i(63978)(e,"__esModule",{value:!0}),e.TextureFormat=void 0,e.TextureFormat=n,function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.R5G6B5=16]="R5G6B5",t[t.Alpha8=2]="Alpha8",t[t.DXT1=3]="DXT1",t[t.DXT5=4]="DXT5",t[t.ETC1RGB=5]="ETC1RGB",t[t.ETC2RGB=6]="ETC2RGB",t[t.ETC2RGBA=7]="ETC2RGBA",t[t.ETC2RGB_Alpha8=8]="ETC2RGB_Alpha8",t[t.ETC2SRGB=28]="ETC2SRGB",t[t.PVRTCRGB_2BPPV=9]="PVRTCRGB_2BPPV",t[t.PVRTCRGBA_2BPPV=10]="PVRTCRGBA_2BPPV",t[t.PVRTCRGB_4BPPV=11]="PVRTCRGB_4BPPV",t[t.PVRTCRGBA_4BPPV=12]="PVRTCRGBA_4BPPV",t[t.R32G32B32A32=15]="R32G32B32A32",t[t.R16G16B16A16=17]="R16G16B16A16",t[t.ASTC4x4=18]="ASTC4x4",t[t.ASTC4x4SRGB=23]="ASTC4x4SRGB",t[t.ASTC6x6=19]="ASTC6x6",t[t.ASTC6x6SRGB=24]="ASTC6x6SRGB",t[t.ASTC8x8=20]="ASTC8x8",t[t.ASTC8x8SRGB=25]="ASTC8x8SRGB",t[t.ASTC10x10=21]="ASTC10x10",t[t.ASTC10x10SRGB=26]="ASTC10x10SRGB",t[t.ASTC12x12=22]="ASTC12x12",t[t.ASTC12x12SRGB=27]="ASTC12x12SRGB",t[t.KTXTEXTURE=-1]="KTXTEXTURE",t[t.PVRTEXTURE=-2]="PVRTEXTURE"}(n||(e.TextureFormat=n={}))},95453:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.WebGLRTMgr=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(93894),l=i(57693),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getRT",value:function(t,e){return e|=0,(t|=0)>=1e4&&console.error("getRT error! w too big"),new o.RenderTexture2D(t,e,l.RenderTextureFormat.R8G8B8A8,-1)}},{key:"releaseRT",value:function(t){t.destroy()}}]),t}();e.WebGLRTMgr=u,u.dict={}},69176:function(t,e,i){"use strict";var n;i(63978)(e,"__esModule",{value:!0}),e.WarpMode=void 0,e.WarpMode=n,function(t){t[t.Repeat=0]="Repeat",t[t.Clamp=1]="Clamp",t[t.Mirrored=2]="Mirrored"}(n||(e.WarpMode=n={}))},21995:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.AutoBitmap=void 0;var s=r(i(2991)),o=r(i(92762)),l=r(i(15375)),u=r(i(17061)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(72276),v=i(54598),y=i(56083),p=i(23835),g=i(92493),m=i(94317),x=i(82994),T=i(43745);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var C=function(t){(0,c.default)(i,t);var e=k(i);function i(){var t;return(0,l.default)(this,i),(t=e.apply(this,arguments)).autoCacheCmd=!0,t._width=0,t._height=0,t.uv=null,t}return(0,u.default)(i,[{key:"destroy",value:function(){(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this),this._source=null,this._sizeGrid=null,this._offset=null}},{key:"sizeGrid",get:function(){return this._sizeGrid},set:function(t){this._sizeGrid=(0,s.default)(t).call(t,(function(t){return+t})),this._setChanged()}},{key:"width",get:function(){return this._width?this._width:this._source?this._source.sourceWidth:0},set:function(t){this._width!=t&&(this._width=t,this._setChanged())}},{key:"height",get:function(){return this._height?this._height:this._source?this._source.sourceHeight:0},set:function(t){this._height!=t&&(this._height=t,this._setChanged())}},{key:"source",get:function(){return this._source},set:function(t){if(t)this._source=t,this._setChanged();else if(this._source=null,this._drawGridCmd){this._one&&this._one==this._drawGridCmd&&this.clear();var e=this.cmds;e&&e.length>0&&e[0]==this._drawGridCmd&&(0,o.default)(e).call(e,0,1)}}},{key:"_setChanged",value:function(){this._isChanged||(this._isChanged=!0,g.ILaya.timer.callLater(this,this.changeSource))}},{key:"_createDrawTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9?arguments[9]:void 0;if(!t||s<.01)return null;if(!t.getIsReady())return null;if(n||(n=t.sourceWidth),a||(a=t.sourceHeight),t.getIsReady()){var h=n/t.sourceWidth,c=a/t.sourceHeight;if(n=t.width*h,a=t.height*c,n<=0||a<=0)return null;e+=t.offsetX*h,i+=t.offsetY*c}return this._sp&&(this._sp._renderType|=T.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),x.DrawTextureCmd.create.call(this,t,e,i,n,a,r,s,o,l,u)}},{key:"changeSource",value:function(){this._isChanged=!1;var t=this._source;if(t&&t.bitmap){var e=this.width,i=this.height,n=this._sizeGrid,a=t.sourceWidth,r=t.sourceHeight;if(!n||a===e&&r===i){var s=this._createDrawTexture(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,e,i,null,1,null,null,this.uv);s&&this._setDrawGridCmd(s)}else{var o=m.Draw9GridTexture.create(t,0,0,e,i,n);this._setDrawGridCmd(o)}this._repaint()}}},{key:"drawBitmap",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;a<.1||r<.1||(!t||e.width==a&&e.height==r?this.drawImage(e,i,n,a,r):this.fillTexture(e,i,n,a,r))}},{key:"_setDrawGridCmd",value:function(t){var e=this._source;if(e&&e.bitmap){var i=this.cmds;if(this._one||i&&!(i.length<=0)){var n=this._one;n?n==this._drawGridCmd?this._one=t:(this.clear(),this._saveToCmd(null,t),this._saveToCmd(null,n)):(0,o.default)(i).call(i,0,0,t)}else this._saveToCmd(null,t);this._drawGridCmd=t}}}],[{key:"getTexture",value:function(t,e,i,n,a){var r;return n<=0&&(n=1),a<=0&&(a=1),t.$_GID||(t.$_GID=y.Utils.getGID()),r&&r._getSource()||(r=v.Texture.createFromTexture(t,e,i,n,a)),r}}]),i}(_.Graphics);e.AutoBitmap=C,p.ClassUtils.regClass("laya.ui.AutoBitmap",C),p.ClassUtils.regClass("Laya.AutoBitmap",C)},93408:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Box=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(93615),f=i(89662),_=i(92493),v=i(23835);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var p=function(t){(0,u.default)(i,t);var e=y(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"dataSource",get:function(){return(0,l.default)((0,c.default)(i.prototype),"dataSource",this)},set:function(t){for(var e in this._dataSource=t,t){var i=this.getChildByName(e);i?i.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,t?(this._onResize(null),this.on(f.Event.RESIZE,this,this._onResize)):(this.graphics.clear(),this.off(f.Event.RESIZE,this,this._onResize))}},{key:"_onResize",value:function(t){this.graphics.clear(),this.graphics.drawRect(0,0,this.width,this.height,this._bgColor)}}]),i}(d.UIComponent);e.Box=p,_.ILaya.regClass(p),v.ClassUtils.regClass("laya.ui.Box",p),v.ClassUtils.regClass("Laya.Box",p)},33879:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Button=void 0;var s=r(i(94198)),o=r(i(15375)),l=r(i(17061)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(93615),_=i(90335),v=i(13407),y=i(81870),p=i(89662),g=i(85096),m=i(54598),x=i(21995),T=i(6642),k=i(41107),C=i(56083),S=i(76006),E=i(92493),M=i(23835);function L(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var b=function(t){(0,h.default)(i,t);var e=L(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,o.default)(this,i),(t=e.call(this))._labelColors=_.Styles.buttonLabelColors,t._state=0,t._autoSize=!0,t._stateNum=_.Styles.buttonStateNum,t._stateChanged=!1,t.skin=n,t.label=a,t}return(0,l.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(t),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new x.AutoBitmap}},{key:"createText",value:function(){this._text||(this._text=new y.Text,this._text.overflow=y.Text.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)}},{key:"initialize",value:function(){1!==this._mouseState&&(this.mouseEnabled=!0,this._setBit(v.Const.HAS_MOUSE,!0)),this._createListener(p.Event.MOUSE_OVER,this,this.onMouse,null,!1,!1),this._createListener(p.Event.MOUSE_OUT,this,this.onMouse,null,!1,!1),this._createListener(p.Event.MOUSE_DOWN,this,this.onMouse,null,!1,!1),this._createListener(p.Event.MOUSE_UP,this,this.onMouse,null,!1,!1),this._createListener(p.Event.CLICK,this,this.onMouse,null,!1,!1)}},{key:"onMouse",value:function(t){if(!1!==this.toggle||!this._selected)return t.type===p.Event.CLICK?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=i.stateMap[t.type]))}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,t?g.Loader.getRes(t)?this._skinLoaded():E.ILaya.loader.load(this._skin,k.Handler.create(this,this._skinLoaded),null,g.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.callLater(this.changeClips),this._setStateChanged(),this._sizeChanged(),this.event(p.Event.LOADED)}},{key:"stateNum",get:function(){return this._stateNum},set:function(t){"string"==typeof t&&(t=(0,s.default)(t)),this._stateNum!=t&&(this._stateNum=t<1?1:t>3?3:t,this.callLater(this.changeClips))}},{key:"changeClips",value:function(){var t=g.Loader.getRes(this._skin);if(t){var e=t.sourceWidth,i=t.sourceHeight/this._stateNum;t.$_GID||(t.$_GID=C.Utils.getGID());var n=t.$_GID+"-"+this._stateNum,a=S.WeakObject.I.get(n);if(C.Utils.isOkTextureList(a)||(a=null),a)this._sources=a;else{if(this._sources=[],1===this._stateNum)this._sources.push(t);else for(var r=0;r<this._stateNum;r++)this._sources.push(m.Texture.createFromTexture(t,0,i*r,e,i));S.WeakObject.I.set(n,this._sources)}this._autoSize?(this._bitmap.width=this._width||e,this._bitmap.height=this._height||i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=e)}else console.log("lose skin",this._skin)}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}},{key:"label",get:function(){return this._text?this._text.text:null},set:function(t){(this._text||t)&&(this.createText(),this._text.text!=t&&(t&&!this._text.parent&&this.addChild(this._text),this._text.text=(t+"").replace(/\\n/g,"\n"),this._setStateChanged()))}},{key:"selected",get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.state=this._selected?2:0,this.event(p.Event.CHANGE))}},{key:"state",get:function(){return this._state},set:function(t){this._state!=t&&(this._state=t,this._setStateChanged())}},{key:"changeState",value:function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[t]),this.label&&(this._text.color=this._labelColors[t],this._strokeColors&&(this._text.strokeColor=this._strokeColors[t]))}},{key:"labelColors",get:function(){return this._labelColors.join(",")},set:function(t){this._labelColors=T.UIUtils.fillArray(_.Styles.buttonLabelColors,t,String),this._setStateChanged()}},{key:"strokeColors",get:function(){return this._strokeColors?this._strokeColors.join(","):""},set:function(t){this._strokeColors=T.UIUtils.fillArray(_.Styles.buttonLabelColors,t,String),this._setStateChanged()}},{key:"labelPadding",get:function(){return this.createText(),this._text.padding.join(",")},set:function(t){this.createText(),this._text.padding=T.UIUtils.fillArray(_.Styles.labelPadding,t,Number)}},{key:"labelSize",get:function(){return this.createText(),this._text.fontSize},set:function(t){this.createText(),this._text.fontSize=t}},{key:"labelStroke",get:function(){return this.createText(),this._text.stroke},set:function(t){this.createText(),this._text.stroke=t}},{key:"labelStrokeColor",get:function(){return this.createText(),this._text.strokeColor},set:function(t){this.createText(),this._text.strokeColor=t}},{key:"labelBold",get:function(){return this.createText(),this._text.bold},set:function(t){this.createText(),this._text.bold=t}},{key:"labelFont",get:function(){return this.createText(),this._text.font},set:function(t){this.createText(),this._text.font=t}},{key:"labelAlign",get:function(){return this.createText(),this._text.align},set:function(t){this.createText(),this._text.align=t}},{key:"clickHandler",get:function(){return this._clickHandler},set:function(t){this._clickHandler=t}},{key:"text",get:function(){return this.createText(),this._text}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=T.UIUtils.fillArray(_.Styles.defaultSizeGrid,t,Number)}},{key:"width",get:function(){return(0,u.default)((0,d.default)(i.prototype),"get_width",this).call(this)},set:function(t){(0,u.default)((0,d.default)(i.prototype),"set_width",this).call(this,t),this._autoSize&&(this._bitmap.width=t,this._text&&(this._text.width=t))}},{key:"height",get:function(){return(0,u.default)((0,d.default)(i.prototype),"get_height",this).call(this)},set:function(t){(0,u.default)((0,d.default)(i.prototype),"set_height",this).call(this,t),this._autoSize&&(this._bitmap.height=t,this._text&&(this._text.height=t))}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"get_dataSource",this).call(this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.label=t+"":(0,u.default)((0,d.default)(i.prototype),"set_dataSource",this).call(this,t)}},{key:"iconOffset",get:function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},set:function(t){this._bitmap._offset=t?T.UIUtils.fillArray([1,1],t,Number):[]}},{key:"_setStateChanged",value:function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))}}]),i}(f.UIComponent);e.Button=b,b.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0},E.ILaya.regClass(b),M.ClassUtils.regClass("laya.ui.Button",b),M.ClassUtils.regClass("Laya.Button",b)},24830:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.CheckBox=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(33879),_=i(92493),v=i(23835);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var p=function(t){(0,h.default)(i,t);var e=y(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,s.default)(this,i),(t=e.call(this,n,a)).toggle=!0,t._autoSize=!1,t}return(0,o.default)(i,[{key:"preinitialize",value:function(){(0,u.default)((0,d.default)(i.prototype),"preinitialize",this).call(this),this.toggle=!0,this._autoSize=!1}},{key:"initialize",value:function(){(0,u.default)((0,d.default)(i.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,t instanceof Boolean?this.selected=t:"string"==typeof t?this.selected="true"===t:(0,l.default)((0,d.default)(i.prototype),"dataSource",t,this,!0)}}]),i}(f.Button);e.CheckBox=p,_.ILaya.regClass(p),v.ClassUtils.regClass("laya.ui.CheckBox",p),v.ClassUtils.regClass("Laya.CheckBox",p)},70078:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Clip=void 0;var s=r(i(94198)),o=r(i(15375)),l=r(i(17061)),u=r(i(49409)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(93615),v=i(21995),y=i(6642),p=i(90335),g=i(13407),m=i(89662),x=i(85096),T=i(54598),k=i(41107),C=i(56083),S=i(76006),E=i(92493),M=i(23835);function L(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var b=function(t){(0,c.default)(i,t);var e=L(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,o.default)(this,i),(t=e.call(this))._clipX=1,t._clipY=1,t._clipWidth=0,t._clipHeight=0,t._interval=50,t._index=0,t._toIndex=-1,t._clipX=a,t._clipY=r,t.skin=n,t}return(0,l.default)(i,[{key:"destroy",value:function(){(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null}},{key:"dispose",value:function(){this.destroy(!0),E.ILaya.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new v.AutoBitmap}},{key:"_onDisplay",value:function(t){this._isPlaying?this._getBit(g.Const.DISPLAYED_INSTAGE)?this.play():this.stop():this._autoPlay&&this.play()}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,t?x.Loader.getRes(t)?this._skinLoaded():E.ILaya.loader.load(this._skin,k.Handler.create(this,this._skinLoaded),null,x.Loader.IMAGE,1):this._bitmap.source=null)}},{key:"_skinLoaded",value:function(){this._setClipChanged(),this._sizeChanged(),this.event(m.Event.LOADED)}},{key:"clipX",get:function(){return this._clipX},set:function(t){this._clipX=t||1,this._setClipChanged()}},{key:"clipY",get:function(){return this._clipY},set:function(t){this._clipY=t||1,this._setClipChanged()}},{key:"clipWidth",get:function(){return this._clipWidth},set:function(t){this._clipWidth=t,this._setClipChanged()}},{key:"clipHeight",get:function(){return this._clipHeight},set:function(t){this._clipHeight=t,this._setClipChanged()}},{key:"changeClip",value:function(){if(this._clipChanged=!1,this._skin&&!this.destroyed){var t=x.Loader.getRes(this._skin);t?this.loadComplete(this._skin,t):E.ILaya.loader.load(this._skin,k.Handler.create(this,this.loadComplete,[this._skin]))}}},{key:"loadComplete",value:function(t,e){if(t===this._skin&&e){var i=this._clipWidth||Math.ceil(e.sourceWidth/this._clipX),n=this._clipHeight||Math.ceil(e.sourceHeight/this._clipY),a=this._skin+i+n,r=S.WeakObject.I.get(a);if(C.Utils.isOkTextureList(r)||(r=null),r)this._sources=r;else{this._sources=[];for(var s=0;s<this._clipY;s++)for(var o=0;o<this._clipX;o++)this._sources.push(T.Texture.createFromTexture(e,i*o,n*s,i,n));S.WeakObject.I.set(a,this._sources)}this.index=this._index,this.event(m.Event.LOADED),this.onCompResize()}}},{key:"sources",get:function(){return this._sources},set:function(t){this._sources=t,this.index=this._index,this.event(m.Event.LOADED)}},{key:"group",get:function(){return this._group},set:function(t){t&&this._skin&&x.Loader.setGroup(this._skin,t),this._group=t}},{key:"width",get:function(){return(0,h.default)((0,f.default)(i.prototype),"width",this)},set:function(t){(0,u.default)((0,f.default)(i.prototype),"width",t,this,!0),this._bitmap.width=t}},{key:"height",get:function(){return(0,h.default)((0,f.default)(i.prototype),"height",this)},set:function(t){(0,u.default)((0,f.default)(i.prototype),"height",t,this,!0),this._bitmap.height=t}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClip),this._bitmap.width}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClip),this._bitmap.height}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=y.UIUtils.fillArray(p.Styles.defaultSizeGrid,t,Number)}},{key:"index",get:function(){return this._index},set:function(t){this._index=t,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[t]),this.event(m.Event.CHANGE)}},{key:"total",get:function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}},{key:"autoPlay",get:function(){return this._autoPlay},set:function(t){this._autoPlay!=t&&(this._autoPlay=t,t?this.play():this.stop())}},{key:"interval",get:function(){return this._interval},set:function(t){this._interval!=t&&(this._interval=t,this._isPlaying&&this.play())}},{key:"isPlaying",get:function(){return this._isPlaying},set:function(t){this._isPlaying=t}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this._isPlaying=!0,this.index=t,this._toIndex=e,this._index++,E.ILaya.timer.loop(this.interval,this,this._loop),this.on(m.Event.DISPLAY,this,this._onDisplay),this.on(m.Event.UNDISPLAY,this,this._onDisplay)}},{key:"_loop",value:function(){this._visible&&this._sources&&(this._index++,this._toIndex>-1&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)}},{key:"stop",value:function(){this._isPlaying=!1,E.ILaya.timer.clear(this,this._loop),this.event(m.Event.COMPLETE)}},{key:"dataSource",get:function(){return(0,h.default)((0,f.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.index=(0,s.default)(t):(0,u.default)((0,f.default)(i.prototype),"dataSource",t,this,!0)}},{key:"bitmap",get:function(){return this._bitmap}},{key:"_setClipChanged",value:function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))}}]),i}(_.UIComponent);e.Clip=b,E.ILaya.regClass(b),M.ClassUtils.regClass("laya.ui.Clip",b),M.ClassUtils.regClass("Laya.Clip",b)},25435:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ColorPicker=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(93615),f=i(93408),_=i(33879),v=i(6642),y=i(61891),p=i(78362),g=i(89662),m=i(85399),x=i(92493),T=i(23835);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var C=function(t){(0,u.default)(i,t);var e=k(i);function i(){var t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,s.default)(this,i),(t=e.call(this,!1))._gridSize=11,t._bgColor="#ffffff",t._borderColor="#000000",t._inputColor="#000000",t._inputBgColor="#efefef",t._colors=[],t._selectedColor="#000000",n&&(t.preinitialize(),t.createChildren(),t.initialize()),t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];x.ILaya.stage.off(g.Event.MOUSE_DOWN,this,this.removeColorBox),(0,l.default)((0,c.default)(i.prototype),"destroy",this).call(this,t),this._colorPanel&&this._colorPanel.destroy(t),this._colorButton&&this._colorButton.destroy(t),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._colorButton=new _.Button),this._colorPanel=new f.Box,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new p.Sprite),this._colorPanel.addChild(this._colorBlock=new p.Sprite),this._colorPanel.addChild(this._colorInput=new y.Input)}},{key:"initialize",value:function(){this._colorButton.on(g.Event.CLICK,this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on(g.Event.CHANGE,this,this.onColorInputChange),this._colorInput.on(g.Event.KEY_DOWN,this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on(g.Event.MOUSE_MOVE,this,this.onColorTilesMouseMove),this._colorTiles.on(g.Event.CLICK,this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on(g.Event.MOUSE_DOWN,this,this.onPanelMouseDown),this.bgColor=this._bgColor}},{key:"onPanelMouseDown",value:function(t){t.stopPropagation()}},{key:"changePanel",value:function(){this._panelChanged=!1;var t=this._colorPanel.graphics;t.clear(!0),t.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(t=this._colorTiles.graphics).clear(!0);for(var e=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],i=0;i<12;i++)for(var n=0;n<20;n++){var a;a=0===n?e[i]:1===n?0:51*(((3*i+n/6)%3<<0)+3*(i/6<<0))<<16|n%6*51<<8|(i<<0)%6*51;var r=v.UIUtils.toColor(a);this._colors.push(r);var s=n*this._gridSize,o=i*this._gridSize;t.drawRect(s,o,this._gridSize,this._gridSize,r,"#000000")}}},{key:"onColorButtonClick",value:function(t){this._colorPanel.parent?this.close():this.open()}},{key:"open",value:function(){var t=x.ILaya.stage,e=this.localToGlobal(new m.Point),i=e.x+this._colorPanel.width<=t.width?e.x:t.width-this._colorPanel.width,n=e.y+this._colorButton.height;n=n+this._colorPanel.height<=t.height?n:e.y-this._colorPanel.height,this._colorPanel.pos(i,n),this._colorPanel.zOrder=1001,t.addChild(this._colorPanel),t.on(g.Event.MOUSE_DOWN,this,this.removeColorBox)}},{key:"close",value:function(){x.ILaya.stage.off(g.Event.MOUSE_DOWN,this,this.removeColorBox),this._colorPanel.removeSelf()}},{key:"removeColorBox",value:function(){this.close()}},{key:"onColorFieldKeyDown",value:function(t){13==t.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),t.stopPropagation())}},{key:"onColorInputChange",value:function(){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")}},{key:"onColorTilesClick",value:function(t){this.selectedColor=this.getColorByMouse(),this.close()}},{key:"onColorTilesMouseMove",value:function(t){this._colorInput.focus=!1;var e=this.getColorByMouse();this._colorInput.text=e,this.drawBlock(e)}},{key:"getColorByMouse",value:function(){var t=this._colorTiles.getMousePoint(),e=Math.floor(t.x/this._gridSize),i=Math.floor(t.y/this._gridSize);return this._colors[20*i+e]}},{key:"drawBlock",value:function(t){var e=this._colorBlock.graphics;e.clear(!0);var i=t||"#ffffff";e.drawRect(0,0,50,20,i,this._borderColor),t||e.drawLine(0,0,50,20,"#ff0000")}},{key:"selectedColor",get:function(){return this._selectedColor},set:function(t){this._selectedColor!=t&&(this._selectedColor=this._colorInput.text=t,this.drawBlock(t),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event(g.Event.CHANGE,g.Event.EMPTY.setTo(g.Event.CHANGE,this,this)))}},{key:"skin",get:function(){return this._colorButton.skin},set:function(t){this._colorButton.once(g.Event.LOADED,this,this.changeColor),this._colorButton.skin=t}},{key:"changeColor",value:function(){var t=this.graphics;t.clear(!0);var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,this._setPanelChanged()}},{key:"borderColor",get:function(){return this._borderColor},set:function(t){this._borderColor=t,this._setPanelChanged()}},{key:"inputColor",get:function(){return this._inputColor},set:function(t){this._inputColor=t,this._setPanelChanged()}},{key:"inputBgColor",get:function(){return this._inputBgColor},set:function(t){this._inputBgColor=t,this._setPanelChanged()}},{key:"_setPanelChanged",value:function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))}}]),i}(d.UIComponent);e.ColorPicker=C,x.ILaya.regClass(C),T.ClassUtils.regClass("laya.ui.ColorPicker",C),T.ClassUtils.regClass("Laya.ColorPicker",C)},20079:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ComboBox=void 0;var s=r(i(81643)),o=r(i(94198)),l=r(i(15375)),u=r(i(17061)),h=r(i(49409)),c=r(i(45408)),d=r(i(97709)),f=r(i(38191)),_=r(i(52305)),v=i(93615),y=i(33879),p=i(75485),g=i(90335),m=i(6642),x=i(89662),T=i(85399),k=i(41107),C=i(92493),S=i(23835);function E(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,_.default)(t);if(e){var r=(0,_.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,f.default)(this,i)}}var M=function(t){(0,d.default)(i,t);var e=E(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,l.default)(this,i),(t=e.call(this))._visibleNum=6,t._itemColors=g.Styles.comboBoxItemColors,t._itemSize=12,t._labels=[],t._selectedIndex=-1,t.itemRender=null,t.skin=n,t.labels=a,t}return(0,u.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];C.ILaya.stage.off(x.Event.MOUSE_DOWN,this,this.removeList),C.ILaya.stage.off(x.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),(0,c.default)((0,_.default)(i.prototype),"destroy",this).call(this,t),this._button&&this._button.destroy(t),this._list&&this._list.destroy(t),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null}},{key:"createChildren",value:function(){this.addChild(this._button=new y.Button),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on(x.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"_createList",value:function(){this._list=new p.List,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)}},{key:"_setListEvent",value:function(t){this._list.selectEnable=!0,this._list.on(x.Event.MOUSE_DOWN,this,this.onListDown),this._list.mouseHandler=k.Handler.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on(x.Event.MOUSE_DOWN,this,this.onScrollBarDown)}},{key:"onListDown",value:function(t){t.stopPropagation()}},{key:"onScrollBarDown",value:function(t){t.stopPropagation()}},{key:"onButtonMouseDown",value:function(t){this.callLater(this.switchTo,[!this._isOpen])}},{key:"skin",get:function(){return this._button.skin},set:function(t){this._button.skin!=t&&(this._button.skin=t,this._listChanged=!0)}},{key:"measureWidth",value:function(){return this._button.width}},{key:"measureHeight",value:function(){return this._button.height}},{key:"changeList",value:function(){this._listChanged=!1;var t=this.width-2,e=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}}]},this._list.repeatY=this._visibleNum,this._list.refresh()}},{key:"onlistItemMouse",value:function(t,e){var i=t.type;if(i===x.Event.MOUSE_OVER||i===x.Event.MOUSE_OUT){if(this._isCustomList)return;var n=this._list.getCell(e);if(!n)return;var a=n.getChildByName("label");a&&(i===x.Event.ROLL_OVER?(a.bgColor=this._itemColors[0],a.color=this._itemColors[1]):(a.bgColor=null,a.color=this._itemColors[2]))}else i===x.Event.CLICK&&(this.selectedIndex=e,this.isOpen=!1)}},{key:"switchTo",value:function(t){this.isOpen=t}},{key:"changeOpen",value:function(){this.isOpen=!this._isOpen}},{key:"width",get:function(){return(0,c.default)((0,_.default)(i.prototype),"width",this)},set:function(t){(0,h.default)((0,_.default)(i.prototype),"width",t,this,!0),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}},{key:"height",get:function(){return(0,c.default)((0,_.default)(i.prototype),"height",this)},set:function(t){(0,h.default)((0,_.default)(i.prototype),"height",t,this,!0),this._button.height=this._height}},{key:"labels",get:function(){return this._labels.join(",")},set:function(t){this._labels.length>0&&(this.selectedIndex=-1),t?this._labels=t.split(","):this._labels.length=0,this._itemChanged=!0}},{key:"changeItem",value:function(){if(this._itemChanged=!1,this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var t=this._list.graphics;t.clear(!0),t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var e=this._list.array||[];e.length=0;for(var i=0,n=this._labels.length;i<n;i++)e.push({label:this._labels[i]});this._list.height=this._listHeight,this._list.array=e}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event(x.Event.CHANGE,[x.Event.EMPTY.setTo(x.Event.CHANGE,this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}},{key:"changeSelected",value:function(){this._button.label=this.selectedLabel}},{key:"selectHandler",get:function(){return this._selectHandler},set:function(t){this._selectHandler=t}},{key:"selectedLabel",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,s.default)(e=this._labels).call(e,t)}},{key:"visibleNum",get:function(){return this._visibleNum},set:function(t){this._visibleNum=t,this._listChanged=!0}},{key:"itemColors",get:function(){return String(this._itemColors)},set:function(t){this._itemColors=m.UIUtils.fillArray(this._itemColors,t,String),this._listChanged=!0}},{key:"itemSize",get:function(){return this._itemSize},set:function(t){this._itemSize=t,this._listChanged=!0}},{key:"isOpen",get:function(){return this._isOpen},set:function(t){if(this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal(T.Point.TEMP.setTo(0,0)),i=e.y+this._button.height;i=i+this._listHeight<=C.ILaya.stage.height?i:e.y-this._listHeight,this._list.pos(e.x,i),this._list.zOrder=1001,C.ILaya.stage.addChild(this._list),C.ILaya.stage.once(x.Event.MOUSE_DOWN,this,this.removeList),C.ILaya.stage.on(x.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}},{key:"_onStageMouseWheel",value:function(t){this._list&&!this._list.contains(t.target)&&this.removeList(null)}},{key:"removeList",value:function(t){C.ILaya.stage.off(x.Event.MOUSE_DOWN,this,this.removeList),C.ILaya.stage.off(x.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this.isOpen=!1}},{key:"scrollBarSkin",get:function(){return this._scrollBarSkin},set:function(t){this._scrollBarSkin=t}},{key:"sizeGrid",get:function(){return this._button.sizeGrid},set:function(t){this._button.sizeGrid=t}},{key:"scrollBar",get:function(){return this.list.scrollBar}},{key:"button",get:function(){return this._button}},{key:"list",get:function(){return this._list||this._createList(),this._list},set:function(t){t&&(t.removeSelf(),this._isCustomList=!0,this._list=t,this._setListEvent(t),this._itemHeight=t.getCell(0).height+t.spaceY)}},{key:"dataSource",get:function(){return(0,c.default)((0,_.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,o.default)(t):t instanceof Array?this.labels=t.join(","):(0,h.default)((0,_.default)(i.prototype),"dataSource",t,this,!0)}},{key:"labelColors",get:function(){return this._button.labelColors},set:function(t){this._button.labelColors!=t&&(this._button.labelColors=t)}},{key:"labelPadding",get:function(){return this._button.text.padding.join(",")},set:function(t){this._button.text.padding=m.UIUtils.fillArray(g.Styles.labelPadding,t,Number)}},{key:"labelSize",get:function(){return this._button.text.fontSize},set:function(t){this._button.text.fontSize=t}},{key:"labelBold",get:function(){return this._button.text.bold},set:function(t){this._button.text.bold=t}},{key:"labelFont",get:function(){return this._button.text.font},set:function(t){this._button.text.font=t}},{key:"stateNum",get:function(){return this._button.stateNum},set:function(t){this._button.stateNum=t}}]),i}(v.UIComponent);e.ComboBox=M,C.ILaya.regClass(M),S.ClassUtils.regClass("laya.ui.ComboBox",M),S.ClassUtils.regClass("Laya.ComboBox",M)},75055:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Dialog=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(89395)),u=r(i(49409)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(79698),v=i(78567),y=i(6642),p=i(89662),g=i(98693),m=i(73371),x=i(92493),T=i(23835);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var C=function(t){(0,c.default)(i,t);var e=k(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this)).isShowEffect=!0,t.isPopupCenter=!0,t.popupEffect=i.manager.popupEffectHandler,t.closeEffect=i.manager.closeEffectHandler,t._dealDragArea(),t.on(p.Event.CLICK,(0,l.default)(t),t._onClick),t}return(0,o.default)(i,[{key:"_dealDragArea",value:function(){var t=this.getChildByName("drag");t&&(this.dragArea=t._x+","+t._y+","+t.width+","+t.height,t.removeSelf())}},{key:"dragArea",get:function(){return this._dragArea?this._dragArea.toString():null},set:function(t){if(t){var e=y.UIUtils.fillArray([0,0,0,0],t,Number);this._dragArea=new g.Rectangle(e[0],e[1],e[2],e[3]),this.on(p.Event.MOUSE_DOWN,this,this._onMouseDown)}else this._dragArea=null,this.off(p.Event.MOUSE_DOWN,this,this._onMouseDown)}},{key:"_onMouseDown",value:function(t){var e=this.getMousePoint();this._dragArea.contains(e.x,e.y)?this.startDrag():this.stopDrag()}},{key:"_onClick",value:function(t){var e=t.target;if(e)switch(e.name){case i.CLOSE:case i.CANCEL:case i.SURE:case i.NO:case i.OK:case i.YES:return void this.close(e.name)}}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._dealDragArea(),this._param=e,i.manager.open(this,t,this.isShowEffect),i.manager.lock(!1)}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.closeType=t,i.manager.close(this)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this._dragArea=null,(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this,t)}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._open(!1,t,e)}},{key:"popup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._open(!0,t,e)}},{key:"_open",value:function(t,e,n){this.isModal=t,this.isShowEffect=n,i.manager.lock(!0),this.open(e)}},{key:"isPopup",get:function(){return null!=this.parent}},{key:"zOrder",get:function(){return(0,h.default)((0,f.default)(i.prototype),"zOrder",this)},set:function(t){(0,u.default)((0,f.default)(i.prototype),"zOrder",t,this,!0),i.manager._checkMask()}}],[{key:"manager",get:function(){return i._manager=i._manager||new v.DialogManager},set:function(t){i._manager=t}},{key:"setLockView",value:function(t){i.manager.setLockView(t)}},{key:"lock",value:function(t){i.manager.lock(t)}},{key:"closeAll",value:function(){i.manager.closeAll()}},{key:"getDialogsByGroup",value:function(t){return i.manager.getDialogsByGroup(t)}},{key:"closeByGroup",value:function(t){return i.manager.closeByGroup(t)}}]),i}(_.View);e.Dialog=C,C.CLOSE="close",C.CANCEL="cancel",C.SURE="sure",C.NO="no",C.YES="yes",C.OK="ok",m.IUI.Dialog=C,x.ILaya.regClass(C),T.ClassUtils.regClass("laya.ui.Dialog",C),T.ClassUtils.regClass("Laya.Dialog",C)},78567:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.DialogManager=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(89395)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(14529),f=i(13407),_=i(78362),v=i(89662),y=i(93408),p=i(45840),g=i(41107),m=i(84221),x=i(73371),T=i(23835),k=i(92493);function C(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var S=function(t){(0,u.default)(i,t);var e=C(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this)).maskLayer=new _.Sprite,t.popupEffect=function(e){e.scale(1,1),e._effectTween=m.Tween.from(e,{x:k.ILaya.stage.width/2,y:k.ILaya.stage.height/2,scaleX:0,scaleY:0},300,p.Ease.backOut,g.Handler.create((0,l.default)(t),t.doOpen,[e]),0,!1,!1)},t.closeEffect=function(e){e._effectTween=m.Tween.to(e,{x:k.ILaya.stage.width/2,y:k.ILaya.stage.height/2,scaleX:0,scaleY:0},300,p.Ease.strongOut,g.Handler.create((0,l.default)(t),t.doClose,[e]),0,!1,!1)},t.popupEffectHandler=new g.Handler((0,l.default)(t),t.popupEffect),t.closeEffectHandler=new g.Handler((0,l.default)(t),t.closeEffect),t.mouseEnabled=t.maskLayer.mouseEnabled=!0,t.zOrder=1e3,k.ILaya.stage.addChild((0,l.default)(t)),k.ILaya.stage.on(v.Event.RESIZE,(0,l.default)(t),t._onResize),d.UIConfig.closeDialogOnSide&&t.maskLayer.on("click",(0,l.default)(t),t._closeOnSide),t._onResize(null),t}return(0,o.default)(i,[{key:"_closeOnSide",value:function(){var t=this.getChildAt(this.numChildren-1);t instanceof x.IUI.Dialog&&t.close("side")}},{key:"setLockView",value:function(t){this.lockLayer||(this.lockLayer=new y.Box,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(k.ILaya.stage.width,k.ILaya.stage.height)),this.lockLayer.removeChildren(),t&&(t.centerX=t.centerY=0,this.lockLayer.addChild(t))}},{key:"_onResize",value:function(){var t=this.maskLayer.width=k.ILaya.stage.width,e=this.maskLayer.height=k.ILaya.stage.height;this.lockLayer&&this.lockLayer.size(t,e),this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,t,e,d.UIConfig.popupBgColor),this.maskLayer.alpha=d.UIConfig.popupBgAlpha;for(var i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n.isPopupCenter&&this._centerDialog(n)}}},{key:"_centerDialog",value:function(t){t.x=Math.round((k.ILaya.stage.width-t.width>>1)+t.pivotX),t.y=Math.round((k.ILaya.stage.height-t.height>>1)+t.pivotY)}},{key:"open",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&this._closeAll(),this._clearDialogEffect(t),t.isPopupCenter&&this._centerDialog(t),this.addChild(t),(t.isModal||this._getBit(f.Const.HAS_ZORDER))&&k.ILaya.timer.callLater(this,this._checkMask),i&&null!=t.popupEffect?t.popupEffect.runWith(t):this.doOpen(t),this.event(v.Event.OPEN)}},{key:"_clearDialogEffect",value:function(t){t._effectTween&&(m.Tween.clear(t._effectTween),t._effectTween=null)}},{key:"doOpen",value:function(t){t.onOpened(t._param)}},{key:"lock",value:function(t){this.lockLayer&&(t?this.addChild(this.lockLayer):this.lockLayer.removeSelf())}},{key:"close",value:function(t){this._clearDialogEffect(t),t.isShowEffect&&null!=t.closeEffect?t.closeEffect.runWith([t]):this.doClose(t),this.event(v.Event.CLOSE)}},{key:"doClose",value:function(t){t.removeSelf(),t.isModal&&this._checkMask(),t.closeHandler&&t.closeHandler.runWith(t.closeType),t.onClosed(t.closeType),t.autoDestroyAtClosed&&t.destroy()}},{key:"closeAll",value:function(){this._closeAll(),this.event(v.Event.CLOSE)}},{key:"_closeAll",value:function(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);e&&null!=e.close&&this.doClose(e)}}},{key:"getDialogsByGroup",value:function(t){for(var e=[],i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n&&n.group===t&&e.push(n)}return e}},{key:"closeByGroup",value:function(t){for(var e=[],i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);n&&n.group===t&&(n.close(),e.push(n))}return e}},{key:"_checkMask",value:function(){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal)return void this.addChildAt(this.maskLayer,t)}}}]),i}(_.Sprite);e.DialogManager=S,T.ClassUtils.regClass("laya.ui.DialogManager",S),T.ClassUtils.regClass("Laya.DialogManager",S)},31487:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.FontClip=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(49409)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(89662),_=i(21995),v=i(70078),y=i(92493),p=i(23835);function g(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var m=function(t){(0,h.default)(i,t);var e=g(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,s.default)(this,i),(t=e.call(this))._valueArr="",t._indexMap=null,t._sheet=null,t._direction="horizontal",t._spaceX=0,t._spaceY=0,t._align="left",t._wordsW=0,t._wordsH=0,n&&(t.skin=n),a&&(t.sheet=a),t}return(0,o.default)(i,[{key:"createChildren",value:function(){this._bitmap=new _.AutoBitmap,this.on(f.Event.LOADED,this,this._onClipLoaded)}},{key:"_onClipLoaded",value:function(){this.callLater(this.changeValue)}},{key:"sheet",get:function(){return this._sheet},set:function(t){t+="",this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length,this.clipY=e.length,this._indexMap={};for(var i=0;i<this._clipY;i++)for(var n=e[i].split(""),a=0,r=n.length;a<r;a++)this._indexMap[n[a]]=i*this._clipX+a}},{key:"value",get:function(){return this._valueArr?this._valueArr:""},set:function(t){t+="",this._valueArr=t,this.callLater(this.changeValue)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t,this.callLater(this.changeValue)}},{key:"spaceX",get:function(){return this._spaceX},set:function(t){this._spaceX=t,"horizontal"===this._direction&&this.callLater(this.changeValue)}},{key:"spaceY",get:function(){return this._spaceY},set:function(t){this._spaceY=t,"horizontal"!==this._direction&&this.callLater(this.changeValue)}},{key:"align",get:function(){return this._align},set:function(t){this._align=t,this.callLater(this.changeValue)}},{key:"changeValue",value:function(){var t;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),t=this._sources[0]))){var e="horizontal"===this._direction;e?(this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX),this._wordsH=t.sourceHeight):(this._wordsW=t.sourceWidth,this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length);var i=0;if(this._width)switch(this._align){case"center":i=.5*(this._width-this._wordsW);break;case"right":i=this._width-this._wordsW;break;default:i=0}for(var n=0,a=this._valueArr.length;n<a;n++){var r=this._indexMap[this._valueArr.charAt(n)];this.sources[r]&&(t=this.sources[r],e?this.graphics.drawImage(t,i+n*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight):this.graphics.drawImage(t,0+i,n*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight))}this._width||(this._widget.resetLayoutX(),this.callLater(this._sizeChanged)),this._height||(this._widget.resetLayoutY(),this.callLater(this._sizeChanged))}}},{key:"width",get:function(){return(0,l.default)((0,d.default)(i.prototype),"width",this)},set:function(t){(0,u.default)((0,d.default)(i.prototype),"width",t,this,!0),this.callLater(this.changeValue)}},{key:"height",get:function(){return(0,l.default)((0,d.default)(i.prototype),"height",this)},set:function(t){(0,u.default)((0,d.default)(i.prototype),"height",t,this,!0),this.callLater(this.changeValue)}},{key:"measureWidth",value:function(){return this._wordsW}},{key:"measureHeight",value:function(){return this._wordsH}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off(f.Event.LOADED,this,this._onClipLoaded),(0,l.default)((0,d.default)(i.prototype),"destroy",this).call(this,t)}}]),i}(v.Clip);e.FontClip=m,y.ILaya.regClass(m),p.ClassUtils.regClass("laya.ui.FontClip",m),p.ClassUtils.regClass("Laya.FontClip",m)},51582:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HBox=void 0;var s=r(i(47302)),o=r(i(15375)),l=r(i(17061)),u=r(i(45408)),h=r(i(49409)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(66754),v=i(92493),y=i(23835);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var g=function(t){(0,c.default)(i,t);var e=p(i);function i(){return(0,o.default)(this,i),e.apply(this,arguments)}return(0,l.default)(i,[{key:"sortItem",value:function(t){t&&(0,s.default)(t).call(t,(function(t,e){return t.x-e.x}))}},{key:"height",get:function(){return(0,u.default)((0,f.default)(i.prototype),"height",this)},set:function(t){this._height!=t&&((0,h.default)((0,f.default)(i.prototype),"height",t,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var t=[],e=0,n=0,a=this.numChildren;n<a;n++){var r=this.getChildAt(n);r&&(t.push(r),e=this._height?this._height:Math.max(e,r.height*r.scaleY))}this.sortItem(t);var s=0;for(n=0,a=t.length;n<a;n++)(r=t[n]).x=s,s+=r.width*r.scaleX+this._space,this._align==i.TOP?r.y=0:this._align==i.MIDDLE?r.y=.5*(e-r.height*r.scaleY):this._align==i.BOTTOM&&(r.y=e-r.height*r.scaleY);this._sizeChanged()}}]),i}(_.LayoutBox);e.HBox=g,g.NONE="none",g.TOP="top",g.MIDDLE="middle",g.BOTTOM="bottom",v.ILaya.regClass(g),y.ClassUtils.regClass("laya.ui.HBox",g),y.ClassUtils.regClass("Laya.HBox",g)},8255:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HScrollBar=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(72978),f=i(92493),_=i(23835);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var y=function(t){(0,u.default)(i,t);var e=v(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"initialize",value:function(){(0,l.default)((0,c.default)(i.prototype),"initialize",this).call(this),this.slider.isVertical=!1}}]),i}(d.ScrollBar);e.HScrollBar=y,f.ILaya.regClass(y),_.ClassUtils.regClass("laya.ui.HScrollBar",y),_.ClassUtils.regClass("Laya.HScrollBar",y)},48181:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.HSlider=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(36895),c=i(92493),d=i(23835);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var _=function(t){(0,o.default)(i,t);var e=f(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,i),(t=e.call(this,n)).isVertical=!1,t}return i}(h.Slider);e.HSlider=_,c.ILaya.regClass(_),d.ClassUtils.regClass("laya.ui.HSlider",_),d.ClassUtils.regClass("Laya.HSlider",_)},73371:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.IUI=void 0;var r=a(i(15375));e.IUI=function t(){(0,r.default)(this,t)}},44476:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Image=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(90335),_=i(89662),v=i(85096),y=i(21995),p=i(93615),g=i(6642),m=i(41107),x=i(92493),T=i(23835);function k(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var C=function(t){(0,h.default)(i,t);var e=k(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,i),(t=e.call(this)).skin=n,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._bitmap&&this._bitmap.destroy(),this._bitmap=null}},{key:"dispose",value:function(){this.destroy(!0),x.ILaya.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new y.AutoBitmap,this._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(t){if(this._skin!=t)if(this._skin=t,t){var e=v.Loader.getRes(t);e?(this.source=e,this.onCompResize()):x.ILaya.loader.load(this._skin,m.Handler.create(this,this.setSource,[this._skin]),null,v.Loader.IMAGE,1,!0,this._group)}else this.source=null}},{key:"source",get:function(){return this._bitmap.source},set:function(t){this._bitmap&&(this._bitmap.source=t,this.event(_.Event.LOADED),this.repaint())}},{key:"group",get:function(){return this._group},set:function(t){t&&this._skin&&v.Loader.setGroup(this._skin,t),this._group=t}},{key:"setSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t===this._skin&&e&&(this.source=e,this.onCompResize())}},{key:"measureWidth",value:function(){return this._bitmap.width}},{key:"measureHeight",value:function(){return this._bitmap.height}},{key:"width",get:function(){return(0,u.default)((0,d.default)(i.prototype),"width",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"width",t,this,!0),this._bitmap.width=0==t?1e-7:t}},{key:"height",get:function(){return(0,u.default)((0,d.default)(i.prototype),"height",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"height",t,this,!0),this._bitmap.height=0==t?1e-7:t}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=g.UIUtils.fillArray(f.Styles.defaultSizeGrid,t,Number)}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"string"==typeof t?this.skin=t:(0,l.default)((0,d.default)(i.prototype),"dataSource",t,this,!0)}}]),i}(p.UIComponent);e.Image=C,x.ILaya.regClass(C),T.ClassUtils.regClass("laya.ui.Image",C),T.ClassUtils.regClass("Laya.Image",C)},96530:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Label=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(90335),_=i(81870),v=i(89662),y=i(93615),p=i(6642),g=i(92493),m=i(23835);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var T=function(t){(0,h.default)(i,t);var e=x(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.default)(this,i),(t=e.call(this)).text=n,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._tf=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new _.Text)}},{key:"text",get:function(){return this._tf.text},set:function(t){this._tf.text!=t&&(t&&(t=p.UIUtils.adptString(t+"")),this._tf.text=t,this.event(v.Event.CHANGE),this._width&&this._height||this.onCompResize())}},{key:"changeText",value:function(t){this._tf.changeText(t)}},{key:"wordWrap",get:function(){return this._tf.wordWrap},set:function(t){this._tf.wordWrap=t}},{key:"color",get:function(){return this._tf.color},set:function(t){this._tf.color=t}},{key:"font",get:function(){return this._tf.font},set:function(t){this._tf.font=t}},{key:"align",get:function(){return this._tf.align},set:function(t){this._tf.align=t}},{key:"valign",get:function(){return this._tf.valign},set:function(t){this._tf.valign=t}},{key:"bold",get:function(){return this._tf.bold},set:function(t){this._tf.bold=t}},{key:"italic",get:function(){return this._tf.italic},set:function(t){this._tf.italic=t}},{key:"leading",get:function(){return this._tf.leading},set:function(t){this._tf.leading=t}},{key:"fontSize",get:function(){return this._tf.fontSize},set:function(t){this._tf.fontSize=t}},{key:"padding",get:function(){return this._tf.padding.join(",")},set:function(t){this._tf.padding=p.UIUtils.fillArray(f.Styles.labelPadding,t,Number)}},{key:"bgColor",get:function(){return this._tf.bgColor},set:function(t){this._tf.bgColor=t}},{key:"borderColor",get:function(){return this._tf.borderColor},set:function(t){this._tf.borderColor=t}},{key:"stroke",get:function(){return this._tf.stroke},set:function(t){this._tf.stroke=t}},{key:"strokeColor",get:function(){return this._tf.strokeColor},set:function(t){this._tf.strokeColor=t}},{key:"textField",get:function(){return this._tf}},{key:"measureWidth",value:function(){return this._tf.width}},{key:"measureHeight",value:function(){return this._tf.height}},{key:"width",get:function(){return this._width||this._tf.text?(0,u.default)((0,d.default)(i.prototype),"width",this):0},set:function(t){(0,l.default)((0,d.default)(i.prototype),"width",t,this,!0),this._tf.width=t}},{key:"height",get:function(){return this._height||this._tf.text?(0,u.default)((0,d.default)(i.prototype),"height",this):0},set:function(t){(0,l.default)((0,d.default)(i.prototype),"height",t,this,!0),this._tf.height=t}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.text=t+"":(0,l.default)((0,d.default)(i.prototype),"dataSource",t,this,!0)}},{key:"overflow",get:function(){return this._tf.overflow},set:function(t){this._tf.overflow=t}},{key:"underline",get:function(){return this._tf.underline},set:function(t){this._tf.underline=t}},{key:"underlineColor",get:function(){return this._tf.underlineColor},set:function(t){this._tf.underlineColor=t}}]),i}(y.UIComponent);e.Label=T,g.ILaya.regClass(T),m.ClassUtils.regClass("laya.ui.Label",T),m.ClassUtils.regClass("Laya.Label",T)},66754:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.LayoutBox=void 0;var s=r(i(47302)),o=r(i(15375)),l=r(i(17061)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(93408),_=i(89662),v=i(92493),y=i(23835);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var g=function(t){(0,h.default)(i,t);var e=p(i);function i(){var t;return(0,o.default)(this,i),(t=e.apply(this,arguments))._space=0,t._align="none",t._itemChanged=!1,t}return(0,l.default)(i,[{key:"addChild",value:function(t){return t.on(_.Event.RESIZE,this,this.onResize),this._setItemChanged(),(0,u.default)((0,d.default)(i.prototype),"addChild",this).call(this,t)}},{key:"onResize",value:function(t){this._setItemChanged()}},{key:"addChildAt",value:function(t,e){return t.on(_.Event.RESIZE,this,this.onResize),this._setItemChanged(),(0,u.default)((0,d.default)(i.prototype),"addChildAt",this).call(this,t,e)}},{key:"removeChildAt",value:function(t){return this.getChildAt(t).off(_.Event.RESIZE,this,this.onResize),this._setItemChanged(),(0,u.default)((0,d.default)(i.prototype),"removeChildAt",this).call(this,t)}},{key:"refresh",value:function(){this._setItemChanged()}},{key:"changeItems",value:function(){this._itemChanged=!1}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._setItemChanged()}},{key:"align",get:function(){return this._align},set:function(t){this._align=t,this._setItemChanged()}},{key:"sortItem",value:function(t){t&&(0,s.default)(t).call(t,(function(t,e){return t.y-e.y}))}},{key:"_setItemChanged",value:function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))}}]),i}(f.Box);e.LayoutBox=g,v.ILaya.regClass(g),y.ClassUtils.regClass("laya.ui.LayoutBox",g),y.ClassUtils.regClass("Laya.LayoutBox",g)},75485:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.List=void 0;var s=r(i(81643)),o=r(i(94198)),l=r(i(92762)),u=r(i(15375)),h=r(i(17061)),c=r(i(49409)),d=r(i(45408)),f=r(i(97709)),_=r(i(38191)),v=r(i(52305)),y=i(93408),p=i(37277),g=i(8255),m=i(6642),x=i(89662),T=i(85399),k=i(98693),C=i(21383),S=i(84221),E=i(92493),M=i(23835);function L(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,v.default)(t);if(e){var r=(0,v.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,_.default)(this,i)}}var b=function(t){(0,f.default)(i,t);var e=L(i);function i(){var t;return(0,u.default)(this,i),(t=e.apply(this,arguments)).selectEnable=!1,t.totalPage=0,t._$componentType="List",t._repeatX=0,t._repeatY=0,t._repeatX2=0,t._repeatY2=0,t._spaceX=0,t._spaceY=0,t._cells=[],t._startIndex=0,t._selectedIndex=-1,t._page=0,t._isVertical=!0,t._cellSize=20,t._cellOffset=0,t._createdLine=0,t._offset=new T.Point,t._usedCache=null,t._elasticEnabled=!1,t._preLen=0,t}return(0,h.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._content&&this._content.destroy(t),this._scrollBar&&this._scrollBar.destroy(t),(0,d.default)((0,v.default)(i.prototype),"destroy",this).call(this,t),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null}},{key:"createChildren",value:function(){this.addChild(this._content=new y.Box)}},{key:"cacheAs",get:function(){return(0,d.default)((0,v.default)(i.prototype),"cacheAs",this)},set:function(t){(0,c.default)((0,v.default)(i.prototype),"cacheAs",t,this,!0),this._scrollBar&&(this._usedCache=null,"none"!==t?this._scrollBar.on(x.Event.START,this,this.onScrollStart):this._scrollBar.off(x.Event.START,this,this.onScrollStart))}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=(0,d.default)((0,v.default)(i.prototype),"cacheAs",this)),(0,c.default)((0,v.default)(i.prototype),"cacheAs","none",this,!0),this._scrollBar.once(x.Event.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){(0,c.default)((0,v.default)(i.prototype),"cacheAs",this._usedCache||"none",this,!0)}},{key:"content",get:function(){return this._content}},{key:"vScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(t){this._removePreScrollBar();var e=new p.VScrollBar;e.name="scrollBar",e.right=0,e.skin=t,e.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=e,this.addChild(e),this._setCellChanged()}},{key:"_removePreScrollBar",value:function(){var t=this.removeChildByName("scrollBar");t&&t.destroy(!0)}},{key:"hScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(t){this._removePreScrollBar();var e=new g.HScrollBar;e.name="scrollBar",e.bottom=0,e.skin=t,e.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=e,this.addChild(e),this._setCellChanged()}},{key:"scrollBar",get:function(){return this._scrollBar},set:function(t){this._scrollBar!=t&&(this._scrollBar=t,t&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on(x.Event.CHANGE,this,this.onScrollBarChange)))}},{key:"itemRender",get:function(){return this._itemRender},set:function(t){if(this._itemRender!=t){this._itemRender=t;for(var e=this._cells.length-1;e>-1;e--)this._cells[e].destroy();this._cells.length=0,this._setCellChanged()}}},{key:"width",get:function(){return(0,d.default)((0,v.default)(i.prototype),"width",this)},set:function(t){t!=this._width&&((0,c.default)((0,v.default)(i.prototype),"width",t,this,!0),this._setCellChanged())}},{key:"height",get:function(){return(0,d.default)((0,v.default)(i.prototype),"height",this)},set:function(t){t!=this._height&&((0,c.default)((0,v.default)(i.prototype),"height",t,this,!0),this._setCellChanged())}},{key:"repeatX",get:function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},set:function(t){this._repeatX=t,this._setCellChanged()}},{key:"repeatY",get:function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},set:function(t){this._repeatY=t,this._setCellChanged()}},{key:"spaceX",get:function(){return this._spaceX},set:function(t){this._spaceX=t,this._setCellChanged()}},{key:"spaceY",get:function(){return this._spaceY},set:function(t){this._spaceY=t,this._setCellChanged()}},{key:"changeCells",value:function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var t=this._getOneCell(),e=t.width+this._spaceX||1,i=t.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/i):Math.round(this._height/i));var n=this._width?this._width:e*this.repeatX-this._spaceX,a=this._height?this._height:i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?i:e,this._cellOffset=this._isVertical?i*Math.max(this._repeatY2,this._repeatY)-a-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-n-this._spaceX,this._isVertical&&this.vScrollBarSkin?this._scrollBar.height=a:!this._isVertical&&this.hScrollBarSkin&&(this._scrollBar.width=n),this.setContentSize(n,a);var r=this._isVertical?this.repeatX:this.repeatY,s=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,r,s),this._createdLine=s,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}}},{key:"_getOneCell",value:function(){if(0===this._cells.length){var t=this.createItem();if(this._offset.setTo(t._x,t._y),this.cacheContent)return t;this._cells.push(t)}return this._cells[0]}},{key:"_createItems",value:function(t,e,i){var n=this._content,a=this._getOneCell(),r=a.width+this._spaceX,s=a.height+this._spaceY;if(this.cacheContent){var o=new y.Box;o.cacheAs="normal",o.pos((this._isVertical?0:t)*r,(this._isVertical?t:0)*s),this._content.addChild(o),n=o}else{for(var l=[],u=this._cells.length-1;u>-1;u--){var h=this._cells[u];h.removeSelf(),l.push(h)}this._cells.length=0}for(var c=t;c<i;c++)for(var d=0;d<e;d++)(a=l&&l.length?l.pop():this.createItem()).x=(this._isVertical?d:c)*r-n._x,a.y=(this._isVertical?c:d)*s-n._y,a.name="item"+(c*e+d),n.addChild(a),this.addCell(a)}},{key:"createItem",value:function(){var t=[];if("function"==typeof this._itemRender)var e=new this._itemRender;else e=C.SceneUtils.createComp(this._itemRender,null,null,t);if(0==t.length&&e._watchMap){var i=e._watchMap;for(var n in i)for(var a=i[n],r=0;r<a.length;r++){var s=a[r];t.push(s.comp,s.prop,s.value)}}return t.length&&(e._$bindData=t),e}},{key:"addCell",value:function(t){t.on(x.Event.CLICK,this,this.onCellMouse),t.on(x.Event.RIGHT_CLICK,this,this.onCellMouse),t.on(x.Event.MOUSE_OVER,this,this.onCellMouse),t.on(x.Event.MOUSE_OUT,this,this.onCellMouse),t.on(x.Event.MOUSE_DOWN,this,this.onCellMouse),t.on(x.Event.MOUSE_UP,this,this.onCellMouse),this._cells.push(t)}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){if(!this._itemRender&&null!=this.getChildByName("item0")){var t;this.repeatX=1,t=0;for(var e=0;e<1e4;e++){var i=this.getChildByName("item"+e);if(!i)break;this.addCell(i),t++}this.repeatY=t}}},{key:"setContentSize",value:function(t,e){this._content.width=t,this._content.height=e,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content._style.scrollRect||(this._content.scrollRect=k.Rectangle.create()),this._content._style.scrollRect.setTo(-this._offset.x,-this._offset.y,t,e),this._content.scrollRect=this._content.scrollRect),this.event(x.Event.RESIZE)}},{key:"onCellMouse",value:function(t){var e;t.type===x.Event.MOUSE_DOWN&&(this._isMoved=!1);var i=t.currentTarget,n=this._startIndex+(0,s.default)(e=this._cells).call(e,i);n<0||(t.type===x.Event.CLICK||t.type===x.Event.RIGHT_CLICK?this.selectEnable&&!this._isMoved?this.selectedIndex=n:this.changeCellState(i,!0,0):t.type!==x.Event.MOUSE_OVER&&t.type!==x.Event.MOUSE_OUT||this._selectedIndex===n||this.changeCellState(i,t.type===x.Event.MOUSE_OVER,0),this.mouseHandler&&this.mouseHandler.runWith([t,n]))}},{key:"changeCellState",value:function(t,e,i){var n=t.getChildByName("selectBox");n&&(this.selectEnable=!0,n.visible=e,n.index=i)}},{key:"_sizeChanged",value:function(){(0,d.default)((0,v.default)(i.prototype),"_sizeChanged",this).call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)}},{key:"onScrollBarChange",value:function(){this.runCallLater(this.changeCells);var t=this._scrollBar.value,e=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,n=Math.floor(t/this._cellSize);if(this.cacheContent)r=i+1,this._createdLine-n<r&&(this._createItems(this._createdLine,e,this._createdLine+r),this.renderItems(this._createdLine*e,0),this._createdLine+=r);else{var a=n*e,r=0,s=!0,o=0;a>this._startIndex?(r=a-this._startIndex,o=this._startIndex+e*(i+1),this._isMoved=!0):a<this._startIndex&&(r=this._startIndex-a,s=!1,o=this._startIndex-1,this._isMoved=!0);for(var l=0;l<r;l++){if(s){var u=this._cells.shift();this._cells[this._cells.length]=u;var h=o+l}else u=this._cells.pop(),this._cells.unshift(u),h=o-l;var c=Math.floor(h/e)*this._cellSize;this._isVertical?u.y=c:u.x=c,this.renderItem(u,h)}this._startIndex=a,this.changeSelectStatus()}var d=this._content._style.scrollRect;this._isVertical?(d.y=t-this._offset.y,d.x=-this._offset.x):(d.y=-this._offset.y,d.x=t-this._offset.x),this._content.scrollRect=d}},{key:"posCell",value:function(t,e){if(this._scrollBar){var i=this._isVertical?this.repeatX:this.repeatY,n=Math.floor(e/i)*this._cellSize;this._isVertical?t._y=n:t.x=n}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.changeSelectStatus(),this.event(x.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(t),this.startIndex=this._startIndex)}},{key:"changeSelectStatus",value:function(){for(var t=0,e=this._cells.length;t<e;t++)this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)}},{key:"selectedItem",get:function(){return this._array&&-1!=this._selectedIndex?this._array[this._selectedIndex]:null},set:function(t){var e;this._array&&(this.selectedIndex=(0,s.default)(e=this._array).call(e,t))}},{key:"selection",get:function(){return this.getCell(this._selectedIndex)},set:function(t){var e;this.selectedIndex=this._startIndex+(0,s.default)(e=this._cells).call(e,t)}},{key:"startIndex",get:function(){return this._startIndex},set:function(t){this._startIndex=t>0?t:0,this.callLater(this.renderItems)}},{key:"renderItems",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t,n=e||this._cells.length;i<n;i++)this.renderItem(this._cells[i],this._startIndex+i);this.changeSelectStatus()}},{key:"renderItem",value:function(t,e){this._array&&e>=0&&e<this._array.length?(t.visible=!0,t._$bindData?(t._dataSource=this._array[e],this._bindData(t,this._array[e])):t.dataSource=this._array[e],this.cacheContent||this.posCell(t,e),this.hasListener(x.Event.RENDER)&&this.event(x.Event.RENDER,[t,e]),this.renderHandler&&this.renderHandler.runWith([t,e])):(t.visible=!1,t.dataSource=null)}},{key:"_bindData",value:function(t,e){for(var i=t._$bindData,n=0,a=i.length;n<a;n++){var r=i[n++],s=i[n++],o=i[n],l=m.UIUtils.getBindFun(o);r[s]=l.call(this,e)}}},{key:"array",get:function(){return this._array},set:function(t){this.runCallLater(this.changeCells),this._array=t||[],this._preLen=this._array.length;var e=this._array.length;if(this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,a=Math.ceil(e/i);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1&&a>=n?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=n/a,this._scrollBar.setScroll(0,(a-n)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}},{key:"updateArray",value:function(t){if(this._array=t,this._array){var e=this._preLen-this._startIndex;e>=0&&this.renderItems(e),this._preLen=this._array.length}if(this._scrollBar){var i=t.length,n=this._isVertical?this.repeatX:this.repeatY,a=this._isVertical?this.repeatY:this.repeatX,r=Math.ceil(i/n);r>=a&&(this._scrollBar.thumbPercent=a/r,this._scrollBar.slider._max=(r-a)*this._cellSize+this._cellOffset)}}},{key:"page",get:function(){return this._page},set:function(t){this._page=t,this._array&&(this._page=t>0?t:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}},{key:"length",get:function(){return this._array?this._array.length:0}},{key:"dataSource",get:function(){return(0,d.default)((0,v.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,o.default)(t):t instanceof Array?this.array=t:(0,c.default)((0,v.default)(i.prototype),"dataSource",t,this,!0)}},{key:"cells",get:function(){return this.runCallLater(this.changeCells),this._cells}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(t){this._elasticEnabled=t,this._scrollBar&&(this._scrollBar.elasticDistance=t?200:0)}},{key:"refresh",value:function(){this.array=this._array}},{key:"getItem",value:function(t){return this._array&&t>-1&&t<this._array.length?this._array[t]:null}},{key:"changeItem",value:function(t,e){t>-1&&this._array&&t<this._array.length&&(this._array[t]=e,t>=this._startIndex&&t<this._startIndex+this._cells.length&&this.renderItem(this.getCell(t),t))}},{key:"setItem",value:function(t,e){this.changeItem(t,e)}},{key:"addItem",value:function(t){this.array?this._array.push(t):this.array=[t],this.array=this._array}},{key:"addItemAt",value:function(t,e){var i;(0,l.default)(i=this._array).call(i,e,0,t),this.array=this._array}},{key:"deleteItem",value:function(t){var e;this._array&&((0,l.default)(e=this._array).call(e,t,1),this.array=this._array)}},{key:"getCell",value:function(t){return this.runCallLater(this.changeCells),t>-1&&this._cells?this._cells[(t-this._startIndex)%this._cells.length]:null}},{key:"scrollTo",value:function(t){if(this._scrollBar){var e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else this.startIndex=t}},{key:"tweenTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._scrollBar){this._scrollBar.stopScroll();var n=this._isVertical?this.repeatX:this.repeatY;S.Tween.to(this._scrollBar,{value:Math.floor(t/n)*this._cellSize},e,null,i,0,!0)}else this.startIndex=t,i&&i.run()}},{key:"_setCellChanged",value:function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeCells)}}]),i}(y.Box);e.List=b,E.ILaya.regClass(b),M.ClassUtils.regClass("laya.ui.List",b),M.ClassUtils.regClass("Laya.List",b)},29084:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Panel=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(93408),_=i(37277),v=i(8255),y=i(89662),p=i(98693),g=i(92493),m=i(23835);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var T=function(t){(0,h.default)(i,t);var e=x(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this))._usedCache=null,t._elasticEnabled=!1,t.width=t.height=100,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._content&&this._content.destroy(t),this._vScrollBar&&this._vScrollBar.destroy(t),this._hScrollBar&&this._hScrollBar.destroy(t),this._vScrollBar=null,this._hScrollBar=null,this._content=null}},{key:"destroyChildren",value:function(){this._content.destroyChildren()}},{key:"createChildren",value:function(){(0,u.default)((0,d.default)(i.prototype),"addChild",this).call(this,this._content=new f.Box)}},{key:"addChild",value:function(t){return t.on(y.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChild(t)}},{key:"onResize",value:function(){this._setScrollChanged()}},{key:"addChildAt",value:function(t,e){return t.on(y.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChildAt(t,e)}},{key:"removeChild",value:function(t){return t.off(y.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChild(t)}},{key:"removeChildAt",value:function(t){return this.getChildAt(t).off(y.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(t)}},{key:"removeChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2147483647;return this._content.removeChildren(t,e),this._setScrollChanged(),this}},{key:"getChildAt",value:function(t){return this._content.getChildAt(t)}},{key:"getChildByName",value:function(t){return this._content.getChildByName(t)}},{key:"getChildIndex",value:function(t){return this._content.getChildIndex(t)}},{key:"numChildren",get:function(){return this._content.numChildren}},{key:"changeScroll",value:function(){this._scrollChanged=!1;var t=this.contentWidth||1,e=this.contentHeight||1,i=this._vScrollBar,n=this._hScrollBar,a=i&&e>this._height,r=n&&t>this._width,s=a?this._width-i.width:this._width,o=r?this._height-n.height:this._height;i&&(i.x=this._width-i.width,i.y=0,i.height=this._height-(r?n.height:0),i.scrollSize=Math.max(.033*this._height,1),i.thumbPercent=o/e,i.setScroll(0,e-o,i.value)),n&&(n.x=0,n.y=this._height-n.height,n.width=this._width-(a?i.width:0),n.scrollSize=Math.max(.033*this._width,1),n.thumbPercent=s/t,n.setScroll(0,t-s,n.value))}},{key:"_sizeChanged",value:function(){(0,u.default)((0,d.default)(i.prototype),"_sizeChanged",this).call(this),this.setContentSize(this._width,this._height)}},{key:"contentWidth",get:function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i._x+i.width*i.scaleX-i.pivotX,t)}return t}},{key:"contentHeight",get:function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i._y+i.height*i.scaleY-i.pivotY,t)}return t}},{key:"setContentSize",value:function(t,e){var i=this._content;i.width=t,i.height=e,i._style.scrollRect||(i.scrollRect=p.Rectangle.create()),i._style.scrollRect.setTo(0,0,t,e),i.scrollRect=i.scrollRect}},{key:"width",get:function(){return(0,u.default)((0,d.default)(i.prototype),"width",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"width",t,this,!0),this._setScrollChanged()}},{key:"height",get:function(){return(0,u.default)((0,d.default)(i.prototype),"height",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"height",t,this,!0),this._setScrollChanged()}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(t){null==this._vScrollBar&&((0,u.default)((0,d.default)(i.prototype),"addChild",this).call(this,this._vScrollBar=new _.VScrollBar),this._vScrollBar.on(y.Event.CHANGE,this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._vScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._vScrollBar.skin=t}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(t){null==this._hScrollBar&&((0,u.default)((0,d.default)(i.prototype),"addChild",this).call(this,this._hScrollBar=new v.HScrollBar),this._hScrollBar.on(y.Event.CHANGE,this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._hScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._hScrollBar.skin=t}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"content",get:function(){return this._content}},{key:"onScrollBarChange",value:function(t){var e=this._content._style.scrollRect;if(e){var i=Math.round(t.value);t.isVertical?e.y=i:e.x=i,this._content.scrollRect=e}}},{key:"scrollTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.vScrollBar&&(this.vScrollBar.value=e),this.hScrollBar&&(this.hScrollBar.value=t)}},{key:"refresh",value:function(){this.changeScroll()}},{key:"cacheAs",get:function(){return(0,u.default)((0,d.default)(i.prototype),"cacheAs",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"cacheAs",t,this,!0),this._usedCache=null,"none"!==t?(this._hScrollBar&&this._hScrollBar.on(y.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on(y.Event.START,this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off(y.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off(y.Event.START,this,this.onScrollStart))}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(t){this._elasticEnabled=t,this._vScrollBar&&(this._vScrollBar.elasticDistance=t?200:0),this._hScrollBar&&(this._hScrollBar.elasticDistance=t?200:0)}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=(0,u.default)((0,d.default)(i.prototype),"cacheAs",this)),(0,l.default)((0,d.default)(i.prototype),"cacheAs","none",this,!0),this._hScrollBar&&this._hScrollBar.once(y.Event.END,this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once(y.Event.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){(0,l.default)((0,d.default)(i.prototype),"cacheAs",this._usedCache,this,!0)}},{key:"_setScrollChanged",value:function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))}}]),i}(f.Box);e.Panel=T,g.ILaya.regClass(T),m.ClassUtils.regClass("laya.ui.Panel",T),m.ClassUtils.regClass("Laya.Panel",T)},58336:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ProgressBar=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(89662),_=i(85096),v=i(93615),y=i(44476),p=i(41107),g=i(92493),m=i(23835);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var T=function(t){(0,h.default)(i,t);var e=x(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,i),(t=e.call(this))._value=.5,t.skin=n,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._bg=this._bar=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new y.Image),this.addChild(this._bar=new y.Image),this._bar._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!_.Loader.getRes(this._skin)?g.ILaya.loader.load(this._skin,p.Handler.create(this,this._skinLoaded),null,_.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.destroyed||(this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue),this._sizeChanged(),this.event(f.Event.LOADED))}},{key:"measureWidth",value:function(){return this._bg.width}},{key:"measureHeight",value:function(){return this._bg.height}},{key:"value",get:function(){return this._value},set:function(t){this._value!=t&&(t=t>1?1:t<0?0:t,this._value=t,this.callLater(this.changeValue),this.event(f.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(t))}},{key:"changeValue",value:function(){if(this.sizeGrid){var t=this.sizeGrid.split(","),e=Number(t[3]),i=Number(t[1]),n=(this.width-e-i)*this._value;this._bar.width=e+i+n,this._bar.visible=this._bar.width>e+i}else this._bar.width=this.width*this._value}},{key:"bar",get:function(){return this._bar}},{key:"bg",get:function(){return this._bg}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(t){this._bg.sizeGrid=this._bar.sizeGrid=t}},{key:"width",get:function(){return(0,u.default)((0,d.default)(i.prototype),"width",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"width",t,this,!0),this._bg.width=this._width,this.callLater(this.changeValue)}},{key:"height",get:function(){return(0,u.default)((0,d.default)(i.prototype),"height",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"height",t,this,!0),this._bg.height=this._height,this._bar.height=this._height}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):(0,l.default)((0,d.default)(i.prototype),"dataSource",t,this,!0)}}]),i}(v.UIComponent);e.ProgressBar=T,g.ILaya.regClass(T),m.ClassUtils.regClass("laya.ui.ProgressBar",T),m.ClassUtils.regClass("Laya.ProgressBar",T)},82201:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Radio=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(89662),f=i(33879),_=i(92493),v=i(23835);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var p=function(t){(0,u.default)(i,t);var e=y(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,s.default)(this,i),(t=e.call(this,n,a)).toggle=!1,t._autoSize=!1,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,l.default)((0,c.default)(i.prototype),"destroy",this).call(this,t),this._value=null}},{key:"preinitialize",value:function(){(0,l.default)((0,c.default)(i.prototype),"preinitialize",this).call(this),this.toggle=!1,this._autoSize=!1}},{key:"initialize",value:function(){(0,l.default)((0,c.default)(i.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on(d.Event.CLICK,this,this.onClick)}},{key:"onClick",value:function(t){this.selected=!0}},{key:"value",get:function(){return null!=this._value?this._value:this.label},set:function(t){this._value=t}}]),i}(f.Button);e.Radio=p,_.ILaya.regClass(p),v.ClassUtils.regClass("laya.ui.Radio",p),v.ClassUtils.regClass("Laya.Radio",p)},50250:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.RadioGroup=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(9570),d=i(82201),f=i(92493),_=i(23835);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var y=function(t){(0,l.default)(i,t);var e=v(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"createItem",value:function(t,e){return new d.Radio(t,e)}}]),i}(c.UIGroup);e.RadioGroup=y,f.ILaya.regClass(y),_.ClassUtils.regClass("laya.ui.RadioGroup",y),_.ClassUtils.regClass("Laya.RadioGroup",y)},2292:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ScaleBox=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(49409)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(93408),_=i(92493),v=i(23835);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var p=function(t){(0,h.default)(i,t);var e=y(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments))._oldW=0,t._oldH=0,t}return(0,o.default)(i,[{key:"onEnable",value:function(){_.ILaya.stage.on("resize",this,this.onResize),this.onResize()}},{key:"onDisable",value:function(){_.ILaya.stage.off("resize",this,this.onResize)}},{key:"onResize",value:function(){var t=_.ILaya.stage;if(this.width>0&&this.height>0){var e=Math.min(t.width/this._oldW,t.height/this._oldH);(0,u.default)((0,d.default)(i.prototype),"width",t.width,this,!0),(0,u.default)((0,d.default)(i.prototype),"height",t.height,this,!0),this.scale(e,e)}}},{key:"width",get:function(){return(0,l.default)((0,d.default)(i.prototype),"width",this)},set:function(t){(0,u.default)((0,d.default)(i.prototype),"width",t,this,!0),this._oldW=t}},{key:"height",get:function(){return(0,l.default)((0,d.default)(i.prototype),"height",this)},set:function(t){(0,u.default)((0,d.default)(i.prototype),"height",t,this,!0),this._oldH=t}}]),i}(f.Box);e.ScaleBox=p,_.ILaya.regClass(p),v.ClassUtils.regClass("laya.ui.ScaleBox",p),v.ClassUtils.regClass("Laya.ScaleBox",p)},72978:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ScrollBar=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(93615),_=i(33879),v=i(36895),y=i(14529),p=i(90335),g=i(89662),m=i(85399),x=i(85096),T=i(45840),k=i(41107),C=i(84221),S=i(92493),E=i(23835);function M(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var L=function(t){(0,h.default)(i,t);var e=M(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,i),(t=e.call(this)).rollRatio=.97,t.scaleBar=!0,t.autoHide=!1,t.elasticDistance=0,t.elasticBackTime=500,t._showButtons=y.UIConfig.showButtons,t._scrollSize=1,t._thumbPercent=1,t._lastOffset=0,t._checkElastic=!1,t._isElastic=!1,t._hide=!1,t._clickOnly=!0,t._touchScrollEnable=y.UIConfig.touchScrollEnable,t._mouseWheelEnable=y.UIConfig.mouseWheelEnable,t.skin=n,t.max=1,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopScroll(),this.target=null,(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this.upButton&&this.upButton.destroy(t),this.downButton&&this.downButton.destroy(t),this.slider&&this.slider.destroy(t),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null}},{key:"createChildren",value:function(){this.addChild(this.slider=new v.Slider),this.addChild(this.upButton=new _.Button),this.addChild(this.downButton=new _.Button)}},{key:"initialize",value:function(){this.slider.showLabel=!1,this.slider.tick=0,this.slider.on(g.Event.CHANGE,this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on(g.Event.MOUSE_DOWN,this,this.onButtonMouseDown),this.downButton.on(g.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"onSliderChange",value:function(){this._value!=this.slider.value&&(this.value=this.slider.value)}},{key:"onButtonMouseDown",value:function(t){var e=t.currentTarget===this.upButton;this.slide(e),S.ILaya.timer.once(p.Styles.scrollBarDelayTime,this,this.startLoop,[e]),S.ILaya.stage.once(g.Event.MOUSE_UP,this,this.onStageMouseUp)}},{key:"startLoop",value:function(t){S.ILaya.timer.frameLoop(1,this,this.slide,[t])}},{key:"slide",value:function(t){t?this.value-=this._scrollSize:this.value+=this._scrollSize}},{key:"onStageMouseUp",value:function(t){S.ILaya.timer.clear(this,this.startLoop),S.ILaya.timer.clear(this,this.slide)}},{key:"skin",get:function(){return this._skin},set:function(t){" "!=t&&this._skin!=t&&(this._skin=t,this._skin&&!x.Loader.getRes(this._skin)?S.ILaya.loader.load([this._skin,this._skin.replace(".png","$up.png"),this._skin.replace(".png","$down.png"),this._skin.replace(".png","$bar.png")],k.Handler.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.destroyed||(this.slider.skin=this._skin,this.callLater(this.changeScrollBar),this._sizeChanged(),this.event(g.Event.LOADED))}},{key:"changeScrollBar",value:function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()}},{key:"_sizeChanged",value:function(){(0,u.default)((0,d.default)(i.prototype),"_sizeChanged",this).call(this),this.repaint(),this.resetPositions(),this.event(g.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this.value)}},{key:"resetPositions",value:function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()}},{key:"resetButtonPosition",value:function(){this.slider.isVertical?this.downButton.y=this.slider._y+this.slider.height:this.downButton.x=this.slider._x+this.slider.width}},{key:"measureWidth",value:function(){return this.slider.isVertical?this.slider.width:100}},{key:"measureHeight",value:function(){return this.slider.isVertical?100:this.slider.height}},{key:"setScroll",value:function(t,e,i){this.runCallLater(this._sizeChanged),this.slider.setSlider(t,e,i),this.slider.bar.visible=e>0,!this._hide&&this.autoHide&&(this.visible=!1)}},{key:"max",get:function(){return this.slider.max},set:function(t){this.slider.max=t}},{key:"min",get:function(){return this.slider.min},set:function(t){this.slider.min=t}},{key:"value",get:function(){return this._value},set:function(t){t!==this._value&&(this._value=t,this._isElastic||(this.slider._value!=t&&(this.slider._value=t,this.slider.changeValue()),this._value=this.slider._value),this.event(g.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this._value))}},{key:"isVertical",get:function(){return this.slider.isVertical},set:function(t){this.slider.isVertical=t}},{key:"sizeGrid",get:function(){return this.slider.sizeGrid},set:function(t){this.slider.sizeGrid=t}},{key:"scrollSize",get:function(){return this._scrollSize},set:function(t){this._scrollSize=t}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):(0,l.default)((0,d.default)(i.prototype),"dataSource",t,this,!0)}},{key:"thumbPercent",get:function(){return this._thumbPercent},set:function(t){this.runCallLater(this.changeScrollBar),this.runCallLater(this._sizeChanged),t=t>=1?.99:t,this._thumbPercent=t,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*t,p.Styles.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*t,p.Styles.scrollBarMinNum))}},{key:"target",get:function(){return this._target},set:function(t){this._target&&(this._target.off(g.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._target.off(g.Event.MOUSE_DOWN,this,this.onTargetMouseDown)),this._target=t,t&&(this._mouseWheelEnable&&this._target.on(g.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on(g.Event.MOUSE_DOWN,this,this.onTargetMouseDown))}},{key:"hide",get:function(){return this._hide},set:function(t){this._hide=t,this.visible=!t}},{key:"showButtons",get:function(){return this._showButtons},set:function(t){this._showButtons=t,this.callLater(this.changeScrollBar)}},{key:"touchScrollEnable",get:function(){return this._touchScrollEnable},set:function(t){this._touchScrollEnable=t,this.target=this._target}},{key:"mouseWheelEnable",get:function(){return this._mouseWheelEnable},set:function(t){this._mouseWheelEnable=t,this.target=this._target}},{key:"onTargetMouseWheel",value:function(t){this.value-=t.delta*this._scrollSize,this.target=this._target}},{key:"onTargetMouseDown",value:function(t){this.isLockedFun&&!this.isLockedFun(t)||(this.event(g.Event.END),this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new m.Point),this._lastPoint.setTo(S.ILaya.stage.mouseX,S.ILaya.stage.mouseY),S.ILaya.timer.clear(this,this.tweenMove),C.Tween.clearTween(this),S.ILaya.stage.once(g.Event.MOUSE_UP,this,this.onStageMouseUp2),S.ILaya.stage.once(g.Event.MOUSE_OUT,this,this.onStageMouseUp2),S.ILaya.timer.frameLoop(1,this,this.loop))}},{key:"startDragForce",value:function(){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new m.Point),this._lastPoint.setTo(S.ILaya.stage.mouseX,S.ILaya.stage.mouseY),S.ILaya.timer.clear(this,this.tweenMove),C.Tween.clearTween(this),S.ILaya.stage.once(g.Event.MOUSE_UP,this,this.onStageMouseUp2),S.ILaya.stage.once(g.Event.MOUSE_OUT,this,this.onStageMouseUp2),S.ILaya.timer.frameLoop(1,this,this.loop)}},{key:"cancelDragOp",value:function(){S.ILaya.stage.off(g.Event.MOUSE_UP,this,this.onStageMouseUp2),S.ILaya.stage.off(g.Event.MOUSE_OUT,this,this.onStageMouseUp2),S.ILaya.timer.clear(this,this.tweenMove),S.ILaya.timer.clear(this,this.loop),this._target.mouseEnabled=!0}},{key:"checkTriggers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.value>=0&&this.value-this._lastOffset<=0&&this.triggerDownDragLimit&&this.triggerDownDragLimit(t)?(this.cancelDragOp(),this.value=0,!0):!!(this.value<=this.max&&this.value-this._lastOffset>=this.max&&this.triggerUpDragLimit&&this.triggerUpDragLimit(t))&&(this.cancelDragOp(),this.value=this.max,!0)}},{key:"lastOffset",get:function(){return this._lastOffset}},{key:"startTweenMoveForce",value:function(t){this._lastOffset=t,S.ILaya.timer.frameLoop(1,this,this.tweenMove,[200])}},{key:"loop",value:function(){var t=S.ILaya.stage.mouseY,e=S.ILaya.stage.mouseX;if(this._lastOffset=this.isVertical?t-this._lastPoint.y:e-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?S.ILaya.stage._canvasTransform.getScaleY():S.ILaya.stage._canvasTransform.getScaleX()))>1))return;if(this._clickOnly=!1,this.checkTriggers())return;this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event(g.Event.START)}else if(this.checkTriggers())return;this._offsets.push(this._lastOffset),this._lastPoint.x=e,this._lastPoint.y=t,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this._lastOffset>0?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value>=this.min&&(this._checkElastic=!1)):this._value>=this.max&&(this._lastOffset<0?this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value<=this.max&&(this._checkElastic=!1))):this.value-=this._lastOffset)}},{key:"onStageMouseUp2",value:function(t){if(S.ILaya.stage.off(g.Event.MOUSE_UP,this,this.onStageMouseUp2),S.ILaya.stage.off(g.Event.MOUSE_OUT,this,this.onStageMouseUp2),S.ILaya.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?C.Tween.to(this,{value:this.min},this.elasticBackTime,T.Ease.sineOut,k.Handler.create(this,this.elasticOver)):this._value>this.max&&C.Tween.to(this,{value:this.max},this.elasticBackTime,T.Ease.sineOut,k.Handler.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?S.ILaya.stage.mouseY-this._lastPoint.y:S.ILaya.stage.mouseX-this._lastPoint.x);for(var e=0,i=Math.min(this._offsets.length,3),n=0;n<i;n++)e+=this._offsets[this._offsets.length-1-n];if(this._lastOffset=e/i,(e=Math.abs(this._lastOffset))<2)return void this.event(g.Event.END);e>250&&(this._lastOffset=this._lastOffset>0?250:-250);var a=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/150)));S.ILaya.timer.frameLoop(1,this,this.tweenMove,[a])}}},{key:"elasticOver",value:function(){this._isElastic=!1,!this.hide&&this.autoHide&&C.Tween.to(this,{alpha:0},500),this.event(g.Event.END)}},{key:"tweenMove",value:function(t){var e;if((this._lastOffset*=this.rollRatio,!this.checkTriggers(!0))&&(t>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,e=.5*-(this.min-t-this.value),this._lastOffset>e&&(this._lastOffset=e)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,e=.5*-(this.max+t-this.value),this._lastOffset<e&&(this._lastOffset=e))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<.1)){if(S.ILaya.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?C.Tween.to(this,{value:this.min},this.elasticBackTime,T.Ease.sineOut,k.Handler.create(this,this.elasticOver)):this._value>this.max?C.Tween.to(this,{value:this.max},this.elasticBackTime,T.Ease.sineOut,k.Handler.create(this,this.elasticOver)):this.elasticOver());this.event(g.Event.END),!this.hide&&this.autoHide&&C.Tween.to(this,{alpha:0},500)}}},{key:"stopScroll",value:function(){this.onStageMouseUp2(null),S.ILaya.timer.clear(this,this.tweenMove),C.Tween.clearTween(this)}},{key:"tick",get:function(){return this.slider.tick},set:function(t){this.slider.tick=t}}]),i}(f.UIComponent);e.ScrollBar=L,S.ILaya.regClass(L),E.ClassUtils.regClass("laya.ui.ScrollBar",L),E.ClassUtils.regClass("Laya.ScrollBar",L)},36895:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Slider=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(93615),_=i(96530),v=i(44476),y=i(33879),p=i(89662),g=i(85399),m=i(85096),x=i(41107),T=i(92493),k=i(23835);function C(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var S=function(t){(0,h.default)(i,t);var e=C(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,i),(t=e.call(this)).isVertical=!0,t.showLabel=!0,t._max=100,t._min=0,t._tick=1,t._value=0,i.label||(i.label=new _.Label),t.skin=n,t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._progress&&this._progress.destroy(t),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new v.Image),this.addChild(this._bar=new y.Button)}},{key:"initialize",value:function(){this._bar.on(p.Event.MOUSE_DOWN,this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0}},{key:"onBarMouseDown",value:function(t){var e=T.ILaya;this._globalSacle||(this._globalSacle=new g.Point),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=e.stage.mouseX,this._ty=e.stage.mouseY,e.stage.on(p.Event.MOUSE_MOVE,this,this.mouseMove),e.stage.once(p.Event.MOUSE_UP,this,this.mouseUp),e.stage.once(p.Event.MOUSE_OUT,this,this.mouseUp),this.showValueText()}},{key:"showValueText",value:function(){if(this.showLabel){var t=i.label;this.addChild(t),t.textField.changeText(this._value+""),this.isVertical?(t.x=this._bar._x+20,t.y=.5*(this._bar.height-t.height)+this._bar._y):(t.y=this._bar._y-20,t.x=.5*(this._bar.width-t.width)+this._bar._x)}}},{key:"hideValueText",value:function(){i.label&&i.label.removeSelf()}},{key:"mouseUp",value:function(t){var e=T.ILaya.stage;e.off(p.Event.MOUSE_MOVE,this,this.mouseMove),e.off(p.Event.MOUSE_UP,this,this.mouseUp),e.off(p.Event.MOUSE_OUT,this,this.mouseUp),this.sendChangeEvent(p.Event.CHANGED),this.hideValueText()}},{key:"mouseMove",value:function(t){var e=T.ILaya.stage,i=this._value;if(this.isVertical?(this._bar.y+=(e.mouseY-this._ty)/this._globalSacle.y,this._bar._y>this._maxMove?this._bar.y=this._maxMove:this._bar._y<0&&(this._bar.y=0),this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x+=(e.mouseX-this._tx)/this._globalSacle.x,this._bar._x>this._maxMove?this._bar.x=this._maxMove:this._bar._x<0&&(this._bar.x=0),this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width)),this._tx=e.mouseX,this._ty=e.mouseY,0!=this._tick){var n=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*n)/n}this._value!=i&&this.sendChangeEvent(),this.showValueText()}},{key:"sendChangeEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.Event.CHANGE;this.event(t),this.changeHandler&&this.changeHandler.runWith(this._value)}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!m.Loader.getRes(this._skin)?T.ILaya.loader.load([this._skin,this._skin.replace(".png","$bar.png")],x.Handler.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var t=this._skin.replace(".png","$progress.png");m.Loader.getRes(t)&&(this._progress||(this.addChild(this._progress=new v.Image),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=t),this.setBarPoint(),this.callLater(this.changeValue),this._sizeChanged(),this.event(p.Event.LOADED)}},{key:"setBarPoint",value:function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))}},{key:"measureWidth",value:function(){return Math.max(this._bg.width,this._bar.width)}},{key:"measureHeight",value:function(){return Math.max(this._bg.height,this._bar.height)}},{key:"_sizeChanged",value:function(){(0,u.default)((0,d.default)(i.prototype),"_sizeChanged",this).call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(t){this._bg.sizeGrid=t,this._bar.sizeGrid=t,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}},{key:"setSlider",value:function(t,e,i){this._value=-1,this._min=t,this._max=e>t?e:t,this.value=i<t?t:i>e?e:i}},{key:"tick",get:function(){return this._tick},set:function(t){this._tick!=t&&(this._tick=t,this.callLater(this.changeValue))}},{key:"changeValue",value:function(){if(0!=this.tick){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t}this._max>=this._max?this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value:this._value=this._value>this._min?this._min:this._value<this._max?this._max:this._value;var e=this._max-this._min;0===e&&(e=1),this.isVertical?(this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width))}},{key:"max",get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.callLater(this.changeValue))}},{key:"min",get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.callLater(this.changeValue))}},{key:"value",get:function(){return this._value},set:function(t){if(this._value!=t){var e=this._value;this._value=t,this.changeValue(),this._value!=e&&this.sendChangeEvent()}}},{key:"allowClickBack",get:function(){return this._allowClickBack},set:function(t){this._allowClickBack!=t&&(this._allowClickBack=t,t?this._bg.on(p.Event.MOUSE_DOWN,this,this.onBgMouseDown):this._bg.off(p.Event.MOUSE_DOWN,this,this.onBgMouseDown))}},{key:"onBgMouseDown",value:function(t){var e=this._bg.getMousePoint();this.isVertical?this.value=e.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=e.x/(this.width-this._bar.width)*(this._max-this._min)+this._min}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):(0,l.default)((0,d.default)(i.prototype),"dataSource",t,this,!0)}},{key:"bar",get:function(){return this._bar}}]),i}(f.UIComponent);e.Slider=S,S.label=null,T.ILaya.regClass(S),k.ClassUtils.regClass("laya.ui.Slider",S),k.ClassUtils.regClass("Laya.Slider",S)},90335:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Styles=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.Styles=s,s.defaultSizeGrid=[4,4,4,4,0],s.labelColor="#000000",s.labelPadding=[2,2,2,2],s.inputLabelPadding=[1,1,1,3],s.buttonStateNum=3,s.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"],s.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"],s.scrollBarMinNum=15,s.scrollBarDelayTime=500},51931:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Tab=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(33879),d=i(9570),f=i(92493),_=i(23835);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var y=function(t){(0,l.default)(i,t);var e=v(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i,[{key:"createItem",value:function(t,e){return new c.Button(t,e)}}]),i}(d.UIGroup);e.Tab=y,f.ILaya.regClass(y),_.ClassUtils.regClass("laya.ui.Tab",y),_.ClassUtils.regClass("Laya.Tab",y)},52357:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.TextArea=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(89395)),u=r(i(49409)),h=r(i(45408)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(89658),v=i(37277),y=i(8255),p=i(90335),g=i(89662),m=i(92493),x=i(23835);function T(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var k=function(t){(0,c.default)(i,t);var e=T(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.default)(this,i),(t=e.call(this,n)).on(g.Event.CHANGE,(0,l.default)(t),t._onTextChange),t}return(0,o.default)(i,[{key:"_onTextChange",value:function(){this.callLater(this.changeScroll)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null,(0,h.default)((0,f.default)(i.prototype),"destroy",this).call(this,t)}},{key:"initialize",value:function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0}},{key:"width",get:function(){return(0,h.default)((0,f.default)(i.prototype),"width",this)},set:function(t){(0,u.default)((0,f.default)(i.prototype),"width",t,this,!0),this.callLater(this.changeScroll)}},{key:"height",get:function(){return(0,h.default)((0,f.default)(i.prototype),"height",this)},set:function(t){(0,u.default)((0,f.default)(i.prototype),"height",t,this,!0),this.callLater(this.changeScroll)}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(t){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new v.VScrollBar),this._vScrollBar.on(g.Event.CHANGE,this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=t}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(t){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new y.HScrollBar),this._hScrollBar.on(g.Event.CHANGE,this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=t}},{key:"onVBarChanged",value:function(t){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)}},{key:"onHBarChanged",value:function(t){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"maxScrollY",get:function(){return this._tf.maxScrollY}},{key:"scrollY",get:function(){return this._tf.scrollY}},{key:"maxScrollX",get:function(){return this._tf.maxScrollX}},{key:"scrollX",get:function(){return this._tf.scrollX}},{key:"changeScroll",value:function(){var t=this._vScrollBar&&this._tf.maxScrollY>0,e=this._hScrollBar&&this._tf.maxScrollX>0,i=t?this._width-this._vScrollBar.width:this._width,n=e?this._height-this._hScrollBar.height:this._height,a=this._tf.padding||p.Styles.labelPadding;this._tf.width=i,this._tf.height=n,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-a[2],this._vScrollBar.y=a[1],this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-a[1]-a[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=n/Math.max(this._tf.textHeight,n),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=t),this._hScrollBar&&(this._hScrollBar.x=a[0],this._hScrollBar.y=this._height-this._hScrollBar.height-a[3],this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-a[0]-a[2],this._hScrollBar.scrollSize=Math.max(.033*i,1),this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=e)}},{key:"scrollTo",value:function(t){this.commitMeasure(),this._tf.scrollY=t}}]),i}(_.TextInput);e.TextArea=k,m.ILaya.regClass(k),x.ClassUtils.regClass("laya.ui.TextArea",k),x.ClassUtils.regClass("Laya.TextArea",k)},89658:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.TextInput=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(49409)),u=r(i(45408)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(96530),_=i(61891),v=i(89662),y=i(85096),p=i(21995),g=i(90335),m=i(6642),x=i(41107),T=i(92493),k=i(23835);function C(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var S=function(t){(0,h.default)(i,t);var e=C(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.default)(this,i),(t=e.call(this)).text=n,t.skin=t.skin,t}return(0,o.default)(i,[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(i.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(),this._bg=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new _.Input),this._tf.padding=g.Styles.inputLabelPadding,this._tf.on(v.Event.INPUT,this,this._onInput),this._tf.on(v.Event.ENTER,this,this._onEnter),this._tf.on(v.Event.BLUR,this,this._onBlur),this._tf.on(v.Event.FOCUS,this,this._onFocus)}},{key:"_onFocus",value:function(){this.event(v.Event.FOCUS,this)}},{key:"_onBlur",value:function(){this.event(v.Event.BLUR,this)}},{key:"_onInput",value:function(){this.event(v.Event.INPUT,this)}},{key:"_onEnter",value:function(){this.event(v.Event.ENTER,this)}},{key:"initialize",value:function(){this.width=128,this.height=22}},{key:"bg",get:function(){return this._bg},set:function(t){this.graphics=this._bg=t}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!y.Loader.getRes(this._skin)?T.ILaya.loader.load(this._skin,x.Handler.create(this,this._skinLoaded),null,y.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg||(this.graphics=this._bg=new p.AutoBitmap),this._bg.source=y.Loader.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height),this._sizeChanged(),this.event(v.Event.LOADED)}},{key:"sizeGrid",get:function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},set:function(t){this._bg||(this.graphics=this._bg=new p.AutoBitmap),this._bg.sizeGrid=m.UIUtils.fillArray(g.Styles.defaultSizeGrid,t,Number)}},{key:"text",get:function(){return(0,u.default)((0,d.default)(i.prototype),"text",this)},set:function(t){this._tf.text!=t&&(t+="",this._tf.text=t,this.event(v.Event.CHANGE))}},{key:"width",get:function(){return(0,u.default)((0,d.default)(i.prototype),"width",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"width",t,this,!0),this._bg&&(this._bg.width=t)}},{key:"height",get:function(){return(0,u.default)((0,d.default)(i.prototype),"height",this)},set:function(t){(0,l.default)((0,d.default)(i.prototype),"height",t,this,!0),this._bg&&(this._bg.height=t)}},{key:"multiline",get:function(){return this._tf.multiline},set:function(t){this._tf.multiline=t}},{key:"editable",get:function(){return this._tf.editable},set:function(t){this._tf.editable=t}},{key:"select",value:function(){this._tf.select()}},{key:"restrict",get:function(){return this._tf.restrict},set:function(t){this._tf.restrict=t}},{key:"prompt",get:function(){return this._tf.prompt},set:function(t){this._tf.prompt=t}},{key:"promptColor",get:function(){return this._tf.promptColor},set:function(t){this._tf.promptColor=t}},{key:"maxChars",get:function(){return this._tf.maxChars},set:function(t){this._tf.maxChars=t}},{key:"focus",get:function(){return this._tf.focus},set:function(t){this._tf.focus=t}},{key:"type",get:function(){return this._tf.type},set:function(t){this._tf.type=t}},{key:"setSelection",value:function(t,e){this._tf.setSelection(t,e)}}]),i}(f.Label);e.TextInput=S,T.ILaya.regClass(S),k.ClassUtils.regClass("laya.ui.TextInput",S),k.ClassUtils.regClass("Laya.TextInput",S)},61241:function(t,e,i){"use strict";var n=i(1068),a=i(3649),r=i(66419),s=i(65420),o=i(19996),l=i(41511),u=i(63978),h=i(8171);u(e,"__esModule",{value:!0}),e.Tree=void 0;var c=h(i(81643)),d=h(i(15375)),f=h(i(17061)),_=h(i(49409)),v=h(i(45408)),y=h(i(97709)),p=h(i(38191)),g=h(i(52305)),m=i(93408),x=i(75485),T=i(89662),k=i(41107),C=i(92493),S=i(23835);function E(t,e){var i=void 0!==s&&o(t)||t["@@iterator"];if(!i){if(l(t)||(i=function(t,e){var i;if(!t)return;if("string"==typeof t)return M(t,e);var n=a(i=Object.prototype.toString.call(t)).call(i,8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return r(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,u=function(){};return{s:u,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h,c=!0,d=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return c=t.done,t},e:function(t){d=!0,h=t},f:function(){try{c||null==i.return||i.return()}finally{if(d)throw h}}}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function L(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,g.default)(t);if(e){var r=(0,g.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,p.default)(this,i)}}var b=function(t){(0,y.default)(i,t);var e=L(i);function i(){var t;return(0,d.default)(this,i),(t=e.call(this))._spaceLeft=10,t._spaceBottom=0,t._keepStatus=!0,t.width=t.height=200,t}return(0,f.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,v.default)((0,g.default)(i.prototype),"destroy",this).call(this,t),this._list&&this._list.destroy(t),this._list=null,this._source=null,this._renderHandler=null}},{key:"createChildren",value:function(){this.addChild(this._list=new x.List),this._list.renderHandler=k.Handler.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on(T.Event.CHANGE,this,this.onListChange)}},{key:"onListChange",value:function(){this.event(T.Event.CHANGE)}},{key:"keepStatus",get:function(){return this._keepStatus},set:function(t){this._keepStatus=t}},{key:"array",get:function(){return this._list.array},set:function(t){this._keepStatus&&this._list.array&&t&&this.parseOpenStatus(this._list.array,t),this._source=t,this._list.array=this.getArray()}},{key:"source",get:function(){return this._source}},{key:"list",get:function(){return this._list}},{key:"itemRender",get:function(){return this._list.itemRender},set:function(t){this._list.itemRender=t}},{key:"scrollBarSkin",get:function(){return this._list.vScrollBarSkin},set:function(t){this._list.vScrollBarSkin=t}},{key:"scrollBar",get:function(){return this._list.scrollBar}},{key:"mouseHandler",get:function(){return this._list.mouseHandler},set:function(t){this._list.mouseHandler=t}},{key:"renderHandler",get:function(){return this._renderHandler},set:function(t){this._renderHandler=t}},{key:"spaceLeft",get:function(){return this._spaceLeft},set:function(t){this._spaceLeft=t}},{key:"spaceBottom",get:function(){return this._list.spaceY},set:function(t){this._list.spaceY=t}},{key:"selectedIndex",get:function(){return this._list.selectedIndex},set:function(t){this._list.selectedIndex=t}},{key:"selectedItem",get:function(){return this._list.selectedItem},set:function(t){this._list.selectedItem=t}},{key:"width",get:function(){return(0,v.default)((0,g.default)(i.prototype),"width",this)},set:function(t){(0,_.default)((0,g.default)(i.prototype),"width",t,this,!0),this._list.width=t}},{key:"height",get:function(){return(0,v.default)((0,g.default)(i.prototype),"height",this)},set:function(t){(0,_.default)((0,g.default)(i.prototype),"height",t,this,!0),this._list.height=t}},{key:"getArray",value:function(){var t=[];for(var e in this._source){var i=this._source[e];this.getParentOpenStatus(i)&&(i.x=this._spaceLeft*this.getDepth(i),t.push(i))}return t}},{key:"getDepth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==t.nodeParent?e:this.getDepth(t.nodeParent,e+1)}},{key:"getParentOpenStatus",value:function(t){var e=t.nodeParent;return null==e||!!e.isOpen&&(null==e.nodeParent||this.getParentOpenStatus(e))}},{key:"renderItem",value:function(t,e){var i=t.dataSource;if(i){t.left=i.x;var n=t.getChildByName("arrow");n&&(i.hasChild?(n.visible=!0,n.index=i.isOpen?1:0,n.tag=e,n.off(T.Event.CLICK,this,this.onArrowClick),n.on(T.Event.CLICK,this,this.onArrowClick)):n.visible=!1);var a=t.getChildByName("folder");a&&(2==a.clipY?a.index=i.isDirectory?0:1:a.index=i.isDirectory?i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([t,e])}}},{key:"onArrowClick",value:function(t){var e=t.currentTarget.tag;this._list.array[e].isOpen=!this._list.array[e].isOpen,this.event(T.Event.OPEN),this._list.array=this.getArray()}},{key:"setItemState",value:function(t,e){this._list.array[t]&&(this._list.array[t].isOpen=e,this._list.array=this.getArray())}},{key:"fresh",value:function(){this._list.array=this.getArray(),this.repaint()}},{key:"dataSource",get:function(){return(0,v.default)((0,g.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,(0,_.default)((0,g.default)(i.prototype),"dataSource",t,this,!0)}},{key:"xml",set:function(t){var e=[];this.parseXml(t.childNodes[0],e,null,!0),this.array=e}},{key:"parseXml",value:function(t,e,i,n){var a,r=t.childNodes,s=r.length;if(!n){a={};var o=t.attributes;for(var l in o){var u=o[l],h=u.nodeName,c=u.nodeValue;a[h]="true"==c||"false"!=c&&c}a.nodeParent=i,s>0&&(a.isDirectory=!0),a.hasChild=s>0,e.push(a)}for(var d=0;d<s;d++){var f=r[d];this.parseXml(f,e,a,!1)}}},{key:"parseOpenStatus",value:function(t,e){for(var i=0,n=e.length;i<n;i++){var a=e[i];if(a.isDirectory)for(var r=0,s=t.length;r<s;r++){var o=t[r];if(o.isDirectory&&this.isSameParent(o,a)&&a.label==o.label){a.isOpen=o.isOpen;break}}}}},{key:"isSameParent",value:function(t,e){return null==t.nodeParent&&null==e.nodeParent||null!=t.nodeParent&&null!=e.nodeParent&&(t.nodeParent.label==e.nodeParent.label&&this.isSameParent(t.nodeParent,e.nodeParent))}},{key:"selectedPath",get:function(){return this._list.selectedItem?this._list.selectedItem.path:null}},{key:"filter",value:function(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t),this._list.array=e}else this._list.array=this.getArray()}},{key:"getFilterSource",value:function(t,e,i){i=i.toLocaleLowerCase();var n,a=E(t);try{for(a.s();!(n=a.n()).done;){var r,s=n.value;!s.isDirectory&&(0,c.default)(r=String(s.label).toLowerCase()).call(r,i)>-1&&(s.x=0,e.push(s)),s.child&&s.child.length>0&&this.getFilterSource(s.child,e,i)}}catch(t){a.e(t)}finally{a.f()}}}]),i}(m.Box);e.Tree=b,C.ILaya.regClass(b),S.ClassUtils.regClass("laya.ui.Tree",b),S.ClassUtils.regClass("Laya.Tree",b)},93615:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.UIComponent=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(72601),f=i(60082),_=i(6642),v=i(78362),y=i(89662),p=i(92493),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var x=function(t){(0,u.default)(i,t);var e=m(i);function i(){var t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,s.default)(this,i),(t=e.call(this))._anchorX=NaN,t._anchorY=NaN,t._widget=d.Widget.EMPTY,n&&(t.preinitialize(),t.createChildren(),t.initialize()),t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,l.default)((0,c.default)(i.prototype),"destroy",this).call(this,t),this._dataSource=null,this._tag=null,this._toolTip=null}},{key:"preinitialize",value:function(){}},{key:"createChildren",value:function(){}},{key:"initialize",value:function(){}},{key:"width",get:function(){return this.get_width()},set:function(t){this.set_width(t)}},{key:"get_width",value:function(){return this._width?this._width:this.measureWidth()}},{key:"measureWidth",value:function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t}},{key:"commitMeasure",value:function(){}},{key:"height",get:function(){return this.get_height()},set:function(t){this.set_height(t)}},{key:"get_height",value:function(){return this._height?this._height:this.measureHeight()}},{key:"measureHeight",value:function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t}},{key:"dataSource",get:function(){return this.get_dataSource()},set:function(t){this.set_dataSource(t)}},{key:"get_dataSource",value:function(){return this._dataSource}},{key:"set_dataSource",value:function(t){for(var e in this._dataSource=t,this._dataSource)e in this&&"function"!=typeof this[e]&&(this[e]=this._dataSource[e])}},{key:"top",get:function(){return this.get_top()},set:function(t){this.set_top(t)}},{key:"get_top",value:function(){return this._widget.top}},{key:"set_top",value:function(t){t!=this._widget.top&&(this._getWidget().top=t)}},{key:"bottom",get:function(){return this.get_bottom()},set:function(t){this.set_bottom(t)}},{key:"get_bottom",value:function(){return this._widget.bottom}},{key:"set_bottom",value:function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}},{key:"left",get:function(){return this._widget.left},set:function(t){t!=this._widget.left&&(this._getWidget().left=t)}},{key:"right",get:function(){return this._widget.right},set:function(t){t!=this._widget.right&&(this._getWidget().right=t)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(y.Event.RESIZE),this._widget!==d.Widget.EMPTY&&this._widget.resetLayout()}},{key:"tag",get:function(){return this._tag},set:function(t){this._tag=t}},{key:"toolTip",get:function(){return this._toolTip},set:function(t){this._toolTip!=t&&(this._toolTip=t,null!=t?(this.on(y.Event.MOUSE_OVER,this,this.onMouseOver),this.on(y.Event.MOUSE_OUT,this,this.onMouseOut)):(this.off(y.Event.MOUSE_OVER,this,this.onMouseOver),this.off(y.Event.MOUSE_OUT,this,this.onMouseOut)))}},{key:"onMouseOver",value:function(t){p.ILaya.stage.event(f.UIEvent.SHOW_TIP,this._toolTip)}},{key:"onMouseOut",value:function(t){p.ILaya.stage.event(f.UIEvent.HIDE_TIP,this._toolTip)}},{key:"gray",get:function(){return this._gray},set:function(t){t!==this._gray&&(this._gray=t,_.UIUtils.gray(this,t))}},{key:"disabled",get:function(){return this._disabled},set:function(t){t!==this._disabled&&(this.gray=this._disabled=t,this.mouseEnabled=!t)}},{key:"_getWidget",value:function(){return this._widget===d.Widget.EMPTY&&(this._widget=this.addComponent(d.Widget)),this._widget}},{key:"scaleX",get:function(){return(0,l.default)((0,c.default)(i.prototype),"scaleX",this)},set:function(t){this.set_scaleX(t)}},{key:"set_scaleX",value:function(t){(0,l.default)((0,c.default)(i.prototype),"get_scaleX",this).call(this)!=t&&((0,l.default)((0,c.default)(i.prototype),"set_scaleX",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"scaleY",get:function(){return(0,l.default)((0,c.default)(i.prototype),"scaleY",this)},set:function(t){this.set_scaleY(t)}},{key:"set_scaleY",value:function(t){(0,l.default)((0,c.default)(i.prototype),"get_scaleY",this).call(this)!=t&&((0,l.default)((0,c.default)(i.prototype),"set_scaleY",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"onCompResize",value:function(){this._sizeChanged()}},{key:"set_width",value:function(t){(0,l.default)((0,c.default)(i.prototype),"get_width",this).call(this)!=t&&((0,l.default)((0,c.default)(i.prototype),"set_width",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"set_height",value:function(t){(0,l.default)((0,c.default)(i.prototype),"get_height",this).call(this)!=t&&((0,l.default)((0,c.default)(i.prototype),"set_height",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"anchorX",get:function(){return this.get_anchorX()},set:function(t){this.set_anchorX(t)}},{key:"get_anchorX",value:function(){return this._anchorX}},{key:"set_anchorX",value:function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this.get_anchorY()},set:function(t){this.set_anchorY(t)}},{key:"get_anchorY",value:function(){return this._anchorY}},{key:"set_anchorY",value:function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}},{key:"_childChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.callLater(this._sizeChanged),(0,l.default)((0,c.default)(i.prototype),"_childChanged",this).call(this,t)}}]),i}(v.Sprite);e.UIComponent=x,p.ILaya.regClass(x),g.ClassUtils.regClass("laya.ui.UIComponent",x),g.ClassUtils.regClass("Laya.UIComponent",x)},60082:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.UIEvent=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(89662),c=i(92493),d=i(23835);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var _=function(t){(0,o.default)(i,t);var e=f(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return i}(h.Event);e.UIEvent=_,_.SHOW_TIP="showtip",_.HIDE_TIP="hidetip",c.ILaya.regClass(_),d.ClassUtils.regClass("laya.ui.UIEvent",_),d.ClassUtils.regClass("Laya.UIEvent",_)},9570:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.UIGroup=void 0;var s=r(i(81643)),o=r(i(94198)),l=r(i(15375)),u=r(i(17061)),h=r(i(49409)),c=r(i(45408)),d=r(i(97709)),f=r(i(38191)),_=r(i(52305)),v=i(93408),y=i(89662),p=i(85096),g=i(41107),m=i(92493),x=i(23835);function T(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,_.default)(t);if(e){var r=(0,_.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,f.default)(this,i)}}var k=function(t){(0,d.default)(i,t);var e=T(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,l.default)(this,i),(t=e.call(this))._selectedIndex=-1,t._direction="horizontal",t._space=0,t.skin=a,t.labels=n,t}return(0,u.default)(i,[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,c.default)((0,_.default)(i.prototype),"destroy",this).call(this,t),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null}},{key:"addItem",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t,n=this._items.length;if(i.name="item"+n,this.addChild(i),this.initItems(),e&&n>0){var a=this._items[n-1];"horizontal"==this._direction?i.x=a._x+a.width+this._space:i.y=a._y+a.height+this._space}else e&&(i.x=0,i.y=0);return n}},{key:"delItem",value:function(t){var e,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,s.default)(e=this._items).call(e,t);if(-1!=n){var a,r=t;this.removeChild(r);for(var o=n+1,l=this._items.length;o<l;o++){var u=this._items[o];u.name="item"+(o-1),i&&("horizontal"==this._direction?u.x-=r.width+this._space:u.y-=r.height+this._space)}if(this.initItems(),this._selectedIndex>-1)a=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=a}}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items||(this._items=[]),this._items.length=0;for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.selected=t===this._selectedIndex,e.clickHandler=g.Handler.create(this,this.itemClick,[t],!1)}}},{key:"itemClick",value:function(t){this.selectedIndex=t}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(t,!0),this.event(y.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}},{key:"setSelect",value:function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].selected=e)}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!p.Loader.getRes(this._skin)?m.ILaya.loader.load(this._skin,g.Handler.create(this,this._skinLoaded),null,p.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._setLabelChanged(),this.event(y.Event.LOADED)}},{key:"labels",get:function(){return this._labels},set:function(t){if(this._labels!=t){if(this._labels=t,this.removeChildren(),this._setLabelChanged(),this._labels)for(var e=this._labels.split(","),i=0,n=e.length;i<n;i++){var a=this.createItem(this._skin,e[i]);a.name="item"+i,this.addChild(a)}this.initItems()}}},{key:"createItem",value:function(t,e){return null}},{key:"labelColors",get:function(){return this._labelColors},set:function(t){this._labelColors!=t&&(this._labelColors=t,this._setLabelChanged())}},{key:"labelStroke",get:function(){return this._labelStroke},set:function(t){this._labelStroke!=t&&(this._labelStroke=t,this._setLabelChanged())}},{key:"labelStrokeColor",get:function(){return this._labelStrokeColor},set:function(t){this._labelStrokeColor!=t&&(this._labelStrokeColor=t,this._setLabelChanged())}},{key:"strokeColors",get:function(){return this._strokeColors},set:function(t){this._strokeColors!=t&&(this._strokeColors=t,this._setLabelChanged())}},{key:"labelSize",get:function(){return this._labelSize},set:function(t){this._labelSize!=t&&(this._labelSize=t,this._setLabelChanged())}},{key:"stateNum",get:function(){return this._stateNum},set:function(t){this._stateNum!=t&&(this._stateNum=t,this._setLabelChanged())}},{key:"labelBold",get:function(){return this._labelBold},set:function(t){this._labelBold!=t&&(this._labelBold=t,this._setLabelChanged())}},{key:"labelFont",get:function(){return this._labelFont},set:function(t){this._labelFont!=t&&(this._labelFont=t,this._setLabelChanged())}},{key:"labelPadding",get:function(){return this._labelPadding},set:function(t){this._labelPadding!=t&&(this._labelPadding=t,this._setLabelChanged())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t,this._setLabelChanged()}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._setLabelChanged()}},{key:"changeLabels",value:function(){if(this._labelChanged=!1,this._items)for(var t=0,e=0,i=this._items.length;e<i;e++){var n=this._items[e];this._skin&&(n.skin=this._skin),this._labelColors&&(n.labelColors=this._labelColors),this._labelSize&&(n.labelSize=this._labelSize),this._labelStroke&&(n.labelStroke=this._labelStroke),this._labelStrokeColor&&(n.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(n.strokeColors=this._strokeColors),this._labelBold&&(n.labelBold=this._labelBold),this._labelPadding&&(n.labelPadding=this._labelPadding),this._labelAlign&&(n.labelAlign=this._labelAlign),this._stateNum&&(n.stateNum=this._stateNum),this._labelFont&&(n.labelFont=this._labelFont),"horizontal"===this._direction?(n.y=0,n.x=t,t+=n.width+this._space):(n.x=0,n.y=t,t+=n.height+this._space)}this._sizeChanged()}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeLabels)}},{key:"items",get:function(){return this._items}},{key:"selection",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,s.default)(e=this._items).call(e,t)}},{key:"dataSource",get:function(){return(0,c.default)((0,_.default)(i.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,o.default)(t):t instanceof Array?this.labels=t.join(","):(0,h.default)((0,_.default)(i.prototype),"dataSource",t,this,!0)}},{key:"_setLabelChanged",value:function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))}}]),i}(v.Box);e.UIGroup=k,m.ILaya.regClass(k),x.ClassUtils.regClass("laya.ui.UIGroup",k),x.ClassUtils.regClass("Laya.UIGroup",k)},6642:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.UIUtils=void 0;var r=a(i(77766)),s=a(i(92762)),o=a(i(15375)),l=a(i(17061)),u=i(20084),h=i(56083),c=i(76006),d=i(23835),f=function(){function t(){(0,o.default)(this,t)}return(0,l.default)(t,null,[{key:"fillArray",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=(0,r.default)(t).call(t);if(e)for(var a=e.split(","),s=0,o=Math.min(n.length,a.length);s<o;s++){var l=a[s];n[s]="true"==l||"false"!=l&&l,null!=i&&(n[s]=i(l))}return n}},{key:"toColor",value:function(t){return h.Utils.toHexColor(t)}},{key:"gray",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i?t.addFilter(e,t.grayFilter):t.clearFilter(e,u.ColorFilter)}},{key:"addFilter",value:function(t,e){var i=t.filters||[];i.push(e),t.filters=i}},{key:"clearFilter",value:function(t,e){var i=t.filters;if(null!=i&&i.length>0){for(var n=i.length-1;n>-1;n--){i[n]instanceof e&&(0,s.default)(i).call(i,n,1)}t.filters=i}}},{key:"_getReplaceStr",value:function(e){return t.escapeSequence[e]}},{key:"adptString",value:function(e){return e.replace(/\\(\w)/g,t._getReplaceStr)}},{key:"getBindFun",value:function(e){t._funMap||(t._funMap=new c.WeakObject);var i=t._funMap.get(e);if(null==i){var n='"'+e+'"',a="(function(data){if(data==null)return;with(data){try{\nreturn "+(n=n.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";i=window.Laya._runScript(a),t._funMap.set(e,i)}return i}}]),t}();e.UIUtils=f,f.grayFilter=new u.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),f.escapeSequence={"\\n":"\n","\\t":"\t"},f._funMap=null,d.ClassUtils.regClass("laya.ui.UIUtils",f),d.ClassUtils.regClass("Laya.UIUtils",f)},42595:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.VBox=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(49409)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(66754),_=i(92493),v=i(23835);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var p=function(t){(0,h.default)(i,t);var e=y(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments)).isSortItem=!1,t}return(0,o.default)(i,[{key:"width",get:function(){return(0,l.default)((0,d.default)(i.prototype),"width",this)},set:function(t){this._width!=t&&((0,u.default)((0,d.default)(i.prototype),"width",t,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var t=[],e=0,n=0,a=this.numChildren;n<a;n++){var r=this.getChildAt(n);r&&(t.push(r),e=this._width?this._width:Math.max(e,r.width*r.scaleX))}this.isSortItem&&this.sortItem(t);var s=0;for(n=0,a=t.length;n<a;n++)(r=t[n]).y=s,s+=r.height*r.scaleY+this._space,this._align==i.LEFT?r.x=0:this._align==i.CENTER?r.x=.5*(e-r.width*r.scaleX):this._align==i.RIGHT&&(r.x=e-r.width*r.scaleX);this._sizeChanged()}}]),i}(f.LayoutBox);e.VBox=p,p.NONE="none",p.LEFT="left",p.CENTER="center",p.RIGHT="right",_.ILaya.regClass(p),v.ClassUtils.regClass("laya.ui.VBox",p),v.ClassUtils.regClass("Laya.VBox",p)},37277:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.VScrollBar=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(72978),c=i(92493),d=i(23835);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var _=function(t){(0,o.default)(i,t);var e=f(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return i}(h.ScrollBar);e.VScrollBar=_,c.ILaya.regClass(_),d.ClassUtils.regClass("laya.ui.VScrollBar",_),d.ClassUtils.regClass("Laya.VScrollBar",_)},70710:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.VSlider=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(36895),c=i(92493),d=i(23835);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var _=function(t){(0,o.default)(i,t);var e=f(i);function i(){return(0,s.default)(this,i),e.apply(this,arguments)}return i}(h.Slider);e.VSlider=_,c.ILaya.regClass(_),d.ClassUtils.regClass("laya.ui.VSlider",_),d.ClassUtils.regClass("Laya.VSlider",_)},79698:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.View=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(72601),f=i(31249),_=i(28294),v=i(81870),y=i(89662),p=i(93408),g=i(33879),m=i(24830),x=i(44476),T=i(96530),k=i(58336),C=i(82201),S=i(50250),E=i(51931),M=i(93615),L=i(57768),b=i(52357),I=i(25435),R=i(2292),w=i(70078),A=i(20079),B=i(8255),D=i(48181),P=i(75485),O=i(29084),F=i(72978),U=i(36895),N=i(89658),G=i(37277),H=i(70710),W=i(61241),V=i(51582),Y=i(42595),X=i(31487),z=i(92493),K=i(23835);function j(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var q=function(t){(0,u.default)(i,t);var e=j(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this,!1))._watchMap={},t._anchorX=NaN,t._anchorY=NaN,t._widget=d.Widget.EMPTY,t.createChildren(),t}return(0,o.default)(i,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._watchMap=null,(0,l.default)((0,c.default)(i.prototype),"destroy",this).call(this,t)}},{key:"changeData",value:function(t){var e=this._watchMap[t];if(e)for(var i=0,n=e.length;i<n;i++){e[i].exe(this)}}},{key:"top",get:function(){return this._widget.top},set:function(t){t!=this._widget.top&&(this._getWidget().top=t)}},{key:"bottom",get:function(){return this._widget.bottom},set:function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}},{key:"left",get:function(){return this._widget.left},set:function(t){t!=this._widget.left&&(this._getWidget().left=t)}},{key:"right",get:function(){return this._widget.right},set:function(t){t!=this._widget.right&&(this._getWidget().right=t)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}},{key:"anchorX",get:function(){return this._anchorX},set:function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this._anchorY},set:function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(y.Event.RESIZE)}},{key:"_getWidget",value:function(){return this._widget===d.Widget.EMPTY&&(this._widget=this.addComponent(d.Widget)),this._widget}},{key:"loadUI",value:function(t){var e=i.uiMap[t];i.uiMap&&this.createView(e)}},{key:"dataSource",get:function(){return this._dataSource},set:function(t){for(var e in this._dataSource=t,t){var i=this.getChildByName(e);i instanceof M.UIComponent?i.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}}],[{key:"__init__",value:function(){z.ILaya.ClassUtils.regShortClassName([L.ViewStack,g.Button,b.TextArea,I.ColorPicker,p.Box,R.ScaleBox,m.CheckBox,w.Clip,A.ComboBox,M.UIComponent,B.HScrollBar,D.HSlider,x.Image,T.Label,P.List,O.Panel,k.ProgressBar,C.Radio,S.RadioGroup,F.ScrollBar,U.Slider,E.Tab,N.TextInput,i,G.VScrollBar,H.VSlider,W.Tree,V.HBox,Y.VBox,f.Animation,v.Text,X.FontClip])}},{key:"regComponent",value:function(t,e){z.ILaya.ClassUtils.regClass(t,e)}},{key:"regViewRuntime",value:function(t,e){z.ILaya.ClassUtils.regClass(t,e)}},{key:"regUI",value:function(t,e){z.ILaya.loader.cacheRes(t,e)}}]),i}(_.Scene);e.View=q,q.uiMap={},z.ILaya.regClass(q),K.ClassUtils.regClass("laya.ui.View",q),K.ClassUtils.regClass("Laya.View",q)},57768:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ViewStack=void 0;var s=r(i(81643)),o=r(i(94198)),l=r(i(15375)),u=r(i(17061)),h=r(i(89395)),c=r(i(45408)),d=r(i(97709)),f=r(i(38191)),_=r(i(52305)),v=i(93408),y=i(41107),p=i(92493),g=i(23835);function m(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,_.default)(t);if(e){var r=(0,_.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,f.default)(this,i)}}var x=function(t){(0,d.default)(i,t);var e=m(i);function i(){var t;return(0,l.default)(this,i),(t=e.apply(this,arguments))._setIndexHandler=y.Handler.create((0,h.default)(t),t.setIndex,null,!1),t}return(0,u.default)(i,[{key:"setItems",value:function(t){this.removeChildren();for(var e=0,i=0,n=t.length;i<n;i++){var a=t[i];a&&(a.name="item"+e,this.addChild(a),e++)}this.initItems()}},{key:"addItem",value:function(t){t.name="item"+this._items.length,this.addChild(t),this.initItems()}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items=[];for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.visible=t==this._selectedIndex}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(this._selectedIndex,!0))}},{key:"setSelect",value:function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].visible=e)}},{key:"selection",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,s.default)(e=this._items).call(e,t)}},{key:"setIndexHandler",get:function(){return this._setIndexHandler},set:function(t){this._setIndexHandler=t}},{key:"setIndex",value:function(t){this.selectedIndex=t}},{key:"items",get:function(){return this._items}},{key:"dataSource",get:function(){return(0,c.default)((0,_.default)(i.prototype),"dataSource",this)},set:function(t){if(this._dataSource=t,"number"==typeof t||"string"==typeof t)this.selectedIndex=(0,o.default)(t);else for(var e in this._dataSource)e in this&&(this[e]=this._dataSource[e])}}]),i}(v.Box);e.ViewStack=x,p.ILaya.regClass(x),g.ClassUtils.regClass("laya.ui.ViewStack",x),g.ClassUtils.regClass("Laya.ViewStack",x)},72601:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Widget=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(42255),d=i(89662),f=i(92493),_=i(23835);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var y=function(t){(0,l.default)(i,t);var e=v(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments))._top=NaN,t._bottom=NaN,t._left=NaN,t._right=NaN,t._centerX=NaN,t._centerY=NaN,t}return(0,o.default)(i,[{key:"onReset",value:function(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=NaN}},{key:"_onEnable",value:function(){this.owner.parent?this._onAdded():this.owner.once(d.Event.ADDED,this,this._onAdded)}},{key:"_onDisable",value:function(){this.owner.off(d.Event.ADDED,this,this._onAdded),this.owner.parent&&this.owner.parent.off(d.Event.RESIZE,this,this._onParentResize)}},{key:"_onAdded",value:function(){this.owner.parent&&this.owner.parent.on(d.Event.RESIZE,this,this._onParentResize),this.resetLayoutX(),this.resetLayoutY()}},{key:"_onParentResize",value:function(){var t=this.resetLayoutX(),e=this.resetLayoutY();(t||e)&&this.owner.event(d.Event.RESIZE)}},{key:"resetLayoutX",value:function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerX)){if(isNaN(this.left))isNaN(this.right)||(t.x=Math.round(e.width-t.displayWidth-this.right+t.pivotX*t.scaleX));else if(t.x=Math.round(this.left+t.pivotX*t.scaleX),!isNaN(this.right)){if(!e._width)return!1;var i=(e._width-this.left-this.right)/(t.scaleX||.01);if(i!=t.width)return t.width=i,!0}}else t.x=Math.round(.5*(e.width-t.displayWidth)+this.centerX+t.pivotX*t.scaleX);return!1}},{key:"resetLayoutY",value:function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerY)){if(isNaN(this.top))isNaN(this.bottom)||(t.y=Math.round(e.height-t.displayHeight-this.bottom+t.pivotY*t.scaleY));else if(t.y=Math.round(this.top+t.pivotY*t.scaleY),!isNaN(this.bottom)){if(!e._height)return!1;var i=(e._height-this.top-this.bottom)/(t.scaleY||.01);if(i!=t.height)return t.height=i,!0}}else t.y=Math.round(.5*(e.height-t.displayHeight)+this.centerY+t.pivotY*t.scaleY);return!1}},{key:"resetLayout",value:function(){this.owner&&(this.resetLayoutX(),this.resetLayoutY())}},{key:"top",get:function(){return this._top},set:function(t){this._top!=t&&(this._top=t,this.resetLayoutY())}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom!=t&&(this._bottom=t,this.resetLayoutY())}},{key:"left",get:function(){return this._left},set:function(t){this._left!=t&&(this._left=t,this.resetLayoutX())}},{key:"right",get:function(){return this._right},set:function(t){this._right!=t&&(this._right=t,this.resetLayoutX())}},{key:"centerX",get:function(){return this._centerX},set:function(t){this._centerX!=t&&(this._centerX=t,this.resetLayoutX())}},{key:"centerY",get:function(){return this._centerY},set:function(t){this._centerY!=t&&(this._centerY=t,this.resetLayoutY())}}]),i}(c.Component);e.Widget=y,y.EMPTY=null,f.ILaya.regClass(y),y.EMPTY=new y,_.ClassUtils.regClass("laya.ui.Widget",y),_.ClassUtils.regClass("Laya.Widget",y)},93568:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Browser=void 0;var r=a(i(81643)),s=a(i(11128)),o=a(i(15375)),l=a(i(17061)),u=i(92493),h=function(){function t(){(0,o.default)(this,t)}return(0,l.default)(t,null,[{key:"__init__",value:function(){var e=window.Laya||u.ILaya.Laya;if(t._window)return t._window;var i=t._window=window,n=t._document=i.document,a=t.userAgent=i.navigator.userAgent,s=i.navigator.maxTouchPoints||0,o=i.navigator.platform;"my"in t.window&&((0,r.default)(a).call(a,"TB/")>-1||(0,r.default)(a).call(a,"Taobao/")>-1||(0,r.default)(a).call(a,"TM/")>-1?(window.tbMiniGame(e,e),e.TBMiniAdapter?e.TBMiniAdapter.enable():console.error("请先添加淘宝适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0")):(0,r.default)(a).call(a,"AlipayMiniGame")>-1&&(window.aliPayMiniGame(e,e),e.ALIMiniAdapter?e.ALIMiniAdapter.enable():console.error("请先添加阿里小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0"))),-1==(0,r.default)(a).call(a,"OPPO")&&(0,r.default)(a).call(a,"MiniGame")>-1&&"wx"in t.window&&("tt"in t.window?(window.ttMiniGame(e,e),e.TTMiniAdapter?e.TTMiniAdapter.enable():console.error("请引入字节跳动小游戏的适配库")):"bl"in t.window?(window.biliMiniGame(e,e),e.BLMiniAdapter?e.BLMiniAdapter.enable():console.error("请引入bilibili小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-7-0")):"qq"in t.window?(window.qqMiniGame(e,e),e.QQMiniAdapter?e.QQMiniAdapter.enable():console.error("请引入手机QQ小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-0-0")):(window.wxMiniGame(e,e),e.MiniAdpter?e.MiniAdpter.enable():console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0"))),"hbs"in t.window&&(window.hwMiniGame(e,e),e.HWMiniAdapter?e.HWMiniAdapter.enable():console.error("请先添加小游戏适配库!")),(0,r.default)(a).call(a,"SwanGame")>-1&&(window.bdMiniGame(e,e),e.BMiniAdapter?e.BMiniAdapter.enable():console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-1-0")),(0,r.default)(a).call(a,"QuickGame")>-1&&(window.miMiniGame(e,e),e.KGMiniAdapter?e.KGMiniAdapter.enable():console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-2-0")),(0,r.default)(a).call(a,"OPPO")>-1&&(0,r.default)(a).call(a,"MiniGame")>-1&&(window.qgMiniGame(e,e),e.QGMiniAdapter?e.QGMiniAdapter.enable():console.error("请先添加OPPO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-3-0")),(0,r.default)(a).call(a,"VVGame")>-1&&(window.vvMiniGame(e,e),e.VVMiniAdapter?e.VVMiniAdapter.enable():console.error("请先添加VIVO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-4-0")),i.trace=console.log,i.requestAnimationFrame=i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame||function(t){return i.setTimeout(t,1e3/60)};var l=n.body.style;l.margin=0,l.overflow="hidden",l["-webkit-user-select"]="none",l["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";for(var h=n.getElementsByTagName("meta"),c=0,d=!1,f="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";c<h.length;){var _=h[c];if("viewport"==_.name){_.content=f,d=!0;break}c++}return d||((_=n.createElement("meta")).name="viewport",_.content=f,n.getElementsByTagName("head")[0].appendChild(_)),t.onMobile=!!window.conch||(0,r.default)(a).call(a,"Mobile")>-1,t.onIOS=!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),t.onIPhone=(0,r.default)(a).call(a,"iPhone")>-1,t.onMac=(0,r.default)(a).call(a,"Mac OS X")>-1,t.onIPad=(0,r.default)(a).call(a,"iPad")>-1||"MacIntel"===o&&s>1,t.onAndroid=(0,r.default)(a).call(a,"Android")>-1||(0,r.default)(a).call(a,"Adr")>-1,t.onWP=(0,r.default)(a).call(a,"Windows Phone")>-1,t.onQQBrowser=(0,r.default)(a).call(a,"QQBrowser")>-1,t.onMQQBrowser=(0,r.default)(a).call(a,"MQQBrowser")>-1||(0,r.default)(a).call(a,"Mobile")>-1&&(0,r.default)(a).call(a,"QQ")>-1,t.onIE=!!i.ActiveXObject||"ActiveXObject"in i,t.onWeiXin=(0,r.default)(a).call(a,"MicroMessenger")>-1,t.onSafari=(0,r.default)(a).call(a,"Safari")>-1,t.onPC=!t.onMobile,t.onFirefox=(0,r.default)(a).call(a,"Firefox")>-1,t.onEdge=(0,r.default)(a).call(a,"Edge")>-1,t.onMiniGame=(0,r.default)(a).call(a,"MiniGame")>-1,t.onBDMiniGame=(0,r.default)(a).call(a,"SwanGame")>-1,t.onLayaRuntime=!!window.conch,(0,r.default)(a).call(a,"OPPO")>-1&&(0,r.default)(a).call(a,"MiniGame")>-1?(t.onQGMiniGame=!0,t.onMiniGame=!1):"qq"in t.window&&(0,r.default)(a).call(a,"MiniGame")>-1?(t.onQQMiniGame=!0,t.onMiniGame=!1):"bl"in t.window&&(0,r.default)(a).call(a,"MiniGame")>-1?(t.onBLMiniGame=!0,t.onMiniGame=!1):"tt"in t.window&&(0,r.default)(a).call(a,"MiniGame")>-1&&(t.onTTMiniGame=!0,t.onMiniGame=!1),t.onHWMiniGame="hbs"in t.window,t.onVVMiniGame=(0,r.default)(a).call(a,"VVGame")>-1,t.onKGMiniGame=(0,r.default)(a).call(a,"QuickGame")>-1,(0,r.default)(a).call(a,"AlipayMiniGame")>-1&&(t.onAlipayMiniGame=!0,t.onMiniGame=!1),((0,r.default)(a).call(a,"TB/")>-1||(0,r.default)(a).call(a,"Taobao/")>-1||(0,r.default)(a).call(a,"TM/")>-1)&&(t.onTBMiniGame=!0),i}},{key:"_isMiniGame",get:function(){return t.onMiniGame||t.onBDMiniGame||t.onQGMiniGame||t.onKGMiniGame||t.onVVMiniGame||t.onAlipayMiniGame||t.onQQMiniGame||t.onBLMiniGame||t.onTTMiniGame||t.onHWMiniGame||t.onTBMiniGame}},{key:"createElement",value:function(e){return t.__init__(),t._document.createElement(e)}},{key:"getElementById",value:function(e){return t.__init__(),t._document.getElementById(e)}},{key:"removeElement",value:function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"now",value:function(){return(0,s.default)()}},{key:"clientWidth",get:function(){return t.__init__(),t._window.innerWidth||t._document.body.clientWidth}},{key:"clientHeight",get:function(){return t.__init__(),t._window.innerHeight||t._document.body.clientHeight||t._document.documentElement.clientHeight}},{key:"width",get:function(){return t.__init__(),(u.ILaya.stage&&u.ILaya.stage.canvasRotation?t.clientHeight:t.clientWidth)*t.pixelRatio}},{key:"height",get:function(){return t.__init__(),(u.ILaya.stage&&u.ILaya.stage.canvasRotation?t.clientWidth:t.clientHeight)*t.pixelRatio}},{key:"pixelRatio",get:function(){var e;t._pixelRatio<0&&(t.__init__(),(0,r.default)(e=t.userAgent).call(e,"Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1?t._pixelRatio=2:(t._pixelRatio=t._window.devicePixelRatio||1,t._pixelRatio<1&&(t._pixelRatio=1)));return t._pixelRatio}},{key:"container",get:function(){return t._container||(t.__init__(),t._container=t.createElement("div"),t._container.id="layaContainer",t._document.body.appendChild(t._container)),t._container},set:function(e){t._container=e}},{key:"window",get:function(){return t._window||t.__init__()}},{key:"document",get:function(){return t.__init__(),t._document}}]),t}();e.Browser=h,h._pixelRatio=-1,h.mainCanvas=null,h.hanzi=new RegExp("^[一-龥]$"),h.fontMap={},h.measureText=function(t,e){var i=h.hanzi.test(t);if(i&&h.fontMap[e])return h.fontMap[e];var n=h.context;n.font=e;var a=n.measureText(t);return i&&(h.fontMap[e]=a),a}},14002:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Byte=void 0;var r=a(i(3649)),s=a(i(98926)),o=a(i(15375)),l=a(i(17061)),u=i(18008),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,o.default)(this,t),this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,e?(this._u8d_=new Uint8Array(e),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}return(0,l.default)(t,[{key:"buffer",get:function(){var t=this._d_.buffer;return t.byteLength===this._length?t:(0,r.default)(t).call(t,0,this._length)}},{key:"endian",get:function(){return this._xd_?t.LITTLE_ENDIAN:t.BIG_ENDIAN},set:function(e){this._xd_=e===t.LITTLE_ENDIAN}},{key:"length",get:function(){return this._length},set:function(t){this._allocated_<t?this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,2*this._allocated_))):this._allocated_>t&&this._resizeBuffer(this._allocated_=t),this._length=t}},{key:"_resizeBuffer",value:function(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}}},{key:"getString",value:function(){return this.readString()}},{key:"readString",value:function(){return this._rUTF(this.getUint16())}},{key:"getFloat32Array",value:function(t,e){return this.readFloat32Array(t,e)}},{key:"readFloat32Array",value:function(t,e){var i,n=t+e;n=n>this._length?this._length:n;var a=new Float32Array((0,r.default)(i=this._d_.buffer).call(i,t,n));return this._pos_=n,a}},{key:"getUint8Array",value:function(t,e){return this.readUint8Array(t,e)}},{key:"readUint8Array",value:function(t,e){var i,n=t+e;n=n>this._length?this._length:n;var a=new Uint8Array((0,r.default)(i=this._d_.buffer).call(i,t,n));return this._pos_=n,a}},{key:"getInt16Array",value:function(t,e){return this.readInt16Array(t,e)}},{key:"readInt16Array",value:function(t,e){var i,n=t+e;n=n>this._length?this._length:n;var a=new Int16Array((0,r.default)(i=this._d_.buffer).call(i,t,n));return this._pos_=n,a}},{key:"getFloat32",value:function(){return this.readFloat32()}},{key:"readFloat32",value:function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"getFloat64",value:function(){return this.readFloat64()}},{key:"readFloat64",value:function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,t}},{key:"writeFloat32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"writeFloat64",value:function(t){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,t,this._xd_),this._pos_+=8}},{key:"getInt32",value:function(){return this.readInt32()}},{key:"readInt32",value:function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"getUint32",value:function(){return this.readUint32()}},{key:"readUint32",value:function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"writeInt32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"writeUint32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"getInt16",value:function(){return this.readInt16()}},{key:"readInt16",value:function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,t}},{key:"getUint16",value:function(){return this.readUint16()}},{key:"readUint16",value:function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,t}},{key:"writeUint16",value:function(t){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,t,this._xd_),this._pos_+=2}},{key:"writeInt16",value:function(t){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,t,this._xd_),this._pos_+=2}},{key:"getUint8",value:function(){return this.readUint8()}},{key:"readUint8",value:function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}},{key:"writeUint8",value:function(t){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,t),this._pos_++}},{key:"_getUInt8",value:function(t){return this._readUInt8(t)}},{key:"_readUInt8",value:function(t){return this._d_.getUint8(t)}},{key:"_getUint16",value:function(t){return this._readUint16(t)}},{key:"_readUint16",value:function(t){return this._d_.getUint16(t,this._xd_)}},{key:"_getMatrix",value:function(){return this._readMatrix()}},{key:"_readMatrix",value:function(){return new u.Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())}},{key:"_rUTF",value:function(t){var e,i,n=this._pos_+t,a=String.fromCharCode,r=this._u8d_,s=[],o=0;for(s.length=1e3;this._pos_<n;){if((e=r[this._pos_++])<128)0!=e&&(s[o++]=a(e));else if(e<224)s[o++]=a((63&e)<<6|127&r[this._pos_++]);else if(e<240)i=r[this._pos_++],s[o++]=a((31&e)<<12|(127&i)<<6|127&r[this._pos_++]);else{var l=(15&e)<<18|(127&(i=r[this._pos_++]))<<12|(127&r[this._pos_++])<<6|127&r[this._pos_++];if(l>=65536){var u=l-65536,h=55296|u>>10,c=56320|1023&u;s[o++]=a(h),s[o++]=a(c)}else s[o++]=a(l)}0}return s.length=o,s.join("")}},{key:"getCustomString",value:function(t){return this.readCustomString(t)}},{key:"readCustomString",value:function(t){for(var e,i="",n=0,a=String.fromCharCode,r=this._u8d_;t>0;)if((e=r[this._pos_])<128)i+=a(e),this._pos_++,t--;else for(n=e-128,this._pos_++,t-=n;n>0;)e=r[this._pos_++],i+=a(r[this._pos_++]<<8|e),n--;return i}},{key:"pos",get:function(){return this._pos_},set:function(t){this._pos_=t}},{key:"bytesAvailable",get:function(){return this._length-this._pos_}},{key:"clear",value:function(){this._pos_=0,this.length=0}},{key:"__getBuffer",value:function(){return this._d_.buffer}},{key:"writeUTFBytes",value:function(t){for(var e=0,i=(t+="").length;e<i;e++){var n=t.charCodeAt(e);if(n<=127)this.writeByte(n);else if(n<=2047)this._ensureWrite(this._pos_+2),this._u8d_.set([192|n>>6,128|63&n],this._pos_),this._pos_+=2;else if(n>=55296&&n<=56319){e++;var a=t.charCodeAt(e);if(!(0,s.default)(a)&&a>=56320&&a<=57343){var r=64+(1023&n),o=1023&a,l=240|r>>8&63,u=128|r>>2&63,h=128|(3&r)<<4|o>>6&15,c=128|63&o;this._ensureWrite(this._pos_+4),this._u8d_.set([l,u,h,c],this._pos_),this._pos_+=4}}else n<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|n>>12,128|n>>6&63,128|63&n],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n],this._pos_),this._pos_+=4)}}},{key:"writeUTFString",value:function(t){var e=this.pos;this.writeUint16(1),this.writeUTFBytes(t);var i=this.pos-e-2;this._d_.setUint16(e,i,this._xd_)}},{key:"writeUTFString32",value:function(t){var e=this.pos;this.writeUint32(1),this.writeUTFBytes(t);var i=this.pos-e-4;this._d_.setUint32(e,i,this._xd_)}},{key:"readUTFString",value:function(){return this.readUTFBytes(this.getUint16())}},{key:"readUTFString32",value:function(){return this.readUTFBytes(this.getUint32())}},{key:"getUTFString",value:function(){return this.readUTFString()}},{key:"readUTFBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(0===t)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";return t=t>0?t:e,this._rUTF(t)}},{key:"getUTFBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.readUTFBytes(t)}},{key:"writeByte",value:function(t){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,t),this._pos_+=1}},{key:"readByte",value:function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}},{key:"getByte",value:function(){return this.readByte()}},{key:"_ensureWrite",value:function(t){this._length<t&&(this._length=t),this._allocated_<t&&(this.length=t)}},{key:"writeArrayBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e<0||i<0)throw"writeArrayBuffer error - Out of bounds";0==i&&(i=t.byteLength-e),this._ensureWrite(this._pos_+i);var n=new Uint8Array(t);this._u8d_.set(n.subarray(e,e+i),this._pos_),this._pos_+=i}},{key:"readArrayBuffer",value:function(t){var e,i;return i=(0,r.default)(e=this._u8d_.buffer).call(e,this._pos_,this._pos_+t),this._pos_=this._pos_+t,i}}],[{key:"getSystemEndian",value:function(){if(!t._sysEndian){var e=new ArrayBuffer(2);new DataView(e).setInt16(0,256,!0),t._sysEndian=256===new Int16Array(e)[0]?t.LITTLE_ENDIAN:t.BIG_ENDIAN}return t._sysEndian}}]),t}();e.Byte=h,h.BIG_ENDIAN="bigEndian",h.LITTLE_ENDIAN="littleEndian",h._sysEndian=null},17939:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.CacheManger=void 0;var r=a(i(92762)),s=a(i(15375)),o=a(i(17061)),l=i(92493),u=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"regCacheByFunction",value:function(e,i){var n;t.unRegCacheByFunction(e,i),n={tryDispose:e,getCacheList:i},t._cacheList.push(n)}},{key:"unRegCacheByFunction",value:function(e,i){var n,a;for(a=t._cacheList.length,n=0;n<a;n++){var s;if(t._cacheList[n].tryDispose==e&&t._cacheList[n].getCacheList==i)return void(0,r.default)(s=t._cacheList).call(s,n,1)}}},{key:"forceDispose",value:function(){var e,i=t._cacheList.length;for(e=0;e<i;e++)t._cacheList[e].tryDispose(!0)}},{key:"beginCheck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;l.ILaya.systemTimer.loop(e,null,t._checkLoop)}},{key:"stopCheck",value:function(){l.ILaya.systemTimer.clear(null,t._checkLoop)}},{key:"_checkLoop",value:function(){var e=t._cacheList;if(!(e.length<1)){var i,n,a=l.ILaya.Browser.now();for(n=i=e.length;i>0&&(t._index++,t._index=t._index%n,e[t._index].tryDispose(!1),!(l.ILaya.Browser.now()-a>t.loopTimeLimit));)i--}}}]),t}();e.CacheManger=u,u.loopTimeLimit=2,u._cacheList=[],u._index=0},38022:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.CallLater=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(92493),l=function(){function t(){(0,r.default)(this,t),this._pool=[],this._map={},this._laters=[]}return(0,s.default)(t,[{key:"_update",value:function(){var t=this._laters,e=t.length;if(e>0){for(var i=0,n=e-1;i<=n;i++){var a=t[i];this._map[a.key]=null,null!==a.method&&(a.run(),a.clear()),this._pool.push(a),i===n&&(n=t.length-1)}t.length=0}}},{key:"_getHandler",value:function(t,e){var i=t?t.$_GID||(t.$_GID=o.ILaya.Utils.getGID()):0,n=e.$_TID||(e.$_TID=o.ILaya.Timer._mid++);return this._map[i+"."+n]}},{key:"callLater",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==this._getHandler(t,e)){var n;(n=this._pool.length?this._pool.pop():new u).caller=t,n.method=e,n.args=i;var a=t?t.$_GID:0,r=e.$_TID;n.key=a+"."+r,this._map[n.key]=n,this._laters.push(n)}}},{key:"runCallLater",value:function(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(),i.clear())}}]),t}();e.CallLater=l,l.I=new l;var u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(){var t=this.caller;if(t&&t.destroyed)return this.clear();var e=this.method,i=this.args;null!=e&&(i?e.apply(t,i):e.call(t))}}]),t}()},23835:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ClassUtils=void 0;var r=a(i(31238)),s=a(i(15375)),o=a(i(17061)),l=i(18008),u=i(72276),h=i(92493),c=i(71706),d=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"regClass",value:function(e,i){t._classMap[e]=i}},{key:"regShortClassName",value:function(e){for(var i=0;i<e.length;i++){var n=e[i],a=n.name;t._classMap[a]=n}}},{key:"getRegClass",value:function(e){return t._classMap[e]}},{key:"getClass",value:function(e){var i=t._classMap[e]||t._classMap["Laya."+e]||e,n=h.ILaya.Laya;return"string"==typeof i?h.ILaya.__classMap[i]||n[e]:i}},{key:"getInstance",value:function(e){var i=t.getClass(e);return i?new i:(console.warn("[error] Undefined class:",e),null)}},{key:"createByJson",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;"string"==typeof e&&(e=JSON.parse(e));var s=e.props;if(!i&&!(i=r?r.runWith(e):t.getInstance(s.runtime||e.type)))return null;var o=e.child;if(o)for(var l=0,u=o.length;l<u;l++){var h=o[l];if("render"!==h.props.name&&"render"!==h.props.renderType||!i._$set_itemRender)if("Graphic"==h.type)t._addGraphicsToSprite(h,i);else if(t._isDrawType(h.type))t._addGraphicToSprite(h,i,!0);else{var c=t.createByJson(h,null,n,a,r);"Script"===h.type?"owner"in c?c.owner=i:"target"in c&&(c.target=i):"mask"==h.props.renderType?i.mask=c:i.addChild(c)}else i.itemRender=h}if(s)for(var d in s){var f=s[d];"var"===d&&n?n[f]=i:f instanceof Array&&i[d]instanceof Function?i[d].apply(i,f):i[d]=f}return a&&e.customProps&&a.runWith([i,e]),i.created&&i.created(),i}},{key:"_addGraphicsToSprite",value:function(e,i){var n=e.child;if(n&&!(n.length<1)){var a,r,s=t._getGraphicsFromSprite(e,i),o=0,l=0;for(e.props&&(o=t._getObjVar(e.props,"x",0),l=t._getObjVar(e.props,"y",0)),0!=o&&0!=l&&s.translate(o,l),r=n.length,a=0;a<r;a++)t._addGraphicToGraphics(n[a],s);0!=o&&0!=l&&s.translate(-o,-l)}}},{key:"_addGraphicToSprite",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=n?t._getGraphicsFromSprite(e,i):i.graphics;t._addGraphicToGraphics(e,a)}},{key:"_getGraphicsFromSprite",value:function(t,e){if(!t||!t.props)return e.graphics;var i=t.props.renderType;if("hit"===i||"unHit"===i){var n=e._style.hitArea||(e.hitArea=new c.HitArea);n[i]||(n[i]=new u.Graphics);var a=n[i]}return a||(a=e.graphics),a}},{key:"_getTransformData",value:function(e){var i;("pivotX"in e||"pivotY"in e)&&(i=i||new l.Matrix).translate(-t._getObjVar(e,"pivotX",0),-t._getObjVar(e,"pivotY",0));var n=t._getObjVar(e,"scaleX",1),a=t._getObjVar(e,"scaleY",1),r=t._getObjVar(e,"rotation",0);t._getObjVar(e,"skewX",0),t._getObjVar(e,"skewY",0);return 1==n&&1==a&&0==r||((i=i||new l.Matrix).scale(n,a),i.rotate(.0174532922222222*r)),i}},{key:"_addGraphicToGraphics",value:function(e,i){var n,a;if((n=e.props)&&(a=t.DrawTypeDic[e.type])){var r=i,s=t._getParams(n,a[1],a[2],a[3]),o=t._tM;(o||1!=t._alpha)&&(r.save(),o&&r.transform(o),1!=t._alpha&&r.alpha(t._alpha)),r[a[0]].apply(r,s),(o||1!=t._alpha)&&r.restore()}}},{key:"_adptLineData",value:function(t){return t[2]=(0,r.default)(t[0])+(0,r.default)(t[2]),t[3]=(0,r.default)(t[1])+(0,r.default)(t[3]),t}},{key:"_adptTextureData",value:function(t){return t[0]=h.ILaya.Loader.getRes(t[0]),t}},{key:"_adptLinesData",value:function(e){return e[2]=t._getPointListByStr(e[2]),e}},{key:"_isDrawType",value:function(e){return"Image"!==e&&e in t.DrawTypeDic}},{key:"_getParams",value:function(e,i){var n,a,r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=t._temParam;for(l.length=i.length,a=i.length,n=0;n<a;n++)l[n]=t._getObjVar(e,i[n][0],i[n][1]);return t._alpha=t._getObjVar(e,"alpha",1),(r=t._getTransformData(e))?(s||(s=0),r.translate(l[s],l[s+1]),l[s]=l[s+1]=0,t._tM=r):t._tM=null,o&&t[o]&&(l=t[o](l)),l}},{key:"_getPointListByStr",value:function(t){var e,i,n=t.split(",");for(i=n.length,e=0;e<i;e++)n[e]=(0,r.default)(n[e]);return n}},{key:"_getObjVar",value:function(t,e,i){return e in t?t[e]:i}}]),t}();e.ClassUtils=d,d.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]},d._temParam=[],d._classMap={}},13104:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ColorUtils=void 0;var r=a(i(81643)),s=a(i(31238)),o=a(i(94198)),l=a(i(15375)),u=a(i(17061)),h=i(56083),c=function(){function t(e){var i,n,a,u;if((0,l.default)(this,t),this.arrColor=[],null==e||"none"==e)return this.strColor="#00000000",this.numColor=0,void(this.arrColor=[0,0,0,0]);if("string"==typeof e)if((0,r.default)(e).call(e,"rgba(")>=0||(0,r.default)(e).call(e,"rgb(")>=0){var c,d,f=e;for(c=(0,r.default)(f).call(f,"("),d=(0,r.default)(f).call(f,")"),f=f.substring(c+1,d),this.arrColor=f.split(","),a=this.arrColor.length,n=0;n<a;n++)this.arrColor[n]=(0,s.default)(this.arrColor[n]),n<3&&(this.arrColor[n]=Math.round(this.arrColor[n]));u=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2],this.strColor=e}else{if(this.strColor=e,"#"===e.charAt(0)&&(e=e.substr(1)),3===(a=e.length)||4===a){var _="";for(n=0;n<a;n++)_+=e[n]+e[n];e=_}u=(0,o.default)(e,16)}else u=e,this.strColor=h.Utils.toHexColor(u);(0,r.default)(i=this.strColor).call(i,"rgba")>=0||9===this.strColor.length?(this.arrColor=[((4278190080&u)>>>24)/255,((16711680&u)>>16)/255,((65280&u)>>8)/255,(255&u)/255],this.numColor=(4278190080&u)>>>24|(16711680&u)>>8|(65280&u)<<8|(255&u)<<24):(this.arrColor=[((16711680&u)>>16)/255,((65280&u)>>8)/255,(255&u)/255,1],this.numColor=4278190080|(16711680&u)>>16|65280&u|(255&u)<<16),this.arrColor.__id=++t._COLODID}return(0,u.default)(t,null,[{key:"_initDefault",value:function(){for(var e in t._DEFAULT={},t._COLOR_MAP)t._SAVE[e]=t._DEFAULT[e]=new t(t._COLOR_MAP[e]);return t._DEFAULT}},{key:"_initSaveMap",value:function(){for(var e in t._SAVE_SIZE=0,t._SAVE={},t._DEFAULT)t._SAVE[e]=t._DEFAULT[e]}},{key:"create",value:function(e){var i=e+"",n=t._SAVE[i];return null!=n?n:(t._SAVE_SIZE<1e3&&t._initSaveMap(),t._SAVE[i]=new t(e))}}]),t}();e.ColorUtils=c,c._SAVE={},c._SAVE_SIZE=0,c._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"},c._DEFAULT=c._initDefault(),c._COLODID=1},97617:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Dragging=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(89662),l=i(47002),u=i(92493),h=i(45840),c=i(41107),d=i(84221),f=function(){function t(){(0,r.default)(this,t),this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}return(0,s.default)(t,[{key:"start",value:function(t,e,i,n,a,r,s){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:.92;this.clearTimer(),this.target=t,this.area=e,this.hasInertia=i,this.elasticDistance=e?n:0,this.elasticBackTime=a,this.data=r,this._disableMouseEvent=s,this.ratio=l,this._parent=t.parent,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,u.ILaya.stage.on(o.Event.MOUSE_UP,this,this.onStageMouseUp),u.ILaya.stage.on(o.Event.MOUSE_OUT,this,this.onStageMouseUp),u.ILaya.systemTimer.frameLoop(1,this,this.loop)}},{key:"clearTimer",value:function(){u.ILaya.systemTimer.clear(this,this.loop),u.ILaya.systemTimer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)}},{key:"stop",value:function(){this._dragging&&(l.MouseManager.instance.disableMouseEvent=!1,u.ILaya.stage.off(o.Event.MOUSE_UP,this,this.onStageMouseUp),u.ILaya.stage.off(o.Event.MOUSE_OUT,this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())}},{key:"loop",value:function(){var t=this._parent.getMousePoint(),e=t.x,i=t.y,n=e-this._lastX,a=i-this._lastY;if(this._clickOnly){if(!(Math.abs(n*u.ILaya.stage._canvasTransform.getScaleX())>1||Math.abs(a*u.ILaya.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event(o.Event.DRAG_START,this.data),l.MouseManager.instance.disableMouseEvent=this._disableMouseEvent}else this._offsets.push(n,a);0===n&&0===a||(this._lastX=e,this._lastY=i,this.target.x+=n*this._elasticRateX,this.target.y+=a*this._elasticRateY,this.area&&this.checkArea(),this.target.event(o.Event.DRAG_MOVE,this.data))}},{key:"checkArea",value:function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target._x<this.area.x)var t=this.area.x-this.target._x;else t=this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-t/this.elasticDistance),this.target._y<this.area.y)var e=this.area.y-this.target.y;else e=this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}}},{key:"backToArea",value:function(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)}},{key:"onStageMouseUp",value:function(t){if(l.MouseManager.instance.disableMouseEvent=!1,u.ILaya.stage.off(o.Event.MOUSE_UP,this,this.onStageMouseUp),u.ILaya.stage.off(o.Event.MOUSE_OUT,this,this.onStageMouseUp),u.ILaya.systemTimer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var e=this._offsets.length,i=Math.min(e,6),n=this._offsets.length-i,a=e-1;a>n;a--)this._offsetY+=this._offsets[a--],this._offsetX+=this._offsets[a];this._offsetX=this._offsetX/i*2,this._offsetY=this._offsetY/i*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),u.ILaya.systemTimer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()}},{key:"checkElastic",value:function(){var t=NaN,e=NaN;if(this.target.x<this.area.x?t=this.area.x:this.target._x>this.area.x+this.area.width&&(t=this.area.x+this.area.width),this.target.y<this.area.y?e=this.area.y:this.target._y>this.area.y+this.area.height&&(e=this.area.y+this.area.height),isNaN(t)&&isNaN(e))this.clear();else{var i={};isNaN(t)||(i.x=t),isNaN(e)||(i.y=e),this._tween=d.Tween.to(this.target,i,this.elasticBackTime,h.Ease.sineOut,c.Handler.create(this,this.clear),0,!1,!1)}}},{key:"tweenMove",value:function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event(o.Event.DRAG_MOVE,this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(u.ILaya.systemTimer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())}},{key:"clear",value:function(){if(this.target){this.clearTimer();var t=this.target;this.target=null,this._parent=null,t.event(o.Event.DRAG_END,this.data)}}}]),t}();e.Dragging=f},45840:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Ease=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"linearNone",value:function(t,e,i,n){return i*t/n+e}},{key:"linearIn",value:function(t,e,i,n){return i*t/n+e}},{key:"linearInOut",value:function(t,e,i,n){return i*t/n+e}},{key:"linearOut",value:function(t,e,i,n){return i*t/n+e}},{key:"bounceIn",value:function(e,i,n,a){return n-t.bounceOut(a-e,0,n,a)+i}},{key:"bounceInOut",value:function(e,i,n,a){return e<.5*a?.5*t.bounceIn(2*e,0,n,a)+i:.5*t.bounceOut(2*e-a,0,n,a)+.5*n+i}},{key:"bounceOut",value:function(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}},{key:"backIn",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return i*(t/=n)*t*((a+1)*t-a)+e}},{key:"backInOut",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return(t/=.5*n)<1?.5*i*(t*t*((1+(a*=1.525))*t-a))+e:i/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+e}},{key:"backOut",value:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return i*((t=t/n-1)*t*((a+1)*t+a)+1)+e}},{key:"elasticIn",value:function(e,i,n,a){var r,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?i:1==(e/=a)?i+n:(o||(o=.3*a),!s||n>0&&s<n||n<0&&s<-n?(s=n,r=o/4):r=o/t.PI2*Math.asin(n/s),-s*Math.pow(2,10*(e-=1))*Math.sin((e*a-r)*t.PI2/o)+i)}},{key:"elasticInOut",value:function(e,i,n,a){var r,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?i:2==(e/=.5*a)?i+n:(o||(o=a*(.3*1.5)),!s||n>0&&s<n||n<0&&s<-n?(s=n,r=o/4):r=o/t.PI2*Math.asin(n/s),e<1?s*Math.pow(2,10*(e-=1))*Math.sin((e*a-r)*t.PI2/o)*-.5+i:s*Math.pow(2,-10*(e-=1))*Math.sin((e*a-r)*t.PI2/o)*.5+n+i)}},{key:"elasticOut",value:function(e,i,n,a){var r,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?i:1==(e/=a)?i+n:(o||(o=.3*a),!s||n>0&&s<n||n<0&&s<-n?(s=n,r=o/4):r=o/t.PI2*Math.asin(n/s),s*Math.pow(2,-10*e)*Math.sin((e*a-r)*t.PI2/o)+n+i)}},{key:"strongIn",value:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e}},{key:"strongInOut",value:function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e}},{key:"strongOut",value:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e}},{key:"sineInOut",value:function(t,e,i,n){return.5*-i*(Math.cos(Math.PI*t/n)-1)+e}},{key:"sineIn",value:function(e,i,n,a){return-n*Math.cos(e/a*t.HALF_PI)+n+i}},{key:"sineOut",value:function(e,i,n,a){return n*Math.sin(e/a*t.HALF_PI)+i}},{key:"quintIn",value:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e}},{key:"quintInOut",value:function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e}},{key:"quintOut",value:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e}},{key:"quartIn",value:function(t,e,i,n){return i*(t/=n)*t*t*t+e}},{key:"quartInOut",value:function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t*t+e:.5*-i*((t-=2)*t*t*t-2)+e}},{key:"quartOut",value:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e}},{key:"cubicIn",value:function(t,e,i,n){return i*(t/=n)*t*t+e}},{key:"cubicInOut",value:function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t*t+e:.5*i*((t-=2)*t*t+2)+e}},{key:"cubicOut",value:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e}},{key:"quadIn",value:function(t,e,i,n){return i*(t/=n)*t+e}},{key:"quadInOut",value:function(t,e,i,n){return(t/=.5*n)<1?.5*i*t*t+e:.5*-i*(--t*(t-2)-1)+e}},{key:"quadOut",value:function(t,e,i,n){return-i*(t/=n)*(t-2)+e}},{key:"expoIn",value:function(t,e,i,n){return 0==t?e:i*Math.pow(2,10*(t/n-1))+e-.001*i}},{key:"expoInOut",value:function(t,e,i,n){return 0==t?e:t==n?e+i:(t/=.5*n)<1?.5*i*Math.pow(2,10*(t-1))+e:.5*i*(2-Math.pow(2,-10*--t))+e}},{key:"expoOut",value:function(t,e,i,n){return t==n?e+i:i*(1-Math.pow(2,-10*t/n))+e}},{key:"circIn",value:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e}},{key:"circInOut",value:function(t,e,i,n){return(t/=.5*n)<1?.5*-i*(Math.sqrt(1-t*t)-1)+e:.5*i*(Math.sqrt(1-(t-=2)*t)+1)+e}},{key:"circOut",value:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e}}]),t}();e.Ease=o,o.HALF_PI=.5*Math.PI,o.PI2=2*Math.PI},75494:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.FontInfo=void 0;var r=a(i(81643)),s=a(i(94198)),o=a(i(15375)),l=a(i(17061)),u=function(){function t(e){(0,o.default)(this,t),this._font="14px Arial",this._family="Arial",this._size=14,this._italic=!1,this._bold=!1,this._id=t._gfontID++,this.setFont(e||this._font)}return(0,l.default)(t,[{key:"setFont",value:function(t){this._font=t;var e=t.split(" "),i=e.length;if(i<2){var n;1==i&&(0,r.default)(n=e[0]).call(n,"px")>0&&(this._size=(0,s.default)(e[0]))}else{for(var a=-1,o=0;o<i;o++){var l,u;if((0,r.default)(l=e[o]).call(l,"px")>0||(0,r.default)(u=e[o]).call(u,"pt")>0){a=o,this._size=(0,s.default)(e[o]),this._size<=0&&(console.error("font parse error:"+t),this._size=14);break}}var h=a+1,c=e[h];for(h++;h<i;h++)c+=" "+e[h];this._family=c.split(",")[0],this._italic=(0,r.default)(e).call(e,"italic")>=0,this._bold=(0,r.default)(e).call(e,"bold")>=0}}}],[{key:"Parse",value:function(e){if(e===t._lastFont)return t._lastFontInfo;var i=t._cache[e];return i||(i=t._cache[e]=new t(e)),t._lastFont=e,t._lastFontInfo=i,i}}]),t}();e.FontInfo=u,u.EMPTY=new u(null),u._cache={},u._gfontID=0,u._lastFont=""},22847:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.GraphicAnimation=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(24288),f=i(72276),_=i(18008),v=i(85096);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var p=function(t){(0,u.default)(i,t);var e=y(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments))._nodeIDAniDic={},t}return(0,o.default)(i,[{key:"_parseNodeList",value:function(t){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[t.compId]=t.props,t.compId&&this._nodeList.push(t.compId);var e=t.child;if(e){var i,n=e.length;for(i=0;i<n;i++)this._parseNodeList(e[i])}}},{key:"_calGraphicData",value:function(t){var e;if(this._setUp(null,t),this._createGraphicData(),this._nodeIDAniDic)for(e in this._nodeIDAniDic)this._nodeIDAniDic[e]=null}},{key:"_createGraphicData",value:function(){var t,e,i=[],n=this.count,a=this._usedFrames;for(a||(a=[]),t=0;t<n;t++)!a[t]&&e||(e=this._createFrameGraphic(t)),i.push(e);this._gList=i}},{key:"_createFrameGraphic",value:function(t){var e=new f.Graphics;return i._rootMatrix||(i._rootMatrix=new _.Matrix),this._updateNodeGraphic(this._rootNode,t,i._rootMatrix,e),e}},{key:"_updateNodeGraphic",value:function(t,e,i,n){var a,r,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;(a=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId])).resultTransform||(a.resultTransform=new _.Matrix),r=a.resultTransform,_.Matrix.mul(a.transform,i,r);var l=a.alpha*o;if(!(l<.01)){a.skin&&(s=this._getTextureByUrl(a.skin))&&(r._checkTransform()?(n.drawTexture(s,0,0,a.width,a.height,r,l),a.resultTransform=null):n.drawTexture(s,r.tx,r.ty,a.width,a.height,null,l));var u,h,c=t.child;if(c)for(h=c.length,u=0;u<h;u++)this._updateNodeGraphic(c[u],e,r,n,l)}}},{key:"_updateNoChilds",value:function(t,e){if(t.skin){var i=this._getTextureByUrl(t.skin);if(i){var n=t.transform;n._checkTransform(),!n._bTransform?e.drawTexture(i,n.tx,n.ty,t.width,t.height,null,t.alpha):e.drawTexture(i,0,0,t.width,t.height,n.clone(),t.alpha)}}}},{key:"_updateNodeGraphic2",value:function(t,e,i){var n;if(n=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]),t.child){var a,r,s,o=n.transform;o._checkTransform(),r=(a=!o._bTransform)&&(0!=o.tx||0!=o.ty),(s=o._bTransform||1!=n.alpha)&&i.save(),1!=n.alpha&&i.alpha(n.alpha),a?r&&i.translate(o.tx,o.ty):i.transform(o.clone());var l,u,h,c=t.child;if(n.skin&&(l=this._getTextureByUrl(n.skin))&&i.drawImage(l,0,0,n.width,n.height),c)for(h=c.length,u=0;u<h;u++)this._updateNodeGraphic2(c[u],e,i);s?i.restore():a?r&&i.translate(-o.tx,-o.ty):i.transform(o.clone().invert())}else this._updateNoChilds(n,i)}},{key:"_calculateKeyFrames",value:function(t){(0,l.default)((0,c.default)(i.prototype),"_calculateKeyFrames",this).call(this,t),this._nodeIDAniDic[t.target]=t}},{key:"getNodeDataByID",value:function(t){return this._nodeIDAniDic[t]}},{key:"_getParams",value:function(t,e,n,a){var r=i._temParam;r.length=e.length;var s,o=e.length;for(s=0;s<o;s++)r[s]=this._getObjVar(t,e[s][0],n,e[s][1],a);return r}},{key:"_getObjVar",value:function(t,e,i,n,a){if(e in t){var r=t[e];return i>=r.length&&(i=r.length-1),t[e][i]}return e in a?a[e]:n}},{key:"_getNodeGraphicData",value:function(t,e,n){n||(n=new g),n.transform?n.transform.identity():n.transform=new _.Matrix;var a=this.getNodeDataByID(t);if(!a)return n;var r,s,o,l=a.frames,u=this._getParams(l,i._drawTextureCmd,e,this._nodeDefaultProps[t]),h=u[0],c=u[5],d=u[6],f=u[13],v=u[14],y=u[7],p=u[8],m=u[9],x=u[11],T=u[12];r=u[3],s=u[4],0!=r&&0!=s||(h=null),-1==r&&(r=0),-1==s&&(s=0),n.skin=h,n.width=r,n.height=s,h&&((o=this._getTextureByUrl(h))?(r||(r=o.sourceWidth),s||(s=o.sourceHeight)):console.warn("lost skin:",h,",you may load pics first")),n.alpha=u[10];var k=n.transform;0!=f&&(c=f*r),0!=v&&(d=v*s),0==c&&0==d||k.translate(-c,-d);var C=null;if(m||1!==y||1!==p||x||T){(C=i._tempMt).identity(),C._bTransform=!0;var S=.0174532922222222*(m-x),E=.0174532922222222*(m+T),M=Math.cos(E),L=Math.sin(E),b=Math.sin(S),I=Math.cos(S);C.a=y*M,C.b=y*L,C.c=-p*b,C.d=p*I,C.tx=C.ty=0}return C&&(k=_.Matrix.mul(k,C,k)),k.translate(u[1],u[2]),n}},{key:"_getTextureByUrl",value:function(t){return v.Loader.getRes(t)}},{key:"setAniData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=t,this._parseNodeList(t);var n,a,r={},s=[],o=t.animations,l=o.length;for(n=0;n<l;n++)if(a=o[n],this._labels=null,(!e||e==a.name)&&a){try{this._calGraphicData(a)}catch(t){console.warn("parse animation fail:"+a.name+",empty animation created"),this._gList=[]}var u={};u.interval=1e3/a.frameRate,u.frames=this._gList,u.labels=this._labels,u.name=a.name,s.push(u),r[a.name]=u}this.animationList=s,this.animationDic=r}i._temParam.length=0}},{key:"parseByData",value:function(t){var e,i;e=t.nodeRoot,i=t.aniO,delete t.nodeRoot,delete t.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=e,this._parseNodeList(e),this._labels=null;try{this._calGraphicData(i)}catch(t){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}var n=t;return n.interval=1e3/i.frameRate,n.frames=this._gList,n.labels=this._labels,n.name=i.name,n}},{key:"setUpAniData",value:function(t){if(t.animations){var e,i,n={},a=[],r=t.animations,s=r.length;for(e=0;e<s;e++)if(i=r[e]){var o={};o.name=i.name,o.aniO=i,o.nodeRoot=t,a.push(o),n[i.name]=o}this.animationList=a,this.animationDic=n}}},{key:"_clear",value:function(){this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic=null}}],[{key:"parseAnimationByData",value:function(t){var e;return i._I||(i._I=new i),e=i._I.parseByData(t),i._I._clear(),e}},{key:"parseAnimationData",value:function(t){var e;return i._I||(i._I=new i),i._I.setUpAniData(t),(e={}).animationList=i._I.animationList,e.animationDic=i._I.animationDic,i._I._clear(),e}}]),i}(d.FrameAnimation);e.GraphicAnimation=p,p._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],p._temParam=[],p._tempMt=new _.Matrix;var g=function t(){(0,s.default)(this,t),this.alpha=1}},25810:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HTMLChar=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(64210),l=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"setData",value:function(e,i,n,a){return this.char=e,this.charNum=e.charCodeAt(0),this.x=this.y=0,this.width=i,this.height=n,this.style=a,this.isWord=!t._isWordRegExp.test(e),this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this.isWord=!1,this.char=null,this.charNum=0,this.style=null,this}},{key:"recover",value:function(){o.Pool.recover("HTMLChar",this.reset())}},{key:"_isChar",value:function(){return!0}},{key:"_getCSSStyle",value:function(){return this.style}}],[{key:"create",value:function(){return o.Pool.getItemByClass("HTMLChar",t)}}]),t}();e.HTMLChar=l,l._isWordRegExp=new RegExp("[\\w.]","")},34277:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HalfFloatUtils=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"__init__",value:function(){for(var e=0;e<256;++e){var i=e-127;i<-27?(t._baseTable[0|e]=0,t._baseTable[256|e]=32768,t._shiftTable[0|e]=24,t._shiftTable[256|e]=24):i<-14?(t._baseTable[0|e]=1024>>-i-14,t._baseTable[256|e]=1024>>-i-14|32768,t._shiftTable[0|e]=-i-1,t._shiftTable[256|e]=-i-1):i<=15?(t._baseTable[0|e]=i+15<<10,t._baseTable[256|e]=i+15<<10|32768,t._shiftTable[0|e]=13,t._shiftTable[256|e]=13):i<128?(t._baseTable[0|e]=31744,t._baseTable[256|e]=64512,t._shiftTable[0|e]=24,t._shiftTable[256|e]=24):(t._baseTable[0|e]=31744,t._baseTable[256|e]=64512,t._shiftTable[0|e]=13,t._shiftTable[256|e]=13)}for(t._mantissaTable[0]=0,e=1;e<1024;++e){var n=e<<13;for(i=0;0==(8388608&n);)i-=8388608,n<<=1;n&=-8388609,i+=947912704,t._mantissaTable[e]=n|i}for(e=1024;e<2048;++e)t._mantissaTable[e]=939524096+(e-1024<<13);for(t._exponentTable[0]=0,e=1;e<31;++e)t._exponentTable[e]=e<<23;for(t._exponentTable[31]=1199570944,t._exponentTable[32]=2147483648,e=33;e<63;++e)t._exponentTable[e]=2147483648+(e-32<<23);for(t._exponentTable[63]=3347054592,t._offsetTable[0]=0,e=1;e<64;++e)t._offsetTable[e]=32===e?0:1024}},{key:"roundToFloat16Bits",value:function(e){t._floatView[0]=e;var i=t._uint32View[0],n=i>>23&511;return t._baseTable[n]+((8388607&i)>>t._shiftTable[n])}},{key:"convertToNumber",value:function(e){var i=e>>10;return t._uint32View[0]=t._mantissaTable[t._offsetTable[i]+(1023&e)]+t._exponentTable[i],t._floatView[0]}}]),t}();e.HalfFloatUtils=o,o._buffer=new ArrayBuffer(4),o._floatView=new Float32Array(o._buffer),o._uint32View=new Uint32Array(o._buffer),o._baseTable=new Uint32Array(512),o._shiftTable=new Uint32Array(512),o._mantissaTable=new Uint32Array(2048),o._exponentTable=new Uint32Array(64),o._offsetTable=new Uint32Array(64)},41107:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Handler=void 0;var r=a(i(77766)),s=a(i(15375)),o=a(i(17061)),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,s.default)(this,t),this.once=!1,this._id=0,this.setTo(e,i,n,a)}return(0,o.default)(t,[{key:"setTo",value:function(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this._id=t._gid++,this.caller=e,this.method=i,this.args=n,this.once=a,this}},{key:"run",value:function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e}},{key:"runWith",value:function(t){var e;if(null==this.method)return null;var i=this._id;if(null==t)var n=this.method.apply(this.caller,this.args);else n=this.args||t.unshift?this.args?this.method.apply(this.caller,(0,r.default)(e=this.args).call(e,t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===i&&this.once&&this.recover(),n}},{key:"clear",value:function(){return this.caller=null,this.method=null,this.args=null,this}},{key:"recover",value:function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))}}],[{key:"create",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return t._pool.length?t._pool.pop().setTo(e,i,n,a):new t(e,i,n,a)}}]),t}();e.Handler=l,l._pool=[],l._gid=1},71706:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.HitArea=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(85399),l=i(98693),u=i(92493),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"contains",value:function(e,i){return!!t._isHitGraphic(e,i,this.hit)&&!t._isHitGraphic(e,i,this.unHit)}},{key:"hit",get:function(){return this._hit||(this._hit=new u.ILaya.Graphics),this._hit},set:function(t){this._hit=t}},{key:"unHit",get:function(){return this._unHit||(this._unHit=new u.ILaya.Graphics),this._unHit},set:function(t){this._unHit=t}}],[{key:"_isHitGraphic",value:function(e,i,n){if(!n)return!1;var a,r,s,o=n.cmds;if(!o&&n._one&&((o=t._cmds).length=1,o[0]=n._one),!o)return!1;for(r=o.length,a=0;a<r;a++)if(s=o[a]){if("Translate"===s.cmdID)e-=s.tx,i-=s.ty;if(t._isHitCmd(e,i,s))return!0}return!1}},{key:"_isHitCmd",value:function(e,i,n){if(!n)return!1;var a=!1;switch(n.cmdID){case"DrawRect":t._rect.setTo(n.x,n.y,n.width,n.height),a=t._rect.contains(e,i);break;case"DrawCircle":a=(e-=n.x)*e+(i-=n.y)*i<n.radius*n.radius;break;case"DrawPoly":e-=n.x,i-=n.y,a=t._ptInPolygon(e,i,n.points)}return a}},{key:"_ptInPolygon",value:function(e,i,n){var a=t._ptPoint;a.setTo(e,i);var r,s,o,l,u,h=0;u=n.length;for(var c=0;c<u;c+=2){if(r=n[c],s=n[c+1],o=n[(c+2)%u],s!=(l=n[(c+3)%u]))if(!(a.y<Math.min(s,l)))if(!(a.y>=Math.max(s,l)))(a.y-s)*(o-r)/(l-s)+r>a.x&&h++}return h%2==1}}]),t}();e.HitArea=h,h._cmds=[],h._rect=new l.Rectangle,h._ptPoint=new o.Point},82671:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.IStatRender=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"show",value:function(){}},{key:"enable",value:function(){}},{key:"hide",value:function(){}},{key:"set_onclick",value:function(t){}},{key:"isCanvasRender",value:function(){return!0}},{key:"renderNotCanvas",value:function(t,e,i){}}]),t}();e.IStatRender=o},32996:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Mouse=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(93568),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"cursor",get:function(){return t._style.cursor},set:function(e){t._style.cursor=e}},{key:"__init__",value:function(){t._style=o.Browser.document.body.style}},{key:"hide",value:function(){"none"!=t.cursor&&(t._preCursor=t.cursor,t.cursor="none")}},{key:"show",value:function(){"none"==t.cursor&&(t._preCursor?t.cursor=t._preCursor:t.cursor="auto")}}]),t}();e.Mouse=l},23877:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.PerformancePlugin=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"setPerformanceDataTool",value:function(t){this.performanceTool=t}},{key:"begainSample",value:function(t){this.performanceTool&&this.performanceTool.enable&&this.performanceTool.BegainSample(t)}},{key:"endSample",value:function(t){return this.performanceTool&&this.performanceTool.enable?this.performanceTool.EndSample(t):0}},{key:"expoertFile",value:function(t){if(this.performanceTool)return this.performanceTool.enable?this.performanceTool.exportPerformanceFile():null}},{key:"showFunSampleFun",value:function(t){this.performanceTool.showFunSampleFun(t)}},{key:"enable",get:function(){return!!this.performanceTool&&this._enable},set:function(t){this.performanceTool&&(this.performanceTool.enable=t)}},{key:"enableDataExport",get:function(){return!!this.performanceTool&&this.performanceTool.enableDataExport},set:function(t){this.performanceTool&&(this.performanceTool.enableDataExport=t)}}]),t}();e.PerformancePlugin=o,o.performanceTool=null,o._enable=!1,o.PERFORMANCE_LAYA="Laya",o.PERFORMANCE_LAYA_3D="Laya/3D",o.PERFORMANCE_LAYA_2D="Laya/2D",o.PERFORMANCE_LAYA_3D_PRERENDER="Laya/3D/PreRender",o.PERFORMANCE_LAYA_3D_UPDATESCRIPT="Laya/3D/UpdateScript",o.PERFORMANCE_LAYA_3D_PHYSICS="Laya/3D/Physics",o.PERFORMANCE_LAYA_3D_PHYSICS_SIMULATE="Laya/3D/Physics/simulate",o.PERFORMANCE_LAYA_3D_PHYSICS_CHARACTORCOLLISION="Laya/3D/Physics/updataCharacters&Collisions",o.PERFORMANCE_LAYA_3D_PHYSICS_EVENTSCRIPTS="Laya/3D/Physics/eventScripts",o.PERFORMANCE_LAYA_3D_RENDER="Laya/3D/Render",o.PERFORMANCE_LAYA_3D_RENDER_SHADOWMAP="Laya/3D/Render/ShadowMap",o.PERFORMANCE_LAYA_3D_RENDER_CLUSTER="Laya/3D/Render/Cluster",o.PERFORMANCE_LAYA_3D_RENDER_CULLING="Laya/3D/Render/Culling",o.PERFORMANCE_LAYA_3D_RENDER_RENDERDEPTHMDOE="Laya/3D/Render/RenderDepthMode",o.PERFORMANCE_LAYA_3D_RENDER_RENDEROPAQUE="Laya/3D/Render/RenderOpaque",o.PERFORMANCE_LAYA_3D_RENDER_RENDERCOMMANDBUFFER="Laya/3D/Render/RenderCommandBuffer",o.PERFORMANCE_LAYA_3D_RENDER_RENDERTRANSPARENT="Laya/3D/Render/RenderTransparent",o.PERFORMANCE_LAYA_3D_RENDER_POSTPROCESS="Laya/3D/Render/PostProcess",window.PerformancePlugin=o},64210:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Pool=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getPoolBySign",value:function(e){return t._poolDic[e]||(t._poolDic[e]=[])}},{key:"clearBySign",value:function(e){t._poolDic[e]&&(t._poolDic[e].length=0)}},{key:"recover",value:function(e,i){i[t.POOLSIGN]||(i[t.POOLSIGN]=!0,t.getPoolBySign(e).push(i))}},{key:"recoverByClass",value:function(e){if(e){var i=e.__className||e.constructor._$gid;i&&t.recover(i,e)}}},{key:"_getClassSign",value:function(e){var i=e.__className||e._$gid;return i||(e._$gid=i=t._CLSID+"",t._CLSID++),i}},{key:"createByClass",value:function(e){return t.getItemByClass(t._getClassSign(e),e)}},{key:"getItemByClass",value:function(e,i){if(!t._poolDic[e])return new i;var n=t.getPoolBySign(e);if(n.length){var a=n.pop();a[t.POOLSIGN]=!1}else a=new i;return a}},{key:"getItemByCreateFun",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.getPoolBySign(e),r=a.length?a.pop():i.call(n);return r[t.POOLSIGN]=!1,r}},{key:"getItem",value:function(e){var i=t.getPoolBySign(e),n=i.length?i.pop():null;return n&&(n[t.POOLSIGN]=!1),n}}]),t}();e.Pool=o,o._CLSID=0,o.POOLSIGN="__InPool",o._poolDic={}},14400:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.RunDriver=void 0;var r=a(i(15375)),s=i(62285),o=function t(){(0,r.default)(this,t)};e.RunDriver=o,o.createShaderCondition=function(t){var e="(function() {return "+t+";})";return window.Laya._runScript(e)},o.changeWebGLSize=function(t,e){s.WebGL.onStageResize(t,e)}},21383:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SceneUtils=void 0;var r=a(i(81643)),s=a(i(15375)),o=a(i(17061)),l=i(64210),u=i(13407),h=i(42255),c=i(24288),d=i(54190),f=i(76006),_=i(85096),v=i(41107),y=i(92493),p=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"__init",value:function(){t._funMap=new f.WeakObject}},{key:"getBindFun",value:function(e){var i=t._funMap.get(e);if(null==i){var n='"'+e+'"',a="(function(data){if(data==null)return;with(data){try{\nreturn "+(n=n.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";i=window.Laya._runScript(a),t._funMap.set(e,i)}return i}},{key:"createByData",value:function(e,i){var n=m.create();if((e=t.createComp(i,e,e,null,n))._setBit(u.Const.NOT_READY,!0),"_idMap"in e&&(e._idMap=n._idMap),i.animations){var a,r,s,o=[],l=i.animations,h=l.length;for(a=0;a<h;a++){switch(r=new c.FrameAnimation,s=l[a],r._setUp(n._idMap,s),e[s.name]=r,r._setControlNode(e),s.action){case 1:r.play(0,!1);break;case 2:r.play(0,!0)}o.push(r)}e._aniList=o}return"Scene"===e._$componentType&&e._width>0&&null==i.props.hitTestPrior&&!e.mouseThrough&&(e.hitTestPrior=!0),n.beginLoad(e),e}},{key:"createInitTool",value:function(){return m.create()}},{key:"createComp",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("Scene3D"==e.type||"Sprite3D"==e.type){var o=[],l=y.ILaya.Laya.Utils3D._createSceneByJsonForMaker(e,o,s);return"Sprite3D"==e.type?y.ILaya.Laya.StaticBatchManager.combine(l,o):y.ILaya.Laya.StaticBatchManager.combine(null,o),l}if(!(i=i||t.getCompInstance(e)))return e.props&&e.props.runtime?console.warn("runtime not found:"+e.props.runtime):console.warn("can not create:"+e.type),null;var u=e.child;if(u)for(var c="List"==i._$componentType,f=0,_=u.length;f<_;f++){var v=u[f];if(!("itemRender"in i)||"render"!=v.props.name&&"render"!==v.props.renderType)if("Graphic"==v.type)y.ILaya.ClassUtils._addGraphicsToSprite(v,i);else if(y.ILaya.ClassUtils._isDrawType(v.type))y.ILaya.ClassUtils._addGraphicToSprite(v,i,!0);else{if(c){var p=[],g=t.createComp(v,null,n,p,s);p.length&&(g._$bindData=p)}else g=t.createComp(v,null,n,a,s);"Script"==v.type?g instanceof h.Component?i._addComponentInstance(g):"owner"in g?g.owner=i:"target"in g&&(g.target=i):"mask"==v.props.renderType||"mask"==v.props.name?i.mask=g:g instanceof d.Node&&i.addChild(g)}else i.itemRender=v}var m=e.props;for(var x in m){var T=m[x];"string"==typeof T&&((0,r.default)(T).call(T,"@node:")>=0||(0,r.default)(T).call(T,"@Prefab:")>=0)?s&&s.addNodeRef(i,x,T):t.setCompValue(i,x,T,n,a)}return i._afterInited&&i._afterInited(),e.compId&&s&&s._idMap&&(s._idMap[e.compId]=i),i}},{key:"setCompValue",value:function(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("string"==typeof n&&(0,r.default)(n).call(n,"${")>-1){if(t._sheet||(t._sheet=y.ILaya.ClassUtils.getClass("laya.data.Table")),!t._sheet)return void console.warn("Can not find class Sheet");if(s)s.push(e,i,n);else if(a){-1==(0,r.default)(n).call(n,"].")&&(n=n.replace(".","[0]."));var o,l,u=new g(e,i,n);u.exe(a);for(var h=n.replace(/\[.*?\]\./g,".");null!=(o=t._parseWatchData.exec(h));){for(var c=o[1];null!=(l=t._parseKeyWord.exec(c));){var d=l[0],f=a._watchMap[d]||(a._watchMap[d]=[]);f.push(u),t._sheet.I.notifer.on(d,a,a.changeData,[d])}(f=a._watchMap[c]||(a._watchMap[c]=[])).push(u),t._sheet.I.notifer.on(c,a,a.changeData,[c])}}}else"var"===i&&a?a[n]=e:e[i]="true"===n||"false"!==n&&n}},{key:"getCompInstance",value:function(e){if("UIView"==e.type&&e.props&&e.props.pageData)return t.createByData(null,e.props.pageData);var i=e.props&&e.props.runtime||e.type,n=y.ILaya.ClassUtils.getClass(i);if(!n)throw"Can not find class "+i;if("Script"===e.type&&n.prototype._doAwake){var a=l.Pool.createByClass(n);return a._destroyed=!1,a}return e.props&&"renderType"in e.props&&"instance"==e.props.renderType?(n.instance||(n.instance=new n),n.instance):new n}}]),t}();e.SceneUtils=p,p._parseWatchData=/\${(.*?)}/g,p._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;var g=function(){function t(e,i,n){(0,s.default)(this,t),this.comp=e,this.prop=i,this.value=n}return(0,o.default)(t,[{key:"exe",value:function(t){var e=p.getBindFun(this.value);this.comp[this.prop]=e.call(this,t)}}]),t}(),m=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,[{key:"reset",value:function(){this._nodeRefList=null,this._initList=null,this._idMap=null,this._loadList=null,this._scene=null}},{key:"recover",value:function(){this.reset(),l.Pool.recover("InitTool",this)}},{key:"addLoadRes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._loadList||(this._loadList=[]),y.ILaya.loader.getRes(t)||(e?this._loadList.push({url:t,type:e}):this._loadList.push(t))}},{key:"addNodeRef",value:function(t,e,i){this._nodeRefList||(this._nodeRefList=[]),this._nodeRefList.push([t,e,i]),(0,r.default)(i).call(i,"@Prefab:")>=0&&this.addLoadRes(i.replace("@Prefab:",""),_.Loader.PREFAB)}},{key:"setNodeRef",value:function(){if(this._nodeRefList)if(this._idMap){var t,e,i;for(e=this._nodeRefList.length,t=0;t<e;t++)(i=this._nodeRefList[t])[0][i[1]]=this.getReferData(i[2]);this._nodeRefList=null}else this._nodeRefList=null}},{key:"getReferData",value:function(t){if((0,r.default)(t).call(t,"@Prefab:")>=0)return _.Loader.getRes(t.replace("@Prefab:",""));if((0,r.default)(t).call(t,"@arr:")>=0){var e,i,n,a;for(n=(e=(t=t.replace("@arr:","")).split(",")).length,i=0;i<n;i++)a=e[i],e[i]=a?this._idMap[a.replace("@node:","")]:null;return e}return this._idMap[t.replace("@node:","")]}},{key:"addInitItem",value:function(t){this._initList||(this._initList=[]),this._initList.push(t)}},{key:"doInits",value:function(){this._initList&&(this._initList=null)}},{key:"finish",value:function(){this.setNodeRef(),this.doInits(),this._scene._setBit(u.Const.NOT_READY,!1),this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._processActive(),this._scene.event("onViewCreated"),this.recover()}},{key:"beginLoad",value:function(t){this._scene=t,!this._loadList||this._loadList.length<1?this.finish():y.ILaya.loader.load(this._loadList,v.Handler.create(this,this.finish))}}],[{key:"create",value:function(){var e=l.Pool.getItemByClass("InitTool",t);return e._idMap={},e}}]),t}()},683:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Stat=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t._StatRender.show(e,i)}},{key:"enable",value:function(){t._StatRender.enable()}},{key:"hide",value:function(){t._StatRender.hide()}},{key:"clear",value:function(){t.trianglesFaces=t.renderBatches=t.savedRenderBatches=t.shaderCall=t.spriteRenderUseCacheCount=t.frustumCulling=t.octreeNodeCulling=t.canvasNormal=t.canvasBitmap=t.canvasReCache=0}},{key:"onclick",set:function(e){t._StatRender.set_onclick(e)}}]),t}();e.Stat=o,o.FPS=0,o.loopCount=0,o.shaderCall=0,o.renderBatches=0,o.savedRenderBatches=0,o.trianglesFaces=0,o.spriteCount=0,o.spriteRenderUseCacheCount=0,o.frustumCulling=0,o.octreeNodeCulling=0,o.canvasNormal=0,o.canvasBitmap=0,o.canvasReCache=0,o.renderSlow=!1,o._fpsData=[],o._timer=0,o._count=0,o._StatRender=null},14334:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.StatUI=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(82671),d=i(93568),f=i(78362),_=i(81870),v=i(85136),y=i(26776),p=i(25883),g=i(683),m=i(92493);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var T=function(t){(0,l.default)(i,t);var e=x(i);function i(){var t;return(0,s.default)(this,i),(t=e.apply(this,arguments))._show=!1,t._useCanvas=!1,t._height=100,t._view=[],t}return(0,o.default)(i,[{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;g.Stat;d.Browser._isMiniGame||m.ILaya.Render.isConchApp||(this._useCanvas=!0),this._show=!0,g.Stat._fpsData.length=60,this._view[0]={title:"FPS(WebGL)",value:"_fpsStr",color:"yellow",units:"int"},this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"},this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"},this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"},this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"},this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"},this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"},v.Render.is3DMode&&(this._view[0].title="FPS(3D)",this._view[8]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},this._view[9]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"},this._view[10]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}),this._useCanvas?this.createUIPre(t,e):this.createUI(t,e),this.enable()}},{key:"createUIPre",value:function(t,e){var n=d.Browser.pixelRatio;this._width=180*n,this._vx=120*n,this._height=n*(12*this._view.length+3*n)+4,i._fontSize=12*n;for(var a=0;a<this._view.length;a++)this._view[a].x=4,this._view[a].y=a*i._fontSize+2*n;this._canvas||(this._canvas=new y.HTMLCanvas(!0),this._canvas.size(this._width,this._height),this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="top",this._ctx.font=i._fontSize+"px Arial",this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+e+"px;width:"+this._width/n+"px;height:"+this._height/n+"px;"),d.Browser.onKGMiniGame||d.Browser.container.appendChild(this._canvas.source),this._first=!0,this.loop(),this._first=!1}},{key:"createUI",value:function(t,e){var n=this._sp,a=d.Browser.pixelRatio;n||(n=new f.Sprite,this._leftText=new _.Text,this._leftText.pos(5,5),this._leftText.color="#ffffff",n.addChild(this._leftText),this._txt=new _.Text,this._txt.pos(130*a,5),this._txt.color="#ffffff",n.addChild(this._txt),this._sp=n),n.pos(t,e);for(var r="",s=0;s<this._view.length;s++){r+=this._view[s].title+"\n"}this._leftText.text=r;var o=138*a,l=a*(12*this._view.length+3*a)+4;this._txt.fontSize=i._fontSize*a,this._leftText.fontSize=i._fontSize*a,n.size(o,l),n.graphics.clear(),n.graphics.alpha(.5),n.graphics.drawRect(0,0,o+110,l+30,"#999999"),n.graphics.alpha(2),this.loop()}},{key:"enable",value:function(){m.ILaya.systemTimer.frameLoop(1,this,this.loop)}},{key:"hide",value:function(){this._show=!1,m.ILaya.systemTimer.clear(this,this.loop),this._canvas&&d.Browser.removeElement(this._canvas.source)}},{key:"set_onclick",value:function(t){this._sp&&this._sp.on("click",this._sp,t),this._canvas&&(this._canvas.source.onclick=t,this._canvas.source.style.pointerEvents="")}},{key:"loop",value:function(){g.Stat._count++;var t=d.Browser.now();if(!(t-g.Stat._timer<1e3)){var e=g.Stat._count;if(g.Stat.FPS=Math.round(1e3*e/(t-g.Stat._timer)),this._show){g.Stat.trianglesFaces=Math.round(g.Stat.trianglesFaces/e),this._useCanvas?g.Stat.renderBatches=Math.round(g.Stat.renderBatches/e):g.Stat.renderBatches=Math.round(g.Stat.renderBatches/e)-1,g.Stat.savedRenderBatches=Math.round(g.Stat.savedRenderBatches/e),g.Stat.shaderCall=Math.round(g.Stat.shaderCall/e),g.Stat.spriteRenderUseCacheCount=Math.round(g.Stat.spriteRenderUseCacheCount/e),g.Stat.canvasNormal=Math.round(g.Stat.canvasNormal/e),g.Stat.canvasBitmap=Math.round(g.Stat.canvasBitmap/e),g.Stat.canvasReCache=Math.ceil(g.Stat.canvasReCache/e),g.Stat.frustumCulling=Math.round(g.Stat.frustumCulling/e),g.Stat.octreeNodeCulling=Math.round(g.Stat.octreeNodeCulling/e);var i=g.Stat.FPS>0?Math.floor(1e3/g.Stat.FPS).toString():" ";g.Stat._fpsStr=g.Stat.FPS+(g.Stat.renderSlow?" slow":"")+" "+i,g.Stat._spriteStr=g.Stat.spriteCount+(g.Stat.spriteRenderUseCacheCount?"/"+g.Stat.spriteRenderUseCacheCount:""),g.Stat._canvasStr=g.Stat.canvasReCache+"/"+g.Stat.canvasNormal+"/"+g.Stat.canvasBitmap,g.Stat.cpuMemory=p.Resource.cpuMemory,g.Stat.gpuMemory=p.Resource.gpuMemory,this._useCanvas?this.renderInfoPre():this.renderInfo(),g.Stat.clear()}g.Stat._count=0,g.Stat._timer=t}}},{key:"renderInfoPre",value:function(){var t,e,i=0;if(this._canvas){var n=this._ctx;for(n.clearRect(this._first?0:this._vx,0,this._width,this._height),i=0;i<this._view.length;i++)t=this._view[i],this._first&&(n.fillStyle="white",n.fillText(t.title,t.x,t.y)),n.fillStyle=t.color,e=g.Stat[t.value],"M"==t.units&&(e=Math.floor(e/1048576*100)/100+" M"),n.fillText(e+"",t.x+this._vx,t.y)}}},{key:"renderInfo",value:function(){for(var t="",e=0;e<this._view.length;e++){var i=this._view[e],n=g.Stat[i.value];"M"==i.units&&(n=Math.floor(n/1048576*100)/100+" M"),"K"==i.units&&(n=Math.floor(n/1024*100)/100+" K"),t+=n+"\n"}this._txt.text=t}},{key:"isCanvasRender",value:function(){return this._useCanvas}},{key:"renderNotCanvas",value:function(t,e,i){this._show&&this._sp&&this._sp.render(t,0,0)}}]),i}(c.IStatRender);e.StatUI=T,T._fontSize=12},61791:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.StringKey=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t),this._strsToID={},this._idToStrs=[],this._length=0}return(0,s.default)(t,[{key:"add",value:function(t){var e=this._strsToID[t];return null!=e?e:(this._idToStrs[this._length]=t,this._strsToID[t]=this._length++)}},{key:"getID",value:function(t){var e=this._strsToID[t];return null==e?-1:e}},{key:"getName",value:function(t){var e=this._idToStrs[t];return null==e?void 0:e}}]),t}();e.StringKey=o},52842:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Timer=void 0;var r=a(i(11128)),s=a(i(39291)),o=a(i(15375)),l=a(i(17061)),u=i(38022),h=i(92493),c=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,o.default)(this,t),this.scale=1,this.currTimer=(0,r.default)(),this.currFrame=0,this._delta=0,this._lastTimer=(0,r.default)(),this._map={},this._handlers=[],this._temp=[],this._count=0,e&&t.gSysTimer&&t.gSysTimer.frameLoop(1,this,this._update)}return(0,l.default)(t,[{key:"delta",get:function(){return this._delta}},{key:"_update",value:function(){if(this.scale<=0)return this._lastTimer=(0,r.default)(),void(this._delta=0);var t=this.currFrame=this.currFrame+this.scale,e=(0,r.default)(),i=e-this._lastTimer>3e4;this._delta=(e-this._lastTimer)*this.scale;var n=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var a=this._handlers;this._count=0;for(var o=0,l=a.length;o<l;o++){var u=a[o];if(null!==u.method){var h=u.userFrame?t:n;if(h>=u.exeTime)if((0,s.default)(u))if(!u.jumpFrame||i)u.exeTime+=u.delay,u.run(!1),h>u.exeTime&&(u.exeTime+=Math.ceil((h-u.exeTime)/u.delay)*u.delay);else for(;h>=u.exeTime;)u.exeTime+=u.delay,u.run(!1);else u.run(!0)}else this._count++}(this._count>30||t%200==0)&&this._clearHandlers()}},{key:"_clearHandlers",value:function(){for(var t=this._handlers,e=0,i=t.length;e<i;e++){var n=t[e];null!==n.method?this._temp.push(n):this._recoverHandler(n)}this._handlers=this._temp,t.length=0,this._temp=t}},{key:"_recoverHandler",value:function(e){this._map[e.key]==e&&(this._map[e.key]=null),e.clear(),t._pool.push(e)}},{key:"_create",value:function(e,i,n,a,s,o,l){if(!n)return s.apply(a,o),null;if(l){var u=this._getHandler(a,s);if(u)return u.repeat=i,u.userFrame=e,u.delay=n,u.caller=a,u.method=s,u.args=o,u.exeTime=n+(e?this.currFrame:this.currTimer+(0,r.default)()-this._lastTimer),u}return(u=t._pool.length>0?t._pool.pop():new d).repeat=i,u.userFrame=e,u.delay=n,u.caller=a,u.method=s,u.args=o,u.exeTime=n+(e?this.currFrame:this.currTimer+(0,r.default)()-this._lastTimer),this._indexHandler(u),this._handlers.push(u),u}},{key:"_indexHandler",value:function(e){var i=e.caller,n=e.method,a=i?i.$_GID||(i.$_GID=h.ILaya.Utils.getGID()):0,r=n.$_TID||(n.$_TID=t._mid++);e.key=a+"_"+r,this._map[e.key]=e}},{key:"once",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!1,!1,t,e,i,n,a)}},{key:"loop",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=this._create(!1,!0,t,e,i,n,a);s&&(s.jumpFrame=r)}},{key:"frameOnce",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!0,!1,t,e,i,n,a)}},{key:"frameLoop",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!0,!0,t,e,i,n,a)}},{key:"toString",value:function(){return" handlers:"+this._handlers.length+" pool:"+t._pool.length}},{key:"clear",value:function(t,e){var i=this._getHandler(t,e);i&&(this._map[i.key]=null,i.key="",i.clear())}},{key:"clearAll",value:function(t){if(t)for(var e=0,i=this._handlers.length;e<i;e++){var n=this._handlers[e];n.caller===t&&(this._map[n.key]=null,n.key="",n.clear())}}},{key:"_getHandler",value:function(e,i){var n=(e?e.$_GID||(e.$_GID=h.ILaya.Utils.getGID()):0)+"_"+(i.$_TID||(i.$_TID=t._mid++));return this._map[n]}},{key:"callLater",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;u.CallLater.I.callLater(t,e,i)}},{key:"runCallLater",value:function(t,e){u.CallLater.I.runCallLater(t,e)}},{key:"runTimer",value:function(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(!0))}},{key:"pause",value:function(){this.scale=0}},{key:"resume",value:function(){this.scale=1}}]),t}();e.Timer=c,c.gSysTimer=null,c._pool=[],c._mid=1;var d=function(){function t(){(0,o.default)(this,t)}return(0,l.default)(t,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var i=this.method,n=this.args;t&&this.clear(),null!=i&&(n?i.apply(e,n):i.call(e))}}]),t}()},84221:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Tween=void 0;var r=a(i(39291)),s=a(i(92762)),o=a(i(15375)),l=a(i(17061)),u=i(64210),h=i(93568),c=i(56083),d=i(92493),f=function(){function t(){(0,o.default)(this,t),this.gid=0,this.repeat=1,this._count=0}return(0,l.default)(t,[{key:"to",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this._create(t,e,i,n,a,r,s,!0,!1,!0)}},{key:"from",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this._create(t,e,i,n,a,r,s,!1,!1,!0)}},{key:"_create",value:function(e,i,n,a,r,s,o,l,u,f){if(!e)throw new Error("Tween:target is null");this._target=e,this._duration=n,this._ease=a||i.ease||t.easeNone,this._complete=r||i.complete,this._delay=s,this._props=[],this._usedTimer=0,this._startTimer=h.Browser.now(),this._usedPool=u,this._delayParam=null,this.update=i.update;var _=e.$_GID||(e.$_GID=c.Utils.getGID());return t.tweenMap[_]?(o&&t.clearTween(e),t.tweenMap[_].push(this)):t.tweenMap[_]=[this],f?s<=0?this.firstStart(e,i,l):(this._delayParam=[e,i,l],d.ILaya.timer.once(s,this,this.firstStart,this._delayParam)):this._initProps(e,i,l),this}},{key:"firstStart",value:function(t,e,i){this._delayParam=null,t.destroyed?this.clear():(this._initProps(t,e,i),this._beginLoop())}},{key:"_initProps",value:function(t,e,i){for(var n in e)if("number"==typeof t[n]){var a=i?t[n]:e[n],r=i?e[n]:t[n];this._props.push([n,a,r-a]),i||(t[n]=a)}}},{key:"_beginLoop",value:function(){d.ILaya.timer.frameLoop(1,this,this._doEase)}},{key:"_doEase",value:function(){this._updateEase(h.Browser.now())}},{key:"_updateEase",value:function(e){var i=this._target;if(i){if(i.destroyed)return t.clearTween(i);var n=this._usedTimer=e-this._startTimer-this._delay;if(!(n<0)){if(n>=this._duration)return this.complete();for(var a=n>0?this._ease(n,0,1,this._duration):0,r=this._props,s=0,o=r.length;s<o;s++){var l=r[s];i[l[0]]=l[1]+a*l[2]}this.update&&this.update.run()}}}},{key:"progress",set:function(t){var e=t*this._duration;this._startTimer=h.Browser.now()-this._delay-e}},{key:"complete",value:function(){if(this._target){d.ILaya.timer.runTimer(this,this.firstStart);for(var t=this._target,e=this._props,i=this._complete,n=0,a=e.length;n<a;n++){var s=e[n];t[s[0]]=s[1]+s[2]}this.update&&this.update.run(),this._count++,0!=(0,r.default)(this)&&this._count>=(0,r.default)(this)?(this.clear(),i&&i.run()):this.restart()}}},{key:"pause",value:function(){var t;d.ILaya.timer.clear(this,this._beginLoop),d.ILaya.timer.clear(this,this._doEase),d.ILaya.timer.clear(this,this.firstStart),(t=h.Browser.now()-this._startTimer-this._delay)<0&&(this._usedTimer=t)}},{key:"setStartTime",value:function(t){this._startTimer=t}},{key:"clear",value:function(){this._target&&(this._remove(),this._clear())}},{key:"_clear",value:function(){this.pause(),d.ILaya.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this.repeat=1,this._usedPool&&(this.update=null,u.Pool.recover("tween",this))}},{key:"recover",value:function(){this._usedPool=!0,this._clear()}},{key:"_remove",value:function(){var e=t.tweenMap[this._target.$_GID];if(e)for(var i=0,n=e.length;i<n;i++)if(e[i]===this){(0,s.default)(e).call(e,i,1);break}}},{key:"restart",value:function(){if(this.pause(),this._usedTimer=0,this._startTimer=h.Browser.now(),this._delayParam)d.ILaya.timer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var t=this._props,e=0,i=t.length;e<i;e++){var n=t[e];this._target[n[0]]=n[1]}d.ILaya.timer.once(this._delay,this,this._beginLoop)}}},{key:"resume",value:function(){this._usedTimer>=this._duration||(this._startTimer=h.Browser.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?d.ILaya.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())}}],[{key:"to",value:function(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return u.Pool.getItemByClass("tween",t)._create(e,i,n,a,r,s,o,!0,l,!0)}},{key:"from",value:function(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return u.Pool.getItemByClass("tween",t)._create(e,i,n,a,r,s,o,!1,l,!0)}},{key:"clearAll",value:function(e){if(e&&e.$_GID){var i=t.tweenMap[e.$_GID];if(i){for(var n=0,a=i.length;n<a;n++)i[n]._clear();i.length=0}}}},{key:"clear",value:function(t){t.clear()}},{key:"clearTween",value:function(e){t.clearAll(e)}},{key:"easeNone",value:function(t,e,i,n){return i*t/n+e}}]),t}();e.Tween=f,f.tweenMap=[]},56083:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Utils=void 0;var r=a(i(54103)),s=a(i(94198)),o=a(i(23054)),l=a(i(81643)),u=a(i(15375)),h=a(i(17061)),c=i(85399),d=i(98693),f=i(92493),_=function(){function t(){(0,u.default)(this,t)}return(0,h.default)(t,null,[{key:"toRadian",value:function(e){return e*t._pi2}},{key:"toAngle",value:function(e){return e*t._pi}},{key:"toHexColor",value:function(t){if(t<0||isNaN(t))return null;for(var e=t.toString(16);e.length<6;)e="0"+e;return"#"+e}},{key:"getGID",value:function(){return t._gid++}},{key:"concatArray",value:function(t,e){if(!e)return t;if(!t)return e;var i,n=e.length;for(i=0;i<n;i++)t.push(e[i]);return t}},{key:"clearArray",value:function(t){return t?(t.length=0,t):t}},{key:"copyArray",value:function(t,e){if(t||(t=[]),!e)return t;t.length=e.length;var i,n=e.length;for(i=0;i<n;i++)t[i]=e[i];return t}},{key:"getGlobalRecByPoints",value:function(t,e,i,n,a){var r,s;r=c.Point.create().setTo(e,i),r=t.localToGlobal(r),s=c.Point.create().setTo(n,a),s=t.localToGlobal(s);var o=d.Rectangle._getWrapRec([r.x,r.y,s.x,s.y]);return r.recover(),s.recover(),o}},{key:"getGlobalPosAndScale",value:function(e){return t.getGlobalRecByPoints(e,0,0,1,1)}},{key:"bind",value:function(t,e){return(0,r.default)(t).call(t,e)}},{key:"updateOrder",value:function(t){if(!t||t.length<2)return!1;for(var e,i,n,a=1,r=t.length;a<r;){for(n=t[e=a],i=t[e]._zOrder;--e>-1&&t[e]._zOrder>i;)t[e+1]=t[e];t[e+1]=n,a++}return!0}},{key:"transPointList",value:function(t,e,i){var n,a=t.length;for(n=0;n<a;n+=2)t[n]+=e,t[n+1]+=i}},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(0,s.default)(t,e);return isNaN(i)?0:i}))},{key:"getFileExtension",value:function(e){t._extReg.lastIndex=(0,o.default)(e).call(e,".");var i=t._extReg.exec(e);return i&&i.length>1?i[1].toLowerCase():null}},{key:"getFilecompatibleExtension",value:function(t){var e=t.split("."),i=e.length;return e.length>2?e[i-2]+"."+e[i-1]:null}},{key:"getTransformRelativeToWindow",value:function(e,i,n){var a=t.gStage,r=t.getGlobalPosAndScale(e),s=a._canvasTransform.clone(),o=s.tx,l=s.ty;s.rotate(-Math.PI/180*a.canvasDegree),s.scale(a.clientScaleX,a.clientScaleY);var u,h,c,d,f=a.canvasDegree%180!=0;return f?(u=n+r.y,h=i+r.x,u*=s.d,h*=s.a,90==a.canvasDegree?(u=o-u,h+=l):(u+=o,h=l-h)):(u=i+r.x,h=n+r.y,u*=s.a,h*=s.d,u+=o,h+=l),h+=a._safariOffsetY,f?(c=s.d*r.height,d=s.a*r.width):(c=s.a*r.width,d=s.d*r.height),{x:u,y:h,scaleX:c,scaleY:d}}},{key:"fitDOMElementInArea",value:function(e,i,n,a,r,s){e._fitLayaAirInitialized||(e._fitLayaAirInitialized=!0,e.style.transformOrigin=e.style.webKittransformOrigin="left top",e.style.position="absolute");var o=t.getTransformRelativeToWindow(i,n,a);e.style.transform=e.style.webkitTransform="scale("+o.scaleX+","+o.scaleY+") rotate("+t.gStage.canvasDegree+"deg)",e.style.width=r+"px",e.style.height=s+"px",e.style.left=o.x+"px",e.style.top=o.y+"px"}},{key:"isOkTextureList",value:function(t){if(!t)return!1;var e,i,n=t.length;for(e=0;e<n;e++)if(!(i=t[e])||!i._getSource())return!1;return!0}},{key:"isOKCmdList",value:function(t){if(!t)return!1;var e,i=t.length;for(e=0;e<i;e++)t[e];return!0}},{key:"getQueryString",value:function(t){if(f.ILaya.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null}}]),t}();e.Utils=_,_.gStage=null,_._gid=1,_._pi=180/Math.PI,_._pi2=Math.PI/180,_._extReg=/\.(\w+)\??/g,_.parseXMLFromString=function(t){var e,i;if(t=t.replace(/>\s+</g,"><"),i=(new DOMParser).parseFromString(t,"text/xml"),(0,l.default)(e=i.firstChild.textContent).call(e,"This page contains the following errors")>-1)throw new Error(i.firstChild.firstChild.textContent);return i}},25670:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.VectorGraphManager=void 0;var r=a(i(54103)),s=a(i(15375)),o=a(i(17061)),l=i(17939),u=function(){function t(){var e,i;(0,s.default)(this,t),this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],l.CacheManger.regCacheByFunction((0,r.default)(e=this.startDispose).call(e,this),(0,r.default)(i=this.getCacheList).call(i,this))}return(0,o.default)(t,[{key:"getId",value:function(){return this._id++}},{key:"addShape",value:function(t,e){this.shapeDic[t]=e,this.useDic[t]||(this.useDic[t]=!0)}},{key:"addLine",value:function(t,e){this.shapeLineDic[t]=e,this.shapeLineDic[t]||(this.shapeLineDic[t]=!0)}},{key:"getShape",value:function(t){this._checkKey&&null!=this.useDic[t]&&(this.useDic[t]=!0)}},{key:"deleteShape",value:function(t){this.shapeDic[t]&&(this.shapeDic[t]=null,delete this.shapeDic[t]),this.shapeLineDic[t]&&(this.shapeLineDic[t]=null,delete this.shapeLineDic[t]),null!=this.useDic[t]&&delete this.useDic[t]}},{key:"getCacheList",value:function(){var t,e=[];for(t in this.shapeDic)e.push(this.shapeDic[t]);for(t in this.shapeLineDic)e.push(this.shapeLineDic[t]);return e}},{key:"startDispose",value:function(t){var e;for(e in this.useDic)this.useDic[e]=!1;this._checkKey=!0}},{key:"endDispose",value:function(){if(this._checkKey){var t;for(t in this.useDic)this.useDic[t]||this.deleteShape(t);this._checkKey=!1}}}],[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}]),t}();e.VectorGraphManager=u},76006:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.WeakObject=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(56083),l=i(92493),u=function(){function t(){(0,r.default)(this,t),this._obj={},t._maps.push(this)}return(0,s.default)(t,[{key:"set",value:function(e,i){null!=e&&(t.supportWeakMap||("string"==typeof e||"number"==typeof e?this._obj[e]=i:(e.$_GID||(e.$_GID=o.Utils.getGID()),this._obj[e.$_GID]=i)))}},{key:"get",value:function(e){return null==e?null:t.supportWeakMap?void 0:"string"==typeof e||"number"==typeof e?this._obj[e]:this._obj[e.$_GID]}},{key:"del",value:function(e){null!=e&&(t.supportWeakMap||("string"==typeof e||"number"==typeof e?delete this._obj[e]:delete this._obj[this._obj.$_GID]))}},{key:"has",value:function(e){return null!=e&&(!t.supportWeakMap&&("string"==typeof e||"number"==typeof e?null!=this._obj[e]:null!=this._obj[this._obj.$_GID]))}}],[{key:"__init__",value:function(){t.I=new t,t.supportWeakMap||l.ILaya.systemTimer.loop(t.delInterval,null,t.clearCache)}},{key:"clearCache",value:function(){for(var e=0,i=t._maps.length;e<i;e++){t._maps[e]._obj={}}}}]),t}();e.WeakObject=u,u.supportWeakMap=!1,u.delInterval=6e5,u._maps=[]},80651:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.WordText=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t),this.save=[],this.toUpperCase=null,this.width=-1,this.pageChars=[],this.startID=0,this.startIDStroke=0,this.lastGCCnt=0,this.splitRender=!1,this.scalex=1,this.scaley=1}return(0,s.default)(t,[{key:"setText",value:function(t){this.changed=!0,this._text=t,this.width=-1,this.cleanCache()}},{key:"toString",value:function(){return this._text}},{key:"length",get:function(){return this._text?this._text.length:0}},{key:"charCodeAt",value:function(t){return this._text?this._text.charCodeAt(t):NaN}},{key:"charAt",value:function(t){return this._text?this._text.charAt(t):null}},{key:"cleanCache",value:function(){var t=this.pageChars;for(var e in t){var i=t[e],n=i.tex;1==i.words.length&&n&&n.ri&&n.destroy()}this.pageChars=[],this.startID=0,this.scalex=1,this.scaley=1}}]),t}();e.WordText=o},32488:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.BufferState2D=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305));function h(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var c=function(t){(0,o.default)(i,t);var e=h(i);function i(){return(0,s.default)(this,i),e.call(this)}return i}(i(5245).BufferStateBase);e.BufferState2D=c},5245:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BufferStateBase=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(33873),l=function(){function t(){(0,r.default)(this,t),this._nativeVertexArrayObject=o.LayaGL.layaGPUInstance.createVertexArray()}return(0,s.default)(t,[{key:"bind",value:function(){t._curBindedBufferState!==this&&(o.LayaGL.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this)}},{key:"unBind",value:function(){if(t._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";o.LayaGL.layaGPUInstance.bindVertexArray(null),t._curBindedBufferState=null}},{key:"destroy",value:function(){o.LayaGL.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject)}},{key:"bindForNative",value:function(){o.LayaGL.instance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this}},{key:"unBindForNative",value:function(){o.LayaGL.instance.bindVertexArray(null),t._curBindedBufferState=null}}]),t}();e.BufferStateBase=l},46996:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.LayaGPU=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(80340),l=i(92493),u=i(79782),h=i(86877),c=function(){function t(e,i){(0,r.default)(this,t),this._gl=null,this._vaoExt=null,this._angleInstancedArrays=null,this._isWebGL2=!1,this._oesTextureHalfFloat=null,this._oes_element_index_uint=null,this._oesTextureHalfFloatLinear=null,this._oesTextureFloat=null,this._extShaderTextureLod=null,this._extTextureFilterAnisotropic=null,this._compressedTextureS3tc=null,this._compressedTexturePvrtc=null,this._compressedTextureEtc1=null,this._compressedTextureETC=null,this._compressedTextureASTC=null,this._webgl_depth_texture=null,this._extColorBufferFloat=null,this._gl=e,this._isWebGL2=i;var n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),a=e.getParameter(e.MAX_TEXTURE_SIZE);i?(this._extColorBufferFloat=this._getExtension("EXT_color_buffer_float"),h.SystemUtils._shaderCapailityLevel=35):(l.ILaya.Render.isConchApp||(u.VertexArrayObject,window._setupVertexArrayObject&&window._setupVertexArrayObject(e)),this._vaoExt=this._getExtension("OES_vertex_array_object"),this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays"),this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float"),this._oesTextureHalfFloatLinear=this._getExtension("OES_texture_half_float_linear"),this._oesTextureFloat=this._getExtension("OES_texture_float"),this._oes_element_index_uint=this._getExtension("OES_element_index_uint"),this._extShaderTextureLod=this._getExtension("EXT_shader_texture_lod"),this._webgl_depth_texture=this._getExtension("WEBGL_depth_texture"),h.SystemUtils._shaderCapailityLevel=30),this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic"),this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc"),this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1"),this._compressedTextureETC=this._getExtension("WEBGL_compressed_texture_etc"),this._compressedTextureASTC=this._getExtension("WEBGL_compressed_texture_astc"),h.SystemUtils._maxTextureCount=n,h.SystemUtils._maxTextureSize=a}return(0,s.default)(t,[{key:"_getExtension",value:function(e){var i=t._extentionVendorPrefixes;for(var n in i){var a=this._gl.getExtension(i[n]+e);if(a)return a}return null}},{key:"createVertexArray",value:function(){return this._isWebGL2?this._gl.createVertexArray():this._vaoExt.createVertexArrayOES()}},{key:"bindVertexArray",value:function(t){this._isWebGL2?this._gl.bindVertexArray(t):this._vaoExt.bindVertexArrayOES(t)}},{key:"deleteVertexArray",value:function(t){this._isWebGL2?this._gl.deleteVertexArray(t):this._vaoExt.deleteVertexArrayOES(t)}},{key:"isVertexArray",value:function(t){this._isWebGL2?this._gl.isVertexArray(t):this._vaoExt.isVertexArrayOES(t)}},{key:"drawElementsInstanced",value:function(t,e,i,n,a){this._isWebGL2?this._gl.drawElementsInstanced(t,e,i,n,a):this._angleInstancedArrays.drawElementsInstancedANGLE(t,e,i,n,a)}},{key:"drawArraysInstanced",value:function(t,e,i,n){this._isWebGL2?this._gl.drawArraysInstanced(t,e,i,n):this._angleInstancedArrays.drawArraysInstancedANGLE(t,e,i,n)}},{key:"vertexAttribDivisor",value:function(t,e){this._isWebGL2?this._gl.vertexAttribDivisor(t,e):this._angleInstancedArrays.vertexAttribDivisorANGLE(t,e)}},{key:"supportInstance",value:function(){return!(!this._isWebGL2&&!this._angleInstancedArrays||!o.Config.allowGPUInstanceDynamicBatch)}},{key:"supportElementIndexUint32",value:function(){return!(!this._isWebGL2&&!this._oes_element_index_uint)}}]),t}();e.LayaGPU=c,c._extentionVendorPrefixes=["","WEBKIT_","MOZ_"]},86877:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SystemUtils=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(33873),l=i(73972),u=i(57693),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"maxTextureCount",get:function(){return this._maxTextureCount}},{key:"maxTextureSize",get:function(){return this._maxTextureSize}},{key:"shaderCapailityLevel",get:function(){return this._shaderCapailityLevel}},{key:"supportTextureFormat",value:function(t){switch(t){case l.TextureFormat.R32G32B32A32:return!(!o.LayaGL.layaGPUInstance._isWebGL2&&!o.LayaGL.layaGPUInstance._oesTextureFloat);case l.TextureFormat.R16G16B16A16:return!(!o.LayaGL.layaGPUInstance._isWebGL2&&!o.LayaGL.layaGPUInstance._oesTextureHalfFloat);default:return!0}}},{key:"supportRenderTextureFormat",value:function(t){switch(t){case u.RenderTextureFormat.R16G16B16A16:return!!(o.LayaGL.layaGPUInstance._isWebGL2&&o.LayaGL.layaGPUInstance._extColorBufferFloat||o.LayaGL.layaGPUInstance._oesTextureHalfFloat&&o.LayaGL.layaGPUInstance._oesTextureHalfFloatLinear);case u.RenderTextureFormat.Depth:return!(!o.LayaGL.layaGPUInstance._isWebGL2&&!o.LayaGL.layaGPUInstance._webgl_depth_texture);case u.RenderTextureFormat.ShadowMap:return!!o.LayaGL.layaGPUInstance._isWebGL2;default:return!0}}}]),t}();e.SystemUtils=h},79782:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.VertexArrayObject=void 0;var r=a(i(94198)),s=a(i(92762)),o=a(i(81643)),l=a(i(15375));e.VertexArrayObject=function t(){(0,l.default)(this,t)},function(){var t={};function e(e,i){var n;t[e]=!0,void 0!==i&&(n=i,window.console&&window.console.error&&window.console.error(n))}var i=function t(e){var i=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var n=0;n<this.attribs.length;n++){var a=new t.VertexAttrib(i);this.attribs[n]=a}this.maxAttrib=0};(i.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=t.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var n=function(e){var i=this;this.gl=e,function(e){var i=e.getError;e.getError=function(){var n;do{(n=i.apply(e))!=e.NO_ERROR&&(t[n]=!0)}while(n!=e.NO_ERROR);for(var a in t)if(t[a])return delete t[a],(0,r.default)(a);return e.NO_ERROR}}(e);var n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(t){return t==i.VERTEX_ARRAY_BINDING_OES?i.currentVertexArrayObject==i.defaultVertexArrayObject?null:i.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(t){var e=i.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var a=e.attribs[t];return a.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(t){var e=i.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var a=e.attribs[t];return a.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(t,a){switch(t){case e.ARRAY_BUFFER:i.currentArrayBuffer=a;break;case e.ELEMENT_ARRAY_BUFFER:i.currentVertexArrayObject.elementArrayBuffer=a}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(t,a){var r=i.currentVertexArrayObject,s=r.attribs[t];switch(a){case e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return s.buffer;case e.VERTEX_ATTRIB_ARRAY_ENABLED:return s.enabled;case e.VERTEX_ATTRIB_ARRAY_SIZE:return s.size;case e.VERTEX_ATTRIB_ARRAY_STRIDE:return s.stride;case e.VERTEX_ATTRIB_ARRAY_TYPE:return s.type;case e.VERTEX_ATTRIB_ARRAY_NORMALIZED:return s.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(t,e,a,r,s,o){var l=i.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);var u=l.attribs[t];return u.buffer=i.currentArrayBuffer,u.size=e,u.type=a,u.normalized=r,u.stride=s,u.offset=o,u.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas.addEventListener("webglcontextrestored",(function(){var t;t="OESVertexArrayObject emulation library context restored",window.console&&window.console.log&&window.console.log(t),i.reset_()}),!0),this.reset_()};n.prototype.VERTEX_ARRAY_BINDING_OES=34229,n.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var e=this.gl;this.maxVertexAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new i(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},n.prototype.createVertexArrayOES=function(){var t=new i(this);return this.vertexArrayObjects.push(t),t},n.prototype.deleteVertexArrayOES=function(t){var e,i;t.isAlive=!1,(0,s.default)(e=this.vertexArrayObjects).call(e,(0,o.default)(i=this.vertexArrayObjects).call(i,t),1),this.currentVertexArrayObject==t&&this.bindVertexArrayOES(null)},n.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof i&&t.hasBeenBound&&t.ext==this)},n.prototype.bindVertexArrayOES=function(t){var i=this.gl;if(!t||t.isAlive){var n=this.original,a=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var r=this.currentVertexArrayObject;if(a!=r){a&&r.elementArrayBuffer==a.elementArrayBuffer||n.bindBuffer.call(i,i.ELEMENT_ARRAY_BUFFER,r.elementArrayBuffer);for(var s=this.currentArrayBuffer,o=Math.max(a?a.maxAttrib:0,r.maxAttrib),l=0;l<=o;l++){var u=r.attribs[l],h=a?a.attribs[l]:null;if(a&&u.enabled==h.enabled||(u.enabled?n.enableVertexAttribArray.call(i,l):n.disableVertexAttribArray.call(i,l)),u.enabled){var c=!1;a&&u.buffer==h.buffer||(s!=u.buffer&&(n.bindBuffer.call(i,i.ARRAY_BUFFER,u.buffer),s=u.buffer),c=!0),(c||u.cached!=h.cached)&&n.vertexAttribPointer.call(i,l,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!=s&&n.bindBuffer.call(i,i.ARRAY_BUFFER,this.currentArrayBuffer)}}else e(i.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject")},window._setupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return(0,o.default)(t).call(t,"OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var i=t.getExtension;t.getExtension=function(t){var e=i.call(this,t);return e||("OES_vertex_array_object"!==t?null:(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new n(this)),this.__OESVertexArrayObject))}}}()},62285:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.WebGL=void 0;var r=a(i(3649)),s=a(i(15375)),o=a(i(17061)),l=i(56161),u=i(61266),h=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"_uint8ArraySlice",value:function(){for(var t=this,e=t.length,i=new Uint8Array(t.length),n=0;n<e;n++)i[n]=t[n];return i}},{key:"_float32ArraySlice",value:function(){for(var t=this,e=t.length,i=new Float32Array(t.length),n=0;n<e;n++)i[n]=t[n];return i}},{key:"_uint16ArraySlice",value:function(){var t,e,i,n=this;if(0===arguments.length)for(t=n.length,e=new Uint16Array(t),i=0;i<t;i++)e[i]=n[i];else if(2===arguments.length){var a=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];if(r>a)for(t=r-a,e=new Uint16Array(t),i=a;i<r;i++)e[i-a]=n[i];else e=new Uint16Array(0)}return e}},{key:"_nativeRender_enable",value:function(){}},{key:"enable",value:function(){return!0}},{key:"inner_enable",value:function(){return(0,r.default)(Float32Array.prototype)||(Float32Array.prototype.slice=t._float32ArraySlice),(0,r.default)(Uint16Array.prototype)||(Uint16Array.prototype.slice=t._uint16ArraySlice),(0,r.default)(Uint8Array.prototype)||(Uint8Array.prototype.slice=t._uint8ArraySlice),!0}},{key:"onStageResize",value:function(t,e){null!=u.WebGLContext.mainContext&&(u.WebGLContext.mainContext.viewport(0,0,t,e),l.RenderState2D.width=t,l.RenderState2D.height=e)}}]),t}();e.WebGL=h,h._isWebGL2=!1,h.isNativeRender_enable=!1},61266:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.WebGLContext=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(92493),l=i(33873),u=1,h=0,c=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"__init__",value:function(){var e=l.LayaGL.instance;t._depthFunc=e.LESS,t._blendEquation=e.FUNC_ADD,t._blendEquationRGB=e.FUNC_ADD,t._blendEquationAlpha=e.FUNC_ADD,u=e.ONE,h=e.ZERO,t._sFactorAlpha=e.ONE,t._dFactorAlpha=e.ZERO,t._activedTextureID=e.TEXTURE0;var i=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);t._activeTextures=new Array(i),t._glTextureIDs=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7,e.TEXTURE8,e.TEXTURE9,e.TEXTURE10,e.TEXTURE11,e.TEXTURE12,e.TEXTURE13,e.TEXTURE14,e.TEXTURE15,e.TEXTURE16,e.TEXTURE17,e.TEXTURE18,e.TEXTURE19,e.TEXTURE20,e.TEXTURE21,e.TEXTURE22,e.TEXTURE23,e.TEXTURE24,e.TEXTURE25,e.TEXTURE26,e.TEXTURE27,e.TEXTURE28,e.TEXTURE29,e.TEXTURE30,e.TEXTURE31];var n=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),a=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);t._maxUniformFragmentVectors=Math.min(n,a)}},{key:"useProgram",value:function(e,i){return t._useProgram!==i&&(e.useProgram(i),t._useProgram=i,!0)}},{key:"setDepthTest",value:function(e,i){i!==t._depthTest&&(t._depthTest=i,i?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST))}},{key:"setDepthMask",value:function(e,i){i!==t._depthMask&&(t._depthMask=i,e.depthMask(i))}},{key:"setDepthFunc",value:function(e,i){i!==t._depthFunc&&(t._depthFunc=i,e.depthFunc(i))}},{key:"setBlend",value:function(e,i){i!==t._blend&&(t._blend=i,i?e.enable(e.BLEND):e.disable(e.BLEND))}},{key:"setBlendEquation",value:function(e,i){i!==t._blendEquation&&(t._blendEquation=i,t._blendEquationRGB=t._blendEquationAlpha=null,e.blendEquation(i))}},{key:"setBlendEquationSeparate",value:function(e,i,n){i===t._blendEquationRGB&&n===t._blendEquationAlpha||(t._blendEquationRGB=i,t._blendEquationAlpha=n,t._blendEquation=null,e.blendEquationSeparate(i,n))}},{key:"setBlendFunc",value:function(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(a||i!==u||n!==h)&&(u=i,h=n,t._sFactorRGB=null,t._dFactorRGB=null,t._sFactorAlpha=null,t._dFactorAlpha=null,e.blendFunc(i,n))}},{key:"setBlendFuncSeperate",value:function(e,i,n,a,r){i===t._sFactorRGB&&n===t._dFactorRGB&&a===t._sFactorAlpha&&r===t._dFactorAlpha||(t._sFactorRGB=i,t._dFactorRGB=n,t._sFactorAlpha=a,t._dFactorAlpha=r,u=null,h=null,e.blendFuncSeparate(i,n,a,r))}},{key:"setCullFace",value:function(e,i){i!==t._cullFace&&(t._cullFace=i,i?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE))}},{key:"setFrontFace",value:function(e,i){i!==t._frontFace&&(t._frontFace=i,e.frontFace(i))}},{key:"activeTexture",value:function(e,i){t._activedTextureID!==i&&(e.activeTexture(i),t._activedTextureID=i)}},{key:"bindTexture",value:function(e,i,n){t._activeTextures[t._activedTextureID-e.TEXTURE0]!==n&&(e.bindTexture(i,n),t._activeTextures[t._activedTextureID-e.TEXTURE0]=n)}},{key:"__init_native",value:function(){if(o.ILaya.Render.supportWebGLPlusRendering){var e=t;e.activeTexture=e.activeTextureForNative,e.bindTexture=e.bindTextureForNative}}},{key:"useProgramForNative",value:function(t,e){return t.useProgram(e),!0}},{key:"setDepthTestForNative",value:function(t,e){e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)}},{key:"setDepthMaskForNative",value:function(t,e){t.depthMask(e)}},{key:"setDepthFuncForNative",value:function(t,e){t.depthFunc(e)}},{key:"setBlendForNative",value:function(t,e){e?t.enable(t.BLEND):t.disable(t.BLEND)}},{key:"setBlendFuncForNative",value:function(t,e,i){t.blendFunc(e,i)}},{key:"setCullFaceForNative",value:function(t,e){e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)}},{key:"setFrontFaceForNative",value:function(t,e){t.frontFace(e)}},{key:"activeTextureForNative",value:function(t,e){t.activeTexture(e)}},{key:"bindTextureForNative",value:function(t,e,i){t.bindTexture(e,i)}},{key:"bindVertexArrayForNative",value:function(t,e){t.bindVertexArray(e)}},{key:"getUniformMaxVector",value:function(){return t._maxUniformFragmentVectors}}]),t}();e.WebGLContext=c,c._activeTextures=new Array(1),c._useProgram=null,c._depthTest=!0,c._depthMask=!0,c._blend=!1,c._cullFace=!1,c.mainContext=null},91700:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BlendMode=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(61266),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"_init_",value:function(e){t.fns=[t.BlendNormal,t.BlendAdd,t.BlendMultiply,t.BlendScreen,t.BlendOverlay,t.BlendLight,t.BlendMask,t.BlendDestinationOut,t.BlendAddOld],t.targetFns=[t.BlendNormalTarget,t.BlendAddTarget,t.BlendMultiplyTarget,t.BlendScreenTarget,t.BlendOverlayTarget,t.BlendLightTarget,t.BlendMask,t.BlendDestinationOut,t.BlendAddTargetOld]}},{key:"BlendNormal",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendAddOld",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA,!0)}},{key:"BlendAdd",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMultiply",value:function(t){o.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendScreen",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendOverlay",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR,!0)}},{key:"BlendLight",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendNormalTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendAddTargetOld",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA,!0)}},{key:"BlendAddTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMultiplyTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendScreenTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendOverlayTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR,!0)}},{key:"BlendLightTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMask",value:function(t){o.WebGLContext.setBlendFunc(t,t.ZERO,t.SRC_ALPHA,!0)}},{key:"BlendDestinationOut",value:function(t){o.WebGLContext.setBlendFunc(t,t.ZERO,t.ZERO,!0)}}]),t}();e.BlendMode=l,l.activeBlendFunction=null,l.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out","add_old"],l.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1,lighter_old:8,add_old:8},l.NORMAL="normal",l.MASK="mask",l.LIGHTER="lighter"},4629:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.DrawStyle=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(13104),l=function(){function t(e){(0,r.default)(this,t),this.setValue(e)}return(0,s.default)(t,[{key:"setValue",value:function(t){this._color=t?t instanceof o.ColorUtils?t:o.ColorUtils.create(t):o.ColorUtils.create("#000000")}},{key:"reset",value:function(){this._color=o.ColorUtils.create("#000000")}},{key:"toInt",value:function(){return this._color.numColor}},{key:"equal",value:function(t){return"string"==typeof t?this._color.strColor===t:t instanceof o.ColorUtils&&this._color.numColor===t.numColor}},{key:"toColorStr",value:function(){return this._color.strColor}}],[{key:"create",value:function(e){if(e){var i=e instanceof o.ColorUtils?e:o.ColorUtils.create(e);return i._drawStyle||(i._drawStyle=new t(e))}return t.DEFAULT}}]),t}();e.DrawStyle=l,l.DEFAULT=new l("#000000")},91902:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Path=void 0;var r=a(i(3649)),s=a(i(15375)),o=a(i(17061)),l=function(){function t(){(0,s.default)(this,t),this._lastOriX=0,this._lastOriY=0,this.paths=[],this._curPath=null}return(0,o.default)(t,[{key:"beginPath",value:function(t){this.paths.length=1,this._curPath=this.paths[0]=new u,this._curPath.convex=t}},{key:"closePath",value:function(){this._curPath.loop=!0}},{key:"newPath",value:function(){this._curPath=new u,this.paths.push(this._curPath)}},{key:"addPoint",value:function(t,e){this._curPath.path.push(t,e)}},{key:"push",value:function(t,e){this._curPath?this._curPath.path.length>0&&(this._curPath=new u,this.paths.push(this._curPath)):(this._curPath=new u,this.paths.push(this._curPath));var i=this._curPath;i.path=(0,r.default)(t).call(t),i.convex=e}},{key:"reset",value:function(){this.paths.length=0}}]),t}();e.Path=l;var u=function t(){(0,s.default)(this,t),this.path=[],this.loop=!1,this.convex=!1}},37560:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.WebGLCacheAsNormalCanvas=void 0;var r=a(i(78914)),s=a(i(15375)),o=a(i(17061)),l=i(18008),u=i(93055),h=i(94286),c=i(30966),d=i(86044),f=function(){function t(e,i){(0,s.default)(this,t),this.submitStartPos=0,this.submitEndPos=0,this.touches=[],this.submits=[],this.sprite=null,this.meshlist=[],this.cachedClipInfo=new l.Matrix,this.oldTx=0,this.oldTy=0,this.invMat=new l.Matrix,this.context=e,this.sprite=i,e._globalClipMatrix.copyTo(this.cachedClipInfo)}return(0,o.default)(t,[{key:"startRec",value:function(){var t=this.context;t._charSubmitCache&&t._charSubmitCache._enable&&(t._charSubmitCache.enable(!1,t),t._charSubmitCache.enable(!0,t)),t._incache=!0,this.touches.length=0,t.touches=this.touches,t._globalClipMatrix.copyTo(this.cachedClipInfo),this.submits.length=0,this.submitStartPos=t._submits._length;for(var e=0,i=this.meshlist.length;e<i;e++){var n=this.meshlist[e];n.canReuse?n.releaseMesh():n.destroy()}this.meshlist.length=0,this._mesh=h.MeshQuadTexture.getAMesh(!1),this._pathMesh=d.MeshVG.getAMesh(!1),this._triangleMesh=c.MeshTexture.getAMesh(!1),this.meshlist.push(this._mesh),this.meshlist.push(this._pathMesh),this.meshlist.push(this._triangleMesh),t._curSubmit=u.SubmitBase.RENDERBASE,this._oldMesh=t._mesh,this._oldPathMesh=t._pathMesh,this._oldTriMesh=t._triangleMesh,this._oldMeshList=t.meshlist,t._mesh=this._mesh,t._pathMesh=this._pathMesh,t._triangleMesh=this._triangleMesh,t.meshlist=this.meshlist,this.oldTx=t._curMat.tx,this.oldTy=t._curMat.ty,t._curMat.tx=0,t._curMat.ty=0,t._curMat.copyTo(this.invMat),this.invMat.invert()}},{key:"endRec",value:function(){var t=this.context;t._charSubmitCache&&t._charSubmitCache._enable&&(t._charSubmitCache.enable(!1,t),t._charSubmitCache.enable(!0,t));var e=t._submits;this.submitEndPos=e._length;for(var i=this.submitEndPos-this.submitStartPos,n=0;n<i;n++)this.submits.push(e[this.submitStartPos+n]);e._length-=i,t._mesh=this._oldMesh,t._pathMesh=this._oldPathMesh,t._triangleMesh=this._oldTriMesh,t.meshlist=this._oldMeshList,t._curSubmit=u.SubmitBase.RENDERBASE,t._curMat.tx=this.oldTx,t._curMat.ty=this.oldTy,t.touches=null,t._incache=!1}},{key:"isCacheValid",value:function(){var t=this.context._globalClipMatrix;return t.a==this.cachedClipInfo.a&&t.b==this.cachedClipInfo.b&&t.c==this.cachedClipInfo.c&&t.d==this.cachedClipInfo.d&&t.tx==this.cachedClipInfo.tx&&t.ty==this.cachedClipInfo.ty}},{key:"flushsubmit",value:function(){var t,e=u.SubmitBase.RENDERBASE;(0,r.default)(t=this.submits).call(t,(function(t){t!=u.SubmitBase.RENDERBASE&&(u.SubmitBase.preRender=e,e=t,t.renderSubmit())}))}},{key:"releaseMem",value:function(){}}]),t}();e.WebGLCacheAsNormalCanvas=f,f.matI=new l.Matrix},94961:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SaveBase=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(93055),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._dataObj[this._valueName]=this._value,t.POOL[t.POOL._length++]=this,this._newSubmit&&(e._curSubmit=o.SubmitBase.RENDERBASE)}}],[{key:"_createArray",value:function(){var t=[];return t._length=0,t}},{key:"_init",value:function(){var e=t._namemap={};return e[t.TYPE_ALPHA]="ALPHA",e[t.TYPE_FILESTYLE]="fillStyle",e[t.TYPE_FONT]="font",e[t.TYPE_LINEWIDTH]="lineWidth",e[t.TYPE_STROKESTYLE]="strokeStyle",e[t.TYPE_ENABLEMERGE]="_mergeID",e[t.TYPE_MARK]=e[t.TYPE_TRANSFORM]=e[t.TYPE_TRANSLATE]=[],e[t.TYPE_TEXTBASELINE]="textBaseline",e[t.TYPE_TEXTALIGN]="textAlign",e[t.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType",e[t.TYPE_SHADER]="shader",e[t.TYPE_FILTERS]="filters",e[t.TYPE_COLORFILTER]="_colorFiler",e}},{key:"save",value:function(e,i,n,a){if((e._saveMark._saveuse&i)!==i){e._saveMark._saveuse|=i;var r=t.POOL,s=r._length>0?r[--r._length]:new t;s._value=n[s._valueName=t._namemap[i]],s._dataObj=n,s._newSubmit=a;var o=e._save;o[o._length++]=s}}}]),t}();e.SaveBase=l,l.TYPE_ALPHA=1,l.TYPE_FILESTYLE=2,l.TYPE_FONT=8,l.TYPE_LINEWIDTH=256,l.TYPE_STROKESTYLE=512,l.TYPE_MARK=1024,l.TYPE_TRANSFORM=2048,l.TYPE_TRANSLATE=4096,l.TYPE_ENABLEMERGE=8192,l.TYPE_TEXTBASELINE=16384,l.TYPE_TEXTALIGN=32768,l.TYPE_GLOBALCOMPOSITEOPERATION=65536,l.TYPE_CLIPRECT=131072,l.TYPE_CLIPRECT_STENCIL=262144,l.TYPE_IBVB=524288,l.TYPE_SHADER=1048576,l.TYPE_FILTERS=2097152,l.TYPE_FILTERS_TYPE=4194304,l.TYPE_COLORFILTER=8388608,l.POOL=l._createArray(),l._namemap=l._init()},64554:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SaveClipRect=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(94961),l=i(18008),u=i(98693),h=function(){function t(){(0,r.default)(this,t),this._globalClipMatrix=new l.Matrix,this._clipInfoID=-1,this._clipRect=new u.Rectangle,this.incache=!1}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._globalClipMatrix.copyTo(e._globalClipMatrix),this._clipRect.clone(e._clipRect),e._clipInfoID=this._clipInfoID,t.POOL[t.POOL._length++]=this,e._clipInCache=this.incache}}],[{key:"save",value:function(e){if((e._saveMark._saveuse&o.SaveBase.TYPE_CLIPRECT)!=o.SaveBase.TYPE_CLIPRECT){e._saveMark._saveuse|=o.SaveBase.TYPE_CLIPRECT;var i=t.POOL,n=i._length>0?i[--i._length]:new t;e._globalClipMatrix.copyTo(n._globalClipMatrix),e._clipRect.clone(n._clipRect),n._clipInfoID=e._clipInfoID,n.incache=e._clipInCache;var a=e._save;a[a._length++]=n}}}]),t}();e.SaveClipRect=h,h.POOL=o.SaveBase._createArray()},43719:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SaveMark=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(94961),l=function(){function t(){(0,r.default)(this,t),this._saveuse=0}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!0}},{key:"restore",value:function(e){e._saveMark=this._preSaveMark,t.POOL[t.POOL._length++]=this}}],[{key:"Create",value:function(e){var i=t.POOL,n=i._length>0?i[--i._length]:new t;return n._saveuse=0,n._preSaveMark=e._saveMark,e._saveMark=n,n}}]),t}();e.SaveMark=l,l.POOL=o.SaveBase._createArray()},55307:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SaveTransform=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(94961),l=i(18008),u=function(){function t(){(0,r.default)(this,t),this._matrix=new l.Matrix}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){e._curMat=this._savematrix,t.POOL[t.POOL._length++]=this}}],[{key:"save",value:function(e){var i=e._saveMark;if((i._saveuse&o.SaveBase.TYPE_TRANSFORM)!==o.SaveBase.TYPE_TRANSFORM){i._saveuse|=o.SaveBase.TYPE_TRANSFORM;var n=t.POOL,a=n._length>0?n[--n._length]:new t;a._savematrix=e._curMat,e._curMat=e._curMat.copyTo(a._matrix);var r=e._save;r[r._length++]=a}}}]),t}();e.SaveTransform=u,u.POOL=o.SaveBase._createArray()},87948:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SaveTranslate=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(94961),l=i(18008),u=function(){function t(){(0,r.default)(this,t),this._mat=new l.Matrix}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._mat.copyTo(e._curMat),t.POOL[t.POOL._length++]=this}}],[{key:"save",value:function(e){var i=t.POOL,n=i._length>0?i[--i._length]:new t;e._curMat.copyTo(n._mat);var a=e._save;a[a._length++]=n}}]),t}();e.SaveTranslate=u,u.POOL=o.SaveBase._createArray()},20541:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.BaseShader=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305));function h(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var c=function(t){(0,o.default)(i,t);var e=h(i);function i(){return(0,s.default)(this,i),e.call(this)}return i}(i(25883).Resource);e.BaseShader=c},17:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Shader=void 0;var s=r(i(81643)),o=r(i(54103)),l=r(i(15375)),u=r(i(17061)),h=r(i(89395)),c=r(i(97709)),d=r(i(38191)),f=r(i(52305)),_=i(92493),v=i(683),y=i(61791),p=i(61266),g=i(20541),m=i(33873);function x(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,d.default)(this,i)}}var T=function(t){(0,c.default)(i,t);var e=x(i);function i(t,n){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,l.default)(this,i),(a=e.call(this))._attribInfo=null,a.customCompile=!1,a._curActTexIndex=0,a.tag={},a._program=null,a._params=null,a._paramsMap={},!t||!n)throw"Shader Error";return a._attribInfo=o,a._id=++i._count,a._vs=t,a._ps=n,a._nameMap=s||{},null!=r&&(i.sharders[r]=(0,h.default)(a)),a.recreateResource(),a.lock=!0,a}return(0,u.default)(i,[{key:"recreateResource",value:function(){this._compile(),this._setGPUMemory(0)}},{key:"_disposeResource",value:function(){p.WebGLContext.mainContext.deleteShader(this._vshader),p.WebGLContext.mainContext.deleteShader(this._pshader),p.WebGLContext.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0}},{key:"_compile",value:function(){if(this._vs&&this._ps&&!this._params){var t;this._reCompile=!0,this._params=[],this.customCompile&&(t=_.ILaya.ShaderCompile.preGetParams(this._vs,this._ps));var e,n,a,r=p.WebGLContext.mainContext;this._program=r.createProgram(),this._vshader=i._createShader(r,this._vs,r.VERTEX_SHADER),this._pshader=i._createShader(r,this._ps,r.FRAGMENT_SHADER),r.attachShader(this._program,this._vshader),r.attachShader(this._program,this._pshader);var o=this._attribInfo?this._attribInfo.length:0;for(n=0;n<o;n+=2)r.bindAttribLocation(this._program,this._attribInfo[n+1],this._attribInfo[n]);if(r.linkProgram(this._program),!this.customCompile&&!r.getProgramParameter(this._program,r.LINK_STATUS))throw r.getProgramInfoLog(this._program);var l=this.customCompile?t.uniforms.length:r.getProgramParameter(this._program,r.ACTIVE_UNIFORMS);for(n=0;n<l;n++){var u,h=this.customCompile?t.uniforms[n]:r.getActiveUniform(this._program,n);e={vartype:"uniform",glfun:null,ivartype:1,location:r.getUniformLocation(this._program,h.name),name:h.name,type:h.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},(0,s.default)(u=e.name).call(u,"[0]")>0&&(e.name=e.name.substr(0,e.name.length-3),e.isArray=!0,e.location=r.getUniformLocation(this._program,e.name)),this._params.push(e)}for(n=0,a=this._params.length;n<a;n++)switch((e=this._params[n]).indexOfParams=n,e.index=1,e.value=[e.location,null],e.codename=e.name,e.name=this._nameMap[e.codename]?this._nameMap[e.codename]:e.codename,this._paramsMap[e.name]=e,e._this=this,e.uploadedValue=[],e.type){case r.INT:e.fun=e.isArray?this._uniform1iv:this._uniform1i;break;case r.FLOAT:e.fun=e.isArray?this._uniform1fv:this._uniform1f;break;case r.FLOAT_VEC2:e.fun=e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case r.FLOAT_VEC3:e.fun=e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case r.FLOAT_VEC4:e.fun=e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case r.SAMPLER_2D:e.fun=this._uniform_sampler2D;break;case r.SAMPLER_CUBE:e.fun=this._uniform_samplerCube;break;case r.FLOAT_MAT4:e.glfun=r.uniformMatrix4fv,e.fun=this._uniformMatrix4fv;break;case r.BOOL:e.fun=this._uniform1i;break;case r.FLOAT_MAT2:case r.FLOAT_MAT3:default:throw new Error("compile shader err!")}}}},{key:"getUniform",value:function(t){return this._paramsMap[t]}},{key:"_uniform1f",value:function(t,e){var i=t.uploadedValue;return i[0]!==e?(p.WebGLContext.mainContext.uniform1f(t.location,i[0]=e),1):0}},{key:"_uniform1fv",value:function(t,e){if(e.length<4){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(p.WebGLContext.mainContext.uniform1fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return p.WebGLContext.mainContext.uniform1fv(t.location,e),1}},{key:"_uniform_vec2",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(p.WebGLContext.mainContext.uniform2f(t.location,i[0]=e[0],i[1]=e[1]),1):0}},{key:"_uniform_vec2v",value:function(t,e){if(e.length<2){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(p.WebGLContext.mainContext.uniform2fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return p.WebGLContext.mainContext.uniform2fv(t.location,e),1}},{key:"_uniform_vec3",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(p.WebGLContext.mainContext.uniform3f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0}},{key:"_uniform_vec3v",value:function(t,e){return p.WebGLContext.mainContext.uniform3fv(t.location,e),1}},{key:"_uniform_vec4",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(p.WebGLContext.mainContext.uniform4f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0}},{key:"_uniform_vec4v",value:function(t,e){return p.WebGLContext.mainContext.uniform4fv(t.location,e),1}},{key:"_uniformMatrix2fv",value:function(t,e){return p.WebGLContext.mainContext.uniformMatrix2fv(t.location,!1,e),1}},{key:"_uniformMatrix3fv",value:function(t,e){return p.WebGLContext.mainContext.uniformMatrix3fv(t.location,!1,e),1}},{key:"_uniformMatrix4fv",value:function(t,e){return p.WebGLContext.mainContext.uniformMatrix4fv(t.location,!1,e),1}},{key:"_uniform1i",value:function(t,e){var i=t.uploadedValue;return i[0]!==e?(p.WebGLContext.mainContext.uniform1i(t.location,i[0]=e),1):0}},{key:"_uniform1iv",value:function(t,e){return p.WebGLContext.mainContext.uniform1iv(t.location,e),1}},{key:"_uniform_ivec2",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(p.WebGLContext.mainContext.uniform2i(t.location,i[0]=e[0],i[1]=e[1]),1):0}},{key:"_uniform_ivec2v",value:function(t,e){return p.WebGLContext.mainContext.uniform2iv(t.location,e),1}},{key:"_uniform_vec3i",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(p.WebGLContext.mainContext.uniform3i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0}},{key:"_uniform_vec3vi",value:function(t,e){return p.WebGLContext.mainContext.uniform3iv(t.location,e),1}},{key:"_uniform_vec4i",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(p.WebGLContext.mainContext.uniform4i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0}},{key:"_uniform_vec4vi",value:function(t,e){return p.WebGLContext.mainContext.uniform4iv(t.location,e),1}},{key:"_uniform_sampler2D",value:function(t,e){var i=p.WebGLContext.mainContext,n=t.uploadedValue;return null==n[0]?(n[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),p.WebGLContext.activeTexture(i,i.TEXTURE0+this._curActTexIndex),p.WebGLContext.bindTexture(i,i.TEXTURE_2D,e),this._curActTexIndex++,1):(p.WebGLContext.activeTexture(i,i.TEXTURE0+n[0]),p.WebGLContext.bindTexture(i,i.TEXTURE_2D,e),0)}},{key:"_uniform_samplerCube",value:function(t,e){var i=p.WebGLContext.mainContext,n=t.uploadedValue;return null==n[0]?(n[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),p.WebGLContext.activeTexture(i,i.TEXTURE0+this._curActTexIndex),p.WebGLContext.bindTexture(i,i.TEXTURE_CUBE_MAP,e),this._curActTexIndex++,1):(p.WebGLContext.activeTexture(i,i.TEXTURE0+n[0]),p.WebGLContext.bindTexture(i,i.TEXTURE_CUBE_MAP,e),0)}},{key:"_noSetValue",value:function(t){console.log("no....:"+t.name)}},{key:"uploadOne",value:function(t,e){p.WebGLContext.useProgram(p.WebGLContext.mainContext,this._program);var i=this._paramsMap[t];i.fun.call(this,i,e)}},{key:"uploadTexture2D",value:function(t){var e=p.WebGLContext;e._activeTextures[0]!==t&&(e.bindTexture(p.WebGLContext.mainContext,m.LayaGL.instance.TEXTURE_2D,t),e._activeTextures[0]=t)}},{key:"upload",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;g.BaseShader.activeShader=g.BaseShader.bindShader=this;var i=p.WebGLContext.mainContext;p.WebGLContext.useProgram(i,this._program),this._reCompile?(e=this._params,this._reCompile=!1):e=e||this._params;for(var n,a,r=e.length,s=0,o=0;o<r;o++)null!==(a=t[(n=e[o]).name])&&(s+=n.fun.call(this,n,a));v.Stat.shaderCall+=s}},{key:"uploadArray",value:function(t,e,i){g.BaseShader.activeShader=this,g.BaseShader.bindShader=this,p.WebGLContext.useProgram(p.WebGLContext.mainContext,this._program);this._params;for(var n,a,r=0,s=e-2;s>=0;s-=2){var l;if(a=this._paramsMap[t[s]])if(null!=(n=t[s+1]))i&&i[a.name]&&(0,o.default)(l=i[a.name]).call(l),r+=a.fun.call(this,a,n)}v.Stat.shaderCall+=r}},{key:"getParams",value:function(){return this._params}},{key:"setAttributesLocation",value:function(t){this._attribInfo=t}}],[{key:"getShader",value:function(t){return i.sharders[t]}},{key:"create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new i(t,e,n,a,r)}},{key:"withCompile",value:function(t,e,n,a){if(n&&i.sharders[n])return i.sharders[n];var r=i._preCompileShader[i.SHADERNAME2ID*t];if(!r)throw new Error("withCompile shader err!"+t);return r.createShader(e,n,a,null)}},{key:"withCompile2D",value:function(t,e,n,a,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(a&&i.sharders[a])return i.sharders[a];var o=i._preCompileShader[i.SHADERNAME2ID*t+e];if(!o)throw new Error("withCompile shader err!"+t+" "+e);return o.createShader(n,a,r,s)}},{key:"addInclude",value:function(t,e){_.ILaya.ShaderCompile.addInclude(t,e)}},{key:"preCompile",value:function(t,e,n,a){var r=i.SHADERNAME2ID*t;i._preCompileShader[r]=new _.ILaya.ShaderCompile(e,n,a)}},{key:"preCompile2D",value:function(t,e,n,a,r){var s=i.SHADERNAME2ID*t+e;i._preCompileShader[s]=new _.ILaya.ShaderCompile(n,a,r)}},{key:"_createShader",value:function(t,e,i){var n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log(t.getShaderInfoLog(n)),null)}}]),i}(g.BaseShader);e.Shader=T,T._count=0,T._preCompileShader={},T.SHADERNAME2ID=2e-4,T.nameKey=new y.StringKey,T.sharders=new Array(32)},805:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ShaderDefinesBase=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(e,i,n){(0,r.default)(this,t),this._value=0,this._name2int=e,this._int2name=i,this._int2nameMap=n}return(0,s.default)(t,[{key:"add",value:function(t){return this._value|="string"==typeof t?this._name2int[t]:t,this._value}},{key:"addInt",value:function(t){return this._value|=t,this._value}},{key:"remove",value:function(t){return this._value&="string"==typeof t?~this._name2int[t]:~t,this._value}},{key:"isDefine",value:function(t){return(this._value&t)===t}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(t){this._value=t}},{key:"toNameDic",value:function(){var e=this._int2nameMap[this._value];return e||t._toText(this._value,this._int2name,this._int2nameMap)}}],[{key:"_reg",value:function(t,e,i,n){i[t]=e,n[e]=t}},{key:"_toText",value:function(t,e,i){var n=i[t];if(n)return n;for(var a={},r=1,s=0;s<32&&!((r=1<<s)>t);s++)if(t&r){var o=e[r];o&&(a[o]="")}return i[t]=a,a}},{key:"_toInt",value:function(t,e){for(var i=t.split("."),n=0,a=0,r=i.length;a<r;a++){var s=e[i[a]];if(!s)throw new Error("Defines to int err:"+t+"/"+i[a]);n|=s}return n}}]),t}();e.ShaderDefinesBase=o},97246:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Shader2D=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(43989),l=i(4629),u=i(17),h=a(i(13867)),c=a(i(1793)),d=a(i(18962)),f=a(i(46011)),_=a(i(50347)),v=a(i(45301)),y=function(){function t(){(0,r.default)(this,t),this.ALPHA=1,this.defines=new o.ShaderDefines2D,this.shaderType=0,this.fillStyle=l.DrawStyle.DEFAULT,this.strokeStyle=l.DrawStyle.DEFAULT}return(0,s.default)(t,[{key:"destroy",value:function(){this.defines=null,this.filters=null}}],[{key:"__init__",value:function(){u.Shader.preCompile2D(0,o.ShaderDefines2D.TEXTURE2D,h.default,c.default,null),u.Shader.preCompile2D(0,o.ShaderDefines2D.PRIMITIVE,d.default,f.default,null),u.Shader.preCompile2D(0,o.ShaderDefines2D.SKINMESH,_.default,v.default,null)}}]),t}();e.Shader2D=y},76839:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Shader2X=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305));function d(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var f=function(t){(0,u.default)(i,t);var e=d(i);function i(t,n){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(0,s.default)(this,i),(a=e.call(this,t,n,r,o,l))._params2dQuick2=null,a._shaderValueWidth=0,a._shaderValueHeight=0,a}return(0,o.default)(i,[{key:"_disposeResource",value:function(){(0,l.default)((0,c.default)(i.prototype),"_disposeResource",this).call(this),this._params2dQuick2=null}},{key:"upload2dQuick2",value:function(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())}},{key:"_make2dQuick2",value:function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var t,e=this._params,i=0,n=e.length;i<n;i++)"size"!==(t=e[i]).name&&this._params2dQuick2.push(t)}return this._params2dQuick2}}],[{key:"create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new i(t,e,n,a,r)}}]),i}(i(17).Shader);e.Shader2X=f},43989:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.ShaderDefines2D=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305));function c(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var d=function(t){(0,l.default)(i,t);var e=c(i);function i(){return(0,s.default)(this,i),e.call(this,i.__name2int,i.__int2name,i.__int2nameMap)}return(0,o.default)(i,null,[{key:"__init__",value:function(){i.reg("TEXTURE2D",i.TEXTURE2D),i.reg("PRIMITIVE",i.PRIMITIVE),i.reg("GLOW_FILTER",i.FILTERGLOW),i.reg("BLUR_FILTER",i.FILTERBLUR),i.reg("COLOR_FILTER",i.FILTERCOLOR),i.reg("COLOR_ADD",i.COLORADD),i.reg("WORLDMAT",i.WORLDMAT),i.reg("FILLTEXTURE",i.FILLTEXTURE),i.reg("MVP3D",i.MVP3D)}},{key:"reg",value:function(t,e){this._reg(t,e,i.__name2int,i.__int2name)}},{key:"toText",value:function(t,e,i){return this._toText(t,e,i)}},{key:"toInt",value:function(t){return this._toInt(t,i.__name2int)}}]),i}(i(805).ShaderDefinesBase);e.ShaderDefines2D=d,d.TEXTURE2D=1,d.PRIMITIVE=4,d.FILTERGLOW=8,d.FILTERBLUR=16,d.FILTERCOLOR=32,d.COLORADD=64,d.WORLDMAT=128,d.FILLTEXTURE=256,d.SKINMESH=512,d.MVP3D=2048,d.NOOPTMASK=d.FILTERGLOW|d.FILTERBLUR|d.FILTERCOLOR|d.FILLTEXTURE,d.__name2int={},d.__int2name=[],d.__int2nameMap=[]},28434:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SkinMeshBuffer=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(86152),l=i(53778),u=i(33873),h=function(){function t(){(0,r.default)(this,t);var e=u.LayaGL.instance;this.ib=o.IndexBuffer2D.create(e.DYNAMIC_DRAW),this.vb=l.VertexBuffer2D.create(8)}return(0,s.default)(t,[{key:"addSkinMesh",value:function(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)}},{key:"reset",value:function(){this.vb.clear(),this.ib.clear()}}],[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}]),t}();e.SkinMeshBuffer=h},2717:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.SkinSV=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(43989),c=i(22245),d=i(70053),f=i(61266);function _(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var v=function(t){(0,o.default)(i,t);var e=_(i);function i(t){var n;(0,s.default)(this,i),(n=e.call(this,h.ShaderDefines2D.SKINMESH,0)).offsetX=300,n.offsetY=0;var a=f.WebGLContext.mainContext,r=8*d.CONST3D2D.BYTES_PE;return n.position=[2,a.FLOAT,!1,r,0],n.texcoord=[2,a.FLOAT,!1,r,2*d.CONST3D2D.BYTES_PE],n.color=[4,a.FLOAT,!1,r,4*d.CONST3D2D.BYTES_PE],n}return i}(c.Value2D);e.SkinSV=v},11984:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.PrimitiveSV=void 0;var s=r(i(15375)),o=r(i(97709)),l=r(i(38191)),u=r(i(52305)),h=i(22245),c=i(43989);function d(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,u.default)(t);if(e){var r=(0,u.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,l.default)(this,i)}}var f=function(t){(0,o.default)(i,t);var e=d(i);function i(t){var n;return(0,s.default)(this,i),(n=e.call(this,c.ShaderDefines2D.PRIMITIVE,0))._attribLocation=["position",0,"attribColor",1],n}return i}(h.Value2D);e.PrimitiveSV=f},56978:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.TextureSV=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(22245),d=i(43989);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var _=function(t){(0,l.default)(i,t);var e=f(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,s.default)(this,i),(t=e.call(this,d.ShaderDefines2D.TEXTURE2D,n)).strength=0,t.blurInfo=null,t.colorMat=null,t.colorAlpha=null,t._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2],t}return(0,o.default)(i,[{key:"clear",value:function(){this.texture=null,this.shader=null,this.defines._value=this.subID}}]),i}(c.Value2D);e.TextureSV=_},22245:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Value2D=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(17),l=i(76839),u=i(43989),h=i(56161),c=i(92493),d=function(){function t(e,i){(0,r.default)(this,t),this.defines=new u.ShaderDefines2D,this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this.ref=1,this._cacheID=0,this.clipMatDir=[c.ILaya.Context._MAXSIZE,0,0,c.ILaya.Context._MAXSIZE],this.clipMatPos=[0,0],this.clipOff=[0,0],this.mainID=e,this.subID=i,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=e|i,this._inClassCache=t._cache[this._cacheID],e>0&&!this._inClassCache&&(this._inClassCache=t._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}return(0,s.default)(t,[{key:"setValue",value:function(t){}},{key:"_ShaderWithCompile",value:function(){return o.Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,l.Shader2X.create,this._attribLocation)}},{key:"upload",value:function(){var t=h.RenderState2D;h.RenderState2D.worldMatrix4===h.RenderState2D.TEMPMAT4_ARRAY||this.defines.addInt(u.ShaderDefines2D.WORLDMAT),this.mmat=t.worldMatrix4,h.RenderState2D.matWVP&&(this.defines.addInt(u.ShaderDefines2D.MVP3D),this.u_MvpMatrix=h.RenderState2D.matWVP.elements);var e=o.Shader.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height?(this.size[0]=t.width,this.size[1]=t.height,e._shaderValueWidth=t.width,e._shaderValueHeight=t.height,e.upload(this,null)):e.upload(this,e._params2dQuick2||e._make2dQuick2())}},{key:"setFilters",value:function(t){if(this.filters=t,t)for(var e,i=t.length,n=0;n<i;n++)(e=t[n])&&(this.defines.add(e.type),e.action.setValue(this))}},{key:"clear",value:function(){this.defines._value=this.subID,this.clipOff[0]=0}},{key:"release",value:function(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1,this.clipOff[0]=0)}}],[{key:"_initone",value:function(e,i){t._typeClass[e]=i,t._cache[e]=[],t._cache[e]._length=0}},{key:"__init__",value:function(){}},{key:"create",value:function(e,i){var n=t._cache[e|i];return n._length?n[--n._length]:new t._typeClass[e|i](i)}}]),t}();e.Value2D=d,d._cache=[],d._typeClass=[],d.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},46322:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.BasePoly=void 0;var r=a(i(3649)),s=a(i(15375)),o=a(i(17061)),l=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"createLine2",value:function(e,i,n,a,r,s){if(e.length<4)return null;var o=t.tempData.length>e.length+2?t.tempData:new Array(e.length+2);o[0]=e[0],o[1]=e[1];var l=2,u=0,h=e.length;for(u=2;u<h;u+=2)Math.abs(e[u]-e[u-2])+Math.abs(e[u+1]-e[u-1])>.01&&(o[l++]=e[u],o[l++]=e[u+1]);s&&Math.abs(e[0]-o[l-2])+Math.abs(e[1]-o[l-1])>.01&&(o[l++]=e[0],o[l++]=e[1]);var c=r;h=l/2;var d,f,_,v,y,p,g,m,x,T,k,C,S,E,M,L,b,I,R,w,A=n/2;for(_=o[0],v=o[1],T=_-(y=o[2]),x=(x=-(v-(p=o[3])))/(w=Math.sqrt(x*x+T*T))*A,T=T/w*A,c.push(_-x,v-T,_+x,v+T),u=1;u<h-1;u++)_=o[2*(u-1)],v=o[2*(u-1)+1],y=o[2*u],p=o[2*u+1],g=o[2*(u+1)],m=o[2*(u+1)+1],T=_-y,C=y-g,M=(-(x=(x=-(v-p))/(w=Math.sqrt(x*x+T*T))*A)+_)*(-(T=T/w*A)+p)-(-x+y)*(-T+v),I=(-(k=(k=-(p-m))/(w=Math.sqrt(k*k+C*C))*A)+g)*(-(C=C/w*A)+p)-(-k+y)*(-C+m),R=(S=-T+v-(-T+p))*(b=-k+y-(-k+g))-(L=-C+m-(-C+p))*(E=-x+y-(-x+_)),Math.abs(R)<.1?(R+=10.1,c.push(y-x,p-T,y+x,p+T)):(((d=(E*I-b*M)/R)-y)*(d-y)+((f=(L*M-S*I)/R)-p)+(f-p),c.push(d,f,y-(d-y),p-(f-p)));for(_=o[l-4],v=o[l-3],T=_-(y=o[l-2]),x=(x=-(v-(p=o[l-1])))/(w=Math.sqrt(x*x+T*T))*A,T=T/w*A,c.push(y-x,p-T,y+x,p+T),u=1;u<h;u++)i.push(a+2*(u-1),a+2*(u-1)+1,a+2*u+1,a+2*u+1,a+2*u,a+2*(u-1));return c}},{key:"createLineTriangle",value:function(t,e,i,n,a,s,o){var l=(0,r.default)(t).call(t),u=l.length,h=l[0],c=l[1],d=l[2],f=(l[2],0),_=0,v=0,y=0,p=u/2;if(!(p<=1)&&2!=p){for(var g=new Array(4*p),m=0,x=0,T=0;T<p-1;T++)h=l[x++],c=l[x++],d=l[x++],y=l[x++]-c,0!=(v=d-h)&&0!=y&&(f=Math.sqrt(v*v+y*y))>.001&&(g[_=4*m]=h,g[_+1]=c,g[_+2]=v/f,g[_+3]=y/f,m++);for(n?(h=l[u-2],c=l[u-1],d=l[0],y=l[1]-c,0!=(v=d-h)&&0!=y&&(f=Math.sqrt(v*v+y*y))>.001&&(g[_=4*m]=h,g[_+1]=c,g[_+2]=v/f,g[_+3]=y/f,m++)):(g[_=4*m]=h,g[_+1]=c,g[_+2]=v/f,g[_+3]=y/f,m++),x=0,T=0;T<p;T++)h=l[x],c=l[x+1],d=l[x+2],l[x+3]}}}]),t}();e.BasePoly=l,l.tempData=new Array(256)},30347:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Earcut=void 0;var r=a(i(47302)),s=a(i(15375)),o=a(i(17061)),l=i(15698),u=function(){function t(){(0,s.default)(this,t)}return(0,o.default)(t,null,[{key:"earcut",value:function(e,i,n){n=n||2;var a,r,s,o,l,u,h,c=i&&i.length,d=c?i[0]*n:e.length,f=t.linkedList(e,0,d,n,!0),_=[];if(!f)return _;if(c&&(f=t.eliminateHoles(e,i,f,n)),e.length>80*n){a=s=e[0],r=o=e[1];for(var v=n;v<d;v+=n)(l=e[v])<a&&(a=l),(u=e[v+1])<r&&(r=u),l>s&&(s=l),u>o&&(o=u);h=0!==(h=Math.max(s-a,o-r))?1/h:0}return t.earcutLinked(f,_,n,a,r,h),_}},{key:"linkedList",value:function(e,i,n,a,r){var s,o;if(r===t.signedArea(e,i,n,a)>0)for(s=i;s<n;s+=a)o=t.insertNode(s,e[s],e[s+1],o);else for(s=n-a;s>=i;s-=a)o=t.insertNode(s,e[s],e[s+1],o);return o&&t.equals(o,o.next)&&(t.removeNode(o),o=o.next),o}},{key:"filterPoints",value:function(e,i){if(!e)return e;i||(i=e);var n,a=e;do{if(n=!1,a.steiner||!t.equals(a,a.next)&&0!==t.area(a.prev,a,a.next))a=a.next;else{if(t.removeNode(a),(a=i=a.prev)===a.next)break;n=!0}}while(n||a!==i);return i}},{key:"earcutLinked",value:function(e,i,n,a,r,s){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(e){!o&&s&&t.indexCurve(e,a,r,s);for(var l,u,h=e;e.prev!==e.next;)if(l=e.prev,u=e.next,s?t.isEarHashed(e,a,r,s):t.isEar(e))i.push(l.i/n),i.push(e.i/n),i.push(u.i/n),t.removeNode(e),e=u.next,h=u.next;else if((e=u)===h){o?1===o?(e=t.cureLocalIntersections(e,i,n),t.earcutLinked(e,i,n,a,r,s,2)):2===o&&t.splitEarcut(e,i,n,a,r,s):t.earcutLinked(t.filterPoints(e,null),i,n,a,r,s,1);break}}}},{key:"isEar",value:function(e){var i=e.prev,n=e,a=e.next;if(t.area(i,n,a)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(t.pointInTriangle(i.x,i.y,n.x,n.y,a.x,a.y,r.x,r.y)&&t.area(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}},{key:"isEarHashed",value:function(e,i,n,a){var r=e.prev,s=e,o=e.next;if(t.area(r,s,o)>=0)return!1;for(var l=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,u=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,c=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,d=t.zOrder(l,u,i,n,a),f=t.zOrder(h,c,i,n,a),_=e.nextZ;_&&_.z<=f;){if(_!==e.prev&&_!==e.next&&t.pointInTriangle(r.x,r.y,s.x,s.y,o.x,o.y,_.x,_.y)&&t.area(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(_=e.prevZ;_&&_.z>=d;){if(_!==e.prev&&_!==e.next&&t.pointInTriangle(r.x,r.y,s.x,s.y,o.x,o.y,_.x,_.y)&&t.area(_.prev,_,_.next)>=0)return!1;_=_.prevZ}return!0}},{key:"cureLocalIntersections",value:function(e,i,n){var a=e;do{var r=a.prev,s=a.next.next;!t.equals(r,s)&&t.intersects(r,a,a.next,s)&&t.locallyInside(r,s)&&t.locallyInside(s,r)&&(i.push(r.i/n),i.push(a.i/n),i.push(s.i/n),t.removeNode(a),t.removeNode(a.next),a=e=s),a=a.next}while(a!==e);return a}},{key:"splitEarcut",value:function(e,i,n,a,r,s){var o=e;do{for(var l=o.next.next;l!==o.prev;){if(o.i!==l.i&&t.isValidDiagonal(o,l)){var u=t.splitPolygon(o,l);return o=t.filterPoints(o,o.next),u=t.filterPoints(u,u.next),t.earcutLinked(o,i,n,a,r,s),void t.earcutLinked(u,i,n,a,r,s)}l=l.next}o=o.next}while(o!==e)}},{key:"eliminateHoles",value:function(e,i,n,a){var s,o,l,u,h,c=[];for(s=0,o=i.length;s<o;s++)l=i[s]*a,u=s<o-1?i[s+1]*a:e.length,(h=t.linkedList(e,l,u,a,!1))===h.next&&(h.steiner=!0),c.push(t.getLeftmost(h));for((0,r.default)(c).call(c,t.compareX),s=0;s<c.length;s++)t.eliminateHole(c[s],n),n=t.filterPoints(n,n.next);return n}},{key:"compareX",value:function(t,e){return t.x-e.x}},{key:"eliminateHole",value:function(e,i){if(i=t.findHoleBridge(e,i)){var n=t.splitPolygon(i,e);t.filterPoints(n,n.next)}}},{key:"findHoleBridge",value:function(e,i){var n,a=i,r=e.x,s=e.y,o=-1/0;do{if(s<=a.y&&s>=a.next.y&&a.next.y!==a.y){var l=a.x+(s-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(l<=r&&l>o){if(o=l,l===r){if(s===a.y)return a;if(s===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==i);if(!n)return null;if(r===o)return n.prev;var u,h=n,c=n.x,d=n.y,f=1/0;for(a=n.next;a!==h;)r>=a.x&&a.x>=c&&r!==a.x&&t.pointInTriangle(s<d?r:o,s,c,d,s<d?o:r,s,a.x,a.y)&&((u=Math.abs(s-a.y)/(r-a.x))<f||u===f&&a.x>n.x)&&t.locallyInside(a,e)&&(n=a,f=u),a=a.next;return n}},{key:"indexCurve",value:function(e,i,n,a){var r=e;do{null===r.z&&(r.z=t.zOrder(r.x,r.y,i,n,a)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,t.sortLinked(r)}},{key:"sortLinked",value:function(t){var e,i,n,a,r,s,o,l,u=1;do{for(i=t,t=null,r=null,s=0;i;){for(s++,n=i,o=0,e=0;e<u&&(o++,n=n.nextZ);e++);for(l=u;o>0||l>0&&n;)0!==o&&(0===l||!n||i.z<=n.z)?(a=i,i=i.nextZ,o--):(a=n,n=n.nextZ,l--),r?r.nextZ=a:t=a,a.prevZ=r,r=a;i=n}r.nextZ=null,u*=2}while(s>1);return t}},{key:"zOrder",value:function(t,e,i,n,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*a)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*a)|e<<8))|e<<4))|e<<2))|e<<1))<<1}},{key:"getLeftmost",value:function(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}},{key:"pointInTriangle",value:function(t,e,i,n,a,r,s,o){return(a-s)*(e-o)-(t-s)*(r-o)>=0&&(t-s)*(n-o)-(i-s)*(e-o)>=0&&(i-s)*(r-o)-(a-s)*(n-o)>=0}},{key:"isValidDiagonal",value:function(e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!t.intersectsPolygon(e,i)&&t.locallyInside(e,i)&&t.locallyInside(i,e)&&t.middleInside(e,i)}},{key:"area",value:function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}},{key:"intersects",value:function(e,i,n,a){return!!(t.equals(e,i)&&t.equals(n,a)||t.equals(e,a)&&t.equals(n,i))||t.area(e,i,n)>0!=t.area(e,i,a)>0&&t.area(n,a,e)>0!=t.area(n,a,i)>0}},{key:"intersectsPolygon",value:function(e,i){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==i.i&&n.next.i!==i.i&&t.intersects(n,n.next,e,i))return!0;n=n.next}while(n!==e);return!1}},{key:"locallyInside",value:function(e,i){return t.area(e.prev,e,e.next)<0?t.area(e,i,e.next)>=0&&t.area(e,e.prev,i)>=0:t.area(e,i,e.prev)<0||t.area(e,e.next,i)<0}},{key:"middleInside",value:function(t,e){var i=t,n=!1,a=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&a<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}},{key:"splitPolygon",value:function(t,e){var i=new l.EarcutNode(t.i,t.x,t.y),n=new l.EarcutNode(e.i,e.x,e.y),a=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=a,a.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}},{key:"insertNode",value:function(t,e,i,n){var a=new l.EarcutNode(t,e,i);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}},{key:"removeNode",value:function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}},{key:"signedArea",value:function(t,e,i,n){for(var a=0,r=e,s=i-n;r<i;r+=n)a+=(t[s]-t[r])*(t[r+1]+t[s+1]),s=r;return a}}]),t}();e.Earcut=u},15698:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.EarcutNode=void 0;var r=a(i(15375));e.EarcutNode=function t(e,i,n){(0,r.default)(this,t),this.i=e,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},36296:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Submit=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(683),d=i(91700),f=i(70053),_=i(61266),v=i(93055);function y(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var p=function(t){(0,l.default)(i,t);var e=y(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.SubmitBase.TYPE_2D;return(0,s.default)(this,i),e.call(this,t)}return(0,o.default)(i,[{key:"renderSubmit",value:function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var i=_.WebGLContext.mainContext;return this._mesh.useMesh(i),this.shaderValue.upload(),d.BlendMode.activeBlendFunction!==this._blendFn&&(_.WebGLContext.setBlend(i,!0),this._blendFn(i),d.BlendMode.activeBlendFunction=this._blendFn),i.drawElements(i.TRIANGLES,this._numEle,i.UNSIGNED_SHORT,this._startIdx),c.Stat.renderBatches++,c.Stat.trianglesFaces+=this._numEle/3,1}},{key:"releaseRender",value:function(){v.SubmitBase.RENDERBASE!=this&&--this._ref<1&&(i.POOL[i._poolSize++]=this,this.shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}}],[{key:"create",value:function(t,e,n){var a=i._poolSize?i.POOL[--i._poolSize]:new i;a._ref=1,a._mesh=e,a._key.clear(),a._startIdx=e.indexNum*f.CONST3D2D.BYTES_PIDX,a._numEle=0;var r=t._nBlendType;a._blendFn=t._targets?d.BlendMode.targetFns[r]:d.BlendMode.fns[r],a.shaderValue=n,a.shaderValue.setValue(t._shader2D);var s=t._shader2D.filters;return s&&a.shaderValue.setFilters(s),a}},{key:"createShape",value:function(t,e,n,a){var r=i._poolSize?i.POOL[--i._poolSize]:new i;r._mesh=e,r._numEle=n,r._startIdx=2*e.indexNum,r._ref=1,r.shaderValue=a,r.shaderValue.setValue(t._shader2D);var s=t._nBlendType;return r._key.blendShader=s,r._blendFn=t._targets?d.BlendMode.targetFns[s]:d.BlendMode.fns[s],r}}]),i}(v.SubmitBase);e.Submit=p,p._poolSize=0,p.POOL=[]},93055:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SubmitBase=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(76993),l=i(22245),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.TYPE_2D;(0,r.default)(this,t),this.clipInfoID=-1,this._mesh=null,this._blendFn=null,this._id=0,this._renderType=0,this._parent=null,this._key=new o.SubmitKey,this._startIdx=0,this._numEle=0,this._ref=1,this.shaderValue=null,this._renderType=e,this._id=++t.ID}return(0,s.default)(t,[{key:"getID",value:function(){return this._id}},{key:"getRenderType",value:function(){return this._renderType}},{key:"toString",value:function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key}},{key:"renderSubmit",value:function(){return 1}},{key:"releaseRender",value:function(){}}],[{key:"__init__",value:function(){var e=t.RENDERBASE=new t(-1);e.shaderValue=new l.Value2D(0,0),e.shaderValue.ALPHA=1,e._ref=4294967295}}]),t}();e.SubmitBase=u,u.TYPE_2D=1e4,u.TYPE_CANVAS=10003,u.TYPE_CMDSETRT=10004,u.TYPE_CUSTOM=10005,u.TYPE_BLURRT=10006,u.TYPE_CMDDESTORYPRERT=10007,u.TYPE_DISABLESTENCIL=10008,u.TYPE_OTHERIBVB=10009,u.TYPE_PRIMITIVE=10010,u.TYPE_RT=10011,u.TYPE_BLUR_RT=10012,u.TYPE_TARGET=10013,u.TYPE_CHANGE_VALUE=10014,u.TYPE_SHAPE=10015,u.TYPE_TEXTURE=10016,u.TYPE_FILLTEXTURE=10017,u.KEY_ONCE=-1,u.KEY_FILLRECT=1,u.KEY_DRAWTEXTURE=2,u.KEY_VG=3,u.KEY_TRIANGLES=4,u.ID=1,u.preRender=null},69153:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SubmitCMD=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(76993),l=function(){function t(){(0,r.default)(this,t),this._ref=1,this._key=new o.SubmitKey}return(0,s.default)(t,[{key:"renderSubmit",value:function(){return this.fun.apply(this._this,this.args),1}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}}}],[{key:"create",value:function(e,i,n){var a=t.POOL._length?t.POOL[--t.POOL._length]:new t;return a.fun=i,a.args=e,a._this=n,a._ref=1,a._key.clear(),a}}]),t}();e.SubmitCMD=l,l.POOL=[],l.POOL._length=0},23800:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.SubmitCanvas=void 0;var s=r(i(77766)),o=r(i(15375)),l=r(i(17061)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(18008),f=i(22245),_=i(70053),v=i(56161),y=i(93055);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var g=function(t){(0,u.default)(i,t);var e=p(i);function i(){var t,n;return(0,o.default)(this,i),(n=e.call(this,y.SubmitBase.TYPE_2D))._matrix=new d.Matrix,n._matrix4=(0,s.default)(t=_.CONST3D2D.defaultMatrix4).call(t),n.shaderValue=new f.Value2D(0,0),n}return(0,l.default)(i,[{key:"renderSubmit",value:function(){var t=v.RenderState2D.worldAlpha,e=v.RenderState2D.worldMatrix4,i=v.RenderState2D.worldMatrix,n=v.RenderState2D.worldFilters,a=v.RenderState2D.worldShaderDefines,r=this.shaderValue,s=this._matrix,o=this._matrix4,l=d.Matrix.TEMP;return d.Matrix.mul(s,i,l),o[0]=l.a,o[1]=l.b,o[4]=l.c,o[5]=l.d,o[12]=l.tx,o[13]=l.ty,v.RenderState2D.worldMatrix=l.clone(),v.RenderState2D.worldMatrix4=o,v.RenderState2D.worldAlpha=v.RenderState2D.worldAlpha*r.alpha,r.filters&&r.filters.length&&(v.RenderState2D.worldFilters=r.filters,v.RenderState2D.worldShaderDefines=r.defines),this.canv.flushsubmit(),v.RenderState2D.worldAlpha=t,v.RenderState2D.worldMatrix4=e,v.RenderState2D.worldMatrix.destroy(),v.RenderState2D.worldMatrix=i,v.RenderState2D.worldFilters=n,v.RenderState2D.worldShaderDefines=a,1}},{key:"releaseRender",value:function(){if(--this._ref<1){var t=i.POOL;this._mesh=null,t[t._length++]=this}}},{key:"getRenderType",value:function(){return y.SubmitBase.TYPE_CANVAS}}],[{key:"create",value:function(t,e,n){var a=i.POOL._length?i.POOL[--i.POOL._length]:new i;a.canv=t,a._ref=1,a._numEle=0;var r=a.shaderValue;return r.alpha=e,r.defines.setValue(0),n&&n.length&&r.setFilters(n),a}}]),i}(y.SubmitBase);e.SubmitCanvas=g,g.POOL=[],g.POOL._length=0},76993:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SubmitKey=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t),this.clear()}return(0,s.default)(t,[{key:"clear",value:function(){this.submitType=-1,this.blendShader=this.other=0}},{key:"copyFrom",value:function(t){this.other=t.other,this.blendShader=t.blendShader,this.submitType=t.submitType}},{key:"copyFrom2",value:function(t,e,i){this.other=i,this.submitType=e}},{key:"equal3_2",value:function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader}},{key:"equal4_2",value:function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader}},{key:"equal_3",value:function(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader}},{key:"equal",value:function(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader}}]),t}();e.SubmitKey=o},40113:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.SubmitTarget=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(76993),l=i(683),u=i(61266),h=i(91700),c=i(70053),d=function(){function t(){(0,r.default)(this,t),this.blendType=0,this._ref=1,this._key=new o.SubmitKey}return(0,s.default)(t,[{key:"renderSubmit",value:function(){var t=u.WebGLContext.mainContext;this._mesh.useMesh(t);var e=this.srcRT;return e&&(this.shaderValue.texture=e._getSource(),this.shaderValue.upload(),this.blend(),l.Stat.renderBatches++,l.Stat.trianglesFaces+=this._numEle/3,t.drawElements(t.TRIANGLES,this._numEle,t.UNSIGNED_SHORT,this._startIdx)),1}},{key:"blend",value:function(){if(h.BlendMode.activeBlendFunction!==h.BlendMode.fns[this.blendType]){var t=u.WebGLContext.mainContext;t.enable(t.BLEND),h.BlendMode.fns[this.blendType](t),h.BlendMode.activeBlendFunction=h.BlendMode.fns[this.blendType]}}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}}}],[{key:"create",value:function(e,i,n,a){var r=t.POOL._length?t.POOL[--t.POOL._length]:new t;if(r._mesh=i,r.srcRT=a,r._startIdx=i.indexNum*c.CONST3D2D.BYTES_PIDX,r._ref=1,r._key.clear(),r._numEle=0,r.blendType=e._nBlendType,r._key.blendShader=r.blendType,r.shaderValue=n,r.shaderValue.setValue(e._shader2D),e._colorFiler){var s=e._colorFiler;n.defines.add(s.type),n.colorMat=s._mat,n.colorAlpha=s._alpha}return r}}]),t}();e.SubmitTarget=d,d.POOL=[],d.POOL._length=0},95055:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.SubmitTexture=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(93055),d=i(683),f=i(61266),_=i(91700),v=i(20541),y=i(43989),p=i(70053);function g(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var m=function(t){(0,l.default)(i,t);var e=g(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.SubmitBase.TYPE_2D;return(0,s.default)(this,i),e.call(this,t)}return(0,o.default)(i,[{key:"releaseRender",value:function(){--this._ref<1&&(i.POOL[i._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}},{key:"renderSubmit",value:function(){if(0===this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var i=f.WebGLContext.mainContext;this._mesh.useMesh(i);var n=c.SubmitBase.preRender,a=c.SubmitBase.preRender._key;return 0===this._key.blendShader&&this._key.submitType===a.submitType&&this._key.blendShader===a.blendShader&&v.BaseShader.activeShader&&c.SubmitBase.preRender.clipInfoID==this.clipInfoID&&n.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&y.ShaderDefines2D.NOOPTMASK)?v.BaseShader.activeShader.uploadTexture2D(e):(_.BlendMode.activeBlendFunction!==this._blendFn&&(f.WebGLContext.setBlend(i,!0),this._blendFn(i),_.BlendMode.activeBlendFunction=this._blendFn),this.shaderValue.texture=e,this.shaderValue.upload()),i.drawElements(i.TRIANGLES,this._numEle,i.UNSIGNED_SHORT,this._startIdx),d.Stat.renderBatches++,d.Stat.trianglesFaces+=this._numEle/3,1}}],[{key:"create",value:function(t,e,n){var a=i._poolSize?i.POOL[--i._poolSize]:new i(c.SubmitBase.TYPE_TEXTURE);a._mesh=e,a._key.clear(),a._key.submitType=c.SubmitBase.KEY_DRAWTEXTURE,a._ref=1,a._startIdx=e.indexNum*p.CONST3D2D.BYTES_PIDX,a._numEle=0;var r=t._nBlendType;if(a._key.blendShader=r,a._blendFn=t._targets?_.BlendMode.targetFns[r]:_.BlendMode.fns[r],a.shaderValue=n,t._colorFiler){var s=t._colorFiler;n.defines.add(s.type),n.colorMat=s._mat,n.colorAlpha=s._alpha}return a}}]),i}(c.SubmitBase);e.SubmitTexture=m,m._poolSize=0,m.POOL=[]},89308:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.AtlasGrid=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,r.default)(this,t),this.atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._used=0,this._cells=null,this._rowInfo=null,this.atlasID=n,this._init(e,i)}return(0,s.default)(t,[{key:"addRect",value:function(t,e,i,n){return!!this._get(e,i,n)&&(this._fill(n.x,n.y,e,i,t),this._texCount++,!0)}},{key:"_release",value:function(){this._cells=null,this._rowInfo=null}},{key:"_init",value:function(t,e){return this._width=t,this._height=e,this._release(),0!=this._width&&(this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=new Uint8Array(this._height),this._used=0,this._clear(),!0)}},{key:"_get",value:function(t,e,i){if(t>this._width||e>this._height)return!1;for(var n=-1,a=-1,r=this._width,s=this._height,o=this._cells,l=0;l<s;l++)if(!(this._rowInfo[l]<t))for(var u=0;u<r;){var h=3*(l*r+u);if(0!=o[h]||o[h+1]<t||o[h+2]<e)u+=o[h+1];else{n=u,a=l;for(var c=0;c<t;c++)if(o[3*c+h+2]<e){n=-1;break}if(!(n<0))return i.x=n,i.y=a,!0;u+=o[h+1]}}return!1}},{key:"_fill",value:function(t,e,i,n,a){var r=this._width,s=this._height;this._check(t+i<=r&&e+n<=s);for(var o=e;o<n+e;++o){this._check(this._rowInfo[o]>=i),this._rowInfo[o]-=i;for(var l=0;l<i;l++){var u=3*(t+o*r+l);this._check(0==this._cells[u]),this._cells[u]=a,this._cells[u+1]=i,this._cells[u+2]=n}}if(t>0)for(o=0;o<n;++o){var h=0;for(l=t-1;l>=0&&0==this._cells[3*((e+o)*r+l)];--l,++h);for(l=h;l>0;--l)this._cells[3*((e+o)*r+t-l)+1]=l,this._check(l>0)}if(e>0)for(l=t;l<t+i;++l){for(h=0,o=e-1;o>=0&&0==this._cells[3*(l+o*r)];--o,h++);for(o=h;o>0;--o)this._cells[3*(l+(e-o)*r)+2]=o,this._check(o>0)}this._used+=i*n/(this._width*this._height)}},{key:"_check",value:function(t){0==t&&console.log("xtexMerger 错误啦")}},{key:"_clear",value:function(){this._texCount=0;for(var t=0;t<this._height;t++)this._rowInfo[t]=this._width;for(var e=0;e<this._height;e++)for(var i=0;i<this._width;i++){var n=3*(e*this._width+i);this._cells[n]=0,this._cells[n+1]=this._width-i,this._cells[n+2]=this._width-e}}}]),t}();e.AtlasGrid=o},50078:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.CharRenderInfo=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(12596),l=function(){function t(){(0,r.default)(this,t),this.char="",this.deleted=!1,this.uv=new Array(8),this.pos=0,this.orix=0,this.oriy=0,this.touchTick=0,this.isSpace=!1}return(0,s.default)(t,[{key:"touch",value:function(){var t=o.RenderInfo.loopCount;this.touchTick!=t&&this.tex.touchRect(this,t),this.touchTick=t}}]),t}();e.CharRenderInfo=l},82310:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.CharRender_Canvas=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(2656),d=i(93568);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var _=function(t){(0,l.default)(i,t);var e=f(i);function i(t,n){var a,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,s.default)(this,i),(a=e.call(this)).ctx=null,a.lastScaleX=1,a.lastScaleY=1,a.maxTexW=0,a.maxTexH=0,a.scaleFontSize=!0,a.showDbgInfo=!1,a.supportImageData=!0,a.maxTexW=t,a.maxTexH=n,a.scaleFontSize=r,a.supportImageData=o,a.showDbgInfo=l,i.canvas||(i.canvas=d.Browser.createElement("canvas"),i.canvas.width=1024,i.canvas.height=512,i.canvas.style.left="-10000px",i.canvas.style.position="absolute",document.body.appendChild(i.canvas),a.ctx=i.canvas.getContext("2d")),a}return(0,o.default)(i,[{key:"canvasWidth",get:function(){return i.canvas.width},set:function(t){i.canvas.width!=t&&(i.canvas.width=t,t>2048&&console.warn("画文字设置的宽度太大，超过2048了"),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.lastScaleX,this.lastScaleY))}},{key:"getWidth",value:function(t,e){return this.ctx?(this.ctx._lastFont!=t&&(this.ctx.font=t,this.ctx._lastFont=t),this.ctx.measureText(e).width):0}},{key:"scale",value:function(t,e){if(!this.supportImageData)return this.lastScaleX=t,void(this.lastScaleY=e);this.lastScaleX==t&&this.lastScaleY==e||(this.ctx.setTransform(t,0,0,e,0,0),this.lastScaleX=t,this.lastScaleY=e)}},{key:"getCharBmp",value:function(t,e,n,a,r,s,o,l,u,h){var c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null;if(!this.supportImageData)return this.getCharCanvas(t,e,n,a,r,s,o,l,u,h);var d=this.ctx,f=this.fontsz;d.font!=e&&(d.font=e,d._lastFont=e),s.width=d.measureText(t).width;var _=s.width*this.lastScaleX,v=s.height*this.lastScaleY;_+=(o+u)*this.lastScaleX,v+=(l+h)*this.lastScaleY,_=Math.ceil(_),v=Math.ceil(v);var y=(_=Math.min(_,i.canvas.width))+2*n+1,p=(v=Math.min(v,i.canvas.height))+2*n+1;c&&(y=Math.max(y,c[0]+c[2]+1),p=Math.max(p,c[1]+c[3]+1)),d.clearRect(0,0,y/this.lastScaleX+1,p/this.lastScaleY+1),d.save(),d.textBaseline="middle",n>0&&(d.strokeStyle=r,d.lineWidth=n,d.strokeText(t,o,l+f/2)),a&&(d.fillStyle=a,d.fillText(t,o,l+f/2)),this.showDbgInfo&&(d.strokeStyle="#ff0000",d.strokeRect(1,1,_-2,v-2),d.strokeStyle="#00ff00",d.strokeRect(o,l,s.width,s.height)),c&&(-1==c[2]&&(c[2]=Math.ceil((s.width+2*n)*this.lastScaleX)),c[2]<=0&&(c[2]=1));var g=c?d.getImageData(c[0],c[1],c[2],c[3]+1):d.getImageData(0,0,_,v+1);return d.restore(),s.bmpWidth=g.width,s.bmpHeight=g.height,g}},{key:"getCharCanvas",value:function(t,e,n,a,r,s,o,l,u,h){var c=this.ctx;c.font!=e&&(c.font=e,c._lastFont=e),s.width=c.measureText(t).width;var d=s.width*this.lastScaleX,f=s.height*this.lastScaleY;d+=(o+u)*this.lastScaleX,f+=(l+h)*this.lastScaleY+1,d=Math.min(d,this.maxTexW),f=Math.min(f,this.maxTexH),i.canvas.width=Math.min(d+1,this.maxTexW),i.canvas.height=Math.min(f+1,this.maxTexH),c.font=e,c.clearRect(0,0,d+1+n,f+1+n),c.setTransform(1,0,0,1,0,0),c.save(),this.scaleFontSize&&c.scale(this.lastScaleX,this.lastScaleY),c.translate(o,l),c.textAlign="left";var _=this.fontsz;return c.textBaseline="middle",n>0?(c.strokeStyle=r,c.fillStyle=a,c.lineWidth=n,c.fillAndStrokeText?c.fillAndStrokeText(t,0,_/2):(c.strokeText(t,0,_/2),c.fillText(t,0,_/2))):a&&(c.fillStyle=a,c.fillText(t,0,_/2)),this.showDbgInfo&&(c.strokeStyle="#ff0000",c.strokeRect(0,0,d,f),c.strokeStyle="#00ff00",c.strokeRect(0,0,s.width,s.height)),c.restore(),s.bmpWidth=i.canvas.width,s.bmpHeight=i.canvas.height,i.canvas}}]),i}(c.ICharRender);e.CharRender_Canvas=_,_.canvas=null},10069:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.CharRender_Native=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(2656),d=i(13104);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var _=function(t){(0,l.default)(i,t);var e=f(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this)).lastFont="",t.lastScaleX=1,t.lastScaleY=1,t}return(0,o.default)(i,[{key:"getWidth",value:function(t,e){return window.conchTextCanvas?(window.conchTextCanvas.font=t,this.lastFont=t,window.conchTextCanvas.measureText(e).width):0}},{key:"scale",value:function(t,e){this.lastScaleX=t,this.lastScaleY=e}},{key:"getCharBmp",value:function(t,e,i,n,a,r,s,o,l,u){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=e,this.lastFont=e;r.width=window.conchTextCanvas.measureText(t).width,r.height;window.conchTextCanvas.scale&&window.conchTextCanvas.scale(this.lastScaleX,this.lastScaleY);var h=d.ColorUtils.create(a),c=h.numColor,f=d.ColorUtils.create(n),_=f.numColor,v=window.conchTextCanvas.getTextBitmapData(t,_,i>2?2:i,c);return r.bmpWidth=v.width,r.bmpHeight=v.height,v}}]),i}(c.ICharRender);e.CharRender_Native=_},35266:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.CharSubmitCache=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=i(43989),u=i(22245),h=i(95055),c=i(12596),d=function(){function t(){(0,r.default)(this,t),this._data=[],this._ndata=0,this._clipid=-1,this._clipMatrix=new o.Matrix,this._enable=!1}return(0,s.default)(t,[{key:"clear",value:function(){this._tex=null,this._imgId=-1,this._ndata=0,this._enable=!1,this._colorFiler=null}},{key:"destroy",value:function(){this.clear(),this._data.length=0,this._data=null}},{key:"add",value:function(t,e,i,n,a,r){this._ndata>0&&(this._tex!=e||this._imgId!=i||this._clipid>=0&&this._clipid!=t._clipInfoID)&&this.submit(t),this._clipid=t._clipInfoID,t._globalClipMatrix.copyTo(this._clipMatrix),this._tex=e,this._imgId=i,this._colorFiler=t._colorFiler,this._data[this._ndata]=n,this._data[this._ndata+1]=a,this._data[this._ndata+2]=r,this._ndata+=3}},{key:"getPos",value:function(){return 0==t.__nPosPool?new Array(8):t.__posPool[--t.__nPosPool]}},{key:"enable",value:function(t,e){t!==this._enable&&(this._enable=t,this._enable||this.submit(e))}},{key:"submit",value:function(e){var i=this._ndata;if(i){var n=e._mesh,a=e._colorFiler;e._colorFiler=this._colorFiler;var r=h.SubmitTexture.create(e,n,u.Value2D.create(l.ShaderDefines2D.TEXTURE2D,0));e._submits[e._submits._length++]=e._curSubmit=r,r.shaderValue.textureHost=this._tex,r._key.other=this._imgId,e._colorFiler=a,e._copyClipInfo(r,this._clipMatrix),r.clipInfoID=this._clipid;for(var s=0;s<i;s+=3)n.addQuad(this._data[s],this._data[s+1],this._data[s+2],!0),t.__posPool[t.__nPosPool++]=this._data[s];i/=3,r._numEle+=6*i,n.indexNum+=6*i,n.vertNum+=4*i,e._drawCount+=i,this._ndata=0,c.RenderInfo.loopCount%100==0&&(this._data.length=0)}}}]),t}();e.CharSubmitCache=d,d.__posPool=[],d.__nPosPool=0},2656:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ICharRender=void 0;var r=a(i(15375)),s=a(i(17061)),o=function(){function t(){(0,r.default)(this,t),this.fontsz=16}return(0,s.default)(t,[{key:"getWidth",value:function(t,e){return 0}},{key:"scale",value:function(t,e){}},{key:"canvasWidth",get:function(){return 0},set:function(t){}},{key:"getCharBmp",value:function(t,e,i,n,a,r,s,o,l,u){return null}}]),t}();e.ICharRender=o},69848:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TextAtlas=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(89308),l=i(20368),u=i(92493),h=function(){function t(){(0,r.default)(this,t),this.texWidth=1024,this.texHeight=1024,this.texture=null,this.charMaps={},this.texHeight=this.texWidth=u.ILaya.TextRender.atlasWidth,this.texture=l.TextTexture.getTextTexture(this.texWidth,this.texHeight),this.texWidth/t.atlasGridW>256&&(t.atlasGridW=Math.ceil(this.texWidth/256)),this.atlasgrid=new o.AtlasGrid(this.texWidth/t.atlasGridW,this.texHeight/t.atlasGridW,this.texture.id)}return(0,s.default)(t,[{key:"setProtecteDist",value:function(t){}},{key:"getAEmpty",value:function(e,i,n){var a=this.atlasgrid.addRect(1,Math.ceil(e/t.atlasGridW),Math.ceil(i/t.atlasGridW),n);return a&&(n.x*=t.atlasGridW,n.y*=t.atlasGridW),a}},{key:"usedRate",get:function(){return this.atlasgrid._used}},{key:"destroy",value:function(){for(var t in this.charMaps){this.charMaps[t].deleted=!0}this.texture.discard()}},{key:"printDebugInfo",value:function(){}}]),t}();e.TextAtlas=h,h.atlasGridW=16},30875:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.TextRender=void 0;var r=a(i(81643)),s=a(i(78914)),o=a(i(15375)),l=a(i(17061)),u=i(69848),h=i(20368),c=i(85399),d=i(12596),f=i(54598),_=i(75494),v=i(80651),y=i(50078),p=i(82310),g=i(10069),m=i(92493),x=function(){function t(){(0,o.default)(this,t),this.fontSizeInfo={},this.mapFont={},this.fontID=0,this.fontScaleX=1,this.fontScaleY=1,this._curStrPos=0,this.textAtlases=[],this.isoTextures=[],this.lastFont=null,this.fontSizeW=0,this.fontSizeH=0,this.fontSizeOffX=0,this.fontSizeOffY=0,this.renderPerChar=!0,this.tmpAtlasPos=new c.Point,this.textureMem=0,m.ILaya.TextAtlas=u.TextAtlas;var e=!1,i=m.ILaya.Laya.MiniAdpter;i&&i.systemInfo&&i.systemInfo.system&&(e="ios 10.1.1"===i.systemInfo.system.toLowerCase()),(m.ILaya.Browser.onMiniGame||m.ILaya.Browser.onTTMiniGame||m.ILaya.Browser.onBLMiniGame||m.ILaya.Browser.onAlipayMiniGame||m.ILaya.Browser.onTBMiniGame)&&!e&&(t.isWan1Wan=!0),this.charRender=m.ILaya.Render.isConchApp?new g.CharRender_Native:new p.CharRender_Canvas(2048,2048,t.scaleFontWithCtx,!t.isWan1Wan,!1),t.textRenderInst=this,m.ILaya.Laya.textRender=this,t.atlasWidth2=t.atlasWidth*t.atlasWidth}return(0,l.default)(t,[{key:"setFont",value:function(e){var i;if(this.lastFont!=e){this.lastFont=e;var n=this.getFontSizeInfo(e._family),a=n>>24,s=n>>16&255,o=n>>8&255,l=255&n,u=e._size/t.standardFontSize;this.fontSizeOffX=Math.ceil(a*u),this.fontSizeOffY=Math.ceil(s*u),this.fontSizeW=Math.ceil(o*u),this.fontSizeH=Math.ceil(l*u),(0,r.default)(i=e._font).call(i,"italic")>=0?this.fontStr=e._font.replace("italic",""):this.fontStr=e._font}}},{key:"getNextChar",value:function(t){var e=t.length,i=this._curStrPos;if(!t.substring)return null;if(i>=e)return null;for(var n=i,a=0;n<e;n++){var r=t.charCodeAt(n);if(r>>>11==27){if(1==a)break;a=1,n++}else if(65038===r||65039===r);else if(8205==r)a=2;else if(0==a)a=1;else if(1==a)break}return this._curStrPos=n,t.substring(i,n)}},{key:"filltext",value:function(t,e,i,n,a,r,s,o,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;if(!(e.length<=0)){var h=_.FontInfo.Parse(a),c=0;switch(l){case"center":c=m.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":c=m.ILaya.Context.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(t,e,null,i,n,h,r,s,o,c,u)}}},{key:"fillWords",value:function(t,e,i,n,a,r,s,o){if(e&&!(e.length<=0)){var l="string"==typeof a?_.FontInfo.Parse(a):a;this._fast_filltext(t,null,e,i,n,l,r,s,o,0,0)}}},{key:"_fast_filltext",value:function(e,i,n,a,r,s,o,l,u,h){if((!i||i.length>=1)&&!(n&&n.length<1)){if(u<0&&(u=0),this.setFont(s),this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var c=1,d=1;if(m.ILaya.Render.isConchApp&&!window.conchTextCanvas.scale||(c=e.getMatScaleX(),d=e.getMatScaleY()),c<1e-4||d<.1)return;c>1&&(this.fontScaleX=c),d>1&&(this.fontScaleY=d)}s._italic&&(e._italicDeg=13);var f=i,_=!n&&i instanceof v.WordText,y=i&&i.toString(),p=!!n,g=_?f.pageChars:[],x=0;switch(_?(y=f._text,(x=f.width)<0&&(x=f.width=this.charRender.getWidth(this.fontStr,y))):x=y?this.charRender.getWidth(this.fontStr,y):0,h){case m.ILaya.Context.ENUM_TEXTALIGN_CENTER:a-=x/2;break;case m.ILaya.Context.ENUM_TEXTALIGN_RIGHT:a-=x}f&&g&&this.hasFreedText(g)&&(g=f.pageChars=[]);var T=null,k=this.renderPerChar=!_||t.forceSplitRender||p||_&&f.splitRender;if(!g||g.length<1)if(_&&(f.scalex=this.fontScaleX,f.scaley=this.fontScaleY),k){var C,S=0,E=0;for(this._curStrPos=0;;){if(n){var M=n[this._curStrPos++];M?(C=M.char,S=M.x,E=M.y):C=null}else C=this.getNextChar(y);if(!C)break;if(!(T=this.getCharRenderInfo(C,s,o,l,u,!1)))break;if(T.isSpace);else{var L=g[T.tex.id];if(L)L=L.words;else{var b={texgen:T.tex.genID,tex:T.tex,words:new Array};g[T.tex.id]=b,L=b.words}L.push({ri:T,x:S,y:E,w:T.bmpWidth/this.fontScaleX,h:T.bmpHeight/this.fontScaleY}),S+=T.width}}}else{var I=m.ILaya.Render.isConchApp?0:s._size/3|0,R=t.noAtlas||(x+I+I)*this.fontScaleX>t.atlasWidth;T=this.getCharRenderInfo(y,s,o,l,u,R),g[0]={texgen:T.tex.genID,tex:T.tex,words:[{ri:T,x:0,y:0,w:T.bmpWidth/this.fontScaleX,h:T.bmpHeight/this.fontScaleY}]}}this._drawResortedWords(e,a,r,g),e._italicDeg=0}}},{key:"_drawResortedWords",value:function(t,e,i,n){var a=!!t._charSubmitCache&&t._charSubmitCache._enable,r=t._curMat;for(var s in n){var o=n[s];if(o){var l=o.words,u=l.length;if(!(u<=0))for(var h=n[s].tex,c=0;c<u;c++){var d=l[c],f=d.ri;if(!f.isSpace){if(f.touch(),t.drawTexAlign=!0,m.ILaya.Render.isConchApp)t._drawTextureM(h.texture,e+d.x-f.orix,i+d.y-f.oriy,d.w,d.h,null,1,f.uv);else{var _=h;t._inner_drawTexture(_.texture,_.id,e+d.x-f.orix,i+d.y-f.oriy,d.w,d.h,r,f.uv,1,a)}t.touches&&t.touches.push(f)}}}}}},{key:"hasFreedText",value:function(t){for(var e in t){var i=t[e];if(i){var n=i.tex;if(n.__destroyed||n.genID!=i.texgen)return!0}}return!1}},{key:"getCharRenderInfo",value:function(e,i,n,a,r){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.mapFont[i._family];null==o&&(this.mapFont[i._family]=o=this.fontID++);var l=e+"_"+o+"_"+i._size+"_"+n;r>0&&(l+="_"+a+r),i._bold&&(l+="P"),1==this.fontScaleX&&1==this.fontScaleY||(l+=(20*this.fontScaleX|0)+"_"+(20*this.fontScaleY|0));var u,c,d=0,f=this.textAtlases.length;if(!s)for(d=0;d<f;d++)if(u=(c=this.textAtlases[d]).charMaps[l])return u.touch(),u;u=new y.CharRenderInfo,this.charRender.scale(this.fontScaleX,this.fontScaleY),u.char=e,u.height=i._size;var _=m.ILaya.Render.isConchApp?0:i._size/3|0,v=null;r||(r=0);var p=Math.ceil((this.charRender.getWidth(this.fontStr,e)+2*r)*this.fontScaleX);if(p>this.charRender.canvasWidth&&(this.charRender.canvasWidth=Math.min(2048,p+2*_)),s){if(this.charRender.fontsz=i._size,v=this.charRender.getCharBmp(e,this.fontStr,r,n,a,u,_,_,_,_,null)){var g=h.TextTexture.getTextTexture(v.width,v.height);g.addChar(v,0,0,u.uv),u.tex=g,u.orix=_,u.oriy=_,g.ri=u,this.isoTextures.push(g)}}else{var x=e.length,T=1*r,k=Math.ceil((this.fontSizeW+2*T)*this.fontScaleX),C=Math.ceil((this.fontSizeH+2*T)*this.fontScaleY);t.imgdtRect[0]=(_-this.fontSizeOffX-T)*this.fontScaleX|0,t.imgdtRect[1]=(_-this.fontSizeOffY-T)*this.fontScaleY|0,this.renderPerChar||1==x?(t.imgdtRect[2]=Math.max(p,k),t.imgdtRect[3]=Math.max(p,C)):(t.imgdtRect[2]=-1,t.imgdtRect[3]=C),this.charRender.fontsz=i._size,(v=this.charRender.getCharBmp(e,this.fontStr,r,n,a,u,_,_,_,_,t.imgdtRect))&&(c=this.addBmpData(v,u),t.isWan1Wan?(u.orix=_,u.oriy=_):(u.orix=this.fontSizeOffX+T,u.oriy=this.fontSizeOffY+T),c.charMaps[l]=u)}return u}},{key:"addBmpData",value:function(t,e){for(var i,n=t.width,a=t.height,r=this.textAtlases.length,s=!1,o=0;o<r&&!(s=(i=this.textAtlases[o]).getAEmpty(n,a,this.tmpAtlasPos));o++);if(!s){if(i=new u.TextAtlas,this.textAtlases.push(i),!(s=i.getAEmpty(n,a,this.tmpAtlasPos)))throw"err1";this.cleanAtlases()}return s&&(i.texture.addChar(t,this.tmpAtlasPos.x,this.tmpAtlasPos.y,e.uv),e.tex=i.texture),i}},{key:"GC",value:function(){for(var e=0,i=this.textAtlases.length,n=t.destroyAtlasDt,a=0,r=d.RenderInfo.loopCount,s=-1,o=0,l=null,u=null;e<i;e++){if(l=(u=this.textAtlases[e]).texture){l.curUsedCovRate,a+=l.curUsedCovRateAtlas;var c=u.usedRate-l.curUsedCovRateAtlas;o<c&&(o=c,s=e)}r-u.texture.lastTouchTm>n&&(t.showLog&&console.log(u.texture.id),u.destroy(),this.textAtlases[e]=this.textAtlases[i-1],i--,e--,s=-1)}for(this.textAtlases.length=i,i=this.isoTextures.length,e=0;e<i;e++)r-(l=this.isoTextures[e]).lastTouchTm>t.destroyUnusedTextureDt&&(l.ri.deleted=!0,l.ri.tex=null,l.destroy(),this.isoTextures[e]=this.isoTextures[i-1],i--,e--);this.isoTextures.length=i;var f=this.textAtlases.length>1&&this.textAtlases.length-a>=2;(t.atlasWidth*t.atlasWidth*4*this.textAtlases.length>t.cleanMem||f||t.simClean)&&(t.simClean=!1,t.showLog&&console.log("清理使用率低的贴图。总使用率:",a,":",this.textAtlases.length,"最差贴图:"+s),s>=0&&((u=this.textAtlases[s]).destroy(),this.textAtlases[s]=this.textAtlases[this.textAtlases.length-1],this.textAtlases.length=this.textAtlases.length-1)),h.TextTexture.clean()}},{key:"cleanAtlases",value:function(){}},{key:"getCharBmp",value:function(t){}},{key:"checkBmpLine",value:function(t,e,i,n){this.bmpData32.buffer!=t.data.buffer&&(this.bmpData32=new Uint32Array(t.data.buffer));for(var a=t.width*e+i,r=i;r<n;r++)if(0!=this.bmpData32[a++])return!0;return!1}},{key:"updateBbx",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.width,a=t.height,r=0,s=e[1],o=0,l=s;if(this.checkBmpLine(t,s,0,n))for(;;){if((l=(s+o)/2|0)+1>=s){e[1]=l;break}this.checkBmpLine(t,l,0,n)?s=l:o=l}if(e[3]>a)e[3]=a;else if(l=s=e[3],o=a,this.checkBmpLine(t,s,0,n))for(;;){if((l=(s+o)/2|0)-1<=s){e[3]=l;break}this.checkBmpLine(t,l,0,n)?s=l:o=l}if(!i){var u=e[0],h=n*e[1];for(l=e[1];l<e[3];l++){for(r=0;r<u;r++)if(0!=this.bmpData32[h+r]){u=r;break}h+=n}e[0]=u;var c=e[2];for(h=n*e[1],l=e[1];l<e[3];l++){for(r=c;r<n;r++)if(0!=this.bmpData32[h+r]){c=r;break}h+=n}e[2]=c}}},{key:"getFontSizeInfo",value:function(e){var i=this.fontSizeInfo[e];if(null!=i)return i;var n="bold "+t.standardFontSize+"px "+e;if(t.isWan1Wan){this.fontSizeW=1.5*this.charRender.getWidth(n,"有"),this.fontSizeH=1.5*t.standardFontSize;var a=this.fontSizeW<<8|this.fontSizeH;return this.fontSizeInfo[e]=a,a}t.pixelBBX[0]=t.standardFontSize/2,t.pixelBBX[1]=t.standardFontSize/2,t.pixelBBX[2]=t.standardFontSize,t.pixelBBX[3]=t.standardFontSize;var r=16,s=16;this.charRender.scale(1,1),t.tmpRI.height=t.standardFontSize,this.charRender.fontsz=t.standardFontSize;var o=this.charRender.getCharBmp("g",n,0,"red",null,t.tmpRI,r,s,16,16);m.ILaya.Render.isConchApp&&(o.data=new Uint8ClampedArray(o.data)),this.bmpData32=new Uint32Array(o.data.buffer),this.updateBbx(o,t.pixelBBX,!1),o=this.charRender.getCharBmp("有",n,0,"red",null,t.tmpRI,s,s,16,16),m.ILaya.Render.isConchApp&&(o.data=new Uint8ClampedArray(o.data)),this.bmpData32=new Uint32Array(o.data.buffer),t.pixelBBX[2]<r+t.tmpRI.width&&(t.pixelBBX[2]=r+t.tmpRI.width),this.updateBbx(o,t.pixelBBX,!1),m.ILaya.Render.isConchApp&&(r=0,s=0);var l=Math.max(r-t.pixelBBX[0],0)<<24|Math.max(s-t.pixelBBX[1],0)<<16|t.pixelBBX[2]-t.pixelBBX[0]<<8|t.pixelBBX[3]-t.pixelBBX[1];return this.fontSizeInfo[e]=l,l}},{key:"printDbgInfo",value:function(){var e,i;for(var n in console.log("图集个数:"+this.textAtlases.length+",每个图集大小:"+t.atlasWidth+"x"+t.atlasWidth," 用canvas:",t.isWan1Wan),console.log("图集占用空间:"+t.atlasWidth*t.atlasWidth*4/1024/1024*this.textAtlases.length+"M"),console.log("缓存用到的字体:"),this.mapFont){var a=this.getFontSizeInfo(n),r=a>>24,o=a>>16&255,l=a>>8&255,u=255&a;console.log("    "+n," off:",r,o," size:",l,u)}var h=0;console.log("缓存数据:");var c=0,f=0;(0,s.default)(e=this.textAtlases).call(e,(function(e){var i=e.texture.id,n=d.RenderInfo.loopCount-e.texture.lastTouchTm,a=n>0?n+"帧以前":"当前帧";for(var r in c+=e.texture.curUsedCovRate,f+=e.texture.curUsedCovRateAtlas,console.log("--图集(id:"+i+",当前使用率:"+(1e3*e.texture.curUsedCovRate|0)+"‰","当前图集使用率:",(100*e.texture.curUsedCovRateAtlas|0)+"%","图集使用率:",100*e.usedRate|0,"%, 使用于:"+a+")--:"),e.charMaps){var s=e.charMaps[r];console.log("     off:",s.orix,s.oriy," bmp宽高:",s.bmpWidth,s.bmpHeight,"无效:",s.deleted,"touchdt:",d.RenderInfo.loopCount-s.touchTick,"位置:",s.uv[0]*t.atlasWidth|0,s.uv[1]*t.atlasWidth|0,"字符:",s.char,"key:",r),h++}})),console.log("独立贴图文字("+this.isoTextures.length+"个):"),(0,s.default)(i=this.isoTextures).call(i,(function(t){console.log("    size:",t._texW,t._texH,"touch间隔:",d.RenderInfo.loopCount-t.lastTouchTm,"char:",t.ri.char)})),console.log("总缓存:",h,"总使用率:",c,"总当前图集使用率:",f)}},{key:"showAtlas",value:function(e,i,n,a,r,s){if(!this.textAtlases[e])return console.log("没有这个图集"),null;var o=new m.ILaya.Sprite,l=this.textAtlases[e].texture,u={width:t.atlasWidth,height:t.atlasWidth,sourceWidth:t.atlasWidth,sourceHeight:t.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return!0},_addReference:function(){},_removeReference:function(){},_getSource:function(){return l._getSource()},bitmap:{id:l.id},_uv:f.Texture.DEF_UV};return o.size=function(t,e){return this.width=t,this.height=e,o.graphics.clear(),o.graphics.drawRect(0,0,o.width,o.height,i),o.graphics.drawTexture(u,0,0,o.width,o.height),this},o.graphics.drawRect(0,0,r,s,i),o.graphics.drawTexture(u,0,0,r,s),o.pos(n,a),m.ILaya.stage.addChild(o),o}},{key:"filltext_native",value:function(t,e,i,n,a,r,s,o,l,u){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;if(!(e&&e.length<=0||i&&i.length<1)){var c=_.FontInfo.Parse(r),d=0;switch(u){case"center":d=m.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":d=m.ILaya.Context.ENUM_TEXTALIGN_RIGHT}return this._fast_filltext(t,e,i,n,a,c,s,o,l,d,h)}}}]),t}();e.TextRender=x,x.useOldCharBook=!1,x.atlasWidth=1024,x.noAtlas=!1,x.forceSplitRender=!1,x.forceWholeRender=!1,x.scaleFontWithCtx=!0,x.standardFontSize=32,x.destroyAtlasDt=10,x.checkCleanTextureDt=2e3,x.destroyUnusedTextureDt=3e3,x.cleanMem=104857600,x.isWan1Wan=!1,x.showLog=!1,x.debugUV=!1,x.tmpRI=new y.CharRenderInfo,x.pixelBBX=[0,0,0,0],x.imgdtRect=[0,0,0,0],x.simClean=!1,h.TextTexture.gTextRender=x},20368:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.TextTexture=void 0;var s=r(i(44494)),o=(r(i(77766)),r(i(15375))),l=r(i(17061)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(33873),f=i(12596),_=i(25883),v=i(61266),y=i(92493);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var g=function(t){(0,u.default)(i,t);var e=p(i);function i(t,n){var a;return(0,o.default)(this,i),(a=e.call(this))._texW=0,a._texH=0,a.__destroyed=!1,a._discardTm=0,a.genID=0,a.bitmap={id:0,_glTexture:null},a.curUsedCovRate=0,a.curUsedCovRateAtlas=0,a.lastTouchTm=0,a.ri=null,a._texW=t||i.gTextRender.atlasWidth,a._texH=n||i.gTextRender.atlasWidth,a.bitmap.id=a.id,a.lock=!0,a}return(0,l.default)(i,[{key:"recreateResource",value:function(){if(!this._source){var t=d.LayaGL.instance,e=this._source=t.createTexture();this.bitmap._glTexture=e,v.WebGLContext.bindTexture(t,t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._texW,this._texH,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i.gTextRender.debugUV&&this.fillWhite()}}},{key:"addChar",value:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i.gTextRender.isWan1Wan)return this.addCharCanvas(t,e,n,a);!this._source&&this.recreateResource();var r=d.LayaGL.instance;v.WebGLContext.bindTexture(r,r.TEXTURE_2D,this._source),!y.ILaya.Render.isConchApp&&r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var s,o,l,u,h=t.data;return t.data instanceof Uint8ClampedArray&&(h=new Uint8Array(h.buffer)),r.texSubImage2D(r.TEXTURE_2D,0,e,n,t.width,t.height,r.RGBA,r.UNSIGNED_BYTE,h),!y.ILaya.Render.isConchApp&&r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s=e/this._texW,o=n/this._texH,l=(e+t.width)/this._texW,u=(n+t.height)/this._texH,(a=a||new Array(8))[0]=s,a[1]=o,a[2]=l,a[3]=o,a[4]=l,a[5]=u,a[6]=s,a[7]=u,a}},{key:"addCharCanvas",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!this._source&&this.recreateResource();var a,r,s,o,l=d.LayaGL.instance;return v.WebGLContext.bindTexture(l,l.TEXTURE_2D,this._source),!y.ILaya.Render.isConchApp&&l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),l.texSubImage2D(l.TEXTURE_2D,0,e,i,l.RGBA,l.UNSIGNED_BYTE,t),!y.ILaya.Render.isConchApp&&l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),y.ILaya.Render.isConchApp?(a=e/this._texW,r=i/this._texH,s=(e+t.width)/this._texW,o=(i+t.height)/this._texH):(a=(e+1)/this._texW,r=(i+1)/this._texH,s=(e+t.width-1)/this._texW,o=(i+t.height-1)/this._texH),(n=n||new Array(8))[0]=a,n[1]=r,n[2]=s,n[3]=r,n[4]=s,n[5]=o,n[6]=a,n[7]=o,n}},{key:"fillWhite",value:function(){!this._source&&this.recreateResource();var t=d.LayaGL.instance,e=new Uint8Array(this._texW*this._texH*4);(0,s.default)(e).call(e,255),t.texSubImage2D(t.TEXTURE_2D,0,0,0,this._texW,this._texH,t.RGBA,t.UNSIGNED_BYTE,e)}},{key:"discard",value:function(){y.ILaya.stage.setGlobalRepaint(),this.destroy()}},{key:"destroy",value:function(){this.__destroyed=!0;var t=d.LayaGL.instance;this._source&&t.deleteTexture(this._source),this._source=null}},{key:"touchRect",value:function(t,e){this.lastTouchTm!=e&&(this.curUsedCovRate=0,this.curUsedCovRateAtlas=0,this.lastTouchTm=e);var n=i.gTextRender.atlasWidth*i.gTextRender.atlasWidth,a=y.ILaya.TextAtlas.atlasGridW*y.ILaya.TextAtlas.atlasGridW;this.curUsedCovRate+=t.bmpWidth*t.bmpHeight/n,this.curUsedCovRateAtlas+=Math.ceil(t.bmpWidth/y.ILaya.TextAtlas.atlasGridW)*Math.ceil(t.bmpHeight/y.ILaya.TextAtlas.atlasGridW)/(n/a)}},{key:"texture",get:function(){return this}},{key:"_getSource",value:function(){return this._source}},{key:"drawOnScreen",value:function(t,e){}}],[{key:"getTextTexture",value:function(t,e){return new i(t,e)}},{key:"clean",value:function(){var t=f.RenderInfo.loopStTm;if(0===i.cleanTm&&(i.cleanTm=t),t-i.cleanTm>=i.gTextRender.checkCleanTextureDt){for(var e=0;e<i.poolLen;e++){var n=i.pool[e];t-n._discardTm>=i.gTextRender.destroyUnusedTextureDt&&(n.destroy(),i.pool[e]=i.pool[i.poolLen-1],i.poolLen--,e--)}i.cleanTm=t}}}]),i}(_.Resource);e.TextTexture=g,g.gTextRender=null,g.pool=new Array(10),g.poolLen=0,g.cleanTm=0},56758:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Buffer=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(33873),l=function(){function t(){(0,r.default)(this,t),this._byteLength=0,this._glBuffer=o.LayaGL.instance.createBuffer()}return(0,s.default)(t,[{key:"bufferUsage",get:function(){return this._bufferUsage}},{key:"_bindForVAO",value:function(){}},{key:"bind",value:function(){return!1}},{key:"destroy",value:function(){this._glBuffer&&(o.LayaGL.instance.deleteBuffer(this._glBuffer),this._glBuffer=null)}}]),t}();e.Buffer=l},15323:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.Buffer2D=void 0;var s=r(i(3649)),o=r(i(54103)),l=r(i(15375)),u=r(i(17061)),h=r(i(97709)),c=r(i(38191)),d=r(i(52305)),f=i(33873),_=i(12596),v=i(20541),y=i(56758);function p(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var g=function(t){(0,h.default)(i,t);var e=p(i);function i(){var t;return(0,l.default)(this,i),(t=e.call(this))._maxsize=0,t._upload=!0,t._uploadSize=0,t._bufferSize=0,t._u8Array=null,t}return(0,u.default)(i,[{key:"bufferLength",get:function(){return this._buffer.byteLength}},{key:"byteLength",set:function(t){this.setByteLength(t)}},{key:"setByteLength",value:function(t){this._byteLength!==t&&(t<=this._bufferSize||this._resizeBuffer(2*t+256,!0),this._byteLength=t)}},{key:"needSize",value:function(t){var e=this._byteLength;if(t){var i=this._byteLength+t;i<=this._bufferSize||this._resizeBuffer(i<<1,!0),this._byteLength=i}return e}},{key:"_bufferData",value:function(){if(this._maxsize=Math.max(this._maxsize,this._byteLength),_.RenderInfo.loopCount%30==0){var t;if(this._buffer.byteLength>this._maxsize+64)this._buffer=(0,s.default)(t=this._buffer).call(t,0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse();this._maxsize=this._byteLength}this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,f.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),f.LayaGL.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))}},{key:"_bufferSubData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this._maxsize=Math.max(this._maxsize,this._byteLength),_.RenderInfo.loopCount%30==0){var n;if(this._buffer.byteLength>this._maxsize+64)this._buffer=(0,s.default)(n=this._buffer).call(n,0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse();this._maxsize=this._byteLength}if(this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,f.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),e||i){var a,r=(0,s.default)(a=this._buffer).call(a,e,i);f.LayaGL.instance.bufferSubData(this._bufferType,t,r)}else f.LayaGL.instance.bufferSubData(this._bufferType,t,this._buffer)}},{key:"_checkArrayUse",value:function(){}},{key:"_bind_uploadForVAO",value:function(){return!!this._upload&&(this._upload=!1,this._bindForVAO(),this._bufferData(),!0)}},{key:"_bind_upload",value:function(){return!!this._upload&&(this._upload=!1,(0,o.default)(this).call(this),this._bufferData(),!0)}},{key:"_bind_subUpload",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!!this._upload&&(this._upload=!1,(0,o.default)(t=this).call(t),this._bufferSubData(e,i,n),!0)}},{key:"_resizeBuffer",value:function(t,e){var i=this._buffer;if(t<=i.byteLength)return this;var n=this._u8Array;if(e&&i&&i.byteLength>0){var a=new ArrayBuffer(t),r=n&&n.buffer==i?n:new Uint8Array(i);(n=this._u8Array=new Uint8Array(a)).set(r,0),i=this._buffer=a}else i=this._buffer=new ArrayBuffer(t),this._u8Array=null;return this._checkArrayUse(),this._upload=!0,this._bufferSize=i.byteLength,this}},{key:"append",value:function(t){var e,i;this._upload=!0,e=t.byteLength,t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+e,!0),i=new Uint8Array(this._buffer,this._byteLength)):t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+e,!0),i=new Uint16Array(this._buffer,this._byteLength)):t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+e,!0),i=new Float32Array(this._buffer,this._byteLength)),i.set(t,0),this._byteLength+=e,this._checkArrayUse()}},{key:"appendU16Array",value:function(t,e){this._resizeBuffer(this._byteLength+2*e,!0);var i=new Uint16Array(this._buffer,this._byteLength,e);if(6==e)i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5];else if(e>=100)i.set(new Uint16Array(t.buffer,0,e));else for(var n=0;n<e;n++)i[n]=t[n];this._byteLength+=2*e,this._checkArrayUse()}},{key:"appendEx",value:function(t,e){var i;this._upload=!0,i=t.byteLength,this._resizeBuffer(this._byteLength+i,!0),new e(this._buffer,this._byteLength).set(t,0),this._byteLength+=i,this._checkArrayUse()}},{key:"appendEx2",value:function(t,e,i){var n,a,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(this._upload=!0,n=i*s,this._resizeBuffer(this._byteLength+n,!0),a=new e(this._buffer,this._byteLength),r=0;r<i;r++)a[r]=t[r];this._byteLength+=n,this._checkArrayUse()}},{key:"getBuffer",value:function(){return this._buffer}},{key:"setNeedUpload",value:function(){this._upload=!0}},{key:"getNeedUpload",value:function(){return this._upload}},{key:"upload",value:function(){var t=f.LayaGL.instance,e=this._bind_upload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(y.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(y.Buffer._bindedIndexBuffer=null),v.BaseShader.activeShader=null,e}},{key:"subUpload",value:function(){var t=f.LayaGL.instance,e=this._bind_subUpload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(y.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(y.Buffer._bindedIndexBuffer=null),v.BaseShader.activeShader=null,e}},{key:"_disposeResource",value:function(){this._upload=!0,this._uploadSize=0}},{key:"clear",value:function(){this._byteLength=0,this._upload=!0}}],[{key:"__int__",value:function(t){}}]),i}(y.Buffer);e.Buffer2D=g,g.FLOAT32=4,g.SHORT=2},70053:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.CONST3D2D=void 0;var r=a(i(15375)),s=function t(){(0,r.default)(this,t)};e.CONST3D2D=s,s.BYTES_PE=4,s.BYTES_PIDX=2,s.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],s.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],s._TMPARRAY=[],s._OFFSETX=0,s._OFFSETY=0},86152:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.IndexBuffer2D=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(33873),d=i(56758);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var _=function(t){(0,l.default)(i,t);var e=f(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:35044;return(0,s.default)(this,i),(t=e.call(this))._bufferUsage=n,t._bufferType=c.LayaGL.instance.ELEMENT_ARRAY_BUFFER,t._buffer=new ArrayBuffer(8),t}return(0,o.default)(i,[{key:"_checkArrayUse",value:function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))}},{key:"getUint16Array",value:function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))}},{key:"_bindForVAO",value:function(){var t=c.LayaGL.instance;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){if(d.Buffer._bindedIndexBuffer!==this._glBuffer){var t=c.LayaGL.instance;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer),d.Buffer._bindedIndexBuffer=this._glBuffer,!0}return!1}},{key:"destory",value:function(){this._uint16Array=null,this._buffer=null}},{key:"disposeResource",value:function(){this._disposeResource()}}]),i}(i(15323).Buffer2D);e.IndexBuffer2D=_,_.create=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:35044;return new _(t)}},14224:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.InlcudeFile=void 0;var r=a(i(81643)),s=a(i(15375)),o=a(i(17061)),l=i(92493),u=function(){function t(e){(0,s.default)(this,t),this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=e;for(var i,n,a=0;!((a=(0,r.default)(e).call(e,"#begin",a))<0);){for(n=a+5;!((n=(0,r.default)(e).call(e,"#end",n))<0)&&"i"===e.charAt(n+4);)n+=5;if(n<0)throw"add include err,no #end:"+e;i=(0,r.default)(e).call(e,"\n",a);var o=l.ILaya.ShaderCompile.splitToWords(e.substr(a,i-a),null);"code"==o[1]?this.codes[o[2]]=e.substr(i+1,n-i-1):"function"==o[1]&&(i=(0,r.default)(e).call(e,"function",a),i+="function".length,this.funs[o[3]]=e.substr(i+1,n-i-1),this.funnames+=o[3]+";"),a=n+1}}return(0,o.default)(t,[{key:"getWith",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=t?this.codes[t]:this.script;if(!e)throw"get with error:"+t;return e}},{key:"getFunsScript",value:function(t){var e="";for(var i in this.funs)(0,r.default)(t).call(t,i+";")>=0&&(e+=this.funs[i]);return e}}]),t}();e.InlcudeFile=u},14398:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.Mesh2D=void 0;var r=a(i(54103)),s=a(i(15375)),o=a(i(17061)),l=i(33873),u=i(32488),h=i(80340),c=i(86152),d=i(53778),f=function(){function t(e,i,n){(0,s.default)(this,t),this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._quadNum=0,this.canReuse=!1,this._stride=e,this._vb=new d.VertexBuffer2D(e,l.LayaGL.instance.DYNAMIC_DRAW),i?this._vb._resizeBuffer(i,!1):h.Config.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*e,!1),this._ib=new c.IndexBuffer2D,n&&this._ib._resizeBuffer(n,!1)}return(0,o.default)(t,[{key:"cloneWithNewVB",value:function(){var e=new t(this._stride,0,0);return e._ib=this._ib,e._quadNum=this._quadNum,e._attribInfo=this._attribInfo,e}},{key:"cloneWithNewVBIB",value:function(){var e=new t(this._stride,0,0);return e._attribInfo=this._attribInfo,e}},{key:"getVBW",value:function(){return this._vb.setNeedUpload(),this._vb}},{key:"getVBR",value:function(){return this._vb}},{key:"getIBR",value:function(){return this._ib}},{key:"getIBW",value:function(){return this._ib.setNeedUpload(),this._ib}},{key:"createQuadIB",value:function(t){this._quadNum=t,this._ib._resizeBuffer(6*t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var e=this._ib.getUint16Array(),i=0,n=0,a=0;a<t;a++)e[i++]=n,e[i++]=n+2,e[i++]=n+1,e[i++]=n,e[i++]=n+3,e[i++]=n+2,n+=4;this._ib.setNeedUpload()}},{key:"setAttributes",value:function(t){if(this._attribInfo=t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"}},{key:"configVAO",value:function(t){var e;if(!this._applied){this._applied=!0,this._vao||(this._vao=new u.BufferState2D),(0,r.default)(e=this._vao).call(e),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var i=this._attribInfo.length/3,n=0,a=0;a<i;a++){var s=this._attribInfo[n+1],o=this._attribInfo[n],l=this._attribInfo[n+2];t.enableVertexAttribArray(a),t.vertexAttribPointer(a,s,o,!1,this._stride,l),n+=3}this._vao.unBind()}}},{key:"useMesh",value:function(t){var e,i,n,a;this._applied||this.configVAO(t),(0,r.default)(e=this._vao).call(e),(0,r.default)(i=this._vb).call(i),this._ib._bind_upload()||(0,r.default)(n=this._ib).call(n),this._vb._bind_upload()||(0,r.default)(a=this._vb).call(a)}},{key:"getEleNum",value:function(){return this._ib.getBuffer().byteLength/2}},{key:"releaseMesh",value:function(){}},{key:"destroy",value:function(){}},{key:"clearVB",value:function(){this._vb.clear()}}]),t}();e.Mesh2D=f,f._gvaoid=0},34415:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.MeshParticle2D=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(14398),d=i(33873);function f(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var _=function(t){(0,l.default)(i,t);var e=f(i);function i(t){var n;return(0,s.default)(this,i),(n=e.call(this,i.const_stride,4*t*i.const_stride,4)).canReuse=!0,n.setAttributes(i._fixattriInfo),n.createQuadIB(t),n._quadNum=t,n}return(0,o.default)(i,[{key:"setMaxParticleNum",value:function(t){this._vb._resizeBuffer(4*t*i.const_stride,!1),this.createQuadIB(t)}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,i._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){var t=d.LayaGL.instance;i._fixattriInfo=[t.FLOAT,4,0,t.FLOAT,3,16,t.FLOAT,3,28,t.FLOAT,4,40,t.FLOAT,4,56,t.FLOAT,3,72,t.FLOAT,2,84,t.FLOAT,4,92,t.FLOAT,1,108,t.FLOAT,1,112]}},{key:"getAMesh",value:function(t){if(i._POOL.length){var e=i._POOL.pop();return e.setMaxParticleNum(t),e}return new i(t)}}]),i}(c.Mesh2D);e.MeshParticle2D=_,_.const_stride=116,_._POOL=[]},94286:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.MeshQuadTexture=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305));function c(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var d=function(t){(0,l.default)(i,t);var e=c(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this,i.const_stride,4,4)).canReuse=!0,t.setAttributes(i._fixattriInfo),i._fixib?(t._ib=i._fixib,t._quadNum=i._maxIB):(t.createQuadIB(i._maxIB),i._fixib=t._ib),t}return(0,o.default)(i,[{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,i._POOL.push(this)}},{key:"destroy",value:function(){this._vb.destroy(),this._vb.deleteBuffer()}},{key:"addQuad",value:function(t,e,n,a){var r=this._vb,s=r._byteLength>>2;r.setByteLength(s+i.const_stride<<2);var o=r._floatArray32||r.getFloat32Array(),l=r._uint32Array,u=s,h=a?255:0;o[u++]=t[0],o[u++]=t[1],o[u++]=e[0],o[u++]=e[1],l[u++]=n,l[u++]=h,o[u++]=t[2],o[u++]=t[3],o[u++]=e[2],o[u++]=e[3],l[u++]=n,l[u++]=h,o[u++]=t[4],o[u++]=t[5],o[u++]=e[4],o[u++]=e[5],l[u++]=n,l[u++]=h,o[u++]=t[6],o[u++]=t[7],o[u++]=e[6],o[u++]=e[7],l[u++]=n,l[u++]=h,r._upload=!0}}],[{key:"__int__",value:function(){i._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(t){var e=null;return e=i._POOL.length?i._POOL.pop():new i,t&&e._vb._resizeBuffer(65536*i.const_stride,!1),e}}]),i}(i(14398).Mesh2D);e.MeshQuadTexture=d,d.const_stride=24,d._maxIB=16384,d._POOL=[]},30966:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.MeshTexture=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(33873);function d(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var f=function(t){(0,l.default)(i,t);var e=d(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this,i.const_stride,4,4)).canReuse=!0,t.setAttributes(i._fixattriInfo),t}return(0,o.default)(i,[{key:"addData",value:function(t,e,n,a,r){var s=this._vb,o=this._ib,l=t.length>>1,u=s.needSize(l*i.const_stride)>>2,h=s._floatArray32||s.getFloat32Array(),c=s._uint32Array,d=0,f=a.a,_=a.b,v=a.c,y=a.d,p=a.tx,g=a.ty,m=0;for(m=0;m<l;m++){var x=t[d],T=t[d+1];h[u]=x*f+T*v+p,h[u+1]=x*_+T*y+g,h[u+2]=e[d],h[u+3]=e[d+1],c[u+4]=r,c[u+5]=255,u+=6,d+=2}s.setNeedUpload();var k=this.vertNum,C=n.length,S=o.needSize(n.byteLength),E=o.getUint16Array(),M=S>>1;if(k>0){var L=M+C,b=0;for(m=M;m<L;m++,b++)E[m]=n[b]+k}else E.set(n,M);o.setNeedUpload(),this.vertNum+=l,this.indexNum+=n.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,i._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){c.LayaGL.instance;i._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(t){var e;return e=i._POOL.length?i._POOL.pop():new i,t&&e._vb._resizeBuffer(65536*i.const_stride,!1),e}}]),i}(i(14398).Mesh2D);e.MeshTexture=f,f.const_stride=24,f._POOL=[]},86044:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.MeshVG=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(97709)),u=r(i(38191)),h=r(i(52305)),c=i(33873);function d(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,u.default)(this,i)}}var f=function(t){(0,l.default)(i,t);var e=d(i);function i(){var t;return(0,s.default)(this,i),(t=e.call(this,i.const_stride,4,4)).canReuse=!0,t.setAttributes(i._fixattriInfo),t}return(0,o.default)(i,[{key:"addVertAndIBToMesh",value:function(t,e,n,a){for(var r=this._vb.needSize(e.length/2*i.const_stride)>>2,s=this._vb._floatArray32||this._vb.getFloat32Array(),o=this._vb._uint32Array,l=0,u=e.length/2,h=0;h<u;h++)s[r++]=e[l],s[r++]=e[l+1],l+=2,o[r++]=n;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(a)),this._ib.setNeedUpload(),this.vertNum+=u,this.indexNum+=a.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,i._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){c.LayaGL.instance;i._fixattriInfo=[5126,2,0,5121,4,8]}},{key:"getAMesh",value:function(t){var e;return e=i._POOL.length?i._POOL.pop():new i,t&&e._vb._resizeBuffer(65536*i.const_stride,!1),e}}]),i}(i(14398).Mesh2D);e.MeshVG=f,f.const_stride=12,f._POOL=[]},56161:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.RenderState2D=void 0;var r=a(i(15375)),s=a(i(17061)),o=i(18008),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"mat2MatArray",value:function(e,i){var n=e,a=i;return a[0]=n.a,a[1]=n.b,a[2]=t.EMPTYMAT4_ARRAY[2],a[3]=t.EMPTYMAT4_ARRAY[3],a[4]=n.c,a[5]=n.d,a[6]=t.EMPTYMAT4_ARRAY[6],a[7]=t.EMPTYMAT4_ARRAY[7],a[8]=t.EMPTYMAT4_ARRAY[8],a[9]=t.EMPTYMAT4_ARRAY[9],a[10]=t.EMPTYMAT4_ARRAY[10],a[11]=t.EMPTYMAT4_ARRAY[11],a[12]=n.tx,a[13]=n.ty,a[14]=t.EMPTYMAT4_ARRAY[14],a[15]=t.EMPTYMAT4_ARRAY[15],i}},{key:"restoreTempArray",value:function(){t.TEMPMAT4_ARRAY[0]=1,t.TEMPMAT4_ARRAY[1]=0,t.TEMPMAT4_ARRAY[4]=0,t.TEMPMAT4_ARRAY[5]=1,t.TEMPMAT4_ARRAY[12]=0,t.TEMPMAT4_ARRAY[13]=0}},{key:"clear",value:function(){t.worldScissorTest=!1,t.worldAlpha=1}}]),t}();e.RenderState2D=l,l._MAXSIZE=99999999,l.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l.worldMatrix4=l.TEMPMAT4_ARRAY,l.worldMatrix=new o.Matrix,l.matWVP=null,l.worldAlpha=1,l.worldScissorTest=!1,l.width=0,l.height=0},97441:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ShaderCompile=void 0;var r=a(i(11128)),s=a(i(81643)),o=a(i(78580)),l=a(i(94198)),u=a(i(15375)),h=a(i(17061)),c=i(33873),d=i(17),f=i(14224),_=i(1648),v=function(){function t(e,i,n){(0,u.default)(this,t),this.defs={};var a=this;function s(e){e=e.replace(t._clearCR,"");var i=[],n=new _.ShaderNode(i);return a._compileToTree(n,e.split("\n"),0,i,a.defs),n}var o=(0,r.default)();this._VS=s(e),this._PS=s(i),this._nameMap=n,(0,r.default)()-o>2&&console.log("ShaderCompile use time:"+((0,r.default)()-o)+"  size:"+e.length+"/"+i.length)}return(0,h.default)(t,[{key:"_compileToTree",value:function(e,i,n,a,r){var l,u,h,c,d,f,v,y,p,g,m,x;for(g=n;g<i.length;g++)if(!((c=i[g]).length<1)&&0!==(v=(0,s.default)(c).call(c,"//"))){if(v>=0&&(c=c.substr(0,v)),u=p||new _.ShaderNode(a),p=null,u.text=c,u.noCompile=!0,(v=(0,s.default)(c).call(c,"#"))>=0){for(d="#",x=v+1,m=c.length;x<m;x++){var T=c.charAt(x);if(" "===T||"\t"===T||"?"===T)break;d+=T}switch(u.name=d,d){case"#ifdef":case"#ifndef":if(u.src=c,u.noCompile=null!=c.match(/[!&|()=<>]/),u.noCompile?console.log("function():Boolean{return "+c.substr(v+u.name.length)+"}"):(y=c.replace(/^\s*/,"").split(/\s+/),u.setCondition(y[1],"#ifdef"===d?t.IFDEF_YES:t.IFDEF_ELSE),u.text="//"+u.text),u.setParent(e),e=u,r)for(y=c.substr(x).split(t._splitToWordExps3),x=0;x<y.length;x++)(c=y[x]).length&&(r[c]=!0);continue;case"#if":if(u.src=c,u.noCompile=!0,u.setParent(e),e=u,r)for(y=c.substr(x).split(t._splitToWordExps3),x=0;x<y.length;x++)(c=y[x]).length&&"defined"!=c&&(r[c]=!0);continue;case"#else":u.src=c,h=(e=e.parent).childs[e.childs.length-1],u.noCompile=h.noCompile,u.noCompile||(u.condition=h.condition,u.conditionType=h.conditionType==t.IFDEF_YES?t.IFDEF_ELSE:t.IFDEF_YES,u.text="//"+u.text+" "+h.text+" "+u.conditionType),u.setParent(e),e=u;continue;case"#endif":h=(e=e.parent).childs[e.childs.length-1],u.noCompile=h.noCompile,u.noCompile||(u.text="//"+u.text),u.setParent(e);continue;case"#include":y=t.splitToWords(c,null);var k=(0,o.default)(t)[y[1]];if(!k)throw"ShaderCompile error no this include file:"+y[1];if((v=(0,s.default)(l=y[0]).call(l,"?"))<0){u.setParent(e),c=k.getWith("with"==y[2]?y[3]:null),this._compileToTree(u,c.split("\n"),0,a,r),u.text="";continue}u.setCondition(y[0].substr(v+1),t.IFDEF_YES),u.text=k.getWith("with"==y[2]?y[3]:null);break;case"#import":f=(y=t.splitToWords(c,null))[1],a.push({node:u,file:(0,o.default)(t)[f],ofs:u.text.length});continue}}else{if((h=e.childs[e.childs.length-1])&&!h.name){a.length>0&&t.splitToWords(c,h),p=u,h.text+="\n"+c;continue}a.length>0&&t.splitToWords(c,u)}u.setParent(e)}}},{key:"createShader",value:function(t,e,i,n){var a={},r="";if(t)for(var s in t)r+="#define "+s+"\n",a[s]=!0;var o=this._VS.toscript(a,[]),l=this._PS.toscript(a,[]);return(i||d.Shader.create)(r+o.join("\n"),r+l.join("\n"),e,this._nameMap,n)}}],[{key:"__init__",value:function(){var e=c.LayaGL.instance;t.shaderParamsMap={float:e.FLOAT,int:e.INT,bool:e.BOOL,vec2:e.FLOAT_VEC2,vec3:e.FLOAT_VEC3,vec4:e.FLOAT_VEC4,ivec2:e.INT_VEC2,ivec3:e.INT_VEC3,ivec4:e.INT_VEC4,bvec2:e.BOOL_VEC2,bvec3:e.BOOL_VEC3,bvec4:e.BOOL_VEC4,mat2:e.FLOAT_MAT2,mat3:e.FLOAT_MAT3,mat4:e.FLOAT_MAT4,sampler2D:e.SAMPLER_2D,samplerCube:e.SAMPLER_CUBE}}},{key:"_parseOne",value:function(e,i,n,a,r,s){var o={type:t.shaderParamsMap[n[a+1]],name:n[a+2],size:isNaN((0,l.default)(n[a+3]))?1:(0,l.default)(n[a+3])};return s&&("attribute"==r?e.push(o):i.push(o)),":"==n[a+3]&&(o.type=n[a+4],a+=2),a+=2}},{key:"addInclude",value:function(e,i){if(!i||0===i.length)throw new Error("add shader include file err:"+e);if((0,o.default)(t)[e])throw new Error("add shader include file err, has add:"+e);(0,o.default)(t)[e]=new f.InlcudeFile(i)}},{key:"preGetParams",value:function(e,i){var n,a,r=[e,i],s={},o=[],l=[],u={},h={};s.attributes=o,s.uniforms=l,s.defines=u;for(var c=0;c<2;c++){r[c]=r[c].replace(t._removeAnnotation,"");var d,f=r[c].match(t._reg);for(n=0,a=f.length;n<a;n++){var _=f[n];if("attribute"==_||"uniform"==_)n=t._parseOne(o,l,f,n,_,!0);else{if("#define"==_){h[_=f[++n]]=1;continue}if("#ifdef"==_){u[d=f[++n]]=u[d]||[];for(n++;n<a;n++)if("attribute"==(_=f[n])||"uniform"==_)n=t._parseOne(o,l,f,n,_,!!h[d]);else if("#else"==_)for(n++;n<a;n++)if("attribute"==(_=f[n])||"uniform"==_)n=t._parseOne(o,l,f,n,_,!h[d]);else if("#endif"==_)break}}}}return s}},{key:"splitToWords",value:function(t,e){for(var i,n,a=[],r=-1,o=0,l=t.length;o<l;o++){if(i=t.charAt(o),(0,s.default)(" \t=+-*/&%!<>()'\",;").call(" \t=+-*/&%!<>()'\",;",i)>=0){if(r>=0&&o-r>1&&(n=t.substr(r,o-r),a.push(n)),'"'==i||"'"==i){var u=(0,s.default)(t).call(t,i,o+1);if(u<0)throw"Sharder err:"+t;a.push(t.substr(o+1,u-o-1)),o=u,r=-1;continue}"("==i&&e&&a.length>0&&(n=a[a.length-1]+";",(0,s.default)("vec4;main;").call("vec4;main;",n)<0&&(e.useFuns+=n)),r=-1}else r<0&&(r=o)}return r<l&&l-r>1&&(n=t.substr(r,l-r),a.push(n)),a}}]),t}();e.ShaderCompile=v,v.IFDEF_NO=0,v.IFDEF_YES=1,v.IFDEF_ELSE=2,v.IFDEF_PARENT=3,v._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),v._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),v._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),v.includes={},v._clearCR=new RegExp("\r","g"),v._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")},1648:function(t,e,i){"use strict";var n=i(63978),a=i(8171);n(e,"__esModule",{value:!0}),e.ShaderNode=void 0;var r=a(i(78914)),s=a(i(15375)),o=a(i(17061)),l=i(92493),u=function(){function t(e){(0,s.default)(this,t),this.childs=[],this.text="",this.useFuns="",this.z=0,this.includefiles=e}return(0,o.default)(t,[{key:"setParent",value:function(t){t.childs.push(this),this.z=t.z+1,this.parent=t}},{key:"setCondition",value:function(t,e){t&&(this.conditionType=e,t=t.replace(/(\s*$)/g,""),this.condition=function(){return this[t]},this.condition.__condition=t)}},{key:"toscript",value:function(e,i){return this._toscript(e,i,++t.__id)}},{key:"_toscript",value:function(t,e,i){var n;if(this.childs.length<1&&!this.text)return e;e.length;if(this.condition){var a=!!this.condition.call(t);if(this.conditionType===l.ILaya.ShaderCompile.IFDEF_ELSE&&(a=!a),!a)return e}if(this.noCompile&&this.text&&e.push(this.text),this.childs.length>0&&(0,r.default)(n=this.childs).call(n,(function(n,a,r){n._toscript(t,e,i)})),this.includefiles.length>0&&this.useFuns.length>0)for(var s,o=0,u=this.includefiles.length;o<u;o++)this.includefiles[o].curUseID!=i&&(s=this.includefiles[o].file.getFunsScript(this.useFuns)).length>0&&(this.includefiles[o].curUseID=i,e[0]=s+e[0]);return e}}]),t}();e.ShaderNode=u,u.__id=1},53778:function(t,e,i){"use strict";var n=i(1068),a=i(63978),r=i(8171);a(e,"__esModule",{value:!0}),e.VertexBuffer2D=void 0;var s=r(i(15375)),o=r(i(17061)),l=r(i(45408)),u=r(i(97709)),h=r(i(38191)),c=r(i(52305)),d=i(15323),f=i(33873),_=i(56758);function v(t){var e=function(){if("undefined"==typeof Reflect||!n)return!1;if(n.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;i=n(a,arguments,r)}else i=a.apply(this,arguments);return(0,h.default)(this,i)}}var y=function(t){(0,u.default)(i,t);var e=v(i);function i(t,n){var a;return(0,s.default)(this,i),(a=e.call(this))._vertexStride=t,a._bufferUsage=n,a._bufferType=f.LayaGL.instance.ARRAY_BUFFER,a._buffer=new ArrayBuffer(8),a._floatArray32=new Float32Array(a._buffer),a._uint32Array=new Uint32Array(a._buffer),a}return(0,o.default)(i,[{key:"vertexStride",get:function(){return this._vertexStride}},{key:"getFloat32Array",value:function(){return this._floatArray32}},{key:"appendArray",value:function(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+4*t.length),this.getFloat32Array().set(t,e),this._upload=!0}},{key:"_checkArrayUse",value:function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))}},{key:"deleteBuffer",value:function(){(0,l.default)((0,c.default)(i.prototype),"_disposeResource",this).call(this)}},{key:"_bindForVAO",value:function(){var t=f.LayaGL.instance;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){if(_.Buffer._bindedVertexBuffer!==this._glBuffer){var t=f.LayaGL.instance;return t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer),_.Buffer._bindedVertexBuffer=this._glBuffer,!0}return!1}},{key:"destroy",value:function(){(0,l.default)((0,c.default)(i.prototype),"destroy",this).call(this),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null}}]),i}(d.Buffer2D);e.VertexBuffer2D=y,y.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35048;return new y(t,e)}},46011:function(t){t.exports="precision mediump float;\r\n//precision mediump float;\r\nvarying vec4 color;\r\n//uniform float alpha;\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\r\n\t//a.a*=alpha;\r\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\r\n\tgl_FragColor.rgb*=color.a;\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n}"},18962:function(t){t.exports="attribute vec4 position;\r\nattribute vec4 attribColor;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\nuniform mat4 u_mmat2;\r\n//uniform vec2 u_pos;\r\nuniform vec2 size;\r\nvarying vec4 color;\r\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\r\n//vec4 clip=vec4(100.,30.,300.,600.);\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t\r\n#ifdef WORLDMAT\r\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\r\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n#else\r\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\r\n#endif\t\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n  //pos2d.x = dot(clippos,dirx);\r\n  color=attribColor/255.;\r\n}"},1793:function(t){t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#if defined(GL_FRAGMENT_PRECISION_HIGH)// 原来的写法会被我们自己的解析流程处理，而我们的解析是不认内置宏的，导致被删掉，所以改成 if defined 了\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;//TODO模糊的过程中会导致变暗变亮  \r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    vec4Color.w=1.0;\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}"},13867:function(t){t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\nattribute vec4 posuv;\r\nattribute vec4 attribColor;\r\nattribute vec4 attribFlags;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\r\nvarying vec2 cliped;\r\nuniform vec2 size;\r\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\n#ifdef MVP3D\r\n\tuniform mat4 u_MvpMatrix;\r\n#endif\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\n\r\nvoid main() {\r\n\r\n\tvec4 pos = vec4(posuv.xy,0.,1.);\r\n#ifdef WORLDMAT\r\n\tpos=mmat*pos;\r\n#endif\r\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\r\n#ifdef MVP3D\r\n\tgl_Position=u_MvpMatrix*pos1;\r\n#else\r\n\tgl_Position=pos1;\r\n#endif\r\n\tv_texcoordAlpha.xy = posuv.zw;\r\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\r\n\tv_color = attribColor/255.0;\r\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\r\n\t\r\n\tv_useTex = attribFlags.r/255.0;\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\t\r\n\tvec2 clpos = clipMatPos.xy;\r\n\t#ifdef WORLDMAT\r\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\r\n\t\tif(clipOff[0]>0.0){\r\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\r\n\t\t\tclpos.y+=mmat[3].y;\t//ty\r\n\t\t}\r\n\t#endif\r\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n\r\n}"},45301:function(t){t.exports="precision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nuniform sampler2D texture;\r\nuniform float alpha;\r\nvoid main() {\r\n\tvec4 t_color = texture2D(texture, v_texcoord);\r\n\tgl_FragColor = t_color.rgba * v_color;\r\n\tgl_FragColor *= alpha;\r\n}"},50347:function(t){t.exports="attribute vec2 position;\r\nattribute vec2 texcoord;\r\nattribute vec4 color;\r\nuniform vec2 size;\r\nuniform float offsetX;\r\nuniform float offsetY;\r\nuniform mat4 mmat;\r\nuniform mat4 u_mmat2;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvoid main() {\r\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\r\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n  v_color = color;\r\n  v_color.rgb *= v_color.a;\r\n  v_texcoord = texcoord;  \r\n}"}}]);