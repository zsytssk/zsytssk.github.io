(self.webpackChunkcustom_render=self.webpackChunkcustom_render||[]).push([[921],{20516:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Config=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.Config=o,(0,l.default)(o,"animationInterval",50),(0,l.default)(o,"isAntialias",!0),(0,l.default)(o,"isAlpha",!1),(0,l.default)(o,"premultipliedAlpha",!0),(0,l.default)(o,"isStencil",!0),(0,l.default)(o,"preserveDrawingBuffer",!1),(0,l.default)(o,"webGL2D_MeshAllocMaxMem",!0),(0,l.default)(o,"is2DPixelArtGame",!1),(0,l.default)(o,"useWebGL2",!0),(0,l.default)(o,"printWebglOrder",!1),(0,l.default)(o,"allowGPUInstanceDynamicBatch",!0),(0,l.default)(o,"enableStaticBatch",!0),(0,l.default)(o,"useRetinalCanvas",!1),window.Config=o},93561:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ILaya=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"regClass",value:function(e){t.__classMap[e.name]=e}}]),t}();e.ILaya=o,(0,l.default)(o,"Laya",null),(0,l.default)(o,"Timer",null),(0,l.default)(o,"WorkerLoader",null),(0,l.default)(o,"Dragging",null),(0,l.default)(o,"GraphicsBounds",null),(0,l.default)(o,"Sprite",null),(0,l.default)(o,"TextRender",null),(0,l.default)(o,"TextAtlas",null),(0,l.default)(o,"timer",null),(0,l.default)(o,"systemTimer",null),(0,l.default)(o,"startTimer",null),(0,l.default)(o,"updateTimer",null),(0,l.default)(o,"lateTimer",null),(0,l.default)(o,"physicsTimer",null),(0,l.default)(o,"stage",null),(0,l.default)(o,"Loader",null),(0,l.default)(o,"loader",null),(0,l.default)(o,"TTFLoader",null),(0,l.default)(o,"SoundManager",null),(0,l.default)(o,"WebAudioSound",null),(0,l.default)(o,"AudioSound",null),(0,l.default)(o,"ShaderCompile",null),(0,l.default)(o,"ClassUtils",null),(0,l.default)(o,"SceneUtils",null),(0,l.default)(o,"Context",null),(0,l.default)(o,"Render",null),(0,l.default)(o,"MouseManager",null),(0,l.default)(o,"Text",null),(0,l.default)(o,"Browser",null),(0,l.default)(o,"WebGL",null),(0,l.default)(o,"Pool",null),(0,l.default)(o,"Utils",null),(0,l.default)(o,"Graphics",null),(0,l.default)(o,"Submit",null),(0,l.default)(o,"Stage",null),(0,l.default)(o,"Resource",null),(0,l.default)(o,"__classMap",{})},14827:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.__init=e.Laya=void 0,e._static=function(t,e){for(var i=0,a=e.length;i<a;i+=2)"length"==e[i]?t.length=e[i+1].call(t):function(){var a=e[i],n=e[i+1];(0,l.default)(t,a,{get:function(){return delete this[a],this[a]=n.call(this)},set:function(t){delete this[a],this[a]=t},enumerable:!0,configurable:!0})}()},e.version=e.updateTimer=e.timer=e.systemTimer=e.startTimer=e.stage=e.render=e.physicsTimer=e.loader=e.lateTimer=e.isWXPosMsg=e.isWXOpenDataContext=e.init=e.enableDebugPanel=e.alertGlobalError=void 0;var r=n(i(78914)),s=n(i(3649)),l=n(i(63978)),o=n(i(47302)),u=n(i(51942)),h=n(i(87368)),c=n(i(28146)),d=n(i(17454)),f=i(93561),_=i(22010),v=i(46804),y=i(85058),p=i(64099),g=i(87210),m=i(84269),x=i(23699),T=i(90512),k=i(70153),C=i(54008),S=i(68499),E=i(5072),M=i(59056),L=i(84581),b=i(33321),I=i(71658),R=i(68837),w=i(70084),A=i(3117),B=i(99036),D=i(23395),P=i(54013),F=i(43269),O=i(8865),U=i(27175),N=i(68173),G=i(89432),H=i(53546),W=i(50528),V=i(89761),Y=i(45651),X=i(14880),z=i(86345),K=i(69833),j=i(11179),q=i(57964),Z=i(54347),Q=i(73061),$=i(86836),J=i(43601),tt=i(54642),et=i(23857),it=i(73943),at=i(74433),nt=i(33965),rt=i(36169),st=i(56843),lt=i(52379),ot=i(83219),ut=i(79041),ht=i(50642),ct=i(16729),dt=i(93543),ft=i(45147),_t=i(12560),vt=i(65700),yt=i(35696),pt=i(62082),gt=i(5866),mt=i(99706),xt=i(63969),Tt=i(20516),kt=function(){function t(){(0,h.default)(this,t)}return(0,c.default)(t,null,[{key:"__init",value:function(t){(0,r.default)(t).call(t,(function(t){t.__init$&&t.__init$()}))}},{key:"init",value:function(i,a){if(!t._isinit){t._isinit=!0,(0,s.default)(ArrayBuffer.prototype)||(ArrayBuffer.prototype.slice=t._arrayBufferSlice),U.Browser.__init__();var n=U.Browser.mainCanvas=new P.HTMLCanvas(!0),r=n.source.style;r.position="absolute",r.top=r.left="0px",r.background="#000000",U.Browser.onKGMiniGame||U.Browser.onAlipayMiniGame||U.Browser.container.appendChild(n.source),U.Browser.canvas=new P.HTMLCanvas(!0),U.Browser.context=U.Browser.canvas.getContext("2d"),U.Browser.supportWebAudio=E.SoundManager.__init__(),U.Browser.supportLocalStorage=I.LocalStorage.__init__(),t.systemTimer=new K.Timer(!1),e.systemTimer=bt=K.Timer.gSysTimer=t.systemTimer,t.startTimer=new K.Timer(!1),t.physicsTimer=new K.Timer(!1),t.updateTimer=new K.Timer(!1),t.lateTimer=new K.Timer(!1),t.timer=new K.Timer(!1),e.startTimer=It=f.ILaya.startTimer=t.startTimer,e.lateTimer=At=f.ILaya.lateTimer=t.lateTimer,e.updateTimer=wt=f.ILaya.updateTimer=t.updateTimer,f.ILaya.systemTimer=t.systemTimer,e.timer=Bt=f.ILaya.timer=t.timer,e.physicsTimer=Rt=f.ILaya.physicsTimer=t.physicsTimer,t.loader=new b.LoaderManager,f.ILaya.Laya=t,e.loader=Dt=f.ILaya.loader=t.loader,q.WeakObject.__init__(),Y.SceneUtils.__init(),ut.Mouse.__init__(),st.WebGL.inner_enable();for(var l=arguments.length,o=new Array(l>2?l-2:0),u=2;u<l;u++)o[u-2]=arguments[u];if(o)for(var h=0,c=o.length;h<c;h++)o[h]&&o[h].enable&&o[h].enable();return f.ILaya.Render.isConchApp&&t.enableNative(),t.enableWebGLPlus(),N.CacheManger.beginCheck(),e.stage=Lt=t.stage=new m.Stage,f.ILaya.stage=t.stage,j.Utils.gStage=t.stage,w.URL.rootPath=w.URL._basePath=t._getUrlPath(),dt.MeshQuadTexture.__int__(),ht.MeshVG.__init__(),ft.MeshTexture.__init__(),t.render=new A.Render(0,0,U.Browser.mainCanvas),e.render=Ft=t.render,t.stage.size(i,a),window.stage=t.stage,lt.WebGLContext.__init__(),ct.MeshParticle2D.__init__(),rt.ShaderCompile.__init__(),B.RenderSprite.__init__(),T.KeyBoardManager.__init__(),k.MouseManager.instance.__init__(t.stage,A.Render.canvas),y.Input.__init__(),E.SoundManager.autoStopMusic=!0,X.Stat._StatRender=new z.StatUI,tt.Value2D._initone(Z.ShaderDefines2D.TEXTURE2D,J.TextureSV),tt.Value2D._initone(Z.ShaderDefines2D.TEXTURE2D|Z.ShaderDefines2D.FILTERGLOW,J.TextureSV),tt.Value2D._initone(Z.ShaderDefines2D.PRIMITIVE,$.PrimitiveSV),tt.Value2D._initone(Z.ShaderDefines2D.SKINMESH,Q.SkinSV),A.Render.canvas}}},{key:"_getUrlPath",value:function(){return w.URL.getPath(location.protocol+"//"+location.host+location.pathname)}},{key:"_arrayBufferSlice",value:function(t,e){var i=new Uint8Array(this,t,e-t),a=new Uint8Array(i.length);return a.set(i),a.buffer}},{key:"alertGlobalError",value:function(t){var e=0;U.Browser.window.onerror=t?function(t,i,a,n,r){e++<5&&r&&this.alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+r.stack)}:null}},{key:"_runScript",value:function(e){return U.Browser.window[t._evcode](e)}},{key:"enableDebugPanel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"libs/laya.debugtool.js";if(window.Laya.DebugPanel)window.Laya.DebugPanel.enable();else{var e=U.Browser.createElement("script");e.onload=function(){window.Laya.DebugPanel.enable()},e.src=t,U.Browser.document.body.appendChild(e)}}},{key:"enableWebGLPlus",value:function(){lt.WebGLContext.__init_native()}},{key:"enableNative",value:function(){t.isNativeRender_enable||(t.isNativeRender_enable=!0,A.Render.supportWebGLPlusRendering&&(et.Shader.prototype.uploadTexture2D=function(t){var e=C.LayaGL.instance;e.bindTexture(e.TEXTURE_2D,t)}),nt.RenderState2D.width=U.Browser.window.innerWidth,nt.RenderState2D.height=U.Browser.window.innerHeight,U.Browser.measureText=function(t,e){return window.conchTextCanvas.font=e,window.conchTextCanvas.measureText(t)},m.Stage.clear=function(t){D.Context.set2DRenderConfig();var e=H.ColorUtils.create(t).arrColor,i=C.LayaGL.instance;e&&i.clearColor(e[0],e[1],e[2],e[3]),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT),nt.RenderState2D.clear()},g.Sprite.drawToCanvas=g.Sprite.drawToTexture=function(t,e,i,a,n,r){n-=t.x,r-=t.y,n|=0,r|=0,i|=0,a|=0;var s=new P.HTMLCanvas(!1),l=s.getContext("2d");return s.size(i,a),l.asBitmap=!0,l._targets.start(),B.RenderSprite.renders[e]._fun(t,l,n,r),l.flush(),l._targets.end(),l._targets.restore(),s},(0,l.default)(F.RenderTexture2D.prototype,"uv",{get:function(){return this._uv},set:function(t){this._uv=t}}),P.HTMLCanvas.prototype.getTexture=function(){return this._texture||(this._texture=this.context._targets,this._texture.uv=F.RenderTexture2D.flipyuv,this._texture.bitmap=this._texture),this._texture})}}]),t}();e.Laya=kt,(0,d.default)(kt,"stage",null),(0,d.default)(kt,"systemTimer",null),(0,d.default)(kt,"startTimer",null),(0,d.default)(kt,"physicsTimer",null),(0,d.default)(kt,"updateTimer",null),(0,d.default)(kt,"lateTimer",null),(0,d.default)(kt,"timer",null),(0,d.default)(kt,"loader",null),(0,d.default)(kt,"version","2.12.0"),(0,d.default)(kt,"_isinit",!1),(0,d.default)(kt,"isWXOpenDataContext",!1),(0,d.default)(kt,"isWXPosMsg",!1),(0,d.default)(kt,"__classmap",null),(0,d.default)(kt,"Config",Tt.Config),(0,d.default)(kt,"TextRender",at.TextRender),(0,d.default)(kt,"EventDispatcher",vt.EventDispatcher),(0,d.default)(kt,"SoundChannel",_t.SoundChannel),(0,d.default)(kt,"Stage",m.Stage),(0,d.default)(kt,"Render",A.Render),(0,d.default)(kt,"Browser",U.Browser),(0,d.default)(kt,"Sprite",g.Sprite),(0,d.default)(kt,"Node",p.Node),(0,d.default)(kt,"Context",D.Context),(0,d.default)(kt,"WebGL",st.WebGL),(0,d.default)(kt,"Handler",yt.Handler),(0,d.default)(kt,"RunDriver",pt.RunDriver),(0,d.default)(kt,"Utils",j.Utils),(0,d.default)(kt,"Input",y.Input),(0,d.default)(kt,"Loader",L.Loader),(0,d.default)(kt,"LocalStorage",I.LocalStorage),(0,d.default)(kt,"SoundManager",E.SoundManager),(0,d.default)(kt,"URL",w.URL),(0,d.default)(kt,"Event",xt.Event),(0,d.default)(kt,"Matrix",gt.Matrix),(0,d.default)(kt,"HTMLImage",mt.HTMLImage),(0,d.default)(kt,"Laya",kt),(0,d.default)(kt,"_evcode","eval"),(0,d.default)(kt,"isNativeRender_enable",!1),kt.__classmap=f.ILaya.__classMap,f.ILaya.Timer=K.Timer,f.ILaya.Dragging=W.Dragging,f.ILaya.GraphicsBounds=v.GraphicsBounds,f.ILaya.Sprite=g.Sprite,f.ILaya.TextRender=at.TextRender,f.ILaya.Loader=L.Loader,f.ILaya.TTFLoader=R.TTFLoader,f.ILaya.WebAudioSound=M.WebAudioSound,f.ILaya.SoundManager=E.SoundManager,f.ILaya.ShaderCompile=rt.ShaderCompile,f.ILaya.ClassUtils=G.ClassUtils,f.ILaya.SceneUtils=Y.SceneUtils,f.ILaya.Context=D.Context,f.ILaya.Render=A.Render,f.ILaya.MouseManager=k.MouseManager,f.ILaya.Text=x.Text,f.ILaya.Browser=U.Browser,f.ILaya.WebGL=st.WebGL,f.ILaya.AudioSound=S.AudioSound,f.ILaya.Pool=V.Pool,f.ILaya.Utils=j.Utils,f.ILaya.Graphics=_.Graphics,f.ILaya.Submit=it.Submit,f.ILaya.Stage=m.Stage,f.ILaya.Resource=O.Resource,f.ILaya.WorkerLoader=ot.WorkerLoader;var Ct=window._layalibs;if(Ct){(0,o.default)(Ct).call(Ct,(function(t,e){return t.i-e.i}));for(var St=0;St<Ct.length;St++)Ct[St].f(window,window.document,kt)}var Et=window;Et.Laya?(Et.Laya.Laya=kt,(0,u.default)(Et.Laya,kt)):Et.Laya=kt;var Mt=kt.__init;e.__init=Mt;var Lt,bt,It,Rt,wt,At,Bt,Dt,Pt=kt.init;e.init=Pt,e.stage=Lt,e.systemTimer=bt,e.startTimer=It,e.physicsTimer=Rt,e.updateTimer=wt,e.lateTimer=At,e.timer=Bt,e.loader=Dt;var Ft,Ot=kt.version;e.version=Ot,e.render=Ft,e.isWXOpenDataContext=void 0,e.isWXPosMsg=void 0;var Ut=kt.alertGlobalError;e.alertGlobalError=Ut;var Nt=kt.enableDebugPanel;e.enableDebugPanel=Nt},89280:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.UIConfig=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.UIConfig=o,(0,l.default)(o,"touchScrollEnable",!0),(0,l.default)(o,"mouseWheelEnable",!0),(0,l.default)(o,"showButtons",!0),(0,l.default)(o,"popupBgColor","#000000"),(0,l.default)(o,"popupBgAlpha",.5),(0,l.default)(o,"closeDialogOnSide",!0),window.UIConfig=o},46222:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Const=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.Const=o,(0,l.default)(o,"NOT_ACTIVE",1),(0,l.default)(o,"ACTIVE_INHIERARCHY",2),(0,l.default)(o,"AWAKED",4),(0,l.default)(o,"NOT_READY",8),(0,l.default)(o,"DISPLAY",16),(0,l.default)(o,"HAS_ZORDER",32),(0,l.default)(o,"HAS_MOUSE",64),(0,l.default)(o,"DISPLAYED_INSTAGE",128),(0,l.default)(o,"DRAWCALL_OPTIMIZE",256)},66272:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.IAniLib=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.IAniLib=o,(0,l.default)(o,"Skeleton",null),(0,l.default)(o,"AnimationTemplet",null),(0,l.default)(o,"Templet",null)},91127:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AnimationContent=void 0;var r=n(i(28146)),s=n(i(87368)),l=(0,r.default)((function t(){(0,s.default)(this,t)}));e.AnimationContent=l},13285:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AnimationNodeContent=void 0;var r=n(i(28146)),s=n(i(87368)),l=(0,r.default)((function t(){(0,s.default)(this,t)}));e.AnimationNodeContent=l},59580:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AnimationParser01=void 0;var r=n(i(3649)),s=n(i(87368)),l=n(i(28146)),o=i(91127),u=i(13285),h=i(69692),c=i(66272),d=i(8245),f=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"parse",value:function(t,e){var i,a,n,s,l,f,_,v=e.__getBuffer(),y=e.readUTFString();t._aniClassName=y;var p,g=e.readUTFString().split("\n"),m=e.getUint8(),x=e.getUint32(),T=e.getUint32();x>0&&(p=(0,r.default)(v).call(v,x,T));var k=new d.Byte(p);for(T>0&&(t._publicExtData=(0,r.default)(v).call(v,T,v.byteLength)),t._useParent=!!e.getUint8(),t._anis.length=m,i=0;i<m;i++){var C=t._anis[i]=new o.AnimationContent;C.nodes=[];var S=C.name=g[e.getUint16()];t._aniMap[S]=i,C.bone3DMap={},C.playTime=e.getFloat32();var E=C.nodes.length=e.getUint8();for(C.totalKeyframeDatasLength=0,a=0;a<E;a++){var M=C.nodes[a]=new u.AnimationNodeContent;M.childs=[];var L=e.getInt16();L>=0&&(M.name=g[L],C.bone3DMap[M.name]=a),M.keyFrame=[],M.parentIndex=e.getInt16(),-1==M.parentIndex?M.parent=null:M.parent=C.nodes[M.parentIndex],M.lerpType=e.getUint8();var b=e.getUint32();k.pos=b;var I=M.keyframeWidth=k.getUint16();if(C.totalKeyframeDatasLength+=I,0===M.lerpType||1===M.lerpType)for(M.interpolationMethod=[],M.interpolationMethod.length=I,n=0;n<I;n++)M.interpolationMethod[n]=c.IAniLib.AnimationTemplet.interpolation[k.getUint8()];null!=M.parent&&M.parent.childs.push(M);var R=e.getUint16();R>0&&(M.extenData=(0,r.default)(v).call(v,e.pos,e.pos+R),e.pos+=R);var w=e.getUint16();M.keyFrame.length=w;var A,B=0;for(n=0,s=w;n<s;n++){if((A=M.keyFrame[n]=new h.KeyFramesContent).duration=e.getFloat32(),A.startTime=B,2===M.lerpType){A.interpolationData=[];var D,P=e.getUint8();switch(D=e.getFloat32()){case 254:for(A.interpolationData.length=I,_=0;_<I;_++)A.interpolationData[_]=0;break;case 255:for(A.interpolationData.length=I,_=0;_<I;_++)A.interpolationData[_]=5;break;default:for(A.interpolationData.push(D),f=1;f<P;f++)A.interpolationData.push(e.getFloat32())}}for(A.data=new Float32Array(I),A.dData=new Float32Array(I),A.nextData=new Float32Array(I),l=0;l<I;l++)A.data[l]=e.getFloat32(),A.data[l]>-1e-8&&A.data[l]<1e-8&&(A.data[l]=0);B+=A.duration}A.startTime=C.playTime,M.playTime=C.playTime,t._calculateKeyFrame(M,w,I)}}}}]),t}();e.AnimationParser01=f},56816:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AnimationParser02=void 0;var r=n(i(3649)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(91127),h=i(13285),c=i(69692),d=i(66272),f=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"READ_DATA",value:function(){t._DATA.offset=t._reader.getUint32(),t._DATA.size=t._reader.getUint32()}},{key:"READ_BLOCK",value:function(){for(var e=t._BLOCK.count=t._reader.getUint16(),i=t._BLOCK.blockStarts=[],a=t._BLOCK.blockLengths=[],n=0;n<e;n++)i.push(t._reader.getUint32()),a.push(t._reader.getUint32())}},{key:"READ_STRINGS",value:function(){var e=t._reader.getUint32(),i=t._reader.getUint16(),a=t._reader.pos;t._reader.pos=e+t._DATA.offset;for(var n=0;n<i;n++)t._strings[n]=t._reader.readUTFString();t._reader.pos=a}},{key:"parse",value:function(e,i){t._templet=e,t._reader=i,i.__getBuffer(),t.READ_DATA(),t.READ_BLOCK(),t.READ_STRINGS();for(var a=0,n=t._BLOCK.count;a<n;a++){var r=i.getUint16(),s=t._strings[r],l=t["READ_"+s];if(null==l)throw new Error("model file err,no this function:"+r+" "+s);l.call(null)}}},{key:"READ_ANIMATIONS",value:function(){var e,i,a,n,s=t._reader,l=s.__getBuffer(),o=s.getUint16(),f=[];for(f.length=o,e=0;e<o;e++)f[e]=d.IAniLib.AnimationTemplet.interpolation[s.getByte()];var _=s.getUint8();for(t._templet._anis.length=_,e=0;e<_;e++){var v=t._templet._anis[e]=new u.AnimationContent;v.nodes=[];var y=v.name=t._strings[s.getUint16()];t._templet._aniMap[y]=e,v.bone3DMap={},v.playTime=s.getFloat32();var p=v.nodes.length=s.getInt16();for(v.totalKeyframeDatasLength=0,i=0;i<p;i++){var g=v.nodes[i]=new h.AnimationNodeContent;g.keyframeWidth=o,g.childs=[];var m=s.getUint16();m>=0&&(g.name=t._strings[m],v.bone3DMap[g.name]=i),g.keyFrame=[],g.parentIndex=s.getInt16(),-1==g.parentIndex?g.parent=null:g.parent=v.nodes[g.parentIndex],v.totalKeyframeDatasLength+=o,g.interpolationMethod=f,null!=g.parent&&g.parent.childs.push(g);var x=s.getUint16();g.keyFrame.length=x;var T=null,k=null;for(a=0,n=x;a<n;a++){(T=g.keyFrame[a]=new c.KeyFramesContent).startTime=s.getFloat32(),k&&(k.duration=T.startTime-k.startTime),T.dData=new Float32Array(o),T.nextData=new Float32Array(o);var C=t._DATA.offset,S=s.getUint32(),E=4*o,M=(0,r.default)(l).call(l,C+S,C+S+E);T.data=new Float32Array(M),k=T}T.duration=0,g.playTime=v.playTime,t._templet._calculateKeyFrame(g,x,o)}}}}]),t}();e.AnimationParser02=f,(0,o.default)(f,"_strings",[]),(0,o.default)(f,"_BLOCK",{count:0}),(0,o.default)(f,"_DATA",{offset:0,size:0})},1731:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.AnimationPlayer=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(23583),_=i(14880),v=i(63969);var y=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,d.default)((0,o.default)(t),"isCache",!0),(0,d.default)((0,o.default)(t),"playbackRate",1),t._destroyed=!1,t._currentAnimationClipIndex=-1,t._currentKeyframeIndex=-1,t._currentTime=0,t._overallDuration=Number.MAX_VALUE,t._stopWhenCircleFinish=!1,t._elapsedPlaybackTime=0,t._startUpdateLoopCount=-1,t._cachePlayRate=1,t.cacheFrameRate=60,t.returnToZeroStopped=!1,t}return(0,l.default)(r,[{key:"templet",get:function(){return this._templet},set:function(t){this.state!==f.AnimationState.stopped&&this.stop(!0),this._templet!==t&&(this._templet=t,this._computeFullKeyframeIndices())}},{key:"playStart",get:function(){return this._playStart}},{key:"playEnd",get:function(){return this._playEnd}},{key:"playDuration",get:function(){return this._playDuration}},{key:"overallDuration",get:function(){return this._overallDuration}},{key:"currentAnimationClipIndex",get:function(){return this._currentAnimationClipIndex}},{key:"currentKeyframeIndex",get:function(){return this._currentKeyframeIndex}},{key:"currentPlayTime",get:function(){return this._currentTime+this._playStart}},{key:"currentFrameTime",get:function(){return this._currentFrameTime}},{key:"cachePlayRate",get:function(){return this._cachePlayRate},set:function(t){this._cachePlayRate!==t&&(this._cachePlayRate=t,this._templet&&this._computeFullKeyframeIndices())}},{key:"cacheFrameRate",get:function(){return this._cacheFrameRate},set:function(t){this._cacheFrameRate!==t&&(this._cacheFrameRate=t,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&this._computeFullKeyframeIndices())}},{key:"currentTime",set:function(t){if(-1!==this._currentAnimationClipIndex&&this._templet){if(t<this._playStart||t>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=_.Stat.loopCount;var e=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/e),this._currentFrameTime=this._currentKeyframeIndex*e}}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t,t&&this.event(v.Event.PAUSED)}},{key:"cacheFrameRateInterval",get:function(){return this._cacheFrameRateInterval}},{key:"state",get:function(){return-1===this._currentAnimationClipIndex?f.AnimationState.stopped:this._paused?f.AnimationState.paused:f.AnimationState.playing}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_onTempletLoadedComputeFullKeyframeIndices",value:function(t,e,i){this._templet===i&&this._cachePlayRate===t&&this._cacheFrameRate===e&&this._computeFullKeyframeIndices()}},{key:"_computeFullKeyframeIndices",value:function(){}},{key:"_onAnimationTempletLoaded",value:function(){this.destroyed||this._calculatePlayDuration()}},{key:"_calculatePlayDuration",value:function(){if(this.state!==f.AnimationState.stopped){var t=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=t),this._playEnd>t&&(this._playEnd=t),this._playDuration=this._playEnd-this._playStart}}},{key:"_setPlayParams",value:function(t,e){this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/e+.01),this._currentFrameTime=this._currentKeyframeIndex*e}},{key:"_setPlayParamsWhenStop",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._currentTime=t;var a=i>0?i:t;this._currentKeyframeIndex=Math.floor(a/e+.01),this._currentKeyframeIndex=Math.floor(t/e+.01),this._currentFrameTime=this._currentKeyframeIndex*e,this._currentAnimationClipIndex=-1}},{key:"_update",value:function(t){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet){var e=this._cacheFrameRateInterval*this._cachePlayRate,i=0;this._startUpdateLoopCount!==_.Stat.loopCount&&(i=t*this.playbackRate,this._elapsedPlaybackTime+=i);var a=this.playDuration;if(i+=this._currentTime,0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=a||0===this._overallDuration&&i>=this.playEnd)return this._setPlayParamsWhenStop(a,e,this.playEnd),void this.event(v.Event.STOPPED);if(a>0){if(i>=a)return this._stopWhenCircleFinish?(this._setPlayParamsWhenStop(a,e),this._stopWhenCircleFinish=!1,void this.event(v.Event.STOPPED)):(i%=a,this._setPlayParams(i,e),void this.event(v.Event.COMPLETE));this._setPlayParams(i,e)}else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(a,e),this._stopWhenCircleFinish=!1,void this.event(v.Event.STOPPED);this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event(v.Event.COMPLETE)}}}},{key:"_destroy",value:function(){this.offAll(),this._templet=null,this._destroyed=!0}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2147483647,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(i<0||a<0||n<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==n&&a>n)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=e,this._overallDuration=i,this._playStart=a,this._playEnd=n,this._paused=!1,this._currentAnimationClipIndex=t,this._currentKeyframeIndex=0,this._startUpdateLoopCount=_.Stat.loopCount,this.event(v.Event.PLAYED),this._calculatePlayDuration(),this._update(0)}},{key:"playByFrame",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2147483647,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:30,s=1e3/r;this.play(t,e,i,a*s,n*s)}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event(v.Event.STOPPED)):this._stopWhenCircleFinish=!0}},{key:"destroy",value:function(){}}]),r}(i(65700).EventDispatcher);e.AnimationPlayer=y},23583:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AnimationState=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.AnimationState=o,(0,l.default)(o,"stopped",0),(0,l.default)(o,"paused",1),(0,l.default)(o,"playing",2)},16038:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.AnimationTemplet=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(59580),_=i(56816),v=i(8865),y=i(44329),p=i(66272),g=i(8245),m=i(82850);var x=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,d.default)((0,o.default)(t),"_anis",[]),(0,d.default)((0,o.default)(t),"_aniMap",{}),(0,d.default)((0,o.default)(t),"unfixedLastAniIndex",-1),(0,d.default)((0,o.default)(t),"_fullFrames",null),(0,d.default)((0,o.default)(t),"_boneCurKeyFrm",[]),t}return(0,l.default)(r,[{key:"parse",value:function(t){var e=new g.Byte(t);this._aniVersion=e.readUTFString(),f.AnimationParser01.parse(this,e)}},{key:"_calculateKeyFrame",value:function(t,e,i){var a=t.keyFrame;a[e]=a[0];for(var n=0;n<e;n++)for(var r=a[n],s=0;s<i;s++)r.dData[s]=0===r.duration?0:(a[n+1].data[s]-r.data[s])/r.duration,r.nextData[s]=a[n+1].data[s];a.length--}},{key:"_onAsynLoaded",value:function(t){var e=new g.Byte(t);this._aniVersion=e.readUTFString(),"LAYAANIMATION:02"===this._aniVersion?_.AnimationParser02.parse(this,e):f.AnimationParser01.parse(this,e)}},{key:"getAnimationCount",value:function(){return this._anis.length}},{key:"getAnimation",value:function(t){return this._anis[t]}},{key:"getAniDuration",value:function(t){return this._anis[t].playTime}},{key:"getNodes",value:function(t){return this._anis[t].nodes}},{key:"getNodeIndexWithName",value:function(t,e){return this._anis[t].bone3DMap[e]}},{key:"getNodeCount",value:function(t){return this._anis[t].nodes.length}},{key:"getTotalkeyframesLength",value:function(t){return this._anis[t].totalKeyframeDatasLength}},{key:"getPublicExtData",value:function(){return this._publicExtData}},{key:"getAnimationDataWithCache",value:function(t,e,i,a){var n=e[i];if(n){var r=n[t];return r?r[a]:null}return null}},{key:"setAnimationDataWithCache",value:function(t,e,i,a,n){var r=e[i]||(e[i]={});(r[t]||(r[t]=[]))[a]=n}},{key:"getNodeKeyFrame",value:function(t,e,i){var a=this._boneCurKeyFrm[e],n=t.length;(null==a||a>=n)&&(a=this._boneCurKeyFrm[e]=0);var r=t[a],s=i-r.startTime;if(0==s||s>0&&r.duration>s)return a;var l=0;if(s>0){for(i+=.01,l=a+1;l<n;l++)if((r=t[l]).startTime<=i&&r.startTime+r.duration>i)return this._boneCurKeyFrm[e]=l,l;return n-1}for(l=0;l<a;l++)if((r=t[l]).startTime<=i&&r.startTime+r.duration>i)return this._boneCurKeyFrm[e]=l,l;return a}},{key:"getOriginalData",value:function(t,e,i,a,n){var s=this._anis[t].nodes,l=this._boneCurKeyFrm;l.length<s.length&&(l.length=s.length);for(var o=0,u=0,h=s.length,c=0;u<h;u++){var d,f=s[u],_=f.keyFrame;d=_[this.getNodeKeyFrame(_,u,n)],f.dataOffset=c;var v=n-d.startTime,y=f.lerpType;if(y)switch(y){case 0:case 1:for(o=0;o<f.keyframeWidth;)o+=f.interpolationMethod[o](f,o,e,c+o,d.data,v,d.dData,d.duration,d.nextData);break;case 2:var p=d.interpolationData,g=p.length,m=0;for(o=0;o<g;){var x=p[o];switch(x){case 6:case 7:o+=r.interpolation[x](f,m,e,c+m,d.data,v,d.dData,d.duration,d.nextData,p,o+1);break;default:o+=r.interpolation[x](f,m,e,c+m,d.data,v,d.dData,d.duration,d.nextData)}m++}}else for(o=0;o<f.keyframeWidth;)o+=f.interpolationMethod[o](f,o,e,c+o,d.data,v,d.dData,d.duration,d.nextData);c+=f.keyframeWidth}}},{key:"getNodesCurrentFrameIndex",value:function(t,e){var i=this._anis[t].nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(i.length),this.unfixedCurrentTimes=new Float32Array(i.length),this.unfixedLastAniIndex=t);for(var a=0,n=i.length;a<n;a++){var r=i[a];for(e<this.unfixedCurrentTimes[a]&&(this.unfixedCurrentFrameIndexes[a]=0),this.unfixedCurrentTimes[a]=e;this.unfixedCurrentFrameIndexes[a]<r.keyFrame.length&&!(r.keyFrame[this.unfixedCurrentFrameIndexes[a]].startTime>this.unfixedCurrentTimes[a]);)this.unfixedCurrentFrameIndexes[a]++;this.unfixedCurrentFrameIndexes[a]--}return this.unfixedCurrentFrameIndexes}},{key:"getOriginalDataUnfixedRate",value:function(t,e,i){var a=this._anis[t].nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(a.length),this.unfixedCurrentTimes=new Float32Array(a.length),this.unfixedKeyframes=[],this.unfixedLastAniIndex=t);for(var n=0,s=0,l=a.length,o=0;s<l;s++){var u=a[s];for(i<this.unfixedCurrentTimes[s]&&(this.unfixedCurrentFrameIndexes[s]=0),this.unfixedCurrentTimes[s]=i;this.unfixedCurrentFrameIndexes[s]<u.keyFrame.length&&!(u.keyFrame[this.unfixedCurrentFrameIndexes[s]].startTime>this.unfixedCurrentTimes[s]);)this.unfixedKeyframes[s]=u.keyFrame[this.unfixedCurrentFrameIndexes[s]],this.unfixedCurrentFrameIndexes[s]++;var h=this.unfixedKeyframes[s];u.dataOffset=o;var c=i-h.startTime;if(u.lerpType)switch(u.lerpType){case 0:case 1:for(n=0;n<u.keyframeWidth;)n+=u.interpolationMethod[n](u,n,e,o+n,h.data,c,h.dData,h.duration,h.nextData);break;case 2:var d=h.interpolationData,f=d.length,_=0;for(n=0;n<f;){var v=d[n];switch(v){case 6:case 7:n+=r.interpolation[v](u,_,e,o+_,h.data,c,h.dData,h.duration,h.nextData,d,n+1);break;default:n+=r.interpolation[v](u,_,e,o+_,h.data,c,h.dData,h.duration,h.nextData)}_++}}else for(n=0;n<u.keyframeWidth;)n+=u.interpolationMethod[n](u,n,e,o+n,h.data,c,h.dData,h.duration,h.nextData);o+=u.keyframeWidth}}}],[{key:"_LinearInterpolation_0",value:function(t,e,i,a,n,r,s,l,o){return i[a]=n[e]+r*s[e],1}},{key:"_QuaternionInterpolation_1",value:function(t,e,i,a,n,r,s,l,o){var u=0===l?0:r/l;return y.MathUtil.slerpQuaternionArray(n,e,o,e,u,i,a),4}},{key:"_AngleInterpolation_2",value:function(t,e,i,a,n,r,s,l,o){return 0}},{key:"_RadiansInterpolation_3",value:function(t,e,i,a,n,r,s,l,o){return 0}},{key:"_Matrix4x4Interpolation_4",value:function(t,e,i,a,n,r,s,l,o){for(var u=0;u<16;u++,e++)i[a+u]=n[e]+r*s[e];return 16}},{key:"_NoInterpolation_5",value:function(t,e,i,a,n,r,s,l,o){return i[a]=n[e],1}},{key:"_BezierInterpolation_6",value:function(t,e,i,a,n,r,s,l,o){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;return i[a]=n[e]+(o[e]-n[e])*m.BezierLerp.getBezierRate(r/l,u[h],u[h+1],u[h+2],u[h+3]),5}},{key:"_BezierInterpolation_7",value:function(t,e,i,a,n,r,s,l,o){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;return i[a]=u[h+4]+u[h+5]*m.BezierLerp.getBezierRate((.001*r+u[h+6])/u[h+7],u[h],u[h+1],u[h+2],u[h+3]),9}}]),r}(v.Resource);e.AnimationTemplet=x,(0,d.default)(x,"interpolation",[x._LinearInterpolation_0,x._QuaternionInterpolation_1,x._AngleInterpolation_2,x._RadiansInterpolation_3,x._Matrix4x4Interpolation_4,x._NoInterpolation_5,x._BezierInterpolation_6,x._BezierInterpolation_7]),p.IAniLib.AnimationTemplet=x},64:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.GraphicsAni=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(5866);var f=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"drawSkin",value:function(t,e){this.drawTriangles(t.texture,0,0,t.vertices,t.uvs,t.indexes,t.transform||d.Matrix.EMPTY,e)}}],[{key:"create",value:function(){return r._caches.pop()||new r}},{key:"recycle",value:function(t){t.clear(),r._caches.push(t)}}]),r}(i(22010).Graphics);e.GraphicsAni=f,(0,c.default)(f,"_caches",[])},69692:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.KeyFramesContent=void 0;var r=n(i(28146)),s=n(i(87368)),l=(0,r.default)((function t(){(0,s.default)(this,t)}));e.KeyFramesContent=l},28684:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Bone=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(69766),u=i(87210),h=i(5866),c=i(93561),d=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"length",10),(0,l.default)(this,"resultTransform",new o.Transform),(0,l.default)(this,"resultMatrix",new h.Matrix),(0,l.default)(this,"inheritScale",!0),(0,l.default)(this,"inheritRotation",!0),(0,l.default)(this,"d",-1),(0,l.default)(this,"_children",[])}return(0,s.default)(t,[{key:"setTempMatrix",value:function(t){this._tempMatrix=t;var e,i=0;for(i=0,e=this._children.length;i<e;i++)this._children[i].setTempMatrix(this._tempMatrix)}},{key:"update",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.rotation=this.transform.skX,e)t=this.resultTransform.getMatrix(),h.Matrix.mul(t,e,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)t=this.resultTransform.getMatrix(),h.Matrix.mul(t,this.parentBone.resultMatrix,this.resultMatrix);else{var i,a,n,r=this.parentBone,s=this.parentBone.resultMatrix;t=this.resultTransform.getMatrix();var l=s.a*t.tx+s.c*t.ty+s.tx,o=s.b*t.tx+s.d*t.ty+s.ty,u=new h.Matrix;this.inheritRotation?(i=Math.atan2(r.resultMatrix.b,r.resultMatrix.a),a=Math.cos(i),n=Math.sin(i),u.setTo(a,n,-n,a,0,0),h.Matrix.mul(this._tempMatrix,u,h.Matrix.TEMP),h.Matrix.TEMP.copyTo(u),t=this.resultTransform.getMatrix(),h.Matrix.mul(t,u,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI),this.resultMatrix.tx=l,this.resultMatrix.ty=o):(this.inheritScale,t=this.resultTransform.getMatrix(),h.Matrix.TEMP.identity(),h.Matrix.TEMP.d=this.d,h.Matrix.mul(t,h.Matrix.TEMP,this.resultMatrix),this.resultMatrix.tx=l,this.resultMatrix.ty=o)}else(t=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var c=0,d=0;for(c=0,d=this._children.length;c<d;c++)this._children[c].update()}},{key:"updateChild",value:function(){var t,e=0;for(e=0,t=this._children.length;e<t;e++)this._children[e].update()}},{key:"setRotation",value:function(t){this._sprite&&(this._sprite.rotation=180*t/Math.PI)}},{key:"updateDraw",value:function(e,i){t.ShowBones&&!t.ShowBones[this.name]||(this._sprite?(this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=i+this.resultMatrix.ty):(this._sprite=new u.Sprite,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),c.ILaya.stage.addChild(this._sprite),this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=i+this.resultMatrix.ty));var a,n=0;for(n=0,a=this._children.length;n<a;n++)this._children[n].updateDraw(e,i)}},{key:"addChild",value:function(t){this._children.push(t),t.parentBone=this}},{key:"findBone",value:function(t){if(this.name==t)return this;var e,i,a;for(e=0,i=this._children.length;e<i;e++)if(a=this._children[e].findBone(t))return a;return null}},{key:"localToWorld",value:function(t){var e=t[0],i=t[1];t[0]=e*this.resultMatrix.a+i*this.resultMatrix.c+this.resultMatrix.tx,t[1]=e*this.resultMatrix.b+i*this.resultMatrix.d+this.resultMatrix.ty}}]),t}();e.Bone=d,(0,l.default)(d,"ShowBones",{})},81050:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BoneSlot=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(43124),u=i(21196),h=i(93561),c=i(5866),d=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"srcDisplayIndex",-1),(0,l.default)(this,"type","src"),(0,l.default)(this,"displayIndex",-1),(0,l.default)(this,"originalIndex",-1),(0,l.default)(this,"_replaceDic",{})}return(0,s.default)(t,[{key:"showSlotData",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currSlotData=t,e&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null}},{key:"showDisplayByName",value:function(t){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(t))}},{key:"replaceDisplayByName",value:function(t,e){var i,a;this.currSlotData&&(i=this.currSlotData.getDisplayByName(t),a=this.currSlotData.getDisplayByName(e),this.replaceDisplayByIndex(i,a))}},{key:"replaceDisplayByIndex",value:function(t,e){this.currSlotData&&(this._replaceDic[t]=e,this.originalIndex==t&&this.showDisplayByIndex(t))}},{key:"showDisplayByIndex",value:function(t){if(this.originalIndex=t,null!=this._replaceDic[t]&&(t=this._replaceDic[t]),this.currSlotData&&t>-1&&t<this.currSlotData.displayArr.length){if(this.displayIndex=t,this.currDisplayData=this.currSlotData.displayArr[t],this.currDisplayData){var e=this.currDisplayData.name;this.currTexture=this.templet.getTexture(e),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null}},{key:"replaceSkin",value:function(t){this._diyTexture=t,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)}},{key:"setParentMatrix",value:function(t){this._parentMatrix=t}},{key:"getSaveVerticle",value:function(e){return t.useSameMatrixAndVerticle&&this._preGraphicVerticle&&t.isSameArr(e,this._preGraphicVerticle)?e=this._preGraphicVerticle:(e=h.ILaya.Utils.copyArray([],e),this._preGraphicVerticle=e),e}},{key:"getSaveMatrix",value:function(e){if(t.useSameMatrixAndVerticle&&this._preGraphicMatrix&&t.isSameMatrix(e,this._preGraphicMatrix))e=this._preGraphicMatrix;else{var i=e.clone();e=i,this._preGraphicMatrix=e}return e}},{key:"draw",value:function(e,i){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if((null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var r,s=this.currTexture;switch(this._diyTexture&&(s=this._diyTexture),this.currDisplayData.type){case 0:if(e){var l=this.getDisplayMatrix();if(this._parentMatrix){var u=!1;if(l){var h;if(c.Matrix.mul(l,this._parentMatrix,c.Matrix.TEMP),a?(null==this._resultMatrix&&(this._resultMatrix=new c.Matrix),h=this._resultMatrix):h=t._tempResultMatrix,this._diyTexture&&this.currDisplayData.uvs){var d=t._tempMatrix;d.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(d.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(u=!0,d.rotate(-Math.PI/2)),c.Matrix.mul(d,c.Matrix.TEMP,h)}else c.Matrix.TEMP.copyTo(h);a||(h=this.getSaveMatrix(h)),h._checkTransform(),u?e.drawTexture(s,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,h,n):e.drawTexture(s,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,h,n)}}}break;case 1:if(a?(null==this._skinSprite&&(this._skinSprite=t.createSkinMesh()),r=this._skinSprite):r=t.createSkinMesh(),null==r)return;var f;if(null==this.currDisplayData.bones){var _,v=this.currDisplayData.weights;this.deformData&&(v=this.deformData),this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=o.UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=o.UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),_=this._curDiyUV):_=this.currDisplayData.uvs,this._mVerticleArr=v,this.currDisplayData.triangles.length,f=this.currDisplayData.triangles,this.deformData&&(a||(this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr))),r.init2(s,f,this._mVerticleArr,_);var y,p=this.getDisplayMatrix();this._parentMatrix&&p&&(c.Matrix.mul(p,this._parentMatrix,c.Matrix.TEMP),a?(null==this._resultMatrix&&(this._resultMatrix=new c.Matrix),y=this._resultMatrix):y=t._tempResultMatrix,c.Matrix.TEMP.copyTo(y),a||(y=this.getSaveMatrix(y)),r.transform=y)}else this.skinMesh(i,r);e.drawSkin(r,n);break;case 2:if(a?(null==this._skinSprite&&(this._skinSprite=t.createSkinMesh()),r=this._skinSprite):r=t.createSkinMesh(),null==r)return;this.skinMesh(i,r),e.drawSkin(r,n)}}}},{key:"skinMesh",value:function(e,i){var a,n=this.currTexture,r=this.currDisplayData.bones;this._diyTexture?(n=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=o.UVTools.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=o.UVTools.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),a=this._curDiyUV):a=this.currDisplayData.uvs;var s,l,u,h,c,d=this.currDisplayData.weights,f=this.currDisplayData.triangles,_=0,v=0,y=0,p=0,g=0,m=0,x=0;if(t._tempVerticleArr.length=0,c=t._tempVerticleArr,this.deformData&&this.deformData.length>0){var T=0;for(m=0,x=r.length;m<x;){for(y=r[m++]+m,_=0,v=0;m<y;m++)l=e[r[m]],u=d[p]+this.deformData[T++],h=d[p+1]+this.deformData[T++],g=d[p+2],_+=(u*l.a+h*l.c+l.tx)*g,v+=(u*l.b+h*l.d+l.ty)*g,p+=3;c.push(_,v)}}else for(m=0,x=r.length;m<x;){for(y=r[m++]+m,_=0,v=0;m<y;m++)l=e[r[m]],u=d[p],h=d[p+1],g=d[p+2],_+=(u*l.a+h*l.c+l.tx)*g,v+=(u*l.b+h*l.d+l.ty)*g,p+=3;c.push(_,v)}this._mVerticleArr=c,s=f,this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr),i.init2(n,s,this._mVerticleArr,a)}},{key:"drawBonePoint",value:function(t){t&&this._parentMatrix&&t.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")}},{key:"getDisplayMatrix",value:function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null}},{key:"getMatrix",value:function(){return this._resultMatrix}},{key:"copy",value:function(){var e=new t;return e.type="copy",e.name=this.name,e.attachmentName=this.attachmentName,e.srcDisplayIndex=this.srcDisplayIndex,e.parent=this.parent,e.displayIndex=this.displayIndex,e.templet=this.templet,e.currSlotData=this.currSlotData,e.currTexture=this.currTexture,e.currDisplayData=this.currDisplayData,e}}],[{key:"createSkinMesh",value:function(){return new u.SkinMeshForGraphic}},{key:"isSameArr",value:function(t,e){if(t.length!=e.length)return!1;var i,a;for(a=t.length,i=0;i<a;i++)if(t[i]!=e[i])return!1;return!0}},{key:"isSameMatrix",value:function(t,e){return t.a==e.a&&t.b==e.b&&t.c==e.c&&t.d==e.d&&Math.abs(t.tx-e.tx)<1e-5&&Math.abs(t.ty-e.ty)<1e-5}}]),t}();e.BoneSlot=d,(0,l.default)(d,"_tempMatrix",new c.Matrix),(0,l.default)(d,"_tempResultMatrix",new c.Matrix),(0,l.default)(d,"useSameMatrixAndVerticle",!0),(0,l.default)(d,"_tempVerticleArr",[])},27948:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DeformAniData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"deformSlotDataList",[])}));e.DeformAniData=o},14337:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DeformSlotData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"deformSlotDisplayList",[])}));e.DeformSlotData=o},62975:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DeformSlotDisplayData=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"slotIndex",-1),(0,l.default)(this,"timeList",[]),(0,l.default)(this,"vectices",[]),(0,l.default)(this,"tweenKeyList",[]),(0,l.default)(this,"frameIndex",0)}return(0,s.default)(t,[{key:"binarySearch1",value:function(t,e){var i=0,a=t.length-2;if(0==a)return 1;for(var n=a>>>1;;){if(t[Math.floor(n+1)]<=e?i=n+1:a=n,i==a)return i+1;n=i+a>>>1}return 0}},{key:"apply",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t+=.05,!(this.timeList.length<=0)){var a=0,n=this.timeList[0];if(!(t<n)){var r=this.vectices[0].length,s=[],l=this.binarySearch1(this.timeList,t);if(this.frameIndex=l,t>=this.timeList[this.timeList.length-1]){var o=this.vectices[this.vectices.length-1];if(i<1)for(a=0;a<r;a++)s[a]+=(o[a]-s[a])*i;else for(a=0;a<r;a++)s[a]=o[a];this.deformData=s}else{var u,h=this.vectices[this.frameIndex-1],c=this.vectices[this.frameIndex],d=this.timeList[this.frameIndex-1],f=this.timeList[this.frameIndex];for(i=this.tweenKeyList[l-1]?(t-d)/(f-d):0,a=0;a<r;a++)u=h[a],s[a]=u+(c[a]-u)*i;this.deformData=s}}}}}]),t}();e.DeformSlotDisplayData=o},80355:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawOrderData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"drawOrder",[])}));e.DrawOrderData=o},98184:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.EventData=void 0;var r=n(i(28146)),s=n(i(87368)),l=(0,r.default)((function t(){(0,s.default)(this,t)}));e.EventData=l},52717:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.IkConstraint=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(5866),u=i(87210),h=i(93561),c=function(){function t(e,i){(0,r.default)(this,t),(0,l.default)(this,"isSpine",!0),(0,l.default)(this,"isDebug",!1),this._targetBone=i[e.targetBoneIndex],this.isSpine=e.isSpine,null==this._bones&&(this._bones=[]),this._bones.length=0;for(var a=0,n=e.boneIndexs.length;a<n;a++)this._bones.push(i[e.boneIndexs[a]]);this.name=e.name,this.mix=e.mix,this.bendDirection=e.bendDirection}return(0,s.default)(t,[{key:"apply",value:function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}}},{key:"_applyIk1",value:function(e,i,a,n){var r=e.parentBone,s=1/(r.resultMatrix.a*r.resultMatrix.d-r.resultMatrix.b*r.resultMatrix.c),l=i-r.resultMatrix.tx,o=a-r.resultMatrix.ty,u=(l*r.resultMatrix.d-o*r.resultMatrix.c)*s-e.transform.x,h=(o*r.resultMatrix.a-l*r.resultMatrix.b)*s-e.transform.y,c=Math.atan2(h,u)*t.radDeg-0-e.transform.skX;e.transform.scX<0&&(c+=180),c>180?c-=360:c<-180&&(c+=360),e.transform.skX=e.transform.skY=e.transform.skX+c*n,e.update()}},{key:"updatePos",value:function(t,e){this._sp&&this._sp.pos(t,e)}},{key:"_applyIk2",value:function(e,i,a,n,r,s){if(0!=s){var l,o,c,d=e.resultTransform.x,f=e.resultTransform.y,_=e.transform.scX,v=e.transform.scY,y=i.transform.scX;_<0?(_=-_,l=180,c=-1):(l=0,c=1),v<0&&(v=-v,c=-c),y<0?(y=-y,o=180):o=0;var p,g,m,x=i.resultTransform.x,T=e.resultMatrix.a,k=e.resultMatrix.c,C=e.resultMatrix.b,S=e.resultMatrix.d,E=Math.abs(_-v)<=1e-4;E?(g=T*x+k*(p=i.resultTransform.y)+e.resultMatrix.tx,m=C*x+S*p+e.resultMatrix.ty):(p=0,g=T*x+e.resultMatrix.tx,m=C*x+e.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new u.Sprite,h.ILaya.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(a,n,15,"#ffff00"),this._sp.graphics.drawCircle(g,m,15,"#ff00ff")),e.setRotation(Math.atan2(m-e.resultMatrix.ty,g-e.resultMatrix.tx));var M=e.parentBone;T=M.resultMatrix.a,k=M.resultMatrix.c,C=M.resultMatrix.b;var L,b,I=1/(T*(S=M.resultMatrix.d)-k*C),R=a-M.resultMatrix.tx,w=n-M.resultMatrix.ty,A=(R*S-w*k)*I-d,B=(w*T-R*C)*I-f,D=((R=g-M.resultMatrix.tx)*S-(w=m-M.resultMatrix.ty)*k)*I-d,P=(w*T-R*C)*I-f,F=Math.sqrt(D*D+P*P),O=i.length*y;if(E){var U=(A*A+B*B-F*F-(O*=_)*O)/(2*F*O);U<-1?U=-1:U>1&&(U=1),b=Math.acos(U)*r,T=F+O*U,k=O*Math.sin(b),L=Math.atan2(B*T-A*k,A*T+B*k)}else{var N=(T=_*O)*T,G=(k=v*O)*k,H=A*A+B*B,W=Math.atan2(B,A),V=-2*G*F,Y=G-N;if((S=V*V-4*Y*(C=G*F*F+N*H-N*G))>0){var X=Math.sqrt(S);V<0&&(X=-X);var z=(X=-(V+X)/2)/Y,K=C/X,j=Math.abs(z)<Math.abs(K)?z:K;j*j<=H&&(w=Math.sqrt(H-j*j)*r,L=W-Math.atan2(w,j),b=Math.atan2(w/v,(j-F)/_))}var q=0,Z=Number.MAX_VALUE,Q=0,$=0,J=0,tt=0,et=0,it=0;(S=(R=F+T)*R)>tt&&(J=0,tt=S,et=R),(S=(R=F-T)*R)<Z&&(q=Math.PI,Z=S,Q=R);var at=Math.acos(-T*F/(N-G));(S=(R=T*Math.cos(at)+F)*R+(w=k*Math.sin(at))*w)<Z&&(q=at,Z=S,Q=R,$=w),S>tt&&(J=at,tt=S,et=R,it=w),H<=(Z+tt)/2?(L=W-Math.atan2($*r,Q),b=q*r):(L=W-Math.atan2(it*r,et),b=J*r)}var nt=Math.atan2(p,x)*c,rt=e.resultTransform.skX;(L=(L-nt)*t.radDeg+l-rt)>180?L-=360:L<-180&&(L+=360),e.resultTransform.x=d,e.resultTransform.y=f,e.resultTransform.skX=e.resultTransform.skY=rt+L*s,rt=i.resultTransform.skX,rt%=360,(b=((b+nt)*t.radDeg-0)*c+o-rt)>180?b-=360:b<-180&&(b+=360),i.resultTransform.x=x,i.resultTransform.y=p,i.resultTransform.skX=i.resultTransform.skY=i.resultTransform.skY+b*s,e.update()}}},{key:"_applyIk3",value:function(e,i,a,n,r,s){if(0!=s){var l,o,c,d,f,_,v=i.resultMatrix.a*i.length,y=i.resultMatrix.b*i.length,p=v*v+y*y,g=Math.sqrt(p),m=e.resultMatrix.tx,x=e.resultMatrix.ty,T=i.resultMatrix.tx,k=i.resultMatrix.ty,C=T-m,S=k-x,E=C*C+S*S,M=Math.sqrt(E),L=(C=a-e.resultMatrix.tx)*C+(S=n-e.resultMatrix.ty)*S,b=Math.sqrt(L);if(g+M<=b||b+g<=M||b+M<=g){var I;T=m+(I=g+M<=b?1:-1)*(a-m)*M/b,k=x+I*(n-x)*M/b}else{var R=(E-p+L)/(2*L),w=Math.sqrt(E-R*R*L)/b,A=m+C*R,B=x+S*R,D=-S*w,P=C*w;r>0?(T=A-D,k=B-P):(T=A+D,k=B+P)}l=T,o=k,this.isDebug&&(this._sp||(this._sp=new u.Sprite,h.ILaya.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(m,x,15,"#ff00ff"),this._sp.graphics.drawCircle(a,n,15,"#ffff00"),this._sp.graphics.drawCircle(l,o,15,"#ff00ff")),c=Math.atan2(o-e.resultMatrix.ty,l-e.resultMatrix.tx),e.setRotation(c),(d=t._tempMatrix).identity(),d.rotate(c),d.scale(e.resultMatrix.getScaleX(),e.resultMatrix.getScaleY()),d.translate(e.resultMatrix.tx,e.resultMatrix.ty),d.copyTo(e.resultMatrix),e.updateChild(),f=Math.atan2(n-o,a-l),i.setRotation(f),(_=t._tempMatrix).identity(),_.rotate(f),_.scale(i.resultMatrix.getScaleX(),i.resultMatrix.getScaleY()),_.translate(l,o),d.copyTo(i.resultMatrix),i.updateChild()}}}]),t}();e.IkConstraint=c,(0,l.default)(c,"radDeg",180/Math.PI),(0,l.default)(c,"degRad",Math.PI/180),(0,l.default)(c,"_tempMatrix",new o.Matrix)},67628:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.IkConstraintData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"boneNames",[]),(0,l.default)(this,"bendDirection",1),(0,l.default)(this,"mix",1),(0,l.default)(this,"isSpine",!0),(0,l.default)(this,"targetBoneIndex",-1),(0,l.default)(this,"boneIndexs",[])}));e.IkConstraintData=o},24493:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.PathConstraint=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(5866),u=function(){function t(e,i){(0,r.default)(this,t),(0,l.default)(this,"_debugKey",!1),(0,l.default)(this,"_segments",[]),(0,l.default)(this,"_curves",[]),this.data=e,this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.bones=[];for(var a=this.data.bones,n=0,s=a.length;n<s;n++)this.bones.push(i[a[n]])}return(0,s.default)(t,[{key:"apply",value:function(t,e){if(this.target){var i=this.translateMix,a=this.translateMix,n=a>0,r=this.data.spacingMode,s="length"==r,l=this.data.rotateMode,o="tangent"==l,u="chainScale"==l,h=[],c=this.bones.length,d=o?c:c+1,f=[];this._spaces=f,f[0]=this.position;var _=this.spacing;if(u||s)for(var v=0,y=d-1;v<y;){var p=this.bones[v],g=p.length,m=g*p.resultMatrix.a,x=g*p.resultMatrix.b;g=Math.sqrt(m*m+x*x),u&&(h[v]=g),f[++v]=s?Math.max(0,g+_):_}else for(v=1;v<d;v++)f[v]=_;var T=this.computeWorldPositions(this.target,t,e,d,o,"percent"==this.data.positionMode,"percent"==r);if(this._debugKey){for(v=0;v<T.length;v++)e.drawCircle(T[v++],T[v++],5,"#00ff00");var k=[];for(v=0;v<T.length;v++)k.push(T[v++],T[v++]);e.drawLines(0,0,k,"#ff0000")}var C,S=T[0],E=T[1],M=this.data.offsetRotation,L="chain"==l&&0==M;for(v=0,C=3;v<c;v++,C+=3){(p=this.bones[v]).resultMatrix.tx+=(S-p.resultMatrix.tx)*i,p.resultMatrix.ty+=(E-p.resultMatrix.ty)*i;var b=(m=T[C])-S,I=(x=T[C+1])-E;if(u&&0!=(g=h[v])){var R=(Math.sqrt(b*b+I*I)/g-1)*a+1;p.resultMatrix.a*=R,p.resultMatrix.c*=R}if(S=m,E=x,n){var w,A,B,D=p.resultMatrix.a,P=p.resultMatrix.c,F=p.resultMatrix.b,O=p.resultMatrix.d;w=o?T[C-1]:0==f[v+1]?T[C+2]:Math.atan2(I,b),w-=Math.atan2(F,D)-M/180*Math.PI,L&&(A=Math.cos(w),B=Math.sin(w),S+=((g=p.length)*(A*D-B*F)-b)*a,E+=(g*(B*D+A*F)-I)*a),w>Math.PI?w-=2*Math.PI:w<-Math.PI&&(w+=2*Math.PI),w*=a,A=Math.cos(w),B=Math.sin(w),p.resultMatrix.a=A*D-B*F,p.resultMatrix.c=A*P-B*O,p.resultMatrix.b=B*D+A*F,p.resultMatrix.d=B*P+A*O}}}}},{key:"computeWorldVertices2",value:function(e,i,a,n,r,s){var l,o,u,h=e.currDisplayData.bones,c=e.currDisplayData.weights,d=e.currDisplayData.triangles,f=0,_=0,v=0,y=0,p=0,g=0,m=0,x=0,T=0,k=0;if(null!=h){for(f=0;f<a;f+=2)_+=(y=h[_])+1,v+=y;var C=i;for(p=s,g=3*v;p<n;p+=2){for(m=0,x=0,y=h[_++],y+=_;_<y;_++,g+=3){l=C[h[_]].resultMatrix,T=c[g],k=c[g+1];var S=c[g+2];m+=(T*l.a+k*l.c+l.tx)*S,x+=(T*l.b+k*l.d+l.ty)*S}r[p]=m,r[p+1]=x}}else{var E,M;if(d||(d=c),e.deformData&&(d=e.deformData),E=e.parent,i)for(u=i.length,f=0;f<u;f++)if(i[f].name==E){o=i[f];break}o&&(M=o.resultMatrix),M||(M=t._tempMt);var L=M.tx,b=M.ty,I=M.a,R=M.b,w=M.c,A=M.d;for(o&&(A*=o.d),_=a,p=s;p<n;_+=2,p+=2)T=d[_],k=d[_+1],r[p]=T*I+k*R+L,r[p+1]=-(T*w+k*A+b)}}},{key:"computeWorldPositions",value:function(t,e,i,a,n,r,s){t.currDisplayData.bones,t.currDisplayData.weights,t.currDisplayData.triangles;var l,o,u,h,c,d,f,_,v=[],y=0,p=t.currDisplayData.verLen,g=this.position,m=this._spaces,x=[],T=p/6,k=-1;if(T--,p-=4,this.computeWorldVertices2(t,e,2,p,v,0),this._debugKey)for(y=0;y<v.length;)i.drawCircle(v[y++],v[y++],10,"#ff0000");_=v,this._curves.length=T;var C=this._curves;l=0;var S,E,M,L,b,I,R,w,A,B=_[0],D=_[1],P=0,F=0,O=0,U=0,N=0,G=0;for(y=0,A=2;y<T;y++,A+=6)b=2*(S=.1875*(B-2*(P=_[A])+(O=_[A+2])))+(M=.09375*(3*(P-O)-B+(N=_[A+4]))),I=2*(E=.1875*(D-2*(F=_[A+1])+(U=_[A+3])))+(L=.09375*(3*(F-U)-D+(G=_[A+5]))),R=.75*(P-B)+S+.16666667*M,w=.75*(F-D)+E+.16666667*L,l+=Math.sqrt(R*R+w*w),R+=b,w+=I,b+=M,I+=L,l+=Math.sqrt(R*R+w*w),R+=b,w+=I,l+=Math.sqrt(R*R+w*w),R+=b+M,w+=I+L,l+=Math.sqrt(R*R+w*w),C[y]=l,B=N,D=G;if(r&&(g*=l),s)for(y=0;y<a;y++)m[y]*=l;var H,W=this._segments,V=0;for(y=0,o=0,u=0,H=0;y<a;y++,o+=3)if((h=g+=c=m[y])<0)this.addBeforePosition(h,_,0,x,o);else if(h>l)this.addAfterPosition(h-l,_,p-4,x,o);else{for(;;u++)if(!(h>(f=C[u]))){0==u?h/=f:h=(h-(d=C[u-1]))/(f-d);break}if(u!=k){k=u;var Y=6*u;for(b=2*(S=.03*((B=_[Y])-2*(P=_[Y+2])+(O=_[Y+4])))+(M=.006*(3*(P-O)-B+(N=_[Y+6]))),I=2*(E=.03*((D=_[Y+1])-2*(F=_[Y+3])+(U=_[Y+5])))+(L=.006*(3*(F-U)-D+(G=_[Y+7]))),R=.3*(P-B)+S+.16666667*M,w=.3*(F-D)+E+.16666667*L,V=Math.sqrt(R*R+w*w),W[0]=V,Y=1;Y<8;Y++)R+=b,w+=I,b+=M,I+=L,V+=Math.sqrt(R*R+w*w),W[Y]=V;R+=b,w+=I,V+=Math.sqrt(R*R+w*w),W[8]=V,R+=b+M,w+=I+L,V+=Math.sqrt(R*R+w*w),W[9]=V,H=0}for(h*=V;;H++)if(!(h>(f=W[H]))){0==H?h/=f:h=H+(h-(d=W[H-1]))/(f-d);break}this.addCurvePosition(.1*h,B,D,P,F,O,U,N,G,x,o,n||y>0&&0==c)}return x}},{key:"addBeforePosition",value:function(t,e,i,a,n){var r=e[i],s=e[i+1],l=e[i+2]-r,o=e[i+3]-s,u=Math.atan2(o,l);a[n]=r+t*Math.cos(u),a[n+1]=s+t*Math.sin(u),a[n+2]=u}},{key:"addAfterPosition",value:function(t,e,i,a,n){var r=e[i+2],s=e[i+3],l=r-e[i],o=s-e[i+1],u=Math.atan2(o,l);a[n]=r+t*Math.cos(u),a[n+1]=s+t*Math.sin(u),a[n+2]=u}},{key:"addCurvePosition",value:function(t,e,i,a,n,r,s,l,o,u,h,c){0==t&&(t=1e-4);var d=t*t,f=d*t,_=1-t,v=_*_,y=v*_,p=_*t,g=3*p,m=_*g,x=g*t,T=e*y+a*m+r*x+l*f,k=i*y+n*m+s*x+o*f;u[h]=T,u[h+1]=k,u[h+2]=c?Math.atan2(k-(i*v+n*p*2+s*d),T-(e*v+a*p*2+r*d)):0}}]),t}();e.PathConstraint=u,(0,l.default)(u,"BEFORE",-2),(0,l.default)(u,"AFTER",-3),(0,l.default)(u,"_tempMt",new o.Matrix)},57867:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.PathConstraintData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"bones",[])}));e.PathConstraintData=o},34380:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Skeleton=void 0;var s=r(i(92762)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(52717),y=i(24493),p=i(99330),g=i(1731),m=i(64),x=i(87210),T=i(35696),k=i(5866),C=i(63969),S=i(5072),E=i(8245),M=i(66272),L=i(93561),b=i(89432);var I=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,l.default)(this,r),t=n.call(this),(0,_.default)((0,u.default)(t),"_boneMatrixArray",[]),(0,_.default)((0,u.default)(t),"_lastTime",0),(0,_.default)((0,u.default)(t),"_currAniIndex",-1),(0,_.default)((0,u.default)(t),"_pause",!0),(0,_.default)((0,u.default)(t),"_aniClipIndex",-1),(0,_.default)((0,u.default)(t),"_clipIndex",-1),(0,_.default)((0,u.default)(t),"_skinIndex",0),(0,_.default)((0,u.default)(t),"_skinName","default"),(0,_.default)((0,u.default)(t),"_aniMode",0),(0,_.default)((0,u.default)(t),"_index",-1),(0,_.default)((0,u.default)(t),"_total",-1),(0,_.default)((0,u.default)(t),"_indexControl",!1),(0,_.default)((0,u.default)(t),"_eventIndex",0),(0,_.default)((0,u.default)(t),"_drawOrderIndex",0),(0,_.default)((0,u.default)(t),"_drawOrder",null),(0,_.default)((0,u.default)(t),"_lastAniClipIndex",-1),(0,_.default)((0,u.default)(t),"_lastUpdateAniClipIndex",-1),(0,_.default)((0,u.default)(t),"_playAudio",!0),(0,_.default)((0,u.default)(t),"_soundChannelArr",[]),e&&t.init(e,i),t}return(0,o.default)(r,[{key:"init",value:function(t){var e,i,a,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=0;if(1==r)for(this._graphicsCache=[],s=0,e=t.getAnimationCount();s<e;s++)this._graphicsCache.push([]);if(this._yReverseMatrix=t.yReverseMatrix,this._aniMode=r,this._templet=t,this._templet._addReference(1),this._player=new g.AnimationPlayer,this._player.cacheFrameRate=t.rate,this._player.templet=t,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=t.mBoneArr,this._rootBone=t.mRootBone,this._aniSectionDic=t.aniSectionDic,t.ikArr.length>0)for(this._ikArr=[],s=0,e=t.ikArr.length;s<e;s++)this._ikArr.push(new v.IkConstraint(t.ikArr[s],this._boneList));if(t.pathArr.length>0)for(null==this._pathDic&&(this._pathDic={}),s=0,e=t.pathArr.length;s<e;s++)i=t.pathArr[s],a=new y.PathConstraint(i,this._boneList),(n=this._boneSlotDic[i.name])&&((a=new y.PathConstraint(i,this._boneList)).target=n),this._pathDic[i.name]=a;if(t.tfArr.length>0)for(this._tfArr=[],s=0,e=t.tfArr.length;s<e;s++)this._tfArr.push(new p.TfConstraint(t.tfArr[s],this._boneList));if(t.skinDataArray.length>0){var l=this._templet.skinDataArray[this._skinIndex];this._skinName=l.name}this._player.on(C.Event.PLAYED,this,this._onPlay),this._player.on(C.Event.STOPPED,this,this._onStop),this._player.on(C.Event.PAUSED,this,this._onPause)}},{key:"url",get:function(){return this._aniPath},set:function(t){this.load(t)}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._aniPath=t,this._complete=e,this._loadAniMode=i,L.ILaya.loader.load([{url:t,type:L.ILaya.Loader.BUFFER}],T.Handler.create(this,this._onLoaded))}},{key:"_onLoaded",value:function(){var t,e=L.ILaya.Loader.getRes(this._aniPath);null!=e&&(null==M.IAniLib.Templet.TEMPLET_DICTIONARY&&(M.IAniLib.Templet.TEMPLET_DICTIONARY={}),(t=M.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath])?t.isParseFail?this._parseFail():t.isParserComplete?this._parseComplete():(t.on(C.Event.COMPLETE,this,this._parseComplete),t.on(C.Event.ERROR,this,this._parseFail)):((t=new M.IAniLib.Templet)._setCreateURL(this._aniPath),M.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath]=t,t.on(C.Event.COMPLETE,this,this._parseComplete),t.on(C.Event.ERROR,this,this._parseFail),t.isParserComplete=!1,t.parseData(null,e)))}},{key:"_parseComplete",value:function(){var t=M.IAniLib.Templet.TEMPLET_DICTIONARY[this._aniPath];t&&(this.init(t,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)}},{key:"_parseFail",value:function(){console.log("[Error]:"+this._aniPath+"解析失败")}},{key:"_onPlay",value:function(){this.event(C.Event.PLAYED)}},{key:"_onStop",value:function(){var t,e=this._templet.eventAniArr[this._aniClipIndex];if(e&&this._eventIndex<e.length)for(;this._eventIndex<e.length;this._eventIndex++)(t=e[this._eventIndex]).time>=this._player.playStart&&t.time<=this._player.playEnd&&this.event(C.Event.LABEL,t);this._drawOrder=null,this.event(C.Event.STOPPED)}},{key:"_onPause",value:function(){this.event(C.Event.PAUSED)}},{key:"_parseSrcBoneMatrix",value:function(){var t=0,e=0;for(e=this._templet.srcBoneMatrixArr.length,t=0;t<e;t++)this._boneMatrixArray.push(new k.Matrix);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var i,a,n=this._templet.boneSlotArray;for(t=0,e=n.length;t<e;t++)i=n[t],null==(a=this._bindBoneBoneSlotDic[i.parent])&&(this._bindBoneBoneSlotDic[i.parent]=a=[]),this._boneSlotDic[i.name]=i=i.copy(),a.push(i),this._boneSlotArray.push(i)}}},{key:"_emitMissedEvents",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=this._templet.eventAniArr,n=a[this._player.currentAnimationClipIndex];if(n){var r,s,l=0;for(r=n.length,l=i;l<r;l++)(s=n[l]).time>=this._player.playStart&&s.time<=this._player.playEnd&&this.event(C.Event.LABEL,s)}}},{key:"_update",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!(t&&this._pause||t&&this._indexControl)){var e=this.timer.currTimer,i=this._player.currentKeyframeIndex,a=e-this._lastTime;if(t?this._player._update(a):i=-1,this._lastTime=e,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||a>0&&this._clipIndex==i&&this._lastUpdateAniClipIndex==this._aniClipIndex))){this._lastUpdateAniClipIndex=this._aniClipIndex,i>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var n,r,s=this._templet.eventAniArr[this._aniClipIndex];if(s&&this._eventIndex<s.length){var l=s[this._eventIndex];l.time>=this._player.playStart&&l.time<=this._player.playEnd?this._player.currentPlayTime>=l.time&&(this.event(C.Event.LABEL,l),this._eventIndex++,this._playAudio&&l.audioValue&&"null"!==l.audioValue&&"undefined"!==l.audioValue&&(n=S.SoundManager.playSound(this._player.templet._path+l.audioValue,1,T.Handler.create(this,this._onAniSoundStoped)),S.SoundManager.playbackRate=this._player.playbackRate,n&&this._soundChannelArr.push(n))):l.time<this._player.playStart&&this._playAudio&&l.audioValue&&"null"!==l.audioValue&&"undefined"!==l.audioValue?(this._eventIndex++,n=S.SoundManager.playSound(this._player.templet._path+l.audioValue,1,T.Handler.create(this,this._onAniSoundStoped),null,(this._player.currentPlayTime-l.time)/1e3),S.SoundManager.playbackRate=this._player.playbackRate,n&&this._soundChannelArr.push(n)):this._eventIndex++}0==this._aniMode?(r=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=r&&(this.graphics=r):1==this._aniMode?(r=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=r&&(this.graphics=r):this._createGraphics()}}}},{key:"_onAniSoundStoped",value:function(t){for(var e,i=this._soundChannelArr.length,a=0;a<i;a++){var n;((e=this._soundChannelArr[a]).isStopped||t)&&(!e.isStopped&&e.stop(),(0,s.default)(n=this._soundChannelArr).call(n,a,1),i--,a--)}}},{key:"_createGraphics",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;-1==t&&(t=this._clipIndex);var e,i=t*this._player.cacheFrameRateInterval,a=this._templet.drawOrderAniArr,n=a[this._aniClipIndex];if(n&&n.length>0)for(this._drawOrderIndex=0,e=n[this._drawOrderIndex];i>=e.time&&(this._drawOrder=e.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=n.length));)e=n[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=m.GraphicsAni.create():this.graphics instanceof m.GraphicsAni?this.graphics.clear():this.graphics=m.GraphicsAni.create();var r=this.graphics,s=this._templet.getNodes(this._aniClipIndex),l=0==this._player.state;this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,null,t,l?i+this._player.cacheFrameRateInterval:i);var o,u,h,c,d=this._aniSectionDic[this._aniClipIndex],f=0,_=0,v=0,y=0,p=0,g=this._templet.srcBoneMatrixArr.length,x=this._curOriginalData;for(_=0,p=d[0];_<g;_++){var T=(c=this._boneList[_]).resultTransform;h=this._templet.srcBoneMatrixArr[_],T.scX=h.scX*x[f++],T.skX=h.skX+x[f++],T.skY=h.skY+x[f++],T.scY=h.scY*x[f++],T.x=h.x+x[f++],T.y=h.y+x[f++],8===this._templet.tMatrixDataLen&&(T.skewX=h.skewX+x[f++],T.skewY=h.skewY+x[f++])}var C,S={},M={};for(p+=d[1];_<p;_++)S[(C=s[_]).name]=x[f++],M[C.name]=x[f++],f+=4;var L,b,I={},R={};for(p+=d[2];_<p;_++)I[(C=s[_]).name]=x[f++],R[C.name]=x[f++],f+=4;if(this._pathDic)for(p+=d[3];_<p;_++)if(C=s[_],L=this._pathDic[C.name]){var w=new E.Byte(C.extenData);switch(w.getByte()){case 1:L.position=x[f++];break;case 2:L.spacing=x[f++];break;case 3:L.rotateMix=x[f++],L.translateMix=x[f++]}}if(this._rootBone.update(this._yReverseMatrix||k.Matrix.TEMP.identity()),this._ikArr)for(_=0,p=this._ikArr.length;_<p;_++)(b=this._ikArr[_]).name in I&&(b.bendDirection=I[b.name]),b.name in R&&(b.mix=R[b.name]),b.apply();if(this._pathDic)for(var A in this._pathDic)(L=this._pathDic[A]).apply(this._boneList,r);if(this._tfArr)for(_=0,y=this._tfArr.length;_<y;_++)this._tfArr[_].apply();for(_=0,y=this._boneList.length;_<y;_++)if(c=this._boneList[_],u=this._bindBoneBoneSlotDic[c.name],c.resultMatrix.copyTo(this._boneMatrixArray[_]),u)for(v=0,p=u.length;v<p;v++)(o=u[v])&&o.setParentMatrix(c.resultMatrix);var B,D,P,F,O={},U=this._templet.deformAniArr;if(U&&U.length>0){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,_=0,p=this._boneSlotArray.length;_<p;_++)(o=this._boneSlotArray[_]).deformData=null;var N,G=U[this._aniClipIndex];for(N in B=G.default,this._setDeform(B,O,this._boneSlotArray,i),G)"default"!=N&&N!=this._skinName&&(B=G[N],this._setDeform(B,O,this._boneSlotArray,i));B=G[this._skinName],this._setDeform(B,O,this._boneSlotArray,i)}if(this._drawOrder)for(_=0,p=this._drawOrder.length;_<p;_++)D=S[(o=this._boneSlotArray[this._drawOrder[_]]).name],P=M[o.name],isNaN(P),isNaN(D)||-2==D||(this._templet.attachmentNames?o.showDisplayByName(this._templet.attachmentNames[D]):o.showDisplayByIndex(D)),O[this._drawOrder[_]]?(F=O[this._drawOrder[_]],o.currDisplayData&&F[o.currDisplayData.attachmentName]?o.deformData=F[o.currDisplayData.attachmentName]:o.deformData=null):o.deformData=null,isNaN(P)?o.draw(r,this._boneMatrixArray,2==this._aniMode):o.draw(r,this._boneMatrixArray,2==this._aniMode,P),isNaN(P);else for(_=0,p=this._boneSlotArray.length;_<p;_++)D=S[(o=this._boneSlotArray[_]).name],P=M[o.name],isNaN(P),isNaN(D)||-2==D||(this._templet.attachmentNames?o.showDisplayByName(this._templet.attachmentNames[D]):o.showDisplayByIndex(D)),O[_]?(F=O[_],o.currDisplayData&&F[o.currDisplayData.attachmentName]?o.deformData=F[o.currDisplayData.attachmentName]:o.deformData=null):o.deformData=null,isNaN(P)?o.draw(r,this._boneMatrixArray,2==this._aniMode):o.draw(r,this._boneMatrixArray,2==this._aniMode,P),isNaN(P);return 0==this._aniMode?(this._templet.setGrahicsDataWithCache(this._aniClipIndex,t,r),this._checkIsAllParsed(this._aniClipIndex)):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,t,r),r}},{key:"_checkIsAllParsed",value:function(t){var e,i;for(i=Math.floor(.01+this._templet.getAniDuration(t)/1e3*this._player.cacheFrameRate),e=0;e<i;e++)if(!this._templet.getGrahicsDataWithCache(t,e))return;this._templet.getGrahicsDataWithCache(t,i)?this._templet.deleteAniData(t):this._createGraphics(i)}},{key:"_setDeform",value:function(t,e,i,a){var n,r,s,l,o,u;if(t&&t)for(l=0,o=t.deformSlotDataList.length;l<o;l++)for(n=t.deformSlotDataList[l],u=0;u<n.deformSlotDisplayList.length;u++)s=i[(r=n.deformSlotDisplayList[u]).slotIndex],r.apply(a,s),e[r.slotIndex]||(e[r.slotIndex]={}),e[r.slotIndex][r.attachment]=r.deformData}},{key:"getAnimNum",value:function(){return this._templet.getAnimationCount()}},{key:"getAniNameByIndex",value:function(t){return this._templet.getAniNameByIndex(t)}},{key:"getSlotByName",value:function(t){return this._boneSlotDic[t]}},{key:"showSkinByName",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.showSkinByIndex(this._templet.getSkinIndexByName(t),e)}},{key:"showSkinByIndex",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=0;i<this._boneSlotArray.length;i++)this._boneSlotArray[i].showSlotData(null,e);if(this._templet.showSkinByIndex(this._boneSlotDic,t,e)){var a=this._templet.skinDataArray[t];this._skinIndex=t,this._skinName=a.name}this._clearCache()}},{key:"showSlotSkinByIndex",value:function(t,e){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.showDisplayByIndex(e),this._clearCache()}}},{key:"showSlotSkinByName",value:function(t,e){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.showDisplayByName(e),this._clearCache()}}},{key:"replaceSlotSkinName",value:function(t,e,i){if(0!=this._aniMode){var a=this.getSlotByName(t);a&&a.replaceDisplayByName(e,i),this._clearCache()}}},{key:"replaceSlotSkinByIndex",value:function(t,e,i){if(0!=this._aniMode){var a=this.getSlotByName(t);a&&a.replaceDisplayByIndex(e,i),this._clearCache()}}},{key:"setSlotSkin",value:function(t,e){if(0!=this._aniMode){var i=this.getSlotByName(t);i&&i.replaceSkin(e),this._clearCache()}}},{key:"_clearCache",value:function(){if(1==this._aniMode)for(var t=0,e=this._graphicsCache.length;t<e;t++){for(var i=0,a=this._graphicsCache[t].length;i<a;i++){var n=this._graphicsCache[t][i];n&&n!=this.graphics&&m.GraphicsAni.recycle(n)}this._graphicsCache[t].length=0}}},{key:"play",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this._playAudio=s,this._indexControl=!1;var l,o=-1;if(l=e?2147483647:0,"string"==typeof t)for(var u=0,h=this._templet.getAnimationCount();u<h;u++){var c=this._templet.getAnimation(u);if(c&&t==c.name){o=u;break}}else o=t;o>-1&&o<this.getAnimNum()&&(this._aniClipIndex=o,(i||this._pause||this._currAniIndex!=o)&&(this._currAniIndex=o,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(o)),this._drawOrder=null,this._eventIndex=0,this._player.play(o,this._player.playbackRate,l,a,n),r&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=L.ILaya.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))}},{key:"stop",value:function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this._soundChannelArr.length>0&&this._onAniSoundStoped(!0),this.timer.clear(this,this._update))}},{key:"playbackRate",value:function(t){this._player&&(this._player.playbackRate=t)}},{key:"paused",value:function(){if(!this._pause){if(this._pause=!0,this._player&&(this._player.paused=!0),this._soundChannelArr.length>0)for(var t,e=this._soundChannelArr.length,i=0;i<e;i++)(t=this._soundChannelArr[i]).isStopped||t.pause();this.timer.clear(this,this._update)}}},{key:"resume",value:function(){if(this._indexControl=!1,this._pause){if(this._pause=!1,this._player&&(this._player.paused=!1),this._soundChannelArr.length>0)for(var t,e=this._soundChannelArr.length,i=0;i<e;i++)(t=this._soundChannelArr[i]).audioBuffer&&t.resume();this._lastTime=L.ILaya.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)}}},{key:"_getGrahicsDataWithCache",value:function(t,e){return this._graphicsCache[t][e]}},{key:"_setGrahicsDataWithCache",value:function(t,e,i){this._graphicsCache[t][e]=i}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this._templet._removeReference(1),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update),this._soundChannelArr.length>0&&this._onAniSoundStoped(!0)}},{key:"index",get:function(){return this._index},set:function(t){this.player&&(this._index=t,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,(this._aniClipIndex<0||this._aniClipIndex>=this.getAnimNum())&&(this._aniClipIndex=0,this._currAniIndex=0,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(this._currAniIndex)),this._drawOrder=null,this._eventIndex=0),this._update(!1))}},{key:"total",get:function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}},{key:"player",get:function(){return this._player}},{key:"templet",get:function(){return this._templet}}]),r}(x.Sprite);e.Skeleton=I,(0,_.default)(I,"useSimpleMeshInCanvas",!1),M.IAniLib.Skeleton=I,L.ILaya.regClass(I),b.ClassUtils.regClass("laya.ani.bone.Skeleton",I),b.ClassUtils.regClass("Laya.Skeleton",I)},48981:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SkinData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"slotArr",[])}));e.SkinData=o},27878:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SkinSlotDisplayData=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(29148),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"createTexture",value:function(t){return this.texture||(this.texture=new l.Texture(t.bitmap,this.uvs),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=t.height,this.texture.height=t.width,this.texture.offsetX=-t.offsetX,this.texture.offsetY=-t.offsetY,this.texture.sourceWidth=t.sourceHeight,this.texture.sourceHeight=t.sourceWidth):(this.texture.width=t.width,this.texture.height=t.height,this.texture.offsetX=-t.offsetX,this.texture.offsetY=-t.offsetY,this.texture.sourceWidth=t.sourceWidth,this.texture.sourceHeight=t.sourceHeight)),this.texture}},{key:"destory",value:function(){this.texture&&this.texture.destroy()}}]),t}();e.SkinSlotDisplayData=o},33231:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SlotData=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"displayArr",[])}return(0,s.default)(t,[{key:"getDisplayByName",value:function(t){for(var e=0,i=this.displayArr.length;e<i;e++)if(this.displayArr[e].attachmentName==t)return e;return-1}}]),t}();e.SlotData=o},66148:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Templet=void 0;var s=r(i(77766)),l=r(i(3649)),o=r(i(23054)),u=r(i(81643)),h=r(i(87368)),c=r(i(28146)),d=r(i(43714)),f=r(i(92135)),_=r(i(13383)),v=r(i(78310)),y=r(i(82669)),p=r(i(17454)),g=i(28684),m=i(85937),x=i(57867),T=i(27948),k=i(14337),C=i(62975),S=i(80355),E=i(98184),M=i(16038),L=i(81050),b=i(48981),I=i(27878),R=i(33231),w=i(69766),A=i(67628),B=i(29148),D=i(5866),P=i(35696),F=i(63969),O=i(8245),U=i(66272),N=i(34380),G=i(93561);var H=function(t){(0,_.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,y.default)(e);if(i){var r=(0,y.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,v.default)(this,t)});function r(){var t,e;(0,h.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,p.default)((0,d.default)(e),"_graphicsCache",[]),(0,p.default)((0,d.default)(e),"srcBoneMatrixArr",[]),(0,p.default)((0,d.default)(e),"ikArr",[]),(0,p.default)((0,d.default)(e),"tfArr",[]),(0,p.default)((0,d.default)(e),"pathArr",[]),(0,p.default)((0,d.default)(e),"boneSlotDic",{}),(0,p.default)((0,d.default)(e),"bindBoneBoneSlotDic",{}),(0,p.default)((0,d.default)(e),"boneSlotArray",[]),(0,p.default)((0,d.default)(e),"skinDataArray",[]),(0,p.default)((0,d.default)(e),"skinDic",{}),(0,p.default)((0,d.default)(e),"subTextureDic",{}),(0,p.default)((0,d.default)(e),"isParseFail",!1),(0,p.default)((0,d.default)(e),"drawOrderAniArr",[]),(0,p.default)((0,d.default)(e),"eventAniArr",[]),(0,p.default)((0,d.default)(e),"attachmentNames",null),(0,p.default)((0,d.default)(e),"deformAniArr",[]),(0,p.default)((0,d.default)(e),"skinSlotDisplayDataArr",[]),(0,p.default)((0,d.default)(e),"_isParseAudio",!1),(0,p.default)((0,d.default)(e),"_isDestroyed",!1),(0,p.default)((0,d.default)(e),"_rate",30),(0,p.default)((0,d.default)(e),"isParserComplete",!1),(0,p.default)((0,d.default)(e),"aniSectionDic",{}),(0,p.default)((0,d.default)(e),"_textureDic",{}),(0,p.default)((0,d.default)(e),"mBoneArr",[]),e}return(0,c.default)(r,[{key:"loadAni",value:function(t){this._skBufferUrl=t,G.ILaya.loader.load(t,P.Handler.create(this,this.onComplete),null,G.ILaya.Loader.BUFFER)}},{key:"onComplete",value:function(){var t,e;if(this._isDestroyed)this.destroy();else{var i=G.ILaya.Loader.getRes(this._skBufferUrl);i?(this._path=(0,l.default)(t=this._skBufferUrl).call(t,0,(0,o.default)(e=this._skBufferUrl).call(e,"/"))+"/",this.parseData(null,i)):this.event(F.Event.ERROR,"load failed:"+this._skBufferUrl)}}},{key:"parseData",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(!this._path){var a=this._relativeUrl||this.url;if(a){var n=(0,o.default)(a).call(a,"/");this._path=n>0?(0,l.default)(a).call(a,0,n)+"/":""}}this._mainTexture=t,this._rate=i,this.parse(e)}},{key:"buildArmature",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new N.Skeleton(this,t)}},{key:"parse",value:function(t){(0,f.default)((0,y.default)(r.prototype),"parse",this).call(this,t),this.event(F.Event.LOADED,this),this._aniVersion===r.LAYA_ANIMATION_VISION?this._isParseAudio=!0:this._aniVersion!=r.LAYA_ANIMATION_160_VISION&&console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+r.LAYA_ANIMATION_VISION),this._mainTexture?this._parsePublicExtData():this._parseTexturePath()}},{key:"_parseTexturePath",value:function(){if(this._isDestroyed)this.destroy();else{var t=0;this._loadList=[];var e,i=new O.Byte(this.getPublicExtData()),a=0,n=i.getInt32(),r=i.readUTFString(),s=r.split("\n");for(t=0;t<n;t++){var l;e=this._path+s[2*t],r=s[2*t+1],i.getFloat32(),i.getFloat32(),i.getFloat32(),i.getFloat32(),a=i.getFloat32(),isNaN(a),a=i.getFloat32(),isNaN(a),a=i.getFloat32(),isNaN(a),a=i.getFloat32(),isNaN(a),-1==(0,u.default)(l=this._loadList).call(l,e)&&this._loadList.push(e)}G.ILaya.loader.load(this._loadList,P.Handler.create(this,this._textureComplete))}}},{key:"_textureComplete",value:function(){for(var t,e=0,i=this._loadList.length;e<i;e++)t=this._loadList[e],this._textureDic[t]=G.ILaya.Loader.getRes(t);this._parsePublicExtData()}},{key:"_parsePublicExtData",value:function(){var t,e=0,i=0,a=0,n=0,r=0;for(e=0,r=this.getAnimationCount();e<r;e++)this._graphicsCache.push([]);t="Dragon"!=this._aniClassName;var s,l,o=new O.Byte(this.getPublicExtData()),u=0,h=0,c=0,d=0,f=0,_=0,v=0,y=0,p=0,M=o.getInt32(),P=o.readUTFString(),U=P.split("\n");for(e=0;e<M;e++){if(s=this._mainTexture,l=this._path+U[2*e],P=U[2*e+1],null==this._mainTexture&&(s=this._textureDic[l]),!s)return this.event(F.Event.ERROR,this),void(this.isParseFail=!0);u=o.getFloat32(),h=o.getFloat32(),c=o.getFloat32(),d=o.getFloat32(),p=o.getFloat32(),f=isNaN(p)?0:p,p=o.getFloat32(),_=isNaN(p)?0:p,p=o.getFloat32(),v=isNaN(p)?c:p,p=o.getFloat32(),y=isNaN(p)?d:p,this.subTextureDic[P]=B.Texture.create(s,u,h,c,d,-f,-_,v,y)}this._mainTexture=s;var N,G,H,W,V,Y=o.getUint16();for(e=0;e<Y;e++)(N=[]).push(o.getUint16()),N.push(o.getUint16()),N.push(o.getUint16()),N.push(o.getUint16()),this.aniSectionDic[e]=N;var X,z=o.getInt16(),K={};for(e=0;e<z;e++)G=new g.Bone,0==e?X=G:G.root=X,G.d=t?-1:1,W=o.readUTFString(),V=o.readUTFString(),G.length=o.getFloat32(),1==o.getByte()&&(G.inheritRotation=!1),1==o.getByte()&&(G.inheritScale=!1),G.name=W,V&&((H=K[V])?H.addChild(G):this.mRootBone=G),K[W]=G,this.mBoneArr.push(G);this.tMatrixDataLen=o.getUint16();var j,q,Z=o.getUint16(),Q=Math.floor(Z/this.tMatrixDataLen),$=this.srcBoneMatrixArr;for(e=0;e<Q;e++)(j=new w.Transform).scX=o.getFloat32(),j.skX=o.getFloat32(),j.skY=o.getFloat32(),j.scY=o.getFloat32(),j.x=o.getFloat32(),j.y=o.getFloat32(),8===this.tMatrixDataLen&&(j.skewX=o.getFloat32(),j.skewY=o.getFloat32()),$.push(j),(G=this.mBoneArr[e]).transform=j;var J,tt,et=o.getUint16();for(e=0;e<et;e++){for(q=new A.IkConstraintData,J=o.getUint16(),i=0;i<J;i++)q.boneNames.push(o.readUTFString()),q.boneIndexs.push(o.getInt16());q.name=o.readUTFString(),q.targetBoneName=o.readUTFString(),q.targetBoneIndex=o.getInt16(),q.bendDirection=o.getFloat32(),q.mix=o.getFloat32(),q.isSpine=t,this.ikArr.push(q)}var it,at,nt=o.getUint16();for(e=0;e<nt;e++){for(tt=new m.TfConstraintData,it=o.getUint16(),i=0;i<it;i++)tt.boneIndexs.push(o.getInt16());tt.name=o.getUTFString(),tt.targetIndex=o.getInt16(),tt.rotateMix=o.getFloat32(),tt.translateMix=o.getFloat32(),tt.scaleMix=o.getFloat32(),tt.shearMix=o.getFloat32(),tt.offsetRotation=o.getFloat32(),tt.offsetX=o.getFloat32(),tt.offsetY=o.getFloat32(),tt.offsetScaleX=o.getFloat32(),tt.offsetScaleY=o.getFloat32(),tt.offsetShearY=o.getFloat32(),this.tfArr.push(tt)}var rt,st,lt,ot,ut,ht,ct,dt,ft,_t,vt=o.getUint16();for(e=0;e<vt;e++){for((at=new x.PathConstraintData).name=o.readUTFString(),rt=o.getUint16(),i=0;i<rt;i++)at.bones.push(o.getInt16());at.target=o.readUTFString(),at.positionMode=o.readUTFString(),at.spacingMode=o.readUTFString(),at.rotateMode=o.readUTFString(),at.offsetRotation=o.getFloat32(),at.position=o.getFloat32(),at.spacing=o.getFloat32(),at.rotateMix=o.getFloat32(),at.translateMix=o.getFloat32(),this.pathArr.push(at)}var yt,pt=o.getInt16();for(e=0;e<pt;e++){var gt=o.getUint8(),mt={};this.deformAniArr.push(mt);for(var xt=0;xt<gt;xt++)for((ct=new T.DeformAniData).skinName=o.getUTFString(),mt[ct.skinName]=ct,st=o.getInt16(),i=0;i<st;i++)for(dt=new k.DeformSlotData,ct.deformSlotDataList.push(dt),lt=o.getInt16(),a=0;a<lt;a++)for(ft=new C.DeformSlotDisplayData,dt.deformSlotDisplayList.push(ft),ft.slotIndex=o.getInt16(),ft.attachment=o.getUTFString(),ot=o.getInt16(),n=0;n<ot;n++)for(1==o.getByte()?ft.tweenKeyList.push(!0):ft.tweenKeyList.push(!1),ut=o.getFloat32(),ft.timeList.push(ut),_t=[],ft.vectices.push(_t),ht=o.getInt16(),r=0;r<ht;r++)_t.push(o.getFloat32())}var Tt,kt,Ct,St,Et=o.getInt16();for(e=0;e<Et;e++){for(Tt=o.getInt16(),yt=[],i=0;i<Tt;i++){for((kt=new S.DrawOrderData).time=o.getFloat32(),Ct=o.getInt16(),a=0;a<Ct;a++)kt.drawOrder.push(o.getInt16());yt.push(kt)}this.drawOrderAniArr.push(yt)}var Mt,Lt,bt=o.getInt16();for(e=0;e<bt;e++){for(Mt=o.getInt16(),St=[],i=0;i<Mt;i++)(Lt=new E.EventData).name=o.getUTFString(),this._isParseAudio&&(Lt.audioValue=o.getUTFString()),Lt.intValue=o.getInt32(),Lt.floatValue=o.getFloat32(),Lt.stringValue=o.getUTFString(),Lt.time=o.getFloat32(),St.push(Lt);this.eventAniArr.push(St)}var It=o.getInt16();if(It>0)for(this.attachmentNames=[],e=0;e<It;e++)this.attachmentNames.push(o.getUTFString());var Rt,wt,At=o.getInt16();for(e=0;e<At;e++)(Rt=new L.BoneSlot).name=o.readUTFString(),Rt.parent=o.readUTFString(),Rt.attachmentName=o.readUTFString(),Rt.srcDisplayIndex=Rt.displayIndex=o.getInt16(),Rt.templet=this,this.boneSlotDic[Rt.name]=Rt,null==(wt=this.bindBoneBoneSlotDic[Rt.parent])&&(this.bindBoneBoneSlotDic[Rt.parent]=wt=[]),wt.push(Rt),this.boneSlotArray.push(Rt);var Bt,Dt,Pt,Ft,Ot,Ut,Nt,Gt,Ht,Wt,Vt=o.readUTFString().split("\n"),Yt=0,Xt=o.getUint8();for(e=0;e<Xt;e++){for((Bt=new b.SkinData).name=Vt[Yt++],Ft=o.getUint8(),i=0;i<Ft;i++){for((Dt=new R.SlotData).name=Vt[Yt++],Rt=this.boneSlotDic[Dt.name],Ot=o.getUint8(),a=0;a<Ot;a++){if(Pt=new I.SkinSlotDisplayData,this.skinSlotDisplayDataArr.push(Pt),Pt.name=Vt[Yt++],Pt.attachmentName=Vt[Yt++],Pt.transform=new w.Transform,Pt.transform.scX=o.getFloat32(),Pt.transform.skX=o.getFloat32(),Pt.transform.skY=o.getFloat32(),Pt.transform.scY=o.getFloat32(),Pt.transform.x=o.getFloat32(),Pt.transform.y=o.getFloat32(),Dt.displayArr.push(Pt),Pt.width=o.getFloat32(),Pt.height=o.getFloat32(),Pt.type=o.getUint8(),Pt.verLen=o.getUint16(),(z=o.getUint16())>0)for(Pt.bones=[],n=0;n<z;n++){var zt=o.getUint16();Pt.bones.push(zt)}if((Ut=o.getUint16())>0)for(Pt.uvs=[],n=0;n<Ut;n++)Pt.uvs.push(o.getFloat32());if((Nt=o.getUint16())>0)for(Pt.weights=[],n=0;n<Nt;n++)Pt.weights.push(o.getFloat32());if((Gt=o.getUint16())>0)for(Pt.triangles=[],n=0;n<Gt;n++)Pt.triangles.push(o.getUint16());if((Ht=o.getUint16())>0)for(Pt.vertices=[],n=0;n<Ht;n++)Pt.vertices.push(o.getFloat32());if((Wt=o.getUint16())>0)for(Pt.lengths=[],n=0;n<Wt;n++)Pt.lengths.push(o.getFloat32())}Bt.slotArr.push(Dt)}this.skinDic[Bt.name]=Bt,this.skinDataArray.push(Bt)}1==o.getUint8()?(this.yReverseMatrix=new D.Matrix(1,0,0,-1,0,0),X&&X.setTempMatrix(this.yReverseMatrix)):X&&X.setTempMatrix(new D.Matrix),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event(F.Event.COMPLETE,this)}},{key:"getTexture",value:function(t){var e=this.subTextureDic[t];return e||(e=this.subTextureDic[t.substr(0,t.length-1)]),null==e?this._mainTexture:e}},{key:"showSkinByIndex",value:function(t,e){var i,a,n,r,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e<0&&e>=this.skinDataArray.length)return!1;var l=this.skinDataArray[e];if(l){for(i=0,a=l.slotArr.length;i<a;i++)(r=l.slotArr[i])&&(n=t[r.name])&&(n.showSlotData(r,s),s&&"undefined"!=n.attachmentName&&"null"!=n.attachmentName?n.showDisplayByName(n.attachmentName):n.showDisplayByIndex(n.displayIndex));return!0}return!1}},{key:"getSkinIndexByName",value:function(t){for(var e=0,i=this.skinDataArray.length;e<i;e++)if(this.skinDataArray[e].name==t)return e;return-1}},{key:"getGrahicsDataWithCache",value:function(t,e){return this._graphicsCache[t]&&this._graphicsCache[t][e]?this._graphicsCache[t][e]:null}},{key:"_setCreateURL",value:function(t){this._skBufferUrl=this._relativeUrl=t,(0,f.default)((0,y.default)(r.prototype),"_setCreateURL",this).call(this,t)}},{key:"setGrahicsDataWithCache",value:function(t,e,i){this._graphicsCache[t][e]=i}},{key:"deleteAniData",value:function(t){if(this._anis[t]){var e=this._anis[t];e.bone3DMap=null,e.nodes=null}}},{key:"destroy",value:function(){var t;for(t in this._isDestroyed=!0,this.subTextureDic)t&&this.subTextureDic[t].destroy();for(t in this._textureDic)t&&this._textureDic[t].destroy();for(var e=0,i=this.skinSlotDisplayDataArr.length;e<i;e++)this.skinSlotDisplayDataArr[e].destory();this.skinSlotDisplayDataArr.length=0,this._relativeUrl&&delete r.TEMPLET_DICTIONARY[this._relativeUrl],(0,f.default)((0,y.default)(r.prototype),"destroy",this).call(this),G.ILaya.loader.clearRes(this._skBufferUrl)}},{key:"getAniNameByIndex",value:function(t){var e=this.getAnimation(t);return e?e.name:null}},{key:"rate",get:function(){return this._rate},set:function(t){this._rate=t}}]),r}(M.AnimationTemplet);e.Templet=H,(0,p.default)(H,"LAYA_ANIMATION_160_VISION","LAYAANIMATION:1.6.0"),(0,p.default)(H,"LAYA_ANIMATION_VISION","LAYAANIMATION:1.7.0"),U.IAniLib.Templet=H},99330:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TfConstraint=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(e,i){var a,n;for((0,r.default)(this,t),(0,l.default)(this,"_temp",[]),this._data=e,null==this._bones&&(this._bones=[]),this.target=i[e.targetIndex],a=0,n=e.boneIndexs.length;a<n;a++)this._bones.push(i[e.boneIndexs[a]]);this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix}return(0,s.default)(t,[{key:"apply",value:function(){for(var t,e=this.target.resultMatrix.a,i=this.target.resultMatrix.b,a=this.target.resultMatrix.c,n=this.target.resultMatrix.d,r=0,s=this._bones.length;r<s;r++){if(t=this._bones[r],this.rotateMix>0){var l=t.resultMatrix.a,o=t.resultMatrix.b,u=t.resultMatrix.c,h=t.resultMatrix.d,c=Math.atan2(a,e)-Math.atan2(u,l)+this._data.offsetRotation*Math.PI/180;c>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c*=this.rotateMix;var d=Math.cos(c),f=Math.sin(c);t.resultMatrix.a=d*l-f*u,t.resultMatrix.b=d*o-f*h,t.resultMatrix.c=f*l+d*u,t.resultMatrix.d=f*o+d*h}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),t.resultMatrix.tx+=(this._temp[0]-t.resultMatrix.tx)*this.translateMix,t.resultMatrix.ty+=(this._temp[1]-t.resultMatrix.ty)*this.translateMix,t.updateChild()),this.scaleMix>0){var _=Math.sqrt(t.resultMatrix.a*t.resultMatrix.a+t.resultMatrix.c*t.resultMatrix.c),v=Math.sqrt(e*e+a*a),y=_>1e-5?(_+(v-_+this._data.offsetScaleX)*this.scaleMix)/_:0;t.resultMatrix.a*=y,t.resultMatrix.c*=y,_=Math.sqrt(t.resultMatrix.b*t.resultMatrix.b+t.resultMatrix.d*t.resultMatrix.d),v=Math.sqrt(i*i+n*n),y=_>1e-5?(_+(v-_+this._data.offsetScaleY)*this.scaleMix)/_:0,t.resultMatrix.b*=y,t.resultMatrix.d*=y}if(this.shearMix>0){o=t.resultMatrix.b,h=t.resultMatrix.d;var p=Math.atan2(h,o);(c=Math.atan2(n,i)-Math.atan2(a,e)-(p-Math.atan2(t.resultMatrix.c,t.resultMatrix.a)))>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c=p+(c+this._data.offsetShearY*Math.PI/180)*this.shearMix,y=Math.sqrt(o*o+h*h),t.resultMatrix.b=Math.cos(c)*y,t.resultMatrix.d=Math.sin(c)*y}}}}]),t}();e.TfConstraint=o},85937:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TfConstraintData=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t),(0,l.default)(this,"boneIndexs",[])}));e.TfConstraintData=o},69766:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Transform=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(5866),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"skX",0),(0,l.default)(this,"skY",0),(0,l.default)(this,"scX",1),(0,l.default)(this,"scY",1),(0,l.default)(this,"x",0),(0,l.default)(this,"y",0),(0,l.default)(this,"skewX",0),(0,l.default)(this,"skewY",0)}return(0,s.default)(t,[{key:"initData",value:function(t){null!=t.x&&(this.x=t.x),null!=t.y&&(this.y=t.y),null!=t.skX&&(this.skX=t.skX),null!=t.skY&&(this.skY=t.skY),null!=t.scX&&(this.scX=t.scX),null!=t.scY&&(this.scY=t.scY)}},{key:"getMatrix",value:function(){var t;return(t=this.mMatrix?this.mMatrix:this.mMatrix=new o.Matrix).identity(),t.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(t,this.skewX*Math.PI/180,this.skewY*Math.PI/180),t.rotate(this.skX*Math.PI/180),t.translate(this.x,this.y),t}},{key:"skew",value:function(t,e,i){var a=Math.sin(i),n=Math.cos(i),r=Math.sin(e),s=Math.cos(e);return t.setTo(t.a*s-t.b*a,t.a*r+t.b*n,t.c*s-t.d*a,t.c*r+t.d*n,t.tx*s-t.ty*a,t.tx*r+t.ty*n),t}}]),t}();e.Transform=u},43124:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.UVTools=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(11179),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getRelativeUV",value:function(t,e){var i,a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t[0],s=t[2]-t[0],l=t[1],o=t[5]-t[1];n||(n=[]),n.length=e.length,a=n.length;var u=1/s,h=1/o;for(i=0;i<a;i+=2)n[i]=(e[i]-r)*u,n[i+1]=(e[i+1]-l)*h;return n}},{key:"getAbsoluteUV",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0==t[0]&&0==t[1]&&1==t[4]&&1==t[5])return i?(l.Utils.copyArray(i,e),i):e;var a,n,r=t[0],s=t[2]-t[0],o=t[1],u=t[5]-t[1];for(i||(i=[]),i.length=e.length,n=i.length,a=0;a<n;a+=2)i[a]=e[a]*s+r,i[a+1]=e[a+1]*u+o;return i}}]),t}();e.UVTools=o},19505:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.MeshData=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(63701),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"uvs",new Float32Array([0,0,1,0,1,1,0,1])),(0,l.default)(this,"vertices",new Float32Array([0,0,100,0,100,100,0,100])),(0,l.default)(this,"indexes",new Uint16Array([0,1,3,3,1,2])),(0,l.default)(this,"useUvTransform",!1),(0,l.default)(this,"canvasPadding",1)}return(0,s.default)(t,[{key:"getBounds",value:function(){return o.Rectangle._getWrapRec(this.vertices)}}]),t}();e.MeshData=u},21196:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.SkinMeshForGraphic=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669));var c=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,s.default)(this,r),n.call(this)}return(0,l.default)(r,[{key:"init2",value:function(t,e,i,a){this.transform&&(this.transform=null);var n=e||[0,1,3,3,1,2];this.texture=t,this.indexes=new Uint16Array(n),this.vertices=new Float32Array(i),this.uvs=new Float32Array(a)}}]),r}(i(19505).MeshData);e.SkinMeshForGraphic=c},82850:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BezierLerp=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(13212),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getBezierRate",value:function(e,i,a,n,r){var s=t._getBezierParamKey(i,a,n,r),l=100*s+e;if(t._bezierResultCache[l])return t._bezierResultCache[l];var o,u,h=t._getBezierPoints(i,a,n,r,s);for(u=h.length,o=0;o<u;o+=2)if(e<=h[o])return t._bezierResultCache[l]=h[o+1],h[o+1];return t._bezierResultCache[l]=1,1}},{key:"_getBezierParamKey",value:function(t,e,i,a){return 100*(100*(100*(100*t+e)+i)+a)}},{key:"_getBezierPoints",value:function(e,i,a,n,r){return t._bezierPointsCache[r]?t._bezierPointsCache[r]:(s=[0,0,e,i,a,n,1,1],l=(new o.Bezier).getBezierPoints(s,100,3),t._bezierPointsCache[r]=l,l);var s,l}}]),t}();e.BezierLerp=u,(0,l.default)(u,"_bezierResultCache",{}),(0,l.default)(u,"_bezierPointsCache",{})},65098:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Component=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(89761),o=i(11179),u=function(){function t(){(0,r.default)(this,t),this._id=o.Utils.getGID(),this._resetComp()}return(0,s.default)(t,[{key:"id",get:function(){return this._id}},{key:"enabled",get:function(){return this._enabled},set:function(t){this._enabled!=t&&(this._enabled=t,this.owner&&(t?this.owner.activeInHierarchy&&this._onEnable():this.owner.activeInHierarchy&&this._onDisable()))}},{key:"isSingleton",get:function(){return!0}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_isScript",value:function(){return!1}},{key:"_resetComp",value:function(){this._indexInList=-1,this._enabled=!0,this._awaked=!1,this.owner=null}},{key:"_getIndexInList",value:function(){return this._indexInList}},{key:"_setIndexInList",value:function(t){this._indexInList=t}},{key:"_onAdded",value:function(){}},{key:"_onAwake",value:function(){}},{key:"_onEnable",value:function(){}},{key:"_onDisable",value:function(){}},{key:"_onDestroy",value:function(){}},{key:"onReset",value:function(){}},{key:"_parse",value:function(t){}},{key:"_parseInteractive",value:function(){}},{key:"_cloneTo",value:function(t){}},{key:"_setActive",value:function(t){t?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable()}},{key:"destroy",value:function(){this.owner&&this.owner._destroyComponent(this)}},{key:"_destroy",value:function(){this.owner.activeInHierarchy&&this._enabled&&this._setActive(!1),this._onDestroy(),this._destroyed=!0,this.onReset!==t.prototype.onReset?(this.onReset(),this._resetComp(),l.Pool.recoverByClass(this)):this._resetComp()}}]),t}();e.Component=u},88587:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Prefab=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(93561),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"create",value:function(){return this.json?l.ILaya.SceneUtils.createByData(null,this.json):null}}]),t}();e.Prefab=o},57650:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Animation=void 0;var s=r(i(81643)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(62466),y=i(22010),p=i(84581),g=i(52619),m=i(35696),x=i(11179),T=i(93561),k=i(89432);var C=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,l.default)(this,r),(t=n.call(this))._setControlNode((0,u.default)(t)),t}return(0,o.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stop(),(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this._frames=null,this._labels=null}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";i&&this._setFramesFromCache(i,!0),(0,h.default)((0,f.default)(r.prototype),"play",this).call(this,t,e,i)}},{key:"_setFramesFromCache",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._url&&(t=this._url+"#"+t),t&&r.framesMap[t]){var i=r.framesMap[t];return i instanceof Array?(this._frames=r.framesMap[t],this._count=this._frames.length):(i.nodeRoot&&(r.framesMap[t]=g.GraphicAnimation.parseAnimationByData(i),i=r.framesMap[t]),this._frames=i.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=i.interval),this._labels=this._copyLabels(i.labels)),!0}return e&&console.log("ani not found:",t),!1}},{key:"_copyLabels",value:function(t){if(!t)return null;var e,i;for(i in e={},t)e[i]=x.Utils.copyArray([],t[i]);return e}},{key:"_frameLoop",value:function(){this._visible&&this._style.alpha>.01&&this._frames&&(0,h.default)((0,f.default)(r.prototype),"_frameLoop",this).call(this)}},{key:"_displayToIndex",value:function(t){this._frames&&(this.graphics=this._frames[t])}},{key:"frames",get:function(){return this._frames},set:function(t){this._frames=t,t&&(this._count=t.length,this._actionName&&this._setFramesFromCache(this._actionName,!0),this.index=this._index)}},{key:"source",set:function(t){(0,s.default)(t).call(t,".ani")>-1?this.loadAnimation(t):(0,s.default)(t).call(t,".json")>-1||(0,s.default)(t).call(t,"als")>-1||(0,s.default)(t).call(t,"atlas")>-1?this.loadAtlas(t):this.loadImages(t.split(","))}},{key:"autoAnimation",set:function(t){this.play(0,!0,t)}},{key:"autoPlay",set:function(t){t?this.play():this.stop()}},{key:"clear",value:function(){return(0,h.default)((0,f.default)(r.prototype),"clear",this).call(this),this.stop(),this.graphics=null,this._frames=null,this._labels=null,this}},{key:"loadImages",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this._url="",this._setFramesFromCache(e)||(this.frames=r.framesMap[e]?r.framesMap[e]:r.createFrames(t,e)),this}},{key:"loadAtlas",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._url="";var a=this;if(!a._setFramesFromCache(i)){var n=function(n){t===n&&(a.frames=r.framesMap[i]?r.framesMap[i]:r.createFrames(t,i),e&&e.run())};p.Loader.getAtlas(t)?n(t):T.ILaya.loader.load(t,m.Handler.create(null,n,[t]),null,p.Loader.ATLAS)}return this}},{key:"loadAnimation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._url=t;var a=this;return this._actionName||(this._actionName=""),a._setFramesFromCache(this._actionName)?(a._setFramesFromCache(this._actionName,!0),this.index=0,e&&e.run()):!i||p.Loader.getAtlas(i)?this._loadAnimationData(t,e,i):T.ILaya.loader.load(i,m.Handler.create(this,this._loadAnimationData,[t,e,i]),null,p.Loader.ATLAS),this}},{key:"_loadAnimationData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!i||p.Loader.getAtlas(i)){var a=this;p.Loader.getRes(t)?n(t):T.ILaya.loader.load(t,m.Handler.create(null,n,[t]),null,p.Loader.JSON)}else console.warn("atlas load fail:"+i);function n(i){if(p.Loader.getRes(i)){if(t===i){var n;if(r.framesMap[t+"#"])a._setFramesFromCache(a._actionName,!0),a.index=0,a._resumePlay();else{var s=g.GraphicAnimation.parseAnimationData(p.Loader.getRes(t));if(!s)return;var l,o,u=s.animationList,h=u.length;for(l=0;l<h;l++)n=u[l],r.framesMap[t+"#"+n.name]=n,o||(o=n);o&&(r.framesMap[t+"#"]=o,a._setFramesFromCache(a._actionName,!0),a.index=0),a._resumePlay()}e&&e.run()}p.Loader.clearRes(t)}else r.framesMap[t+"#"]&&(a._setFramesFromCache(a._actionName,!0),a.index=0,a._resumePlay(),e&&e.run())}}}],[{key:"createFrames",value:function(t,e){var i;if("string"==typeof t){var a=p.Loader.getAtlas(t);if(a&&a.length){i=[];for(var n=0,s=a.length;n<s;n++){var l=new y.Graphics;l.drawImage(p.Loader.getRes(a[n]),0,0),i.push(l)}}}else if(t instanceof Array)for(i=[],n=0,s=t.length;n<s;n++)(l=new y.Graphics).loadImage(t[n],0,0),i.push(l);return e&&(r.framesMap[e]=i),i}},{key:"clearCache",value:function(t){var e,i=r.framesMap,a=t+"#";for(e in i)e!==t&&0!==(0,s.default)(e).call(e,a)||delete r.framesMap[e]}}]),r}(v.AnimationBase);e.Animation=C,(0,_.default)(C,"framesMap",{}),T.ILaya.regClass(C),k.ClassUtils.regClass("laya.display.Animation",C),k.ClassUtils.regClass("Laya.Animation",C)},62466:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.AnimationBase=void 0;var s=r(i(81643)),l=r(i(92762)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(92135)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=r(i(17454)),y=i(87210),p=i(20516),g=i(46222),m=i(63969),x=i(89432);var T=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t;return(0,o.default)(this,r),t=n.call(this),(0,v.default)((0,h.default)(t),"wrapMode",0),(0,v.default)((0,h.default)(t),"_interval",p.Config.animationInterval),(0,v.default)((0,h.default)(t),"_isReverse",!1),(0,v.default)((0,h.default)(t),"_frameRateChanged",!1),t._setBitUp(g.Const.DISPLAY),t}return(0,u.default)(r,[{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._isPlaying=!0,this._actionName=i,this.index="string"==typeof t?this._getFrameByLabel(t):t,this.loop=e,this._isReverse=this.wrapMode===r.WRAP_REVERSE,0==this.index&&this._isReverse&&(this.index=this.count-1),this.interval>0&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)}},{key:"interval",get:function(){return this._interval},set:function(t){this._interval!=t&&(this._frameRateChanged=!0,this._interval=t,this._isPlaying&&t>0&&this.timerLoop(t,this,this._frameLoop,null,!0,!0))}},{key:"_getFrameByLabel",value:function(t){for(var e=0;e<this._count;e++){var i,a=this._labels[e];if(a&&(0,s.default)(i=a).call(i,t)>-1)return e}return 0}},{key:"_frameLoop",value:function(){if(this._controlNode&&!this._controlNode.destroyed){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event(m.Event.COMPLETE);this.wrapMode==r.WRAP_PINGPONG?(this._index=this._count>0?1:0,this._isReverse=!1):this._index=this._count-1,this.event(m.Event.COMPLETE)}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event(m.Event.COMPLETE);this.wrapMode==r.WRAP_PINGPONG?(this._index=this._count-2>=0?this._count-2:0,this._isReverse=!0):this._index=0,this.event(m.Event.COMPLETE)}this.index=this._index}else this.clearTimer(this,this._frameLoop)}},{key:"_setControlNode",value:function(t){this._controlNode&&(this._controlNode.off(m.Event.DISPLAY,this,this._resumePlay),this._controlNode.off(m.Event.UNDISPLAY,this,this._resumePlay)),this._controlNode=t,t&&t!=this&&(t.on(m.Event.DISPLAY,this,this._resumePlay),t.on(m.Event.UNDISPLAY,this,this._resumePlay))}},{key:"_setDisplay",value:function(t){(0,c.default)((0,_.default)(r.prototype),"_setDisplay",this).call(this,t),this._resumePlay()}},{key:"_resumePlay",value:function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))}},{key:"stop",value:function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"addLabel",value:function(t,e){this._labels||(this._labels={}),this._labels[e]||(this._labels[e]=[]),this._labels[e].push(t)}},{key:"removeLabel",value:function(t){if(t){if(this._labels)for(var e in this._labels)this._removeLabelFromList(this._labels[e],t)}else this._labels=null}},{key:"_removeLabelFromList",value:function(t,e){if(t)for(var i=t.length-1;i>=0;i--)t[i]==e&&(0,l.default)(t).call(t,i,1)}},{key:"gotoAndStop",value:function(t){this.index="string"==typeof t?this._getFrameByLabel(t):t,this.stop()}},{key:"index",get:function(){return this._index},set:function(t){if(this._index=t,this._displayToIndex(t),this._labels&&this._labels[t])for(var e=this._labels[t],i=0,a=e.length;i<a;i++)this.event(m.Event.LABEL,e[i])}},{key:"_displayToIndex",value:function(t){}},{key:"count",get:function(){return this._count}},{key:"clear",value:function(){return this.stop(),this._labels=null,this}}]),r}(y.Sprite);e.AnimationBase=T,(0,v.default)(T,"WRAP_POSITIVE",0),(0,v.default)(T,"WRAP_REVERSE",1),(0,v.default)(T,"WRAP_PINGPONG",2),x.ClassUtils.regClass("laya.display.AnimationBase",T),x.ClassUtils.regClass("Laya.AnimationBase",T)},86431:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var r=n(i(81643)),s=n(i(94198)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(63701),c=i(29148),d=i(35696),f=i(93561),_=i(89432),v=function(){function t(){(0,l.default)(this,t),(0,u.default)(this,"_fontCharDic",{}),(0,u.default)(this,"_fontWidthMap",{}),(0,u.default)(this,"_maxWidth",0),(0,u.default)(this,"_spaceWidth",10),(0,u.default)(this,"fontSize",12),(0,u.default)(this,"autoScaleSize",!1),(0,u.default)(this,"letterSpacing",0)}return(0,o.default)(t,[{key:"loadFont",value:function(t,e){this._path=t,this._complete=e,t&&-1!==(0,r.default)(t).call(t,".fnt")?f.ILaya.loader.load([{url:t,type:f.ILaya.Loader.XML},{url:t.replace(".fnt",".png"),type:f.ILaya.Loader.IMAGE}],d.Handler.create(this,this._onLoaded)):console.error('Bitmap font configuration information must be a ".fnt" file')}},{key:"_onLoaded",value:function(){this.parseFont(f.ILaya.Loader.getRes(this._path),f.ILaya.Loader.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()}},{key:"parseFont",value:function(t,e){if(null!=t&&null!=e){this._texture=e;var i=t.getElementsByTagName("info");if(!i[0].getAttributeNode)return this.parseFont2(t,e);this.fontSize=(0,s.default)(i[0].getAttributeNode("size").nodeValue);var a=i[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[(0,s.default)(a[0]),(0,s.default)(a[1]),(0,s.default)(a[2]),(0,s.default)(a[3])];var n=t.getElementsByTagName("char"),r=0;for(r=0;r<n.length;r++){var l=n[r],o=(0,s.default)(l.getAttributeNode("id").nodeValue),u=(0,s.default)(l.getAttributeNode("xoffset").nodeValue)/1,d=(0,s.default)(l.getAttributeNode("yoffset").nodeValue)/1,f=(0,s.default)(l.getAttributeNode("xadvance").nodeValue)/1,_=new h.Rectangle;_.x=(0,s.default)(l.getAttributeNode("x").nodeValue),_.y=(0,s.default)(l.getAttributeNode("y").nodeValue),_.width=(0,s.default)(l.getAttributeNode("width").nodeValue),_.height=(0,s.default)(l.getAttributeNode("height").nodeValue);var v=c.Texture.create(e,_.x,_.y,_.width,_.height,u,d);this._maxWidth=Math.max(this._maxWidth,f+this.letterSpacing),this._fontCharDic[o]=v,this._fontWidthMap[o]=f}}}},{key:"parseFont2",value:function(t,e){if(null!=t&&null!=e){this._texture=e;var i=t.getElementsByTagName("info");this.fontSize=(0,s.default)(i[0].attributes.size.nodeValue);var a=i[0].attributes.padding.nodeValue.split(",");this._padding=[(0,s.default)(a[0]),(0,s.default)(a[1]),(0,s.default)(a[2]),(0,s.default)(a[3])];var n=t.getElementsByTagName("char"),r=0;for(r=0;r<n.length;r++){var l=n[r].attributes,o=(0,s.default)(l.id.nodeValue),u=(0,s.default)(l.xoffset.nodeValue)/1,d=(0,s.default)(l.yoffset.nodeValue)/1,f=(0,s.default)(l.xadvance.nodeValue)/1,_=new h.Rectangle;_.x=(0,s.default)(l.x.nodeValue),_.y=(0,s.default)(l.y.nodeValue),_.width=(0,s.default)(l.width.nodeValue),_.height=(0,s.default)(l.height.nodeValue);var v=c.Texture.create(e,_.x,_.y,_.width,_.height,u,d);this._maxWidth=Math.max(this._maxWidth,f+this.letterSpacing),this._fontCharDic[o]=v,this._fontWidthMap[o]=f}}}},{key:"getCharTexture",value:function(t){return this._fontCharDic[t.charCodeAt(0)]}},{key:"destroy",value:function(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];e&&e.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null,this._complete=null,this._padding=null}}},{key:"setSpaceWidth",value:function(t){this._spaceWidth=t}},{key:"getCharWidth",value:function(t){var e=t.charCodeAt(0);return this._fontWidthMap[e]?this._fontWidthMap[e]+this.letterSpacing:" "===t?this._spaceWidth+this.letterSpacing:0}},{key:"getTextWidth",value:function(t){for(var e=0,i=0,a=t.length;i<a;i++)e+=this.getCharWidth(t.charAt(i));return e}},{key:"getMaxWidth",value:function(){return this._maxWidth}},{key:"getMaxHeight",value:function(){return this.fontSize}},{key:"_drawText",value:function(t,e,i,a,n,r){var s,l=this.getTextWidth(t),o=0;"center"===n&&(o=(r-l)/2),"right"===n&&(o=r-l);for(var u=0,h=0,c=t.length;h<c;h++)(s=this.getCharTexture(t.charAt(h)))&&(e.graphics.drawImage(s,i+u+o,a),u+=this.getCharWidth(t.charAt(h)))}}]),t}();e.BitmapFont=v,_.ClassUtils.regClass("laya.display.BitmapFont",v),_.ClassUtils.regClass("Laya.BitmapFont",v)},14290:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.FrameAnimation=void 0;var s=r(i(69301)),l=r(i(81643)),o=r(i(47302)),u=r(i(87368)),h=r(i(28146)),c=r(i(92135)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=i(62466),y=i(44329),p=i(96060),g=i(89432);var m=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t;return(0,u.default)(this,r),t=n.call(this),void 0===r._sortIndexFun&&(r._sortIndexFun=y.MathUtil.sortByKey("index",!1,!0)),t}return(0,h.default)(r,[{key:"_setUp",value:function(t,e){this._targetDic=t,this._animationData=e,this.interval=1e3/e.frameRate,e.parsed?(this._count=e.count,this._labels=e.labels,this._usedFrames=e.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),e.parsed=!0,e.labels=this._labels,e.count=this._count,e.animationNewFrames=this._usedFrames)}},{key:"clear",value:function(){return(0,c.default)((0,_.default)(r.prototype),"clear",this).call(this),this._targetDic=null,this._animationData=null,this}},{key:"_displayToIndex",value:function(t){if(this._animationData){t<0&&(t=0),t>this._count&&(t=this._count);var e,i=this._animationData.nodes,a=i.length;for(e=0;e<a;e++)this._displayNodeToFrame(i[e],t)}}},{key:"_displayNodeToFrame",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i||(i=this._targetDic);var a=i[t.target];if(a){var n,r,l,o,u=t.frames,h=(0,s.default)(t),c=h.length;for(o=0;o<c;o++)l=(r=u[n=h[o]]).length>e?r[e]:r[r.length-1],a[n]=l;var d,f=t.funkeys;if(0!=(c=f.length))for(o=0;o<c;o++)void 0!==(d=u[n=f[o]])[e]&&a[n]&&a[n].apply(a,d[e])}}},{key:"_calculateDatas",value:function(){if(this._animationData){var t,e,i=this._animationData.nodes,a=i.length;for(this._count=0,t=0;t<a;t++)e=i[t],this._calculateKeyFrames(e);this._count+=1}}},{key:"_calculateKeyFrames",value:function(t){var e,i,a=t.keyframes,n=t.target;for(e in t.frames||(t.frames={}),(0,s.default)(t)?(0,s.default)(t).length=0:t.keys=[],t.funkeys?t.funkeys.length=0:t.funkeys=[],t.initValues||(t.initValues={}),a){var u=-1!=(0,l.default)(e).call(e,"()");if(i=a[e],u&&(e=e.substr(0,e.length-2)),t.frames[e]||(t.frames[e]=[]),u){t.funkeys.push(e);for(var h=t.frames[e],c=0;c<i.length;c++){var d=i[c];h[d.index]=d.value,d.index>this._count&&(this._count=d.index)}}else this._targetDic&&this._targetDic[n]&&(t.initValues[e]=this._targetDic[n][e]),(0,o.default)(i).call(i,r._sortIndexFun),(0,s.default)(t).push(e),this._calculateNodePropFrames(i,t.frames[e],e,n)}}},{key:"resetNodes",value:function(){if(this._targetDic&&this._animationData){var t,e,i,a=this._animationData.nodes,n=a.length;for(t=0;t<n;t++)if(i=(e=a[t]).initValues){var r,s=this._targetDic[e.target];if(s)for(r in i)s[r]=i[r]}}}},{key:"_calculateNodePropFrames",value:function(t,e,i,a){var n,r=t.length-1;for(e.length=t[r].index+1,n=0;n<r;n++)this._dealKeyFrame(t[n]),this._calculateFrameValues(t[n],t[n+1],e);0==r&&(e[0]=t[0].value,this._usedFrames&&(this._usedFrames[t[0].index]=!0)),this._dealKeyFrame(t[n])}},{key:"_dealKeyFrame",value:function(t){t.label&&""!=t.label&&this.addLabel(t.label,t.index)}},{key:"_calculateFrameValues",value:function(t,e,i){var a,n,r=t.index,s=e.index,l=t.value,o=e.value-t.value,u=s-r,h=this._usedFrames;if(s>this._count&&(this._count=s),t.tween)for(null==(n=p.Ease[t.tweenMethod])&&(n=p.Ease.linearNone),a=r;a<s;a++)i[a]=n(a-r,l,o,u),h&&(h[a]=!0);else for(a=r;a<s;a++)i[a]=l;h&&(h[t.index]=!0,h[e.index]=!0),i[e.index]=e.value}}],[{key:"_sortIndexFun",value:function(t,e){return t.index-e.index}}]),r}(v.AnimationBase);e.FrameAnimation=m,g.ClassUtils.regClass("laya.display.FrameAnimation",m),g.ClassUtils.regClass("Laya.FrameAnimation",m)},22010:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Graphics=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(46804),u=i(46791),h=i(81379),c=i(20783),d=i(32487),f=i(39808),_=i(44265),v=i(60003),y=i(2475),p=i(10085),g=i(36999),m=i(17050),x=i(5712),T=i(75697),k=i(5831),C=i(44992),S=i(327),E=i(49505),M=i(34966),L=i(99643),b=i(48555),I=i(39471),R=i(17267),w=i(92672),A=i(25113),B=i(63969),D=i(91020),P=i(3117),F=i(29148),O=i(11179),U=i(48331),N=i(93561),G=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_sp",null),(0,l.default)(this,"_one",null),(0,l.default)(this,"_render",this._renderEmpty),(0,l.default)(this,"_cmds",null),(0,l.default)(this,"_vectorgraphArray",null),(0,l.default)(this,"_graphicBounds",null),(0,l.default)(this,"autoDestroy",!1),this._createData()}return(0,s.default)(t,[{key:"_createData",value:function(){}},{key:"_clearData",value:function(){}},{key:"_destroyData",value:function(){}},{key:"destroy",value:function(){this.clear(!0),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null),this._destroyData()}},{key:"clear",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t){var e=this._one;if(this._cmds){var i,a=this._cmds.length;for(i=0;i<a;i++)(e=this._cmds[i]).recover();this._cmds.length=0}else e&&e.recover()}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._clearData(),this._sp&&(this._sp._renderType&=~u.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._repaint(),this._vectorgraphArray){for(i=0,a=this._vectorgraphArray.length;i<a;i++)U.VectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);this._vectorgraphArray.length=0}}},{key:"_clearBoundsCache",value:function(){this._graphicBounds&&this._graphicBounds.reset()}},{key:"_initGraphicBounds",value:function(){this._graphicBounds||(this._graphicBounds=o.GraphicsBounds.create(),this._graphicBounds._graphics=this)}},{key:"_repaint",value:function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()}},{key:"_isOnlyOne",value:function(){return!this._cmds||0===this._cmds.length}},{key:"cmds",get:function(){return this._cmds},set:function(t){this._sp&&(this._sp._renderType|=u.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._cmds=t,this._render=this._renderAll,this._repaint()}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBounds(t)}},{key:"getBoundPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBoundPoints(t)}},{key:"drawImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!t)return null;if(a||(a=t.sourceWidth),n||(n=t.sourceHeight),t.getIsReady()){var r=a/t.sourceWidth,s=n/t.sourceHeight;if(a=t.width*r,n=t.height*s,a<=0||n<=0)return null;e+=t.offsetX*r,i+=t.offsetY*s}this._sp&&(this._sp._renderType|=u.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var l=v.DrawImageCmd.create.call(this,t,e,i,a,n);return null==this._one?(this._one=l,this._render=this._renderOneImg):this._saveToCmd(null,l),this._repaint(),l}},{key:"drawTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9?arguments[9]:void 0;if(!t||s<.01)return null;if(!t.getIsReady())return null;if(a||(a=t.sourceWidth),n||(n=t.sourceHeight),t.getIsReady()){var c=a/t.sourceWidth,d=n/t.sourceHeight;if(a=t.width*c,n=t.height*d,a<=0||n<=0)return null;e+=t.offsetX*c,i+=t.offsetY*d}this._sp&&(this._sp._renderType|=u.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType));var f=k.DrawTextureCmd.create.call(this,t,e,i,a,n,r,s,l,o,h);return this._repaint(),this._saveToCmd(null,f)}},{key:"drawTextures",value:function(t,e){return t?this._saveToCmd(P.Render._context.drawTextures,C.DrawTexturesCmd.create.call(this,t,e)):null}},{key:"drawTriangles",value:function(t,e,i,a,n,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:4294967295;return this._saveToCmd(P.Render._context.drawTriangles,S.DrawTrianglesCmd.create.call(this,t,e,i,a,n,r,s,l,o,u,h))}},{key:"fillTexture",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"repeat",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return t&&t.getIsReady()?this._saveToCmd(P.Render._context._fillTexture,M.FillTextureCmd.create.call(this,t,e,i,a,n,r,s||D.Point.EMPTY,{})):null}},{key:"_saveToCmd",value:function(t,e){return this._sp&&(this._sp._renderType|=u.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),null==this._one?(this._one=e,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(e)),this._repaint(),e}},{key:"clipRect",value:function(t,e,i,a){return this._saveToCmd(P.Render._context.clipRect,c.ClipRectCmd.create.call(this,t,e,i,a))}},{key:"fillText",value:function(t,e,i,a,n,r){return this._saveToCmd(P.Render._context.fillText,E.FillTextCmd.create.call(this,t,null,e,i,a||N.ILaya.Text.defaultFontStr(),n,r,0,""))}},{key:"fillBorderText",value:function(t,e,i,a,n,r,s,l){return this._saveToCmd(P.Render._context.fillText,E.FillTextCmd.create.call(this,t,null,e,i,a||N.ILaya.Text.defaultFontStr(),n,r,s,l))}},{key:"fillWords",value:function(t,e,i,a,n){return this._saveToCmd(P.Render._context.fillText,E.FillTextCmd.create.call(this,null,t,e,i,a||N.ILaya.Text.defaultFontStr(),n,"",0,null))}},{key:"fillBorderWords",value:function(t,e,i,a,n,r,s){return this._saveToCmd(P.Render._context.fillText,E.FillTextCmd.create.call(this,null,t,e,i,a||N.ILaya.Text.defaultFontStr(),n,"",s,r))}},{key:"strokeText",value:function(t,e,i,a,n,r,s){return this._saveToCmd(P.Render._context.fillText,E.FillTextCmd.create.call(this,t,null,e,i,a||N.ILaya.Text.defaultFontStr(),null,s,r,n))}},{key:"alpha",value:function(t){return this._saveToCmd(P.Render._context.alpha,h.AlphaCmd.create.call(this,t))}},{key:"transform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._saveToCmd(P.Render._context._transform,w.TransformCmd.create.call(this,t,e,i))}},{key:"rotate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._saveToCmd(P.Render._context._rotate,b.RotateCmd.create.call(this,t,e,i))}},{key:"scale",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this._saveToCmd(P.Render._context._scale,R.ScaleCmd.create.call(this,t,e,i,a))}},{key:"translate",value:function(t,e){return this._saveToCmd(P.Render._context.translate,A.TranslateCmd.create.call(this,t,e))}},{key:"save",value:function(){return this._saveToCmd(P.Render._context._save,I.SaveCmd.create.call(this))}},{key:"restore",value:function(){return this._saveToCmd(P.Render._context.restore,L.RestoreCmd.create.call(this))}},{key:"replaceText",value:function(t){this._repaint();var e=this._cmds;if(e){for(var i=e.length-1;i>-1;i--)if(this._isTextCmd(e[i]))return e[i].text=t,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=t,!0;return!1}},{key:"_isTextCmd",value:function(t){return t.cmdID==E.FillTextCmd.ID}},{key:"replaceTextColor",value:function(t){this._repaint();var e=this._cmds;if(e)for(var i=e.length-1;i>-1;i--)this._isTextCmd(e[i])&&this._setTextCmdColor(e[i],t);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,t)}},{key:"_setTextCmdColor",value:function(t,e){t.cmdID===E.FillTextCmd.ID&&(t.color=e)}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=N.ILaya.Loader.getRes(t);s?s.getIsReady()?this.drawImage(s,e,i,a,n):s.once(B.Event.READY,this,this.drawImage,[s,e,i,a,n]):((s=new F.Texture).load(t),N.ILaya.Loader.cacheTexture(t,s),s.once(B.Event.READY,this,this.drawImage,[s,e,i,a,n])),null!=r&&(s.getIsReady()?r.call(this._sp):s.on(B.Event.READY,this._sp,r))}},{key:"_renderEmpty",value:function(t,e,i,a){}},{key:"_renderAll",value:function(t,e,i,a){for(var n=this._cmds,r=0,s=n.length;r<s;r++)n[r].run(e,i,a)}},{key:"_renderOne",value:function(t,e,i,a){e.sprite=t,this._one.run(e,i,a)}},{key:"_renderOneImg",value:function(t,e,i,a){e.sprite=t,this._one.run(e,i,a)}},{key:"drawLine",value:function(t,e,i,a,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=r<1||r%2==0?0:.5;return this._saveToCmd(P.Render._context._drawLine,y.DrawLineCmd.create.call(this,t+s,e+s,i+s,a+s,n,r,0))}},{key:"drawLines",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(!i||i.length<4)return null;var r=n<1||n%2==0?0:.5;return this._saveToCmd(P.Render._context._drawLines,p.DrawLinesCmd.create.call(this,t+r,e+r,i,a,n,0))}},{key:"drawCurves",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return this._saveToCmd(P.Render._context.drawCurves,_.DrawCurvesCmd.create.call(this,t,e,i,a,n))}},{key:"drawRect",value:function(t,e,i,a,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=s>=1&&r?s/2:0,o=r?s:0;return this._saveToCmd(P.Render._context.drawRect,T.DrawRectCmd.create.call(this,t+l,e+l,i-o,a-o,n,r,s))}},{key:"drawCircle",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=r>=1&&n?r/2:0;return this._saveToCmd(P.Render._context._drawCircle,f.DrawCircleCmd.create.call(this,t,e,i-s,a,n,r,0))}},{key:"drawPie",value:function(t,e,i,a,n,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,o=l>=1&&s?l/2:0,u=s?l:0;return this._saveToCmd(P.Render._context._drawPie,m.DrawPieCmd.create.call(this,t+o,e+o,i-u,O.Utils.toRadian(a),O.Utils.toRadian(n),r,s,l,0))}},{key:"drawPoly",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=!1;s=!(i.length>6);var l=r>=1&&n?r%2==0?0:.5:0;return this._saveToCmd(P.Render._context._drawPoly,x.DrawPolyCmd.create.call(this,t+l,e+l,i,a,n,r,s,0))}},{key:"drawPath",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return this._saveToCmd(P.Render._context._drawPath,g.DrawPathCmd.create.call(this,t,e,i,a,n))}},{key:"draw9Grid",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5?arguments[5]:void 0;this._saveToCmd(null,d.Draw9GridTexture.create(t,e,i,a,n,r))}}]),t}();e.Graphics=G},46804:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.GraphicsBounds=void 0;var r=n(i(77766)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(81379),h=i(39808),c=i(44265),d=i(60003),f=i(2475),_=i(10085),v=i(36999),y=i(17050),p=i(5712),g=i(75697),m=i(5831),x=i(34966),T=i(99643),k=i(48555),C=i(17267),S=i(92672),E=i(25113),M=i(13212),L=i(92356),b=i(5866),I=i(91020),R=i(63701),w=i(3117),A=i(89761),B=i(11179),D=i(327),P=i(32487),F=i(39471),O=function(){function t(){(0,s.default)(this,t),(0,o.default)(this,"_cacheBoundsType",!1)}return(0,l.default)(t,[{key:"destroy",value:function(){this._graphics=null,this._cacheBoundsType=!1,this._temp&&(this._temp.length=0),this._rstBoundPoints&&(this._rstBoundPoints.length=0),this._bounds&&this._bounds.recover(),this._bounds=null,A.Pool.recover("GraphicsBounds",this)}},{key:"reset",value:function(){this._temp&&(this._temp.length=0)}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._bounds=R.Rectangle._getWrapRec(this.getBoundPoints(t),this._bounds)),this._cacheBoundsType=t,this._bounds}},{key:"getBoundPoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(t)),this._cacheBoundsType=t,this._rstBoundPoints=B.Utils.copyArray(this._rstBoundPoints,this._temp)}},{key:"_getCmdPoints",value:function(){var e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=(w.Render._context,this._graphics.cmds);if((e=this._temp||(this._temp=[])).length=0,a||null==this._graphics._one||(t._tempCmds.length=0,t._tempCmds.push(this._graphics._one),a=t._tempCmds),!a)return e;var n=t._tempMatrixArrays;n.length=0;var s=t._initMatrix;s.identity();for(var l,o,b=t._tempMatrix,I=0,A=a.length;I<A;I++)switch((l=a[I]).cmdID){case u.AlphaCmd.ID:case F.SaveCmd.ID:n.push(s),s=s.clone();break;case T.RestoreCmd.ID:s=n.pop();break;case C.ScaleCmd.ID:b.identity(),b.translate(-l.pivotX,-l.pivotY),b.scale(l.scaleX,l.scaleY),b.translate(l.pivotX,l.pivotY),this._switchMatrix(s,b);break;case k.RotateCmd.ID:b.identity(),b.translate(-l.pivotX,-l.pivotY),b.rotate(l.angle),b.translate(l.pivotX,l.pivotY),this._switchMatrix(s,b);break;case E.TranslateCmd.ID:b.identity(),b.translate(l.tx,l.ty),this._switchMatrix(s,b);break;case S.TransformCmd.ID:b.identity(),b.translate(-l.pivotX,-l.pivotY),(0,r.default)(b).call(b,l.matrix),b.translate(l.pivotX,l.pivotY),this._switchMatrix(s,b);break;case d.DrawImageCmd.ID:case x.FillTextureCmd.ID:t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,l.width,l.height),s);break;case m.DrawTextureCmd.ID:s.copyTo(b),l.matrix&&(0,r.default)(b).call(b,l.matrix),t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,l.width,l.height),b);break;case d.DrawImageCmd.ID:if(o=l.texture,i)l.width&&l.height?t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,l.width,l.height),s):t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,o.width,o.height),s);else{var O=(l.width||o.sourceWidth)/o.width,U=(l.height||o.sourceHeight)/o.height,N=O*o.sourceWidth,G=U*o.sourceHeight,H=o.offsetX>0?o.offsetX:0,W=o.offsetY>0?o.offsetY:0;H*=O,W*=U,t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x-H,l.y-W,N,G),s)}break;case x.FillTextureCmd.ID:l.width&&l.height?t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,l.width,l.height),s):(o=l.texture,t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,o.width,o.height),s));break;case m.DrawTextureCmd.ID:var V;l.matrix?(s.copyTo(b),(0,r.default)(b).call(b,l.matrix),V=b):V=s,i?l.width&&l.height?t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,l.width,l.height),V):(o=l.texture,t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,o.width,o.height),V)):(o=l.texture,O=(l.width||o.sourceWidth)/o.width,U=(l.height||o.sourceHeight)/o.height,N=O*o.sourceWidth,G=U*o.sourceHeight,H=o.offsetX>0?o.offsetX:0,W=o.offsetY>0?o.offsetY:0,H*=O,W*=U,t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x-H,l.y-W,N,G),V));break;case g.DrawRectCmd.ID:t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x,l.y,l.width,l.height),s);break;case h.DrawCircleCmd.ID:t._addPointArrToRst(e,R.Rectangle._getBoundPointS(l.x-l.radius,l.y-l.radius,l.radius+l.radius,l.radius+l.radius),s);break;case f.DrawLineCmd.ID:var Y;t._tempPoints.length=0,Y=.5*l.lineWidth,l.fromX==l.toX?t._tempPoints.push(l.fromX+Y,l.fromY,l.toX+Y,l.toY,l.fromX-Y,l.fromY,l.toX-Y,l.toY):l.fromY==l.toY?t._tempPoints.push(l.fromX,l.fromY+Y,l.toX,l.toY+Y,l.fromX,l.fromY-Y,l.toX,l.toY-Y):t._tempPoints.push(l.fromX,l.fromY,l.toX,l.toY),t._addPointArrToRst(e,t._tempPoints,s);break;case c.DrawCurvesCmd.ID:t._addPointArrToRst(e,M.Bezier.I.getBezierPoints(l.points),s,l.x,l.y);break;case _.DrawLinesCmd.ID:case p.DrawPolyCmd.ID:t._addPointArrToRst(e,l.points,s,l.x,l.y);break;case v.DrawPathCmd.ID:t._addPointArrToRst(e,this._getPathPoints(l.paths),s,l.x,l.y);break;case y.DrawPieCmd.ID:t._addPointArrToRst(e,this._getPiePoints(l.x,l.y,l.radius,l.startAngle,l.endAngle),s);break;case D.DrawTrianglesCmd.ID:t._addPointArrToRst(e,this._getTriAngBBXPoints(l.vertices),s);break;case P.Draw9GridTexture.ID:t._addPointArrToRst(e,this._getDraw9GridBBXPoints(l),s)}return e.length>200?e=B.Utils.copyArray(e,R.Rectangle._getWrapRec(e)._getBoundPoints()):e.length>8&&(e=L.GrahamScan.scanPList(e)),e}},{key:"_switchMatrix",value:function(t,e){(0,r.default)(e).call(e,t),e.copyTo(t)}},{key:"_getPiePoints",value:function(e,i,a,n,r){var s=t._tempPoints;t._tempPoints.length=0;var l=Math.PI/180,o=r-n;if(o>=360||o<=-360)return s.push(e-a,i-a),s.push(e+a,i-a),s.push(e+a,i+a),s.push(e-a,i+a),s;s.push(e,i);var u=o%360;u<0&&(u+=360);var h=n+u,c=n*l,d=h*l;s.push(e+a*Math.cos(c),i+a*Math.sin(c)),s.push(e+a*Math.cos(d),i+a*Math.sin(d));for(var f=90*Math.ceil(n/90),_=90*Math.floor(h/90),v=f;v<=_;v+=90){var y=v*l;s.push(e+a*Math.cos(y),i+a*Math.sin(y))}return s}},{key:"_getTriAngBBXPoints",value:function(t){var e=t.length;if(e<2)return[];for(var i=t[0],a=t[1],n=i,r=a,s=2;s<e;){var l=t[s++],o=t[s++];i>l&&(i=l),a>o&&(a=o),n<l&&(n=l),r<o&&(r=o)}return[i,a,n,a,n,r,i,r]}},{key:"_getDraw9GridBBXPoints",value:function(t){var e=t.width,i=t.height;return[0,0,e,0,e,i,0,i]}},{key:"_getPathPoints",value:function(e){var i,a,n,r=t._tempPoints;for(r.length=0,a=e.length,i=0;i<a;i++)(n=e[i]).length>1&&(r.push(n[1],n[2]),n.length>3&&r.push(n[3],n[4]));return r}}],[{key:"create",value:function(){return A.Pool.getItemByClass("GraphicsBounds",t)}},{key:"_addPointArrToRst",value:function(e,i,a){var n,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;for(r=i.length,n=0;n<r;n+=2)t._addPointToRst(e,i[n]+s,i[n+1]+l,a)}},{key:"_addPointToRst",value:function(t,e,i,a){var n=I.Point.TEMP;n.setTo(e||0,i||0),a.transformPoint(n),t.push(n.x,n.y)}}]),t}();e.GraphicsBounds=O,(0,o.default)(O,"_tempMatrix",new b.Matrix),(0,o.default)(O,"_initMatrix",new b.Matrix),(0,o.default)(O,"_tempPoints",[]),(0,o.default)(O,"_tempMatrixArrays",[]),(0,o.default)(O,"_tempCmds",[])},85058:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Input=void 0;var s=r(i(81643)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(23699),y=i(63969),p=i(11179),g=i(93561),m=i(89432);var x=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,l.default)(this,r),t=n.call(this),(0,_.default)((0,u.default)(t),"_multiline",!1),(0,_.default)((0,u.default)(t),"_editable",!0),(0,_.default)((0,u.default)(t),"_maxChars",1e5),(0,_.default)((0,u.default)(t),"_type","text"),(0,_.default)((0,u.default)(t),"_prompt",""),(0,_.default)((0,u.default)(t),"_promptColor","#A9A9A9"),(0,_.default)((0,u.default)(t),"_originColor","#000000"),(0,_.default)((0,u.default)(t),"_content",""),r.IOS_IFRAME=g.ILaya.Browser.onIOS&&g.ILaya.Browser.window.top!=g.ILaya.Browser.window.self,t._width=100,t._height=20,t.multiline=!1,t.overflow=v.Text.SCROLL,t.on(y.Event.MOUSE_DOWN,(0,u.default)(t),t._onMouseDown),t.on(y.Event.UNDISPLAY,(0,u.default)(t),t._onUnDisplay),t}return(0,o.default)(r,[{key:"setSelection",value:function(t,e){this.focus=!0,r.inputElement.selectionStart=t,r.inputElement.selectionEnd=e}},{key:"multiline",get:function(){return this._multiline},set:function(t){this._multiline=t,this.valign=t?"top":"middle"}},{key:"nativeInput",get:function(){return this._multiline?r.area:r.input}},{key:"_onUnDisplay",value:function(){this.focus=!1}},{key:"_onMouseDown",value:function(t){this.focus=!0}},{key:"_syncInputTransform",value:function(){var t=this.nativeInput,e=p.Utils.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),i=this._width-this.padding[1]-this.padding[3],a=this._height-this.padding[0]-this.padding[2];g.ILaya.Render.isConchApp?(t.setScale(e.scaleX,e.scaleY),t.setSize(i,a),t.setPos(e.x,e.y)):(r.inputContainer.style.transform=r.inputContainer.style.webkitTransform="scale("+e.scaleX+","+e.scaleY+") rotate("+g.ILaya.stage.canvasDegree+"deg)",t.style.width=i+"px",t.style.height=a+"px",r.inputContainer.style.left=e.x+"px",r.inputContainer.style.top=e.y+"px")}},{key:"select",value:function(){this.nativeInput.select()}},{key:"focus",get:function(){return this._focus},set:function(t){var e=this.nativeInput;this._focus!==t&&(t?(e.target?e.target._focusOut():this._setInputMethod(),e.target=this,this._focusIn()):(e.target=null,this._focusOut(),g.ILaya.Browser.document.body.scrollTop=0,e.blur(),g.ILaya.Render.isConchApp?e.setPos(-1e4,-1e4):r.inputContainer.contains(e)&&r.inputContainer.removeChild(e)))}},{key:"_setInputMethod",value:function(){r.input.parentElement&&r.inputContainer.removeChild(r.input),r.area.parentElement&&r.inputContainer.removeChild(r.area),g.ILaya.Browser.onAndroid&&(r.input=r.inputElement=g.ILaya.Browser.createElement("input"),r._initInput(r.input)),r.inputElement=this._multiline?r.area:r.input,r.inputContainer.appendChild(r.inputElement),v.Text.RightToLeft&&(r.inputElement.style.direction="rtl")}},{key:"_focusIn",value:function(){r.isInputting=!0;var t=this.nativeInput;r.input&&(r.input.type=this._type),this._focus=!0;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),t.readOnly=!this._editable,g.ILaya.Render.isConchApp&&(t.setType(this._type),t.setForbidEdit(!this._editable)),t.maxLength=this._maxChars,t.value=this._content,t.placeholder=this._prompt,g.ILaya.stage.off(y.Event.KEY_DOWN,this,this._onKeyDown),g.ILaya.stage.on(y.Event.KEY_DOWN,this,this._onKeyDown),g.ILaya.stage.focus=this,this.event(y.Event.FOCUS),g.ILaya.Browser.onPC&&t.focus(),g.ILaya.Browser.onMiniGame||g.ILaya.Browser.onBDMiniGame||g.ILaya.Browser.onQGMiniGame||g.ILaya.Browser.onKGMiniGame||g.ILaya.Browser.onVVMiniGame||g.ILaya.Browser.onAlipayMiniGame||g.ILaya.Browser.onQQMiniGame||g.ILaya.Browser.onBLMiniGame||g.ILaya.Browser.onTTMiniGame||g.ILaya.Browser.onHWMiniGame||g.ILaya.Browser.onTBMiniGame||(this._text=null),this.typeset(),t.setColor(this._originColor),t.setFontSize(this.fontSize),t.setFontFace(g.ILaya.Browser.onIPhone&&v.Text.fontFamilyMap[this.font]||this.font),g.ILaya.Render.isConchApp&&t.setMultiAble&&t.setMultiAble(this._multiline),e.lineHeight=this.leading+this.fontSize+"px",e.fontStyle=this.italic?"italic":"normal",e.fontWeight=this.bold?"bold":"normal",e.textAlign=this.align,e.padding="0 0",this._syncInputTransform(),!g.ILaya.Render.isConchApp&&g.ILaya.Browser.onPC&&g.ILaya.systemTimer.frameLoop(1,this,this._syncInputTransform)}},{key:"_setPromptColor",value:function(){r.promptStyleDOM=g.ILaya.Browser.getElementById("promptStyle"),r.promptStyleDOM||(r.promptStyleDOM=g.ILaya.Browser.createElement("style"),r.promptStyleDOM.setAttribute("id","promptStyle"),g.ILaya.Browser.document.head.appendChild(r.promptStyleDOM)),r.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"}},{key:"_focusOut",value:function(){r.isInputting&&(r.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?((0,h.default)((0,f.default)(r.prototype),"set_text",this).call(this,this._content),(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,this._originColor)):((0,h.default)((0,f.default)(r.prototype),"set_text",this).call(this,this._prompt),(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,this._promptColor)),g.ILaya.stage.off(y.Event.KEY_DOWN,this,this._onKeyDown),g.ILaya.stage.focus=null,this.event(y.Event.BLUR),this.event(y.Event.CHANGE),g.ILaya.Render.isConchApp&&this.nativeInput.blur(),g.ILaya.Browser.onPC&&g.ILaya.systemTimer.clear(this,this._syncInputTransform))}},{key:"_onKeyDown",value:function(t){13===t.keyCode&&(g.ILaya.Browser.onMobile&&!this._multiline&&(this.focus=!1),this.event(y.Event.ENTER))}},{key:"text",get:function(){return this._focus?this.nativeInput.value:this._content||""},set:function(t){(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,this._originColor),t+="",this._focus?(this.nativeInput.value=t||"",this.event(y.Event.CHANGE)):(this._multiline||(t=t.replace(/\r?\n/g,"")),this._content=t,t?(0,h.default)((0,f.default)(r.prototype),"set_text",this).call(this,t):((0,h.default)((0,f.default)(r.prototype),"set_text",this).call(this,this._prompt),(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,this.promptColor)))}},{key:"changeText",value:function(t){this._content=t,this._focus?(this.nativeInput.value=t||"",this.event(y.Event.CHANGE)):(0,h.default)((0,f.default)(r.prototype),"changeText",this).call(this,t)}},{key:"color",get:function(){return(0,h.default)((0,f.default)(r.prototype),"color",this)},set:function(t){this._focus&&this.nativeInput.setColor(t),(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,this._content?t:this._promptColor),this._originColor=t}},{key:"bgColor",get:function(){return(0,h.default)((0,f.default)(r.prototype),"bgColor",this)},set:function(t){(0,h.default)((0,f.default)(r.prototype),"set_bgColor",this).call(this,t),g.ILaya.Render.isConchApp&&this.nativeInput.setBgColor(t)}},{key:"restrict",get:function(){return this._restrictPattern?this._restrictPattern.source:""},set:function(t){t?(t="[^"+t+"]",(0,s.default)(t).call(t,"^^")>-1&&(t=t.replace("^^","")),this._restrictPattern=new RegExp(t,"g")):this._restrictPattern=null}},{key:"editable",get:function(){return this._editable},set:function(t){this._editable=t,g.ILaya.Render.isConchApp&&r.input.setForbidEdit(!t)}},{key:"maxChars",get:function(){return this._maxChars},set:function(t){t<=0&&(t=1e5),this._maxChars=t}},{key:"prompt",get:function(){return this._prompt},set:function(t){!this._text&&t&&(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,this._promptColor),this.promptColor=this._promptColor,this._text?(0,h.default)((0,f.default)(r.prototype),"set_text",this).call(this,this._text==this._prompt?t:this._text):(0,h.default)((0,f.default)(r.prototype),"set_text",this).call(this,t),this._prompt=v.Text.langPacks&&v.Text.langPacks[t]?v.Text.langPacks[t]:t}},{key:"promptColor",get:function(){return this._promptColor},set:function(t){this._promptColor=t,this._content||(0,h.default)((0,f.default)(r.prototype),"set_color",this).call(this,t)}},{key:"type",get:function(){return this._type},set:function(t){this._getTextStyle().asPassword="password"===t,this._type=t}}],[{key:"__init__",value:function(){if(r._createInputElement(),g.ILaya.Browser.onMobile){var t=!1;(g.ILaya.Browser.onMiniGame||g.ILaya.Browser.onBDMiniGame||g.ILaya.Browser.onQGMiniGame||g.ILaya.Browser.onKGMiniGame||g.ILaya.Browser.onVVMiniGame||g.ILaya.Browser.onAlipayMiniGame||g.ILaya.Browser.onQQMiniGame||g.ILaya.Browser.onBLMiniGame||g.ILaya.Browser.onTTMiniGame||g.ILaya.Browser.onHWMiniGame||g.ILaya.Browser.onTBMiniGame)&&(t=!0),g.ILaya.Render.canvas.addEventListener(r.IOS_IFRAME?t?"touchend":"click":"touchend",r._popupInputMethod)}}},{key:"_popupInputMethod",value:function(t){r.isInputting&&r.inputElement.focus()}},{key:"_createInputElement",value:function(){r._initInput(r.area=g.ILaya.Browser.createElement("textarea")),r._initInput(r.input=g.ILaya.Browser.createElement("input")),r.inputContainer=g.ILaya.Browser.createElement("div"),r.inputContainer.style.position="absolute",r.inputContainer.style.zIndex="1E5",g.ILaya.Browser.container.appendChild(r.inputContainer),r.inputContainer.setPos=function(t,e){r.inputContainer.style.left=t+"px",r.inputContainer.style.top=e+"px"}}},{key:"_initInput",value:function(t){var e=t.style;e.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",e.resize="none",e.backgroundColor="transparent",e.border="none",e.outline="none",e.zIndex="1",t.addEventListener("input",r._processInputting),t.addEventListener("mousemove",r._stopEvent),t.addEventListener("mousedown",r._stopEvent),t.addEventListener("touchmove",r._stopEvent),t.setFontFace=function(e){t.style.fontFamily=e},g.ILaya.Render.isConchApp||(t.setColor=function(e){t.style.color=e},t.setFontSize=function(e){t.style.fontSize=e+"px"})}},{key:"_processInputting",value:function(t){var e=r.inputElement.target;if(e){var i=r.inputElement.value;e._restrictPattern&&(i=i.replace(/\u2006|\x27/g,""),e._restrictPattern.test(i)&&(i=i.replace(e._restrictPattern,""),r.inputElement.value=i)),e._text=i,e.event(y.Event.INPUT)}}},{key:"_stopEvent",value:function(t){"touchmove"==t.type&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()}}]),r}(v.Text);e.Input=x,(0,_.default)(x,"TYPE_TEXT","text"),(0,_.default)(x,"TYPE_PASSWORD","password"),(0,_.default)(x,"TYPE_EMAIL","email"),(0,_.default)(x,"TYPE_URL","url"),(0,_.default)(x,"TYPE_NUMBER","number"),(0,_.default)(x,"TYPE_RANGE","range"),(0,_.default)(x,"TYPE_DATE","date"),(0,_.default)(x,"TYPE_MONTH","month"),(0,_.default)(x,"TYPE_WEEK","week"),(0,_.default)(x,"TYPE_TIME","time"),(0,_.default)(x,"TYPE_DATE_TIME","datetime"),(0,_.default)(x,"TYPE_DATE_TIME_LOCAL","datetime-local"),(0,_.default)(x,"TYPE_SEARCH","search"),(0,_.default)(x,"IOS_IFRAME",!1),(0,_.default)(x,"inputHeight",45),(0,_.default)(x,"isInputting",!1),m.ClassUtils.regClass("laya.display.Input",x),m.ClassUtils.regClass("Laya.Input",x)},64099:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Node=void 0;var s=r(i(92762)),l=r(i(81643)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(46222),y=i(63969),p=i(65700),g=i(89761),m=i(14880),x=i(93561),T=i(89432);var k=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,o.default)(this,r),t=n.call(this),(0,_.default)((0,h.default)(t),"_bits",0),(0,_.default)((0,h.default)(t),"_children",r.ARRAY_EMPTY),(0,_.default)((0,h.default)(t),"_extUIChild",r.ARRAY_EMPTY),(0,_.default)((0,h.default)(t),"_parent",null),(0,_.default)((0,h.default)(t),"name",""),(0,_.default)((0,h.default)(t),"destroyed",!1),t.createGLBuffer(),t}return(0,u.default)(r,[{key:"createGLBuffer",value:function(){}},{key:"_setBit",value:function(t,e){t===v.Const.DISPLAY&&this._getBit(t)!=e&&this._updateDisplayedInstage(),e?this._bits|=t:this._bits&=~t}},{key:"_getBit",value:function(t){return 0!=(this._bits&t)}},{key:"_setUpNoticeChain",value:function(){this._getBit(v.Const.DISPLAY)&&this._setBitUp(v.Const.DISPLAY)}},{key:"_setBitUp",value:function(t){var e=this;for(e._setBit(t,!0),e=e._parent;e;){if(e._getBit(t))return;e._setBit(t,!0),e=e._parent}}},{key:"on",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t!==y.Event.DISPLAY&&t!==y.Event.UNDISPLAY||this._getBit(v.Const.DISPLAY)||this._setBitUp(v.Const.DISPLAY),this._createListener(t,e,i,a,!1)}},{key:"once",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t!==y.Event.DISPLAY&&t!==y.Event.UNDISPLAY||this._getBit(v.Const.DISPLAY)||this._setBitUp(v.Const.DISPLAY),this._createListener(t,e,i,a,!0)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.destroyed=!0,this._destroyAllComponent(),this._parent&&this._parent.removeChild(this),this._children&&(t?this.destroyChildren():this.removeChildren()),this.onDestroy(),this._children=null,this.offAll()}},{key:"onDestroy",value:function(){}},{key:"destroyChildren",value:function(){if(this._children)for(var t=0,e=this._children.length;t<e;t++)this._children[0].destroy(!0)}},{key:"addChild",value:function(t){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(v.Const.HAS_ZORDER,!0),t._parent===this){var e,i=this.getChildIndex(t);i!==this._children.length-1&&((0,s.default)(e=this._children).call(e,i,1),this._children.push(t),this._childChanged())}else t._parent&&t._parent.removeChild(t),this._children===r.ARRAY_EMPTY&&(this._children=[]),this._children.push(t),t._setParent(this),this._childChanged();return t}},{key:"addInputChild",value:function(t){if(this._extUIChild==r.ARRAY_EMPTY)this._extUIChild=[t];else{var e;if((0,l.default)(e=this._extUIChild).call(e,t)>=0)return null;this._extUIChild.push(t)}return null}},{key:"removeInputChild",value:function(t){var e,i,a=(0,l.default)(e=this._extUIChild).call(e,t);a>=0&&(0,s.default)(i=this._extUIChild).call(i,a,1)}},{key:"addChildren",value:function(){for(var t=0,e=arguments.length;t<e;){var i;this.addChild((i=t++)<0||arguments.length<=i?void 0:arguments[i])}}},{key:"addChildAt",value:function(t,e){if(!t||this.destroyed||t===this)return t;if(t._zOrder&&this._setBit(v.Const.HAS_ZORDER,!0),e>=0&&e<=this._children.length){if(t._parent===this){var i,a,n=this.getChildIndex(t);(0,s.default)(i=this._children).call(i,n,1),(0,s.default)(a=this._children).call(a,e,0,t),this._childChanged()}else{var l;t._parent&&t._parent.removeChild(t),this._children===r.ARRAY_EMPTY&&(this._children=[]),(0,s.default)(l=this._children).call(l,e,0,t),t._setParent(this)}return t}throw new Error("appendChildAt:The index is out of bounds")}},{key:"getChildIndex",value:function(t){var e;return(0,l.default)(e=this._children).call(e,t)}},{key:"getChildByName",value:function(t){var e=this._children;if(e)for(var i=0,a=e.length;i<a;i++){var n=e[i];if(n.name===t)return n}return null}},{key:"getChildAt",value:function(t){return this._children[t]||null}},{key:"setChildIndex",value:function(t,e){var i=this._children;if(e<0||e>=i.length)throw new Error("setChildIndex:The index is out of bounds.");var a=this.getChildIndex(t);if(a<0)throw new Error("setChildIndex:node is must child of this object.");return(0,s.default)(i).call(i,a,1),(0,s.default)(i).call(i,e,0,t),this._childChanged(),t}},{key:"_childChanged",value:function(){}},{key:"removeChild",value:function(t){var e;if(!this._children)return t;var i=(0,l.default)(e=this._children).call(e,t);return this.removeChildAt(i)}},{key:"removeSelf",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"removeChildByName",value:function(t){var e=this.getChildByName(t);return e&&this.removeChild(e),e}},{key:"removeChildAt",value:function(t){var e,i=this.getChildAt(t);return i&&((0,s.default)(e=this._children).call(e,t,1),i._setParent(null)),i}},{key:"removeChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2147483647;if(this._children&&this._children.length>0){var i=this._children;if(0===t&&e>=i.length-1){var a=i;this._children=r.ARRAY_EMPTY}else a=(0,s.default)(i).call(i,t,e-t+1);for(var n=0,l=a.length;n<l;n++)a[n]._setParent(null)}return this}},{key:"replaceChild",value:function(t,e){var i,a,n=(0,l.default)(i=this._children).call(i,e);return n>-1?((0,s.default)(a=this._children).call(a,n,1,t),e._setParent(null),t._setParent(this),t):null}},{key:"numChildren",get:function(){return this._children.length}},{key:"parent",get:function(){return this._parent}},{key:"_setParent",value:function(t){this._parent!==t&&(t?(this._parent=t,this._onAdded(),this.event(y.Event.ADDED),this._getBit(v.Const.DISPLAY)&&(this._setUpNoticeChain(),t.displayedInStage&&this._displayChild(this,!0)),t._childChanged(this)):(this._onRemoved(),this.event(y.Event.REMOVED),this._parent._childChanged(),this._getBit(v.Const.DISPLAY)&&this._displayChild(this,!1),this._parent=t))}},{key:"displayedInStage",get:function(){return this._getBit(v.Const.DISPLAY)||this._setBitUp(v.Const.DISPLAY),this._getBit(v.Const.DISPLAYED_INSTAGE)}},{key:"_updateDisplayedInstage",value:function(){var t;t=this;for(var e=x.ILaya.stage,i=!1;t;){if(t._getBit(v.Const.DISPLAY)){i=t._getBit(v.Const.DISPLAYED_INSTAGE);break}if(t===e||t._getBit(v.Const.DISPLAYED_INSTAGE)){i=!0;break}t=t._parent}this._setBit(v.Const.DISPLAYED_INSTAGE,i)}},{key:"_setDisplay",value:function(t){this._getBit(v.Const.DISPLAYED_INSTAGE)!==t&&(this._setBit(v.Const.DISPLAYED_INSTAGE,t),t?this.event(y.Event.DISPLAY):this.event(y.Event.UNDISPLAY))}},{key:"_displayChild",value:function(t,e){var i=t._children;if(i)for(var a=0,n=i.length;a<n;a++){var r=i[a];r._getBit(v.Const.DISPLAY)&&(r._children.length>0?this._displayChild(r,e):r._setDisplay(e))}t._setDisplay(e)}},{key:"contains",value:function(t){if(t===this)return!0;for(;t;){if(t._parent===this)return!0;t=t._parent}return!1}},{key:"timerLoop",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=this.scene?this.scene.timer:x.ILaya.timer;s.loop(t,e,i,a,n,r)}},{key:"timerOnce",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.scene?this.scene.timer:x.ILaya.timer;r._create(!1,!1,t,e,i,a,n)}},{key:"frameLoop",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.scene?this.scene.timer:x.ILaya.timer;r._create(!0,!0,t,e,i,a,n)}},{key:"frameOnce",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=this.scene?this.scene.timer:x.ILaya.timer;r._create(!0,!1,t,e,i,a,n)}},{key:"clearTimer",value:function(t,e){(this.scene?this.scene.timer:x.ILaya.timer).clear(t,e)}},{key:"callLater",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.scene?this.scene.timer:x.ILaya.timer;i.callLater(this,t,e)}},{key:"runCallLater",value:function(t){(this.scene?this.scene.timer:x.ILaya.timer).runCallLater(this,t)}},{key:"scene",get:function(){return this._scene}},{key:"active",get:function(){return!this._getBit(v.Const.NOT_READY)&&!this._getBit(v.Const.NOT_ACTIVE)},set:function(t){if(t=!!t,!this._getBit(v.Const.NOT_ACTIVE)!==t){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw t?"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.":"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._setBit(v.Const.NOT_ACTIVE,!t),this._parent&&this._parent.activeInHierarchy&&(t?this._processActive():this._processInActive())}}},{key:"activeInHierarchy",get:function(){return this._getBit(v.Const.ACTIVE_INHIERARCHY)}},{key:"_onActive",value:function(){m.Stat.spriteCount++}},{key:"_onInActive",value:function(){m.Stat.spriteCount--}},{key:"_onActiveInScene",value:function(){}},{key:"_onInActiveInScene",value:function(){}},{key:"_parse",value:function(t,e){}},{key:"_setBelongScene",value:function(t){if(!this._scene){this._scene=t,this._onActiveInScene();for(var e=0,i=this._children.length;e<i;e++)this._children[e]._setBelongScene(t)}}},{key:"_setUnBelongScene",value:function(){if(this._scene!==this){this._onInActiveInScene(),this._scene=null;for(var t=0,e=this._children.length;t<e;t++)this._children[t]._setUnBelongScene()}}},{key:"onAwake",value:function(){}},{key:"onEnable",value:function(){}},{key:"_processActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._activeHierarchy(this._activeChangeScripts),this._activeScripts()}},{key:"_activeHierarchy",value:function(t){if(this._setBit(v.Const.ACTIVE_INHIERARCHY,!0),this._components)for(var e=0,i=this._components.length;e<i;e++){var a=this._components[e];a._isScript()?a._enabled&&t.push(a):a._setActive(!0)}for(this._onActive(),e=0,i=this._children.length;e<i;e++){var n=this._children[e];!n._getBit(v.Const.NOT_ACTIVE)&&!n._getBit(v.Const.NOT_READY)&&n._activeHierarchy(t)}this._getBit(v.Const.AWAKED)||(this._setBit(v.Const.AWAKED,!0),this.onAwake()),this.onEnable()}},{key:"_activeScripts",value:function(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++){var i=this._activeChangeScripts[t];i._awaked||(i._awaked=!0,i._onAwake()),i._onEnable()}this._activeChangeScripts.length=0}},{key:"_processInActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._inActiveHierarchy(this._activeChangeScripts),this._inActiveScripts()}},{key:"_inActiveHierarchy",value:function(t){if(this._onInActive(),this._components)for(var e=0,i=this._components.length;e<i;e++){var a=this._components[e];!a._isScript()&&a._setActive(!1),a._isScript()&&a._enabled&&t.push(a)}for(this._setBit(v.Const.ACTIVE_INHIERARCHY,!1),e=0,i=this._children.length;e<i;e++){var n=this._children[e];n&&!n._getBit(v.Const.NOT_ACTIVE)&&n._inActiveHierarchy(t)}this.onDisable()}},{key:"_inActiveScripts",value:function(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].owner&&this._activeChangeScripts[t]._onDisable();this._activeChangeScripts.length=0}},{key:"onDisable",value:function(){}},{key:"_onAdded",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";var t=this._parent.scene;t&&this._setBelongScene(t),this._parent.activeInHierarchy&&this.active&&this._processActive()}},{key:"_onRemoved",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._parent.activeInHierarchy&&this.active&&this._processInActive(),this._parent.scene&&this._setUnBelongScene()}},{key:"_addComponentInstance",value:function(t){this._components=this._components||[],this._components.push(t),t.owner=this,t._onAdded(),this.activeInHierarchy&&t._setActive(!0)}},{key:"_destroyComponent",value:function(t){if(this._components)for(var e=0,i=this._components.length;e<i;e++){var a=this._components[e];if(a===t){var n;a._destroy(),(0,s.default)(n=this._components).call(n,e,1);break}}}},{key:"_destroyAllComponent",value:function(){if(this._components){for(var t=0,e=this._components.length;t<e;t++){var i=this._components[t];i&&i._destroy()}this._components.length=0}}},{key:"_cloneTo",value:function(t,e,i){var a=t;if(this._components)for(var n=0,r=this._components.length;n<r;n++){var s=a.addComponent(this._components[n].constructor);this._components[n]._cloneTo(s)}}},{key:"addComponentIntance",value:function(t){if(t.owner)throw"Node:the component has belong to other node.";if(t.isSingleton&&this.getComponent(t.constructor))throw"Node:the component is singleton,can't add the second one.";return this._addComponentInstance(t),t}},{key:"addComponent",value:function(t){var e=g.Pool.createByClass(t);if(!e)throw t.toString()+"组件不存在";if(e._destroyed=!1,e.isSingleton&&this.getComponent(t))throw"无法实例"+t+"组件，"+t+"组件已存在！";return this._addComponentInstance(e),e}},{key:"getComponent",value:function(t){if(this._components)for(var e=0,i=this._components.length;e<i;e++){var a=this._components[e];if(a instanceof t)return a}return null}},{key:"getComponents",value:function(t){var e;if(this._components)for(var i=0,a=this._components.length;i<a;i++){var n=this._components[i];n instanceof t&&(e=e||[]).push(n)}return e}},{key:"timer",get:function(){return this.scene?this.scene.timer:x.ILaya.timer}}]),r}(p.EventDispatcher);e.Node=k,(0,_.default)(k,"ARRAY_EMPTY",[]),T.ClassUtils.regClass("laya.display.Node",k),T.ClassUtils.regClass("Laya.Node",k)},53417:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Scene=void 0;var s=r(i(81643)),l=r(i(92762)),o=r(i(77766)),u=r(i(87368)),h=r(i(28146)),c=r(i(43714)),d=r(i(92135)),f=r(i(13383)),_=r(i(78310)),v=r(i(82669)),y=r(i(17454)),p=i(64099),g=i(46222),m=i(87210),x=i(63969),T=i(38263),k=i(8865),C=i(35696),S=i(45651),E=i(93561),M=i(89432),L=i(70084);var b=function(t){(0,f.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,_.default)(this,t)});function r(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,u.default)(this,r),t=n.call(this),(0,y.default)((0,c.default)(t),"autoDestroyAtClosed",!1),(0,y.default)((0,c.default)(t),"url",null),(0,y.default)((0,c.default)(t),"_viewCreated",!1),(0,y.default)((0,c.default)(t),"_idMap",null),(0,y.default)((0,c.default)(t),"_$componentType","Scene"),r.unDestroyedScenes.push((0,c.default)(t)),t._scene=(0,c.default)(t),e&&t.createChildren(),t}return(0,h.default)(r,[{key:"createChildren",value:function(){}},{key:"loadScene",value:function(t){var e=(0,s.default)(t).call(t,".")>-1?t:t+".scene",i=E.ILaya.loader.getRes(e);if(i)this.createView(i);else{this._setBit(g.Const.NOT_READY,!0),E.ILaya.loader.resetProgress();var a=new T.SceneLoader;a.on(x.Event.COMPLETE,this,this._onSceneLoaded,[e]),a.load(e)}}},{key:"_onSceneLoaded",value:function(t){this.createView(E.ILaya.Loader.getRes(t))}},{key:"createView",value:function(t){t&&!this._viewCreated&&(this._viewCreated=!0,S.SceneUtils.createByData(this,t))}},{key:"getNodeByID",value:function(t){return this._idMap?this._idMap[t]:null}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&r.closeAll(),r.root.addChild(this),this.onOpened(e)}},{key:"onOpened",value:function(t){}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.onClosed(t),this.autoDestroyAtClosed?this.destroy():this.removeSelf()}},{key:"onClosed",value:function(){}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._idMap=null,(0,d.default)((0,v.default)(r.prototype),"destroy",this).call(this,t);for(var e=r.unDestroyedScenes,i=e.length-1;i>-1;i--)if(e[i]===this)return void(0,l.default)(e).call(e,i,1)}},{key:"scaleX",get:function(){return(0,d.default)((0,v.default)(r.prototype),"scaleX",this)},set:function(t){(0,d.default)((0,v.default)(r.prototype),"get_scaleX",this).call(this)!=t&&((0,d.default)((0,v.default)(r.prototype),"set_scaleX",this).call(this,t),this.event(x.Event.RESIZE))}},{key:"scaleY",get:function(){return(0,d.default)((0,v.default)(r.prototype),"scaleY",this)},set:function(t){(0,d.default)((0,v.default)(r.prototype),"get_scaleY",this).call(this)!=t&&((0,d.default)((0,v.default)(r.prototype),"set_scaleY",this).call(this,t),this.event(x.Event.RESIZE))}},{key:"width",get:function(){if(this._width)return this._width;for(var t=0,e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t},set:function(t){(0,d.default)((0,v.default)(r.prototype),"get_width",this).call(this)!=t&&((0,d.default)((0,v.default)(r.prototype),"set_width",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"height",get:function(){if(this._height)return this._height;for(var t=0,e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t},set:function(t){(0,d.default)((0,v.default)(r.prototype),"get_height",this).call(this)!=t&&((0,d.default)((0,v.default)(r.prototype),"set_height",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){this.event(x.Event.RESIZE)}},{key:"timer",get:function(){return this._timer||E.ILaya.timer},set:function(t){this._timer=t}}],[{key:"setUIMap",value:function(t){var e=E.ILaya.loader.getRes(t);if(!e)throw"请提前加载uimap的json，再使用该接口设置！";for(var i in e)E.ILaya.Loader.loadedMap[L.URL.formatURL(i+".scene")]=e[i]}},{key:"root",get:function(){return r._root||(r._root=E.ILaya.stage.addChild(new m.Sprite),r._root.name="root",E.ILaya.stage.on("resize",null,(function(){r._root.size(E.ILaya.stage.width,E.ILaya.stage.height),r._root.event(x.Event.RESIZE)})),r._root.size(E.ILaya.stage.width,E.ILaya.stage.height),r._root.event(x.Event.RESIZE)),r._root}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;E.ILaya.loader.resetProgress();var a=new T.SceneLoader;function n(t){r._loadPage&&r._loadPage.event("progress",t),i&&i.runWith(t)}function s(){a.off(x.Event.PROGRESS,null,n);var i=E.ILaya.Loader.getRes(t);if(!i)throw"Can not find scene:"+t;if(!i.props)throw"Scene data is error:"+t;var s=i.props.runtime?i.props.runtime:i.type,l=E.ILaya.ClassUtils.getClass(s);if("instance"==i.props.renderType)var o=l.instance||(l.instance=new l);else o=new l;if(!(o&&o instanceof p.Node))throw"Can not find scene:"+s;o.url=t,o._viewCreated?e&&e.runWith(o):(o.on("onViewCreated",null,(function(){e&&e.runWith(o)})),o.createView(i)),r.hideLoadingPage()}a.on(x.Event.PROGRESS,null,n),a.once(x.Event.COMPLETE,null,s),a.load(t)}},{key:"open",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(i instanceof C.Handler){var s=a;a=i,i=s}r.showLoadingPage(),r.load(t,C.Handler.create(null,this._onSceneLoaded,[e,a,i]),n)}},{key:"_onSceneLoaded",value:function(t,e,i,a){a.open(t,i),e&&e.runWith(a)}},{key:"close",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!1,a=r.unDestroyedScenes,n=0,s=a.length;n<s;n++){var l=a[n];l&&l.parent&&l.url===t&&l.name==e&&(l.close(),i=!0)}return i}},{key:"closeAll",value:function(){for(var t=r.root,e=0,i=t.numChildren;e<i;e++){var a=t.getChildAt(0);a instanceof r?a.close():a.removeSelf()}}},{key:"destroy",value:function(t){for(var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=!1,n=(0,o.default)(e=[]).call(e,r.unDestroyedScenes),s=0,l=n.length;s<l;s++){var u=n[s];u.url!==t||u.name!=i||u.destroyed||(u.destroy(),a=!0)}return a}},{key:"gc",value:function(){k.Resource.destroyUnusedResources()}},{key:"setLoadingPage",value:function(t){r._loadPage!=t&&(r._loadPage=t)}},{key:"showLoadingPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;r._loadPage&&(E.ILaya.systemTimer.clear(null,r._showLoading),E.ILaya.systemTimer.clear(null,r._hideLoading),E.ILaya.systemTimer.once(e,null,r._showLoading,[t],!1))}},{key:"_showLoading",value:function(t){E.ILaya.stage.addChild(r._loadPage),r._loadPage.onOpened(t)}},{key:"_hideLoading",value:function(){r._loadPage.close()}},{key:"hideLoadingPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;r._loadPage&&(E.ILaya.systemTimer.clear(null,r._showLoading),E.ILaya.systemTimer.clear(null,r._hideLoading),E.ILaya.systemTimer.once(t,null,r._hideLoading))}}]),r}(m.Sprite);e.Scene=b,(0,y.default)(b,"unDestroyedScenes",[]),E.ILaya.regClass(b),M.ClassUtils.regClass("laya.display.Scene",b),M.ClassUtils.regClass("Laya.Scene",b)},87210:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Sprite=void 0;var s=r(i(3649)),l=r(i(31238)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(13383)),d=r(i(78310)),f=r(i(92135)),_=r(i(82669)),v=r(i(17454)),y=i(93561),p=i(46222),g=i(63969),m=i(66356),x=i(34981),T=i(92356),k=i(5866),C=i(91020),S=i(63701),E=i(99036),M=i(23395),L=i(54013),b=i(29148),I=i(89432),R=i(11179),w=i(38648),A=i(46812),B=i(97297),D=i(22010),P=i(64099),F=i(46791),O=i(70084);var U=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,o.default)(this,r),t=n.call(this),(0,v.default)((0,h.default)(t),"_x",0),(0,v.default)((0,h.default)(t),"_y",0),(0,v.default)((0,h.default)(t),"_width",0),(0,v.default)((0,h.default)(t),"_height",0),(0,v.default)((0,h.default)(t),"_visible",!0),(0,v.default)((0,h.default)(t),"_mouseState",0),(0,v.default)((0,h.default)(t),"_zOrder",0),(0,v.default)((0,h.default)(t),"_renderType",0),(0,v.default)((0,h.default)(t),"_transform",null),(0,v.default)((0,h.default)(t),"_tfChanged",!1),(0,v.default)((0,h.default)(t),"_repaint",F.SpriteConst.REPAINT_NONE),(0,v.default)((0,h.default)(t),"_texture",null),(0,v.default)((0,h.default)(t),"_style",B.SpriteStyle.EMPTY),(0,v.default)((0,h.default)(t),"_cacheStyle",A.CacheStyle.EMPTY),(0,v.default)((0,h.default)(t),"_boundStyle",null),(0,v.default)((0,h.default)(t),"_graphics",null),(0,v.default)((0,h.default)(t),"mouseThrough",!1),(0,v.default)((0,h.default)(t),"autoSize",!1),(0,v.default)((0,h.default)(t),"hitTestPrior",!1),t}return(0,u.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,f.default)((0,_.default)(r.prototype),"destroy",this).call(this,t),this._style&&this._style.recover(),this._cacheStyle&&this._cacheStyle.recover(),this._boundStyle&&this._boundStyle.recover(),this._style=null,this._cacheStyle=null,this._boundStyle=null,this._transform=null,this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy(),this._graphics=null,this.texture=null}},{key:"updateZOrder",value:function(){R.Utils.updateOrder(this._children)&&this.repaint()}},{key:"_getBoundsStyle",value:function(){return this._boundStyle||(this._boundStyle=w.BoundsStyle.create()),this._boundStyle}},{key:"_setCustomRender",value:function(){}},{key:"customRenderEnable",set:function(t){t&&(this._renderType|=F.SpriteConst.CUSTOM,this._setRenderType(this._renderType),this._setCustomRender())}},{key:"cacheAs",get:function(){return this._cacheStyle.cacheAs},set:function(t){t!==this._cacheStyle.userSetCache&&(this.mask&&"normal"===t||(this._setCacheAs(t),this._getCacheStyle().userSetCache=t,this._checkCanvasEnable(),this.repaint()))}},{key:"_setCacheAs",value:function(t){}},{key:"_checkCanvasEnable",value:function(){var t=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=t,t?(this._cacheStyle.needBitmapCache()?this._cacheStyle.cacheAs="bitmap":this._cacheStyle.cacheAs=this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=F.SpriteConst.CANVAS):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=~F.SpriteConst.CANVAS),this._setCacheAs(this._cacheStyle.cacheAs),this._setRenderType(this._renderType)}},{key:"staticCache",get:function(){return this._cacheStyle.staticCache},set:function(t){this._getCacheStyle().staticCache=t,t||this.reCache()}},{key:"reCache",value:function(){this._cacheStyle.reCache=!0,this._repaint|=F.SpriteConst.REPAINT_CACHE}},{key:"getRepaint",value:function(){return this._repaint}},{key:"_setX",value:function(t){this._x=t}},{key:"_setY",value:function(t){this._y=t}},{key:"_setWidth",value:function(t,e){}},{key:"_setHeight",value:function(t,e){}},{key:"x",get:function(){return this._x},set:function(t){if(!this.destroyed&&this._x!==t){this._setX(t),this.parentRepaint(F.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(F.SpriteConst.REPAINT_CACHE)}}},{key:"y",get:function(){return this._y},set:function(t){if(!this.destroyed&&this._y!==t){this._setY(t),this.parentRepaint(F.SpriteConst.REPAINT_CACHE);var e=this._cacheStyle.maskParent;e&&e.repaint(F.SpriteConst.REPAINT_CACHE)}}},{key:"width",get:function(){return this.get_width()},set:function(t){this.set_width(t)}},{key:"set_width",value:function(t){this._width!==t&&(this._width=t,this._setWidth(this.texture,t),this._setTranformChange())}},{key:"get_width",value:function(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)}},{key:"height",get:function(){return this.get_height()},set:function(t){this.set_height(t)}},{key:"set_height",value:function(t){this._height!==t&&(this._height=t,this._setHeight(this.texture,t),this._setTranformChange())}},{key:"get_height",value:function(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)}},{key:"displayWidth",get:function(){return this.width*this.scaleX}},{key:"displayHeight",get:function(){return this.height*this.scaleY}},{key:"setSelfBounds",value:function(t){this._getBoundsStyle().userBounds=t}},{key:"getBounds",value:function(){return this._getBoundsStyle().bounds=S.Rectangle._getWrapRec(this._boundPointsToParent())}},{key:"getSelfBounds",value:function(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=S.Rectangle._getWrapRec(this._getBoundPointsM(!1)):S.Rectangle.TEMP.setTo(0,0,this.width,this.height)}},{key:"_boundPointsToParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0,i=0;this._style&&(e=this.pivotX,i=this.pivotY,t=t||0!==this._style.rotation,this._style.scrollRect&&(e+=this._style.scrollRect.x,i+=this._style.scrollRect.y));var a=this._getBoundPointsM(t);if(!a||a.length<1)return a;if(8!=a.length&&(a=t?T.GrahamScan.scanPList(a):S.Rectangle._getWrapRec(a,S.Rectangle.TEMP)._getBoundPoints()),!this.transform)return R.Utils.transPointList(a,this._x-e,this._y-i),a;var n,r=C.Point.TEMP,s=a.length;for(n=0;n<s;n+=2)r.x=a[n],r.y=a[n+1],this.toParentPoint(r),a[n]=r.x,a[n+1]=r.y;return a}},{key:"getGraphicBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._graphics?this._graphics.getBounds(t):S.Rectangle.TEMP.setTo(0,0,0,0)}},{key:"_getBoundPointsM",value:function(){var t,e,i,a,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(this._boundStyle||this._getBoundsStyle(),this._boundStyle.temBM||(this._boundStyle.temBM=[]),this._style.scrollRect){var s=R.Utils.clearArray(this._boundStyle.temBM),l=S.Rectangle.TEMP;return l.copyFrom(this._style.scrollRect),R.Utils.concatArray(s,l._getBoundPoints()),s}t=this._graphics?this._graphics.getBoundPoints():R.Utils.clearArray(this._boundStyle.temBM),this._texture&&((l=S.Rectangle.TEMP).setTo(0,0,this.width||this._texture.width,this.height||this._texture.height),R.Utils.concatArray(t,l._getBoundPoints()));for(var o=0,u=(a=this._children).length;o<u;o++)(e=a[o])instanceof r&&!0===e._visible&&(i=e._boundPointsToParent(n))&&(t=t?R.Utils.concatArray(t,i):i);return t}},{key:"_getCacheStyle",value:function(){return this._cacheStyle===A.CacheStyle.EMPTY&&(this._cacheStyle=A.CacheStyle.create()),this._cacheStyle}},{key:"getStyle",value:function(){return this._style===B.SpriteStyle.EMPTY&&(this._style=B.SpriteStyle.create()),this._style}},{key:"setStyle",value:function(t){this._style=t}},{key:"scaleX",get:function(){return this._style.scaleX},set:function(t){this.set_scaleX(t)}},{key:"_setScaleX",value:function(t){this._style.scaleX=t}},{key:"scaleY",get:function(){return this._style.scaleY},set:function(t){this.set_scaleY(t)}},{key:"_setScaleY",value:function(t){this._style.scaleY=t}},{key:"set_scaleX",value:function(t){this.getStyle().scaleX!==t&&(this._setScaleX(t),this._setTranformChange())}},{key:"get_scaleX",value:function(){return this._style.scaleX}},{key:"set_scaleY",value:function(t){this.getStyle().scaleY!==t&&(this._setScaleY(t),this._setTranformChange())}},{key:"get_scaleY",value:function(){return this._style.scaleY}},{key:"rotation",get:function(){return this._style.rotation},set:function(t){this.getStyle().rotation!==t&&(this._setRotation(t),this._setTranformChange())}},{key:"_setRotation",value:function(t){this._style.rotation=t}},{key:"skewX",get:function(){return this._style.skewX},set:function(t){this.getStyle().skewX!==t&&(this._setSkewX(t),this._setTranformChange())}},{key:"_setSkewX",value:function(t){this._style.skewX=t}},{key:"skewY",get:function(){return this._style.skewY},set:function(t){this.getStyle().skewY!==t&&(this._setSkewY(t),this._setTranformChange())}},{key:"_setSkewY",value:function(t){this._style.skewY=t}},{key:"_createTransform",value:function(){return k.Matrix.create()}},{key:"_adjustTransform",value:function(){this._tfChanged=!1;var t=this._style,e=t.scaleX,i=t.scaleY,a=t.skewX,n=t.skewY,r=t.rotation,s=this._transform||(this._transform=this._createTransform());if(r||1!==e||1!==i||0!==a||0!==n){s._bTransform=!0;var l=.0174532922222222*(r-a),o=.0174532922222222*(r+n),u=Math.cos(o),h=Math.sin(o),c=Math.sin(l),d=Math.cos(l);s.a=e*u,s.b=e*h,s.c=-i*c,s.d=i*d,s.tx=s.ty=0}else s.identity(),this._renderType&=~F.SpriteConst.TRANSFORM,this._setRenderType(this._renderType);return s}},{key:"_setTransform",value:function(t){}},{key:"transform",get:function(){return this._tfChanged?this._adjustTransform():this._transform},set:function(t){this.set_transform(t)}},{key:"get_transform",value:function(){return this._tfChanged?this._adjustTransform():this._transform}},{key:"set_transform",value:function(t){this._tfChanged=!1;var e=this._transform||(this._transform=this._createTransform());t.copyTo(e),this._setTransform(e),t&&(this._x=e.tx,this._y=e.ty,e.tx=e.ty=0),t?this._renderType|=F.SpriteConst.TRANSFORM:this._renderType&=~F.SpriteConst.TRANSFORM,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"_setPivotX",value:function(t){this.getStyle().pivotX=t}},{key:"_getPivotX",value:function(){return this._style.pivotX}},{key:"_setPivotY",value:function(t){this.getStyle().pivotY=t}},{key:"_getPivotY",value:function(){return this._style.pivotY}},{key:"pivotX",get:function(){return this._getPivotX()},set:function(t){this._setPivotX(t),this.repaint()}},{key:"pivotY",get:function(){return this._getPivotY()},set:function(t){this._setPivotY(t),this.repaint()}},{key:"_setAlpha",value:function(t){this._style.alpha!==t&&(this.getStyle().alpha=t,1!==t?this._renderType|=F.SpriteConst.ALPHA:this._renderType&=~F.SpriteConst.ALPHA,this._setRenderType(this._renderType),this.parentRepaint())}},{key:"_getAlpha",value:function(){return this._style.alpha}},{key:"alpha",get:function(){return this._getAlpha()},set:function(t){t=t<0?0:t>1?1:t,this._setAlpha(t)}},{key:"visible",get:function(){return this.get_visible()},set:function(t){this.set_visible(t)}},{key:"get_visible",value:function(){return this._visible}},{key:"set_visible",value:function(t){this._visible!==t&&(this._visible=t,this.parentRepaint(F.SpriteConst.REPAINT_ALL))}},{key:"_setBlendMode",value:function(t){}},{key:"blendMode",get:function(){return this._style.blendMode},set:function(t){this._setBlendMode(t),this.getStyle().blendMode=t,t&&"source-over"!=t?this._renderType|=F.SpriteConst.BLEND:this._renderType&=~F.SpriteConst.BLEND,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"graphics",get:function(){return this._graphics||(this.graphics=new D.Graphics,this._graphics.autoDestroy=!0),this._graphics},set:function(t){this._graphics&&(this._graphics._sp=null),this._graphics=t,t?(this._setGraphics(t),this._renderType|=F.SpriteConst.GRAPHICS,t._sp=this):this._renderType&=~F.SpriteConst.GRAPHICS,this._setRenderType(this._renderType),this.repaint()}},{key:"_setGraphics",value:function(t){}},{key:"_setGraphicsCallBack",value:function(){}},{key:"scrollRect",get:function(){return this._style.scrollRect},set:function(t){this.getStyle().scrollRect=t,this._setScrollRect(t),this.repaint(),t?this._renderType|=F.SpriteConst.CLIP:this._renderType&=~F.SpriteConst.CLIP,this._setRenderType(this._renderType)}},{key:"_setScrollRect",value:function(t){}},{key:"pos",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._x!==t||this._y!==e){if(this.destroyed)return this;if(i){this._setX(t),this._setY(e),this.parentRepaint(F.SpriteConst.REPAINT_CACHE);var a=this._cacheStyle.maskParent;a&&a.repaint(F.SpriteConst.REPAINT_CACHE)}else this.x=t,this.y=e}return this}},{key:"pivot",value:function(t,e){return this.pivotX=t,this.pivotY=e,this}},{key:"size",value:function(t,e){return this.width=t,this.height=e,this}},{key:"scale",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.getStyle();if(a.scaleX!=t||a.scaleY!=e){if(this.destroyed)return this;i?(this._setScaleX(t),this._setScaleY(e),this._setTranformChange()):(this.scaleX=t,this.scaleY=e)}return this}},{key:"skew",value:function(t,e){return this.skewX=t,this.skewY=e,this}},{key:"render",value:function(t,e,i){E.RenderSprite.renders[this._renderType]._fun(this,t,e+this._x,i+this._y),this._repaint=0}},{key:"drawToCanvas",value:function(t,e,i,a){return r.drawToCanvas(this,this._renderType,t,e,i,a)}},{key:"drawToTexture",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return r.drawToTexture(this,this._renderType,t,e,i,a,n)}},{key:"drawToTexture3D",value:function(t,e,i){throw"not implement"}},{key:"customRender",value:function(t,e,i){this._repaint=F.SpriteConst.REPAINT_ALL}},{key:"_applyFilters",value:function(){}},{key:"filters",get:function(){return this._cacheStyle.filters},set:function(t){t&&0===t.length&&(t=null),this._cacheStyle.filters!=t&&(this._getCacheStyle().filters=t?(0,s.default)(t).call(t):null,t&&t.length?(this._setColorFilter(t[0]),this._renderType|=F.SpriteConst.FILTERS):(this._setColorFilter(null),this._renderType&=~F.SpriteConst.FILTERS),this._setRenderType(this._renderType),t&&t.length>0?(this._getBit(p.Const.DISPLAY)||this._setBitUp(p.Const.DISPLAY),1==t.length&&t[0]instanceof m.ColorFilter||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())}},{key:"_setColorFilter",value:function(t){}},{key:"_isHaveGlowFilter",value:function(){var t,e;if(this.filters)for(t=0;t<this.filters.length;t++)if(this.filters[t].type==x.Filter.GLOW)return!0;for(t=0,e=this._children.length;t<e;t++)if(this._children[t]._isHaveGlowFilter())return!0;return!1}},{key:"localToGlobal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!0===e&&(t=new C.Point(t.x,t.y));var a=this;for(i=i||y.ILaya.stage;a&&!a.destroyed&&a!=i;)t=a.toParentPoint(t),a=a.parent;return t}},{key:"globalToLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e&&(t=new C.Point(t.x,t.y));var a=this,n=[];for(i=i||y.ILaya.stage;a&&!a.destroyed&&a!=i;)n.push(a),a=a.parent;for(var r=n.length-1;r>=0;)t=(a=n[r]).fromParentPoint(t),r--;return t}},{key:"toParentPoint",value:function(t){if(!t)return t;t.x-=this.pivotX,t.y-=this.pivotY,this.transform&&this._transform.transformPoint(t),t.x+=this._x,t.y+=this._y;var e=this._style.scrollRect;return e&&(t.x-=e.x,t.y-=e.y),t}},{key:"fromParentPoint",value:function(t){if(!t)return t;t.x-=this._x,t.y-=this._y;var e=this._style.scrollRect;return e&&(t.x+=e.x,t.y+=e.y),this.transform&&this._transform.invertTransformPoint(t),t.x+=this.pivotX,t.y+=this.pivotY,t}},{key:"fromStagePoint",value:function(t){return t}},{key:"on",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(p.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,i,a,!1)):(0,f.default)((0,_.default)(r.prototype),"on",this).call(this,t,e,i,a)}},{key:"once",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(t)?(this.mouseEnabled=!0,this._setBit(p.Const.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(t,e,i,a,!0)):(0,f.default)((0,_.default)(r.prototype),"once",this).call(this,t,e,i,a)}},{key:"_onDisplay",value:function(t){if(1!==this._mouseState){var e=this;for(e=e.parent;e&&1!==e._mouseState&&!e._getBit(p.Const.HAS_MOUSE);)e.mouseEnabled=!0,e._setBit(p.Const.HAS_MOUSE,!0),e=e.parent}}},{key:"_setParent",value:function(t){(0,f.default)((0,_.default)(r.prototype),"_setParent",this).call(this,t),t&&this._getBit(p.Const.HAS_MOUSE)&&this._onDisplay()}},{key:"loadImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){var i=y.ILaya.Loader.textureMap[O.URL.formatURL(t)];i||((i=new b.Texture).load(t),y.ILaya.Loader.cacheTexture(t,i)),this.texture=i,i.getIsReady()?a.call(this):i.once(g.Event.READY,this,a)}else this.texture=null,a.call(this);function a(){this.repaint(F.SpriteConst.REPAINT_ALL),e&&e.run()}return this}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.SpriteConst.REPAINT_CACHE;this._repaint&t||(this._repaint|=t,this.parentRepaint(t)),this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(t)}},{key:"_needRepaint",value:function(){return this._repaint&F.SpriteConst.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache}},{key:"_childChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._children.length?this._renderType|=F.SpriteConst.CHILDS:this._renderType&=~F.SpriteConst.CHILDS,this._setRenderType(this._renderType),t&&this._getBit(p.Const.HAS_ZORDER)&&y.ILaya.systemTimer.callLater(this,this.updateZOrder),this.repaint(F.SpriteConst.REPAINT_ALL)}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.SpriteConst.REPAINT_CACHE,e=this._parent;!e||e._repaint&t||(e._repaint|=t,e.parentRepaint(t))}},{key:"stage",get:function(){return y.ILaya.stage}},{key:"hitArea",get:function(){return this._style.hitArea},set:function(t){this.getStyle().hitArea=t}},{key:"_setMask",value:function(t){}},{key:"mask",get:function(){return this._cacheStyle.mask},set:function(t){t&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=t,this._setMask(t),this._checkCanvasEnable(),t?t._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=F.SpriteConst.MASK,this._setRenderType(this._renderType),this.parentRepaint(F.SpriteConst.REPAINT_ALL))}},{key:"mouseEnabled",get:function(){return this._mouseState>1},set:function(t){this._mouseState=t?2:1}},{key:"startDrag",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.92;this._style.dragging||(this.getStyle().dragging=new y.ILaya.Dragging),this._style.dragging.start(this,t,e,i,a,n,r,s)}},{key:"stopDrag",value:function(){this._style.dragging&&this._style.dragging.stop()}},{key:"_setDisplay",value:function(t){t||this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1)),(0,f.default)((0,_.default)(r.prototype),"_setDisplay",this).call(this,t)}},{key:"hitTestPoint",value:function(t,e){var i=this.globalToLocal(C.Point.TEMP.setTo(t,e));return t=i.x,e=i.y,(this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?S.Rectangle.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(t,e)}},{key:"getMousePoint",value:function(){return this.globalToLocal(C.Point.TEMP.setTo(y.ILaya.stage.mouseX,y.ILaya.stage.mouseY))}},{key:"globalScaleX",get:function(){for(var t=1,e=this;e&&e!==y.ILaya.stage;)t*=e.scaleX,e=e.parent;return t}},{key:"globalRotation",get:function(){for(var t=0,e=this;e&&e!==y.ILaya.stage;)t+=e.rotation,e=e.parent;return t}},{key:"globalScaleY",get:function(){for(var t=1,e=this;e&&e!==y.ILaya.stage;)t*=e.scaleY,e=e.parent;return t}},{key:"mouseX",get:function(){return this.getMousePoint().x}},{key:"mouseY",get:function(){return this.getMousePoint().y}},{key:"zOrder",get:function(){return this._zOrder},set:function(t){this._zOrder!=t&&(this._zOrder=t,this._parent&&(t&&this._parent._setBit(p.Const.HAS_ZORDER,!0),y.ILaya.systemTimer.callLater(this._parent,this.updateZOrder)))}},{key:"texture",get:function(){return this._texture},set:function(t){"string"==typeof t?this.loadImage(t):this._texture!=t&&(this._texture&&this._texture._removeReference(),this._texture=t,t&&t._addReference(),this._setTexture(t),this._setWidth(this._texture,this.width),this._setHeight(this._texture,this.height),t?this._renderType|=F.SpriteConst.TEXTURE:this._renderType&=~F.SpriteConst.TEXTURE,this._setRenderType(this._renderType),this.repaint())}},{key:"_setTexture",value:function(t){}},{key:"viewport",get:function(){return this._style.viewport},set:function(t){var e;"string"==typeof t&&(e=t.split(",")).length>3&&(t=new S.Rectangle((0,l.default)(e[0]),(0,l.default)(e[1]),(0,l.default)(e[2]),(0,l.default)(e[3]))),this.getStyle().viewport=t}},{key:"_setRenderType",value:function(t){}},{key:"_setTranformChange",value:function(){this._tfChanged=!0,this._renderType|=F.SpriteConst.TRANSFORM,this.parentRepaint(F.SpriteConst.REPAINT_CACHE)}},{key:"_setBgStyleColor",value:function(t,e,i,a,n){}},{key:"_setBorderStyleColor",value:function(t,e,i,a,n,r){}},{key:"captureMouseEvent",value:function(t){y.ILaya.MouseManager.instance.setCapture(this,t)}},{key:"releaseMouseEvent",value:function(){y.ILaya.MouseManager.instance.releaseCapture()}},{key:"drawCallOptimize",get:function(){return this._getBit(p.Const.DRAWCALL_OPTIMIZE)},set:function(t){this._setBit(p.Const.DRAWCALL_OPTIMIZE,t)}}],[{key:"drawToCanvas",value:function(t,e,i,a,n,r){n-=t.x,r-=t.y,n|=0,r|=0,i|=0,a|=0;var s=new M.Context;s.size(i,a),s.asBitmap=!0,s._targets.start(),s._targets.clear(0,0,0,0),E.RenderSprite.renders[e]._fun(t,s,n,r),s.flush(),s._targets.end(),s._targets.restore();var l=s._targets.getData(0,0,i,a);s.destroy();for(var o=new ImageData(i,a),u=4*i,h=(new Uint8Array(u),o.data),c=a-1,d=c*u,f=0;c>=0;c--)h.set(l.subarray(f,f+u),d),d-=u,f+=u;var _=new L.HTMLCanvas(!0);return _.size(i,a),_.getContext("2d").putImageData(o,0,0),_}},{key:"drawToTexture",value:function(t,e,i,a,n,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;r.drawtocanvCtx||(r.drawtocanvCtx=new M.Context),n-=t.x,s-=t.y,n|=0,s|=0,i|=0,a|=0;var o=l?r.drawtocanvCtx:new M.Context;if(o.clear(),o.size(i,a),l?o._targets=l:o.asBitmap=!0,o._targets&&(o._targets.start(),o._targets.clear(0,0,0,0),E.RenderSprite.renders[e]._fun(t,o,n,s),o.flush(),o._targets.end(),o._targets.restore()),!l){var u=new b.Texture(o._targets,b.Texture.INV_UV);return o.destroy(!0),u}return t._repaint=0,l}},{key:"fromImage",value:function(t){return(new r).loadImage(t)}}]),r}(P.Node);e.Sprite=U,I.ClassUtils.regClass("laya.display.Sprite",U),I.ClassUtils.regClass("Laya.Sprite",U)},46791:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SpriteConst=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.SpriteConst=o,(0,l.default)(o,"ALPHA",1),(0,l.default)(o,"TRANSFORM",2),(0,l.default)(o,"BLEND",4),(0,l.default)(o,"CANVAS",8),(0,l.default)(o,"FILTERS",16),(0,l.default)(o,"MASK",32),(0,l.default)(o,"CLIP",64),(0,l.default)(o,"STYLE",128),(0,l.default)(o,"TEXTURE",256),(0,l.default)(o,"GRAPHICS",512),(0,l.default)(o,"LAYAGL3D",1024),(0,l.default)(o,"CUSTOM",2048),(0,l.default)(o,"ONECHILD",4096),(0,l.default)(o,"CHILDS",8192),(0,l.default)(o,"REPAINT_NONE",0),(0,l.default)(o,"REPAINT_NODE",1),(0,l.default)(o,"REPAINT_CACHE",2),(0,l.default)(o,"REPAINT_ALL",3)},84269:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Stage=void 0;var s=r(i(94198)),l=r(i(81643)),o=r(i(92762)),u=r(i(87368)),h=r(i(28146)),c=r(i(43714)),d=r(i(13383)),f=r(i(78310)),_=r(i(92135)),v=r(i(82669)),y=r(i(17454)),p=i(87210),g=i(20516),m=i(85058),x=i(46791),T=i(46222),k=i(63969),C=i(70153),S=i(5866),E=i(91020),M=i(3117),L=i(39498),b=i(23395),I=i(27175),R=i(37444),w=i(53546),A=i(62082),B=i(48331),D=i(33965),P=i(14880),F=i(93561),O=i(54008),U=i(89432),N=i(7695);var G=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t,e;(0,u.default)(this,r),e=n.call(this),(0,y.default)((0,c.default)(e),"offset",new E.Point),(0,y.default)((0,c.default)(e),"_frameRate","fast"),(0,y.default)((0,c.default)(e),"designWidth",0),(0,y.default)((0,c.default)(e),"designHeight",0),(0,y.default)((0,c.default)(e),"canvasRotation",!1),(0,y.default)((0,c.default)(e),"canvasDegree",0),(0,y.default)((0,c.default)(e),"renderingEnabled",!0),(0,y.default)((0,c.default)(e),"screenAdaptationEnabled",!0),(0,y.default)((0,c.default)(e),"_canvasTransform",new S.Matrix),(0,y.default)((0,c.default)(e),"_screenMode","none"),(0,y.default)((0,c.default)(e),"_scaleMode","noscale"),(0,y.default)((0,c.default)(e),"_alignV","top"),(0,y.default)((0,c.default)(e),"_alignH","left"),(0,y.default)((0,c.default)(e),"_bgColor","black"),(0,y.default)((0,c.default)(e),"_mouseMoveTime",0),(0,y.default)((0,c.default)(e),"_renderCount",0),(0,y.default)((0,c.default)(e),"_safariOffsetY",0),(0,y.default)((0,c.default)(e),"_frameStartTime",0),(0,y.default)((0,c.default)(e),"_previousOrientation",I.Browser.window.orientation),(0,y.default)((0,c.default)(e),"_wgColor",[0,0,0,1]),(0,y.default)((0,c.default)(e),"_scene3Ds",[]),(0,y.default)((0,c.default)(e),"_globalRepaintSet",!1),(0,y.default)((0,c.default)(e),"_globalRepaintGet",!1),(0,y.default)((0,c.default)(e),"_3dUI",[]),(0,y.default)((0,c.default)(e),"_curUIBase",null),(0,y.default)((0,c.default)(e),"useRetinalCanvas",!1),(0,_.default)((t=(0,c.default)(e),(0,v.default)(r.prototype)),"set_transform",t).call(t,e._createTransform()),e.mouseEnabled=!0,e.hitTestPrior=!0,e.autoSize=!1,e._setBit(T.Const.DISPLAYED_INSTAGE,!0),e._setBit(T.Const.ACTIVE_INHIERARCHY,!0),e._isFocused=!0,e._isVisibility=!0,e.useRetinalCanvas=g.Config.useRetinalCanvas;var i=I.Browser.window;i.addEventListener("focus",(function(){e._isFocused=!0,e.event(k.Event.FOCUS),e.event(k.Event.FOCUS_CHANGE)})),i.addEventListener("blur",(function(){e._isFocused=!1,e.event(k.Event.BLUR),e.event(k.Event.FOCUS_CHANGE),e._isInputting()&&(m.Input.inputElement.target.focus=!1)}));var a="visibilityState",s="visibilitychange",l=i.document;return void 0!==l.hidden?(s="visibilitychange",a="visibilityState"):void 0!==l.mozHidden?(s="mozvisibilitychange",a="mozVisibilityState"):void 0!==l.msHidden?(s="msvisibilitychange",a="msVisibilityState"):void 0!==l.webkitHidden&&(s="webkitvisibilitychange",a="webkitVisibilityState"),i.document.addEventListener(s,(function(){"hidden"==I.Browser.document[a]?(e._isVisibility=!1,e._isInputting()&&(m.Input.inputElement.target.focus=!1)):e._isVisibility=!0,e.renderingEnabled=e._isVisibility,e.event(k.Event.VISIBILITY_CHANGE)})),i.addEventListener("resize",(function(){var t=I.Browser.window.orientation;null!=t&&t!=e._previousOrientation&&e._isInputting()&&(m.Input.inputElement.target.focus=!1),e._previousOrientation=t,e._isInputting()||(I.Browser.onSafari&&(e._safariOffsetY=(I.Browser.window.__innerHeight||I.Browser.document.body.clientHeight||I.Browser.document.documentElement.clientHeight)-I.Browser.window.innerHeight),e._resetCanvas())})),i.addEventListener("orientationchange",(function(t){e._resetCanvas()})),e.on(k.Event.MOUSE_MOVE,(0,c.default)(e),e._onmouseMove),I.Browser.onMobile&&e.on(k.Event.MOUSE_DOWN,(0,c.default)(e),e._onmouseMove),e}return(0,h.default)(r,[{key:"_isInputting",value:function(){return I.Browser.onMobile&&m.Input.isInputting}},{key:"width",get:function(){return(0,_.default)((0,v.default)(r.prototype),"get_width",this).call(this)},set:function(t){this.designWidth=t,(0,_.default)((0,v.default)(r.prototype),"set_width",this).call(this,t),F.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"height",get:function(){return(0,_.default)((0,v.default)(r.prototype),"get_height",this).call(this)},set:function(t){this.designHeight=t,(0,_.default)((0,v.default)(r.prototype),"set_height",this).call(this,t),F.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"transform",get:function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||this._createTransform()},set:function(t){(0,_.default)((0,v.default)(r.prototype),"set_transform",this).call(this,t)}},{key:"isFocused",get:function(){return this._isFocused}},{key:"isVisibility",get:function(){return this._isVisibility}},{key:"_changeCanvasSize",value:function(){this.setScreenSize(I.Browser.clientWidth*I.Browser.pixelRatio,I.Browser.clientHeight*I.Browser.pixelRatio)}},{key:"_resetCanvas",value:function(){this.screenAdaptationEnabled&&this._changeCanvasSize()}},{key:"setScreenSize",value:function(t,e){var i=!1;if(this._screenMode!==r.SCREEN_NONE&&(i=(t/e<1?r.SCREEN_VERTICAL:r.SCREEN_HORIZONTAL)!==this._screenMode)){var a=e;e=t,t=a}this.canvasRotation=i;var n=M.Render._mainCanvas,l=n.source.style,o=this._canvasTransform.identity(),u=this._scaleMode,h=t/this.designWidth,c=e/this.designHeight,d=this.useRetinalCanvas?t:this.designWidth,f=this.useRetinalCanvas?e:this.designHeight,y=t,p=e,g=I.Browser.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,u){case r.SCALE_NOSCALE:h=c=1,y=this.designWidth,p=this.designHeight;break;case r.SCALE_SHOWALL:h=c=Math.min(h,c),d=y=Math.round(this.designWidth*h),f=p=Math.round(this.designHeight*c);break;case r.SCALE_NOBORDER:h=c=Math.max(h,c),y=Math.round(this.designWidth*h),p=Math.round(this.designHeight*c);break;case r.SCALE_FULL:h=c=1,this._width=d=t,this._height=f=e;break;case r.SCALE_FIXED_WIDTH:c=h,this._height=f=Math.round(e/h);break;case r.SCALE_FIXED_HEIGHT:h=c,this._width=d=Math.round(t/c);break;case r.SCALE_FIXED_AUTO:t/e<this.designWidth/this.designHeight?(c=h,this._height=f=Math.round(e/h)):(h=c,this._width=d=Math.round(t/c))}this.useRetinalCanvas&&(y=d=t,p=f=e),h*=this.scaleX,c*=this.scaleY,1===h&&1===c?this.transform.identity():(this.transform.a=this._formatData(h/(y/d)),this.transform.d=this._formatData(c/(p/f))),n.size(d,f),A.RunDriver.changeWebGLSize(d,f),o.scale(y/d/g,p/f/g),this._alignH===r.ALIGN_LEFT?this.offset.x=0:this._alignH===r.ALIGN_RIGHT?this.offset.x=t-y:this.offset.x=.5*(t-y)/g,this._alignV===r.ALIGN_TOP?this.offset.y=0:this._alignV===r.ALIGN_BOTTOM?this.offset.y=e-p:this.offset.y=.5*(e-p)/g,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),o.translate(this.offset.x,this.offset.y),this._safariOffsetY&&o.translate(0,this._safariOffsetY),this.canvasDegree=0,i&&(this._screenMode===r.SCREEN_HORIZONTAL?(o.rotate(Math.PI/2),o.translate(e/g,0),this.canvasDegree=90):(o.rotate(-Math.PI/2),o.translate(0,t/g),this.canvasDegree=-90)),o.a=this._formatData(o.a),o.d=this._formatData(o.d),o.tx=this._formatData(o.tx),o.ty=this._formatData(o.ty),(0,_.default)((0,v.default)(r.prototype),"set_transform",this).call(this,this.transform),l.transformOrigin=l.webkitTransformOrigin=l.msTransformOrigin=l.mozTransformOrigin=l.oTransformOrigin="0px 0px 0px",l.transform=l.webkitTransform=l.msTransform=l.mozTransform=l.oTransform="matrix("+o.toString()+")",l.width=d,l.height=f,this._safariOffsetY&&o.translate(0,-this._safariOffsetY),o.translate((0,s.default)(l.left)||0,(0,s.default)(l.top)||0),this.visible=!0,this._repaint|=x.SpriteConst.REPAINT_CACHE,this.event(k.Event.RESIZE)}},{key:"_formatData",value:function(t){return Math.abs(t)<1e-6?0:Math.abs(1-t)<.001?t>0?1:-1:t}},{key:"scaleMode",get:function(){return this._scaleMode},set:function(t){this._scaleMode=t,F.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignH",get:function(){return this._alignH},set:function(t){this._alignH=t,F.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignV",get:function(){return this._alignV},set:function(t){this._alignV=t,F.ILaya.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,this._wgColor=t?w.ColorUtils.create(t).arrColor:null,M.Render.canvas.style.background=t||"none"}},{key:"mouseX",get:function(){return Math.round(C.MouseManager.instance.mouseX/this.clientScaleX)}},{key:"mouseY",get:function(){return Math.round(C.MouseManager.instance.mouseY/this.clientScaleY)}},{key:"getMousePoint",value:function(){return E.Point.TEMP.setTo(this.mouseX,this.mouseY)}},{key:"clientScaleX",get:function(){return this._transform?this._transform.getScaleX():1}},{key:"clientScaleY",get:function(){return this._transform?this._transform.getScaleY():1}},{key:"screenMode",get:function(){return this._screenMode},set:function(t){this._screenMode=t}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.SpriteConst.REPAINT_CACHE;this._repaint|=t}},{key:"parentRepaint",value:function(){arguments.length>0&&void 0!==arguments[0]||x.SpriteConst.REPAINT_CACHE}},{key:"_loop",value:function(){return this._globalRepaintGet=this._globalRepaintSet,this._globalRepaintSet=!1,this.render(M.Render._context,0,0),!0}},{key:"getFrameTm",value:function(){return this._frameStartTime}},{key:"_onmouseMove",value:function(t){this._mouseMoveTime=I.Browser.now()}},{key:"getTimeFromFrameStart",value:function(){return I.Browser.now()-this._frameStartTime}},{key:"visible",get:function(){return(0,_.default)((0,v.default)(r.prototype),"visible",this)},set:function(t){this.visible!==t&&((0,_.default)((0,v.default)(r.prototype),"set_visible",this).call(this,t),M.Render._mainCanvas.source.style.visibility=t?"visible":"hidden")}},{key:"render",value:function(t,e,i){if(window.conch)this.renderToNative(t,e,i);else{if(this._frameRate===r.FRAME_SLEEP){var a=I.Browser.now();if(!(a-this._frameStartTime>=1e3))return;this._frameStartTime=a}else{if(!this._visible)return this._renderCount++,void(this._renderCount%5==0&&(R.CallLater.I._update(),P.Stat.loopCount++,L.RenderInfo.loopCount=P.Stat.loopCount,this._updateTimers()));this._frameStartTime=I.Browser.now(),L.RenderInfo.loopStTm=this._frameStartTime}this._renderCount++;var n=(this._frameRate===r.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2e3?r.FRAME_FAST:r.FRAME_SLOW:this._frameRate)!==r.FRAME_SLOW,s=this._renderCount%2==0;if(P.Stat.renderSlow=!n,n||s){if(R.CallLater.I._update(),P.Stat.loopCount++,L.RenderInfo.loopCount=P.Stat.loopCount,N.PerformancePlugin.begainSample(N.PerformancePlugin.PERFORMANCE_LAYA),this.renderingEnabled){for(var l=0,o=this._scene3Ds.length;l<o;l++)this._scene3Ds[l]._update();t.clear(),(0,_.default)((0,v.default)(r.prototype),"render",this).call(this,t,e,i),P.Stat._StatRender.renderNotCanvas(t,e,i)}this.renderingEnabled&&(r.clear(this._bgColor),t.flush(),B.VectorGraphManager.instance&&B.VectorGraphManager.getInstance().endDispose()),this._updateTimers(),N.PerformancePlugin.endSample(N.PerformancePlugin.PERFORMANCE_LAYA)}}}},{key:"renderToNative",value:function(t,e,i){if(this._renderCount++,this._visible){if(R.CallLater.I._update(),P.Stat.loopCount++,L.RenderInfo.loopCount=P.Stat.loopCount,this.renderingEnabled){for(var a=0,n=this._scene3Ds.length;a<n;a++)this._scene3Ds[a]._update();t.clear(),(0,_.default)((0,v.default)(r.prototype),"render",this).call(this,t,e,i),P.Stat._StatRender.renderNotCanvas(t,e,i)}this.renderingEnabled&&(r.clear(this._bgColor),t.flush(),B.VectorGraphManager.instance&&B.VectorGraphManager.getInstance().endDispose()),this._updateTimers()}else this._renderCount%5==0&&(R.CallLater.I._update(),P.Stat.loopCount++,L.RenderInfo.loopCount=P.Stat.loopCount,this._updateTimers())}},{key:"_updateTimers",value:function(){F.ILaya.systemTimer._update(),F.ILaya.startTimer._update(),F.ILaya.physicsTimer._update(),F.ILaya.updateTimer._update(),F.ILaya.lateTimer._update(),F.ILaya.timer._update()}},{key:"fullScreenEnabled",set:function(t){var e=I.Browser.document,i=M.Render.canvas;t?(i.addEventListener("mousedown",this._requestFullscreen),i.addEventListener("touchstart",this._requestFullscreen),e.addEventListener("fullscreenchange",this._fullScreenChanged),e.addEventListener("mozfullscreenchange",this._fullScreenChanged),e.addEventListener("webkitfullscreenchange",this._fullScreenChanged),e.addEventListener("msfullscreenchange",this._fullScreenChanged)):(i.removeEventListener("mousedown",this._requestFullscreen),i.removeEventListener("touchstart",this._requestFullscreen),e.removeEventListener("fullscreenchange",this._fullScreenChanged),e.removeEventListener("mozfullscreenchange",this._fullScreenChanged),e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),e.removeEventListener("msfullscreenchange",this._fullScreenChanged))}},{key:"frameRate",get:function(){return F.ILaya.Render.isConchApp?this._frameRateNative:this._frameRate},set:function(t){if(F.ILaya.Render.isConchApp){var e=window.conch;switch(t){case r.FRAME_FAST:e.config.setLimitFPS(60);break;case r.FRAME_MOUSE:e.config.setMouseFrame(2e3);break;case r.FRAME_SLOW:e.config.setSlowFrame(!0);break;case r.FRAME_SLEEP:e.config.setLimitFPS(1)}this._frameRateNative=t}else this._frameRate=t}},{key:"_requestFullscreen",value:function(){var t=I.Browser.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},{key:"_fullScreenChanged",value:function(){F.ILaya.stage.event(k.Event.FULL_SCREEN_CHANGE)}},{key:"exitFullscreen",value:function(){var t=I.Browser.document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}},{key:"isGlobalRepaint",value:function(){return this._globalRepaintGet}},{key:"setGlobalRepaint",value:function(){this._globalRepaintSet=!0}},{key:"add3DUI",value:function(t){var e,i=t.rootView;(0,l.default)(e=this._3dUI).call(e,i)>=0||this._3dUI.push(i)}},{key:"remove3DUI",value:function(t){var e,i,a=t.rootView,n=(0,l.default)(e=this._3dUI).call(e,a);return n>=0&&((0,o.default)(i=this._3dUI).call(i,n,1),!0)}}]),r}(p.Sprite);e.Stage=G,(0,y.default)(G,"SCALE_NOSCALE","noscale"),(0,y.default)(G,"SCALE_EXACTFIT","exactfit"),(0,y.default)(G,"SCALE_SHOWALL","showall"),(0,y.default)(G,"SCALE_NOBORDER","noborder"),(0,y.default)(G,"SCALE_FULL","full"),(0,y.default)(G,"SCALE_FIXED_WIDTH","fixedwidth"),(0,y.default)(G,"SCALE_FIXED_HEIGHT","fixedheight"),(0,y.default)(G,"SCALE_FIXED_AUTO","fixedauto"),(0,y.default)(G,"ALIGN_LEFT","left"),(0,y.default)(G,"ALIGN_RIGHT","right"),(0,y.default)(G,"ALIGN_CENTER","center"),(0,y.default)(G,"ALIGN_TOP","top"),(0,y.default)(G,"ALIGN_MIDDLE","middle"),(0,y.default)(G,"ALIGN_BOTTOM","bottom"),(0,y.default)(G,"SCREEN_NONE","none"),(0,y.default)(G,"SCREEN_HORIZONTAL","horizontal"),(0,y.default)(G,"SCREEN_VERTICAL","vertical"),(0,y.default)(G,"FRAME_FAST","fast"),(0,y.default)(G,"FRAME_SLOW","slow"),(0,y.default)(G,"FRAME_MOUSE","mouse"),(0,y.default)(G,"FRAME_SLEEP","sleep"),(0,y.default)(G,"clear",(function(t){b.Context.set2DRenderConfig();var e=O.LayaGL.instance;D.RenderState2D.worldScissorTest&&e.disable(e.SCISSOR_TEST);var i=M.Render.context,a=0==i._submits._length||g.Config.preserveDrawingBuffer?w.ColorUtils.create(t).arrColor:F.ILaya.stage._wgColor;a?i.clearBG(a[0],a[1],a[2],a[3]):i.clearBG(0,0,0,0),D.RenderState2D.clear()})),U.ClassUtils.regClass("laya.display.Stage",G),U.ClassUtils.regClass("Laya.Stage",G)},23699:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Text=void 0;var s=r(i(78914)),l=r(i(31238)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(92135)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=r(i(17454)),y=i(87210),p=i(46791),g=i(60558),m=i(63969),x=i(91020),T=i(63701),k=i(87956),C=i(93561),S=i(89432);var E=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t;return(0,o.default)(this,r),t=n.call(this),(0,v.default)((0,h.default)(t),"_textWidth",0),(0,v.default)((0,h.default)(t),"_textHeight",0),(0,v.default)((0,h.default)(t),"_lines",[]),(0,v.default)((0,h.default)(t),"_lineWidths",[]),(0,v.default)((0,h.default)(t),"_startX",0),(0,v.default)((0,h.default)(t),"_startY",0),(0,v.default)((0,h.default)(t),"_charSize",{}),(0,v.default)((0,h.default)(t),"_valign","top"),(0,v.default)((0,h.default)(t),"_fontSize",r.defaultFontSize),(0,v.default)((0,h.default)(t),"_font",r.defaultFont),(0,v.default)((0,h.default)(t),"_color","#000000"),(0,v.default)((0,h.default)(t),"_singleCharRender",!1),(0,v.default)((0,h.default)(t),"overflow",r.VISIBLE),t._style=g.TextStyle.EMPTY,t}return(0,u.default)(r,[{key:"getStyle",value:function(){return this._style===g.TextStyle.EMPTY&&(this._style=g.TextStyle.create()),this._style}},{key:"_getTextStyle",value:function(){return this._style===g.TextStyle.EMPTY&&(this._style=g.TextStyle.create()),this._style}},{key:"destroy",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,c.default)((0,_.default)(r.prototype),"destroy",this).call(this,e),this._clipPoint=null,this._lines=null,this._lineWidths=null,this._words&&(0,s.default)(t=this._words).call(t,(function(t){t.cleanCache()})),this._words=null,this._charSize=null}},{key:"_getBoundPointsM",value:function(){var t=T.Rectangle.TEMP;return t.setTo(0,0,this.width,this.height),t._getBoundPoints()}},{key:"getGraphicBounds",value:function(){var t=T.Rectangle.TEMP;return t.setTo(0,0,this.width,this.height),t}},{key:"width",get:function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},set:function(t){t!=this._width&&((0,c.default)((0,_.default)(r.prototype),"set_width",this).call(this,t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"height",get:function(){return this._height?this._height:this.textHeight},set:function(t){t!=this._height&&((0,c.default)((0,_.default)(r.prototype),"set_height",this).call(this,t),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"textWidth",get:function(){return this._isChanged&&C.ILaya.systemTimer.runCallLater(this,this.typeset),this._textWidth}},{key:"textHeight",get:function(){return this._isChanged&&C.ILaya.systemTimer.runCallLater(this,this.typeset),this._textHeight}},{key:"text",get:function(){return this._text||""},set:function(t){this.set_text(t)}},{key:"get_text",value:function(){return this._text||""}},{key:"set_text",value:function(t){this._text!==t&&(this.lang(t+""),this.isChanged=!0,this.event(m.Event.CHANGE),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"lang",value:function(t){if(t=r.langPacks&&r.langPacks[t]?r.langPacks[t]:t,arguments.length<2)this._text=t;else{for(var e=0,i=arguments.length;e<i;e++)t=t.replace("{"+e+"}",arguments[e+1]);this._text=t}}},{key:"font",get:function(){return this._font},set:function(t){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1)),r._bitmapFonts&&r._bitmapFonts[t]&&(this._getTextStyle().currBitmapFont=r._bitmapFonts[t]),this._font=t,this.isChanged=!0}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!=t&&(this._fontSize=t,this.isChanged=!0)}},{key:"bold",get:function(){return this._style.bold},set:function(t){this._getTextStyle().bold=t,this.isChanged=!0}},{key:"color",get:function(){return this._color},set:function(t){this.set_color(t)}},{key:"get_color",value:function(){return this._color}},{key:"set_color",value:function(t){this._color!=t&&(this._color=t,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}},{key:"italic",get:function(){return this._style.italic},set:function(t){this._getTextStyle().italic=t,this.isChanged=!0}},{key:"align",get:function(){return this._style.align},set:function(t){this._getTextStyle().align=t,this.isChanged=!0}},{key:"valign",get:function(){return this._valign},set:function(t){this._valign=t,this.isChanged=!0}},{key:"wordWrap",get:function(){return this._style.wordWrap},set:function(t){this._getTextStyle().wordWrap=t,this.isChanged=!0}},{key:"leading",get:function(){return this._style.leading},set:function(t){this._getTextStyle().leading=t,this.isChanged=!0}},{key:"padding",get:function(){return this._style.padding},set:function(t){if("string"==typeof t){var e,i,a;for(a=(e=t.split(",")).length;e.length<4;)e.push(0);for(i=0;i<a;i++)e[i]=(0,l.default)(e[i])||0;t=e}this._getTextStyle().padding=t,this.isChanged=!0}},{key:"bgColor",get:function(){return this._style.bgColor},set:function(t){this.set_bgColor(t)}},{key:"set_bgColor",value:function(t){this._getTextStyle().bgColor=t,this._renderType|=p.SpriteConst.STYLE,this._setBgStyleColor(0,0,this.width,this.height,t),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"get_bgColor",value:function(){return this._style.bgColor}},{key:"borderColor",get:function(){return this._style.borderColor},set:function(t){this._getTextStyle().borderColor=t,this._renderType|=p.SpriteConst.STYLE,this._setBorderStyleColor(0,0,this.width,this.height,t,1),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"stroke",get:function(){return this._style.stroke},set:function(t){this._getTextStyle().stroke=t,this.isChanged=!0}},{key:"strokeColor",get:function(){return this._style.strokeColor},set:function(t){this._getTextStyle().strokeColor=t,this.isChanged=!0}},{key:"isChanged",set:function(t){this._isChanged!==t&&(this._isChanged=t,t&&C.ILaya.systemTimer.callLater(this,this.typeset))}},{key:"_getContextFont",value:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(C.ILaya.Browser.onIPhone&&r.fontFamilyMap[this.font]||this.font)}},{key:"_isPassWordMode",value:function(){var t=this._style.asPassword;return"prompt"in this&&this.prompt==this._text&&(t=!1),t}},{key:"_getPassWordTxt",value:function(t){var e;e="";for(var i=t.length;i>0;i--)e+="●";return e}},{key:"_renderText",value:function(){var t=this.padding,e=this._lines.length;this.overflow!=r.VISIBLE&&(e=Math.min(e,Math.floor((this.height-t[0]-t[2])/(this.leading+this._charSize.height))+1));var i=this.scrollY/(this._charSize.height+this.leading)|0,a=this.graphics;a.clear(!0);var n=this._getContextFont();C.ILaya.Browser.context.font=n;var s=t[3],l="left",o=this._lines,u=this.leading+this._charSize.height,h=this._style.currBitmapFont;h&&(u=this.leading+h.getMaxHeight());var c=t[0];!h&&this._width>0&&this._textWidth<=this._width&&("right"==this.align?(l="right",s=this._width-t[1]):"center"==this.align&&(l="center",s=.5*this._width+t[3]-t[1]));var d,f,_=1;if(h&&h.autoScaleSize&&(_=h.fontSize/this.fontSize),this._height>0){var v=this._textHeight>this._height?"top":this.valign;"middle"===v?c=.5*(this._height-e/_*u)+t[0]-t[2]:"bottom"===v&&(c=this._height-e/_*u-t[2])}this._clipPoint&&(a.save(),h&&h.autoScaleSize?(d=this._width?this._width-t[3]-t[1]:this._textWidth,f=this._height?this._height-t[0]-t[2]:this._textHeight,d*=_,f*=_,a.clipRect(t[3],t[0],d,f)):a.clipRect(t[3],t[0],this._width?this._width-t[3]-t[1]:this._textWidth,this._height?this._height-t[0]-t[2]:this._textHeight),this.repaint());var y=this._style,p=y.asPassword;"prompt"in this&&this.prompt==this._text&&(p=!1);for(var g=0,m=0,x=Math.min(this._lines.length,e+i)||1,T=i;T<x;T++){var S,E=o[T];if(p)for(var M=(E="").length;M>0;M--)E+="●";if(null==E&&(E=""),g=s-(this._clipPoint?this._clipPoint.x:0),m=c+u*T-(this._clipPoint?this._clipPoint.y:0),this.underline&&this._drawUnderline(l,g,m,T),h){var L=this.width;h.autoScaleSize&&(L=this.width*_,g*=_,m*=_),h._drawText(E,this,g,m,this.align,L)}else this._words||(this._words=[]),this._words.length>T-i?S=this._words[T-i]:(S=new k.WordText,this._words.push(S)),S.setText(E),S.splitRender=this._singleCharRender,y.stroke?a.fillBorderText(S,g,m,n,this.color,l,y.stroke,y.strokeColor):a.fillText(S,g,m,n,this.color,l)}if(h&&h.autoScaleSize){var b=1/_;this.scale(b,b)}this._clipPoint&&a.restore(),this._startX=s,this._startY=c}},{key:"_drawUnderline",value:function(t,e,i,a){var n=this._lineWidths[a];switch(t){case"center":e-=n/2;break;case"right":e-=n}i+=this._charSize.height,this._graphics.drawLine(e,i,e+n,i,this.underlineColor||this.color,1)}},{key:"typeset",value:function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);C.ILaya.Render.isConchApp?window.conchTextCanvas.font=this._getContextFont():C.ILaya.Browser.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new x.Point(0,0)):this._clipPoint=null,this._renderText()}},{key:"_evalTextSize",value:function(){var t,e;t=Math.max.apply(this,this._lineWidths);var i=this._style.currBitmapFont;if(i){var a=i.getMaxHeight();i.autoScaleSize&&(a=this.fontSize),e=this._lines.length*(a+this.leading)+this.padding[0]+this.padding[2]}else e=this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],this._lines.length&&(e-=this.leading);t==this._textWidth&&e==this._textHeight||(this._textWidth=t,this._textHeight=e)}},{key:"_checkEnabledViewportOrNot",value:function(){return this.overflow==r.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)}},{key:"changeText",value:function(t){this._text!==t&&(this.lang(t+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())}},{key:"_parseLines",value:function(t){var e=this.wordWrap||this.overflow==r.HIDDEN;if(e)var i=this._getWordWrapWidth();var a=this._style.currBitmapFont;if(a)this._charSize.width=a.getMaxWidth(),this._charSize.height=a.getMaxHeight();else{var n=null;(n=C.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(r._testWord):C.ILaya.Browser.context.measureText(r._testWord))||(n={width:100}),this._charSize.width=n.width,this._charSize.height=n.height||this.fontSize}for(var s=t.replace(/\r\n/g,"\n").split("\n"),l=0,o=s.length;l<o;l++){var u=s[l];e?this._parseLine(u,i):(this._lineWidths.push(this._getTextWidth(u)),this._lines.push(u))}}},{key:"_parseLine",value:function(t,e){var i=this._lines,a=0,n=0,s=0,l=0;if((n=this._getTextWidth(t))<=e)return i.push(t),void this._lineWidths.push(n);n=this._charSize.width,0==(a=Math.floor(e/n))&&(a=1),s=n=this._getTextWidth(t.substring(0,a));for(var o=a,u=t.length;o<u;o++)if((s+=n=this._getTextWidth(t.charAt(o)))>e)if(this.wordWrap){var h=t.substring(l,o);if(h.charCodeAt(h.length-1)<255){var c=/(?:\w|-)+$/.exec(h);c&&(o=c.index+l,0==c.index?o+=h.length:h=t.substring(l,o))}if(i.push(h),this._lineWidths.push(s-n),l=o,!(o+a<u)){i.push(t.substring(l,u)),this._lineWidths.push(this._getTextWidth(i[i.length-1])),l=-1;break}o+=a,s=n=this._getTextWidth(t.substring(l,o)),o--}else if(this.overflow==r.HIDDEN)return i.push(t.substring(0,o)),void this._lineWidths.push(this._getTextWidth(i[i.length-1]));this.wordWrap&&-1!=l&&(i.push(t.substring(l,u)),this._lineWidths.push(this._getTextWidth(i[i.length-1])))}},{key:"_getTextWidth",value:function(t){var e=this._style.currBitmapFont;return e?e.getTextWidth(t):C.ILaya.Render.isConchApp?window.conchTextCanvas.measureText(t).width:(C.ILaya.Browser.context.measureText(t)||{width:100}).width}},{key:"_getWordWrapWidth",value:function(){var t,e=this.padding,i=this._style.currBitmapFont;return(t=i&&i.autoScaleSize?this._width*(i.fontSize/this.fontSize):this._width)<=0&&(t=this.wordWrap?100:C.ILaya.Browser.width),t<=0&&(t=100),t-e[3]-e[1]}},{key:"getCharPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._isChanged&&C.ILaya.systemTimer.runCallLater(this,this.typeset);for(var i=0,a=this._lines,n=0,r=0,s=a.length;r<s;r++){if(t<(i+=a[r].length)){var l=r;break}n=i}var o=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;C.ILaya.Browser.context.font=o;var u=this._getTextWidth(this._text.substring(n,t)),h=e||new x.Point;return h.setTo(this._startX+u-(this._clipPoint?this._clipPoint.x:0),this._startY+l*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))}},{key:"scrollX",get:function(){return this._clipPoint?this._clipPoint.x:0},set:function(t){if(!(this.overflow!=r.SCROLL||this.textWidth<this._width)&&this._clipPoint){t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t,this._clipPoint.x=t,this._renderText()}}},{key:"scrollY",get:function(){return this._clipPoint?this._clipPoint.y:0},set:function(t){if(!(this.overflow!=r.SCROLL||this.textHeight<this._height)&&this._clipPoint){t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t,this._clipPoint.y=t,this._renderText()}}},{key:"maxScrollX",get:function(){return this.textWidth<this._width?0:this._textWidth-this._width}},{key:"maxScrollY",get:function(){return this.textHeight<this._height?0:this._textHeight-this._height}},{key:"lines",get:function(){return this._isChanged&&this.typeset(),this._lines}},{key:"underlineColor",get:function(){return this._style.underlineColor},set:function(t){this._getTextStyle().underlineColor=t,this._isChanged||this._renderText()}},{key:"underline",get:function(){return this._style.underline},set:function(t){this._getTextStyle().underline=t}},{key:"singleCharRender",get:function(){return this._singleCharRender},set:function(t){this._singleCharRender=t}}],[{key:"defaultFontStr",value:function(){return r.defaultFontSize+"px "+r.defaultFont}},{key:"registerBitmapFont",value:function(t,e){r._bitmapFonts||(r._bitmapFonts={}),r._bitmapFonts[t]=e}},{key:"unregisterBitmapFont",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r._bitmapFonts&&r._bitmapFonts[t]){var i=r._bitmapFonts[t];e&&i.destroy(),delete r._bitmapFonts[t]}}}]),r}(y.Sprite);e.Text=E,(0,v.default)(E,"VISIBLE","visible"),(0,v.default)(E,"SCROLL","scroll"),(0,v.default)(E,"HIDDEN","hidden"),(0,v.default)(E,"defaultFontSize",12),(0,v.default)(E,"defaultFont","Arial"),(0,v.default)(E,"isComplexText",!1),(0,v.default)(E,"fontFamilyMap",{报隶:"报隶-简",黑体:"黑体-简",楷体:"楷体-简",兰亭黑:"兰亭黑-简",隶变:"隶变-简",凌慧体:"凌慧体-简",翩翩体:"翩翩体-简",苹方:"苹方-简",手札体:"手札体-简",宋体:"宋体-简",娃娃体:"娃娃体-简",魏碑:"魏碑-简",行楷:"行楷-简",雅痞:"雅痞-简",圆体:"圆体-简"}),(0,v.default)(E,"_testWord","游"),(0,v.default)(E,"CharacterCache",!0),(0,v.default)(E,"RightToLeft",!1),C.ILaya.regClass(E),S.ClassUtils.regClass("laya.display.Text",E),S.ClassUtils.regClass("Laya.Text",E)},81379:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AlphaCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("AlphaCmd",this)}},{key:"run",value:function(t,e,i){t.alpha(this.alpha)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e){var i=o.Pool.getItemByClass("AlphaCmd",t);return i.alpha=e,i}}]),t}();e.AlphaCmd=u,(0,l.default)(u,"ID","Alpha")},20783:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ClipRectCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("ClipRectCmd",this)}},{key:"run",value:function(t,e,i){t.clipRect(this.x+e,this.y+i,this.width,this.height)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n){var r=o.Pool.getItemByClass("ClipRectCmd",t);return r.x=e,r.y=i,r.width=a,r.height=n,r}}]),t}();e.ClipRectCmd=u,(0,l.default)(u,"ID","ClipRect")},32487:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Draw9GridTexture=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture._removeReference(),o.Pool.recover("Draw9GridTexture",this)}},{key:"run",value:function(t,e,i){t.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,e,i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s){var l=o.Pool.getItemByClass("Draw9GridTexture",t);return l.texture=e,e._addReference(),l.x=i,l.y=a,l.width=n,l.height=r,l.sizeGrid=s,l}}]),t}();e.Draw9GridTexture=u,(0,l.default)(u,"ID","Draw9GridTexture")},39808:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawCircleCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawCircleCmd",this)}},{key:"run",value:function(t,e,i){t._drawCircle(this.x+e,this.y+i,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l){var u=o.Pool.getItemByClass("DrawCircleCmd",t);return u.x=e,u.y=i,u.radius=a,u.fillColor=n,u.lineColor=r,u.lineWidth=s,u.vid=l,u}}]),t}();e.DrawCircleCmd=u,(0,l.default)(u,"ID","DrawCircle")},44265:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawCurvesCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.points=null,this.lineColor=null,o.Pool.recover("DrawCurvesCmd",this)}},{key:"run",value:function(t,e,i){this.points&&t.drawCurves(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r){var s=o.Pool.getItemByClass("DrawCurvesCmd",t);return s.x=e,s.y=i,s.points=a,s.lineColor=n,s.lineWidth=r,s}}]),t}();e.DrawCurvesCmd=u,(0,l.default)(u,"ID","DrawCurves")},60003:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawImageCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,o.Pool.recover("DrawImageCmd",this)}},{key:"run",value:function(t,e,i){this.texture&&t.drawTexture(this.texture,this.x+e,this.y+i,this.width,this.height)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r){var s=o.Pool.getItemByClass("DrawImageCmd",t);return s.texture=e,e._addReference(),s.x=i,s.y=a,s.width=n,s.height=r,s}}]),t}();e.DrawImageCmd=u,(0,l.default)(u,"ID","DrawImage")},2475:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawLineCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("DrawLineCmd",this)}},{key:"run",value:function(t,e,i){t._drawLine(e,i,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l){var u=o.Pool.getItemByClass("DrawLineCmd",t);return u.fromX=e,u.fromY=i,u.toX=a,u.toY=n,u.lineColor=r,u.lineWidth=s,u.vid=l,u}}]),t}();e.DrawLineCmd=u,(0,l.default)(u,"ID","DrawLine")},10085:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawLinesCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.points=null,this.lineColor=null,o.Pool.recover("DrawLinesCmd",this)}},{key:"run",value:function(t,e,i){this.points&&t._drawLines(this.x+e,this.y+i,this.points,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s){var l=o.Pool.getItemByClass("DrawLinesCmd",t);return l.x=e,l.y=i,l.points=a,l.lineColor=n,l.lineWidth=r,l.vid=s,l}}]),t}();e.DrawLinesCmd=u,(0,l.default)(u,"ID","DrawLines")},36999:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawPathCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.paths=null,this.brush=null,this.pen=null,o.Pool.recover("DrawPathCmd",this)}},{key:"run",value:function(t,e,i){this.paths&&t._drawPath(this.x+e,this.y+i,this.paths,this.brush,this.pen)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r){var s=o.Pool.getItemByClass("DrawPathCmd",t);return s.x=e,s.y=i,s.paths=a,s.brush=n,s.pen=r,s}}]),t}();e.DrawPathCmd=u,(0,l.default)(u,"ID","DrawPath")},17050:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawPieCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawPieCmd",this)}},{key:"run",value:function(t,e,i){t._drawPie(this.x+e,this.y+i,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return t.ID}},{key:"startAngle",get:function(){return 180*this._startAngle/Math.PI},set:function(t){this._startAngle=t*Math.PI/180}},{key:"endAngle",get:function(){return 180*this._endAngle/Math.PI},set:function(t){this._endAngle=t*Math.PI/180}}],[{key:"create",value:function(e,i,a,n,r,s,l,u,h){var c=o.Pool.getItemByClass("DrawPieCmd",t);return c.x=e,c.y=i,c.radius=a,c._startAngle=n,c._endAngle=r,c.fillColor=s,c.lineColor=l,c.lineWidth=u,c.vid=h,c}}]),t}();e.DrawPieCmd=u,(0,l.default)(u,"ID","DrawPie")},5712:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawPolyCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.points=null,this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawPolyCmd",this)}},{key:"run",value:function(t,e,i){this.points&&t._drawPoly(this.x+e,this.y+i,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l,u){var h=o.Pool.getItemByClass("DrawPolyCmd",t);return h.x=e,h.y=i,h.points=a,h.fillColor=n,h.lineColor=r,h.lineWidth=s,h.isConvexPolygon=l,h.vid=u,h}}]),t}();e.DrawPolyCmd=u,(0,l.default)(u,"ID","DrawPoly")},75697:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawRectCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,o.Pool.recover("DrawRectCmd",this)}},{key:"run",value:function(t,e,i){t.drawRect(this.x+e,this.y+i,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l){var u=o.Pool.getItemByClass("DrawRectCmd",t);return u.x=e,u.y=i,u.width=a,u.height=n,u.fillColor=r,u.lineColor=s,u.lineWidth=l,u}}]),t}();e.DrawRectCmd=u,(0,l.default)(u,"ID","DrawRect")},5831:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawTextureCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(66356),u=i(89761),h=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"colorFlt",null),(0,l.default)(this,"uv",null)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,this.matrix=null,u.Pool.recover("DrawTextureCmd",this)}},{key:"run",value:function(t,e,i){this.texture&&t.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,e,i,this.alpha,this.blendMode,this.colorFlt,this.uv)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l,h,c,d){var f=u.Pool.getItemByClass("DrawTextureCmd",t);return f.texture=e,e._addReference(),f.x=i,f.y=a,f.width=n,f.height=r,f.matrix=s,f.alpha=l,f.color=h,f.blendMode=c,f.uv=null==d?null:d,h&&(f.colorFlt=new o.ColorFilter,f.colorFlt.setColor(h)),f}}]),t}();e.DrawTextureCmd=h,(0,l.default)(h,"ID","DrawTexture")},44992:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawTexturesCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture._removeReference(),this.texture=null,this.pos=null,o.Pool.recover("DrawTexturesCmd",this)}},{key:"run",value:function(t,e,i){t.drawTextures(this.texture,this.pos,e,i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i){var a=o.Pool.getItemByClass("DrawTexturesCmd",t);return a.texture=e,e._addReference(),a.pos=i,a}}]),t}();e.DrawTexturesCmd=u,(0,l.default)(u,"ID","DrawTextures")},327:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawTrianglesCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(66356),u=i(53546),h=i(89761),c=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture=null,this.vertices=null,this.uvs=null,this.indices=null,this.matrix=null,h.Pool.recover("DrawTrianglesCmd",this)}},{key:"run",value:function(t,e,i){t.drawTriangles(this.texture,this.x+e,this.y+i,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode,this.colorNum)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l,c,d,f,_){var v=h.Pool.getItemByClass("DrawTrianglesCmd",t);if(v.texture=e,v.x=i,v.y=a,v.vertices=n,v.uvs=r,v.indices=s,v.matrix=l,v.alpha=c,d){v.color=new o.ColorFilter;var y=u.ColorUtils.create(d).arrColor;v.color.color(255*y[0],255*y[1],255*y[2],255*y[3])}return v.blendMode=f,v.colorNum=_,v}}]),t}();e.DrawTrianglesCmd=c,(0,l.default)(c,"ID","DrawTriangles")},49505:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.FillTextCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(23395),u=i(53546),h=i(17333),c=i(89761),d=i(87956),f=i(93561),_=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_textIsWorldText",!1),(0,l.default)(this,"_fontColor",4294967295),(0,l.default)(this,"_strokeColor",0),(0,l.default)(this,"_fontObj",t._defFontObj),(0,l.default)(this,"_nTexAlign",0)}return(0,s.default)(t,[{key:"recover",value:function(){c.Pool.recover("FillTextCmd",this)}},{key:"run",value:function(t,e,i){f.ILaya.stage.isGlobalRepaint()&&this._textIsWorldText&&this._text.cleanCache(),this._words?o.Context._textRender.fillWords(t,this._words,this.x+e,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth):this._textIsWorldText?t._fast_filltext(this._text,this.x+e,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth,this._nTexAlign,0):o.Context._textRender.filltext(t,this._text,this.x+e,this.y+i,this.font,this.color,this._borderColor,this._lineWidth,this._textAlign)}},{key:"cmdID",get:function(){return t.ID}},{key:"text",get:function(){return this._text},set:function(t){this._text=t,this._textIsWorldText=t instanceof d.WordText,this._textIsWorldText&&this._text.cleanCache()}},{key:"font",get:function(){return this._font},set:function(t){this._font=t,this._fontObj=h.FontInfo.Parse(t),this._textIsWorldText&&this._text.cleanCache()}},{key:"color",get:function(){return this._color},set:function(t){this._color=t,this._fontColor=u.ColorUtils.create(t).numColor,this._textIsWorldText&&this._text.cleanCache()}},{key:"textAlign",get:function(){return this._textAlign},set:function(t){switch(this._textAlign=t,t){case"center":this._nTexAlign=f.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=f.ILaya.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=f.ILaya.Context.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}}],[{key:"create",value:function(e,i,a,n,r,s,l,o,u){var h=c.Pool.getItemByClass("FillTextCmd",t);return h.text=e,h._textIsWorldText=e instanceof d.WordText,h._words=i,h.x=a,h.y=n,h.font=r,h.color=s,h.textAlign=l,h._lineWidth=o,h._borderColor=u,h}}]),t}();e.FillTextCmd=_,(0,l.default)(_,"ID","FillText"),(0,l.default)(_,"_defFontObj",new h.FontInfo(null))},34966:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.FillTextureCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.texture=null,this.offset=null,this.other=null,o.Pool.recover("FillTextureCmd",this)}},{key:"run",value:function(t,e,i){t.fillTexture(this.texture,this.x+e,this.y+i,this.width,this.height,this.type,this.offset,this.other)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n,r,s,l,u){var h=o.Pool.getItemByClass("FillTextureCmd",t);return h.texture=e,h.x=i,h.y=a,h.width=n,h.height=r,h.type=s,h.offset=l,h.other=u,h}}]),t}();e.FillTextureCmd=u,(0,l.default)(u,"ID","FillTexture")},99643:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.RestoreCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("RestoreCmd",this)}},{key:"run",value:function(t,e,i){t.restore()}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(){return o.Pool.getItemByClass("RestoreCmd",t)}}]),t}();e.RestoreCmd=u,(0,l.default)(u,"ID","Restore")},48555:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.RotateCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("RotateCmd",this)}},{key:"run",value:function(t,e,i){t._rotate(this.angle,this.pivotX+e,this.pivotY+i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a){var n=o.Pool.getItemByClass("RotateCmd",t);return n.angle=e,n.pivotX=i,n.pivotY=a,n}}]),t}();e.RotateCmd=u,(0,l.default)(u,"ID","Rotate")},39471:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SaveCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("SaveCmd",this)}},{key:"run",value:function(t,e,i){t.save()}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(){return o.Pool.getItemByClass("SaveCmd",t)}}]),t}();e.SaveCmd=u,(0,l.default)(u,"ID","Save")},17267:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ScaleCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("ScaleCmd",this)}},{key:"run",value:function(t,e,i){t._scale(this.scaleX,this.scaleY,this.pivotX+e,this.pivotY+i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a,n){var r=o.Pool.getItemByClass("ScaleCmd",t);return r.scaleX=e,r.scaleY=i,r.pivotX=a,r.pivotY=n,r}}]),t}();e.ScaleCmd=u,(0,l.default)(u,"ID","Scale")},92672:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TransformCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){this.matrix=null,o.Pool.recover("TransformCmd",this)}},{key:"run",value:function(t,e,i){t._transform(this.matrix,this.pivotX+e,this.pivotY+i)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i,a){var n=o.Pool.getItemByClass("TransformCmd",t);return n.matrix=e,n.pivotX=i,n.pivotY=a,n}}]),t}();e.TransformCmd=u,(0,l.default)(u,"ID","Transform")},25113:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TranslateCmd=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"recover",value:function(){o.Pool.recover("TranslateCmd",this)}},{key:"run",value:function(t,e,i){t.translate(this.tx,this.ty)}},{key:"cmdID",get:function(){return t.ID}}],[{key:"create",value:function(e,i){var a=o.Pool.getItemByClass("TranslateCmd",t);return a.tx=e,a.ty=i,a}}]),t}();e.TranslateCmd=u,(0,l.default)(u,"ID","Translate")},38648:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BoundsStyle=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(89761),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"reset",value:function(){return this.bounds&&this.bounds.recover(),this.userBounds&&this.userBounds.recover(),this.bounds=null,this.userBounds=null,this.temBM=null,this}},{key:"recover",value:function(){l.Pool.recover("BoundsStyle",this.reset())}}],[{key:"create",value:function(){return l.Pool.getItemByClass("BoundsStyle",t)}}]),t}();e.BoundsStyle=o},46812:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.CacheStyle=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(91020),u=i(63701),h=i(54013),c=i(89761),d=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"needBitmapCache",value:function(){return this.cacheForFilters||!!this.mask}},{key:"needEnableCanvasRender",value:function(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask}},{key:"releaseContext",value:function(){if(this.canvas&&this.canvas.size){c.Pool.recover("CacheCanvas",this.canvas),this.canvas.size(0,0);try{this.canvas.width=0,this.canvas.height=0}catch(t){}}this.canvas=null}},{key:"createContext",value:function(){if(!this.canvas){this.canvas=c.Pool.getItem("CacheCanvas")||new h.HTMLCanvas(!1);var t=this.canvas.context;t||(t=this.canvas.getContext("2d"))}}},{key:"releaseFilterCache",value:function(){var t=this.filterCache;t&&(t.destroy(),t.recycle(),this.filterCache=null)}},{key:"recover",value:function(){this!==t.EMPTY&&c.Pool.recover("SpriteCache",this.reset())}},{key:"reset",value:function(){return this.releaseContext(),this.releaseFilterCache(),this.cacheAs="none",this.enableCanvasRender=!1,this.userSetCache="none",this.cacheForFilters=!1,this.staticCache=!1,this.reCache=!0,this.mask=null,this.maskParent=null,this.filterCache=null,this.filters=null,this.hasGlowFilter=!1,this.cacheRect&&this.cacheRect.recover(),this.cacheRect=null,this}},{key:"_calculateCacheRect",value:function(e,i,a,n){var r,s=e._cacheStyle;if(s.cacheRect||(s.cacheRect=u.Rectangle.create()),"bitmap"===i?((r=e.getSelfBounds()).width=r.width+2*t.CANVAS_EXTEND_EDGE,r.height=r.height+2*t.CANVAS_EXTEND_EDGE,r.x=r.x-e.pivotX,r.y=r.y-e.pivotY,r.x=r.x-t.CANVAS_EXTEND_EDGE,r.y=r.y-t.CANVAS_EXTEND_EDGE,r.x=Math.floor(r.x+a)-a,r.y=Math.floor(r.y+n)-n,r.width=Math.floor(r.width),r.height=Math.floor(r.height),s.cacheRect.copyFrom(r)):s.cacheRect.setTo(-e._style.pivotX,-e._style.pivotY,1,1),r=s.cacheRect,e._style.scrollRect){var l=e._style.scrollRect;r.x-=l.x,r.y-=l.y}return t._scaleInfo.setTo(1,1),t._scaleInfo}}],[{key:"create",value:function(){return c.Pool.getItemByClass("SpriteCache",t)}}]),t}();e.CacheStyle=d,(0,l.default)(d,"EMPTY",new d),(0,l.default)(d,"_scaleInfo",new o.Point),(0,l.default)(d,"CANVAS_EXTEND_EDGE",16)},97297:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SpriteStyle=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){return this.scaleX=this.scaleY=1,this.skewX=this.skewY=0,this.pivotX=this.pivotY=this.rotation=0,this.alpha=1,this.scrollRect&&this.scrollRect.recover(),this.scrollRect=null,this.viewport&&this.viewport.recover(),this.viewport=null,this.hitArea=null,this.dragging=null,this.blendMode=null,this}},{key:"recover",value:function(){this!==t.EMPTY&&o.Pool.recover("SpriteStyle",this.reset())}}],[{key:"create",value:function(){return o.Pool.getItemByClass("SpriteStyle",t)}}]),t}();e.SpriteStyle=u,(0,l.default)(u,"EMPTY",new u)},60558:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.TextStyle=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(97297),y=i(89761);var p=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,_.default)((0,u.default)(e),"italic",!1),e}return(0,o.default)(r,[{key:"reset",value:function(){return(0,h.default)((0,f.default)(r.prototype),"reset",this).call(this),this.italic=!1,this.align="left",this.wordWrap=!1,this.leading=0,this.padding=[0,0,0,0],this.bgColor=null,this.borderColor=null,this.asPassword=!1,this.stroke=0,this.strokeColor="#000000",this.bold=!1,this.underline=!1,this.underlineColor=null,this.currBitmapFont=null,this}},{key:"recover",value:function(){this!==r.EMPTY&&y.Pool.recover("TextStyle",this.reset())}},{key:"render",value:function(t,e,i,a){(this.bgColor||this.borderColor)&&e.drawRect(i-this.pivotX,a-this.pivotY,t.width,t.height,this.bgColor,this.borderColor,1)}}],[{key:"create",value:function(){return y.Pool.getItemByClass("TextStyle",r)}}]),r}(v.SpriteStyle);e.TextStyle=p,(0,_.default)(p,"EMPTY",new p)},42306:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.BlurFilterSetter=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(15092),v=i(39168),y=i(89432);var p=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,f.default)((0,o.default)(t),"_strength",4),t._filter=new v.BlurFilter(t.strength),t}return(0,l.default)(r,[{key:"buildFilter",value:function(){this._filter=new v.BlurFilter(this.strength),(0,u.default)((0,d.default)(r.prototype),"buildFilter",this).call(this)}},{key:"strength",get:function(){return this._strength},set:function(t){this._strength=t}}]),r}(_.FilterSetterBase);e.BlurFilterSetter=p,y.ClassUtils.regClass("laya.effect.BlurFilterSetter",p),y.ClassUtils.regClass("Laya.BlurFilterSetter",p)},27082:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ColorFilterSetter=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(15092),v=i(66356),y=i(53546),p=i(89432);var g=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,f.default)((0,o.default)(t),"_brightness",0),(0,f.default)((0,o.default)(t),"_contrast",0),(0,f.default)((0,o.default)(t),"_saturation",0),(0,f.default)((0,o.default)(t),"_hue",0),(0,f.default)((0,o.default)(t),"_red",0),(0,f.default)((0,o.default)(t),"_green",0),(0,f.default)((0,o.default)(t),"_blue",0),(0,f.default)((0,o.default)(t),"_alpha",0),t._filter=new v.ColorFilter,t}return(0,l.default)(r,[{key:"buildFilter",value:function(){this._filter.reset(),this._filter.color(this.red,this.green,this.blue,this.alpha),this._filter.adjustHue(this.hue),this._filter.adjustContrast(this.contrast),this._filter.adjustBrightness(this.brightness),this._filter.adjustSaturation(this.saturation),(0,u.default)((0,d.default)(r.prototype),"buildFilter",this).call(this)}},{key:"brightness",get:function(){return this._brightness},set:function(t){this._brightness=t,this.paramChanged()}},{key:"contrast",get:function(){return this._contrast},set:function(t){this._contrast=t,this.paramChanged()}},{key:"saturation",get:function(){return this._saturation},set:function(t){this._saturation=t,this.paramChanged()}},{key:"hue",get:function(){return this._hue},set:function(t){this._hue=t,this.paramChanged()}},{key:"red",get:function(){return this._red},set:function(t){this._red=t,this.paramChanged()}},{key:"green",get:function(){return this._green},set:function(t){this._green=t,this.paramChanged()}},{key:"blue",get:function(){return this._blue},set:function(t){this._blue=t,this.paramChanged()}},{key:"color",get:function(){return this._color},set:function(t){var e;this._color=t,e=y.ColorUtils.create(t),this._red=255*e.arrColor[0],this._green=255*e.arrColor[1],this._blue=255*e.arrColor[2],this.paramChanged()}},{key:"alpha",get:function(){return this._alpha},set:function(t){this._alpha=t,this.paramChanged()}}]),r}(_.FilterSetterBase);e.ColorFilterSetter=g,p.ClassUtils.regClass("laya.effect.ColorFilterSetter",g),p.ClassUtils.regClass("Laya.ColorFilterSetter",g)},15092:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.FilterSetterBase=void 0;var r=n(i(81643)),s=n(i(87368)),l=n(i(28146)),o=i(14827),u=i(11179),h=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,[{key:"paramChanged",value:function(){o.Laya.systemTimer.callLater(this,this.buildFilter)}},{key:"buildFilter",value:function(){this._target&&this.addFilter(this._target)}},{key:"addFilter",value:function(t){var e;t&&(t.filters?(e=t.filters,(0,r.default)(e).call(e,this._filter)<0&&(e.push(this._filter),t.filters=u.Utils.copyArray([],e))):t.filters=[this._filter])}},{key:"removeFilter",value:function(t){t&&(t.filters=null)}},{key:"target",set:function(t){this._target!=t&&(this._target=t,this.paramChanged())}}]),t}();e.FilterSetterBase=h},98767:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.GlowFilterSetter=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(15092),v=i(33452),y=i(89432);var p=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,f.default)((0,o.default)(t),"_color","#ff0000"),(0,f.default)((0,o.default)(t),"_blur",4),(0,f.default)((0,o.default)(t),"_offX",6),(0,f.default)((0,o.default)(t),"_offY",6),t._filter=new v.GlowFilter(t._color),t}return(0,l.default)(r,[{key:"buildFilter",value:function(){this._filter=new v.GlowFilter(this.color,this.blur,this.offX,this.offY),(0,u.default)((0,d.default)(r.prototype),"buildFilter",this).call(this)}},{key:"color",get:function(){return this._color},set:function(t){this._color=t,this.paramChanged()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this.paramChanged()}},{key:"offX",get:function(){return this._offX},set:function(t){this._offX=t,this.paramChanged()}},{key:"offY",get:function(){return this._offY},set:function(t){this._offY=t,this.paramChanged()}}]),r}(_.FilterSetterBase);e.GlowFilterSetter=p,y.ClassUtils.regClass("laya.effect.GlowFilterSetter",p),y.ClassUtils.regClass("Laya.GlowFilterSetter",p)},63969:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Event=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(91020),u=i(93561),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"setTo",value:function(t,e,i){return this.type=t,this.currentTarget=e,this.target=i,this}},{key:"stopPropagation",value:function(){this._stoped=!0}},{key:"touches",get:function(){if(!this.nativeEvent)return null;var t=this.nativeEvent.touches;if(t)for(var e=u.ILaya.stage,i=0,a=t.length;i<a;i++){var n=t[i],r=o.Point.TEMP;r.setTo(n.clientX,n.clientY),e._canvasTransform.invertTransformPoint(r),e.transform.invertTransformPoint(r),n.stageX=r.x,n.stageY=r.y}return t}},{key:"altKey",get:function(){return this.nativeEvent.altKey}},{key:"ctrlKey",get:function(){return this.nativeEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.nativeEvent.shiftKey}},{key:"charCode",get:function(){return this.nativeEvent.charCode}},{key:"keyLocation",get:function(){return this.nativeEvent.location||this.nativeEvent.keyLocation}},{key:"stageX",get:function(){return u.ILaya.stage.mouseX}},{key:"stageY",get:function(){return u.ILaya.stage.mouseY}}]),t}();e.Event=h,(0,l.default)(h,"EMPTY",new h),(0,l.default)(h,"MOUSE_DOWN","mousedown"),(0,l.default)(h,"MOUSE_UP","mouseup"),(0,l.default)(h,"CLICK","click"),(0,l.default)(h,"RIGHT_MOUSE_DOWN","rightmousedown"),(0,l.default)(h,"RIGHT_MOUSE_UP","rightmouseup"),(0,l.default)(h,"RIGHT_CLICK","rightclick"),(0,l.default)(h,"MOUSE_MOVE","mousemove"),(0,l.default)(h,"MOUSE_OVER","mouseover"),(0,l.default)(h,"MOUSE_OUT","mouseout"),(0,l.default)(h,"MOUSE_WHEEL","mousewheel"),(0,l.default)(h,"ROLL_OVER","mouseover"),(0,l.default)(h,"ROLL_OUT","mouseout"),(0,l.default)(h,"DOUBLE_CLICK","doubleclick"),(0,l.default)(h,"CHANGE","change"),(0,l.default)(h,"CHANGED","changed"),(0,l.default)(h,"RESIZE","resize"),(0,l.default)(h,"ADDED","added"),(0,l.default)(h,"REMOVED","removed"),(0,l.default)(h,"DISPLAY","display"),(0,l.default)(h,"UNDISPLAY","undisplay"),(0,l.default)(h,"ERROR","error"),(0,l.default)(h,"COMPLETE","complete"),(0,l.default)(h,"LOADED","loaded"),(0,l.default)(h,"READY","ready"),(0,l.default)(h,"PROGRESS","progress"),(0,l.default)(h,"INPUT","input"),(0,l.default)(h,"RENDER","render"),(0,l.default)(h,"OPEN","open"),(0,l.default)(h,"MESSAGE","message"),(0,l.default)(h,"CLOSE","close"),(0,l.default)(h,"KEY_DOWN","keydown"),(0,l.default)(h,"KEY_PRESS","keypress"),(0,l.default)(h,"KEY_UP","keyup"),(0,l.default)(h,"FRAME","enterframe"),(0,l.default)(h,"DRAG_START","dragstart"),(0,l.default)(h,"DRAG_MOVE","dragmove"),(0,l.default)(h,"DRAG_END","dragend"),(0,l.default)(h,"ENTER","enter"),(0,l.default)(h,"SELECT","select"),(0,l.default)(h,"BLUR","blur"),(0,l.default)(h,"FOCUS","focus"),(0,l.default)(h,"VISIBILITY_CHANGE","visibilitychange"),(0,l.default)(h,"FOCUS_CHANGE","focuschange"),(0,l.default)(h,"PLAYED","played"),(0,l.default)(h,"PAUSED","paused"),(0,l.default)(h,"STOPPED","stopped"),(0,l.default)(h,"START","start"),(0,l.default)(h,"END","end"),(0,l.default)(h,"COMPONENT_ADDED","componentadded"),(0,l.default)(h,"COMPONENT_REMOVED","componentremoved"),(0,l.default)(h,"RELEASED","released"),(0,l.default)(h,"LINK","link"),(0,l.default)(h,"LABEL","label"),(0,l.default)(h,"FULL_SCREEN_CHANGE","fullscreenchange"),(0,l.default)(h,"DEVICE_LOST","devicelost"),(0,l.default)(h,"TRANSFORM_CHANGED","transformchanged"),(0,l.default)(h,"ANIMATION_CHANGED","animationchanged"),(0,l.default)(h,"TRAIL_FILTER_CHANGE","trailfilterchange"),(0,l.default)(h,"TRIGGER_ENTER","triggerenter"),(0,l.default)(h,"TRIGGER_STAY","triggerstay"),(0,l.default)(h,"TRIGGER_EXIT","triggerexit")},65700:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.EventDispatcher=void 0;var s=r(i(92762)),l=r(i(13383)),o=r(i(78310)),u=r(i(82669)),h=r(i(87368)),c=r(i(28146)),d=r(i(17454)),f=i(35696);var _=function(){function t(){(0,h.default)(this,t)}return(0,c.default)(t,[{key:"hasListener",value:function(t){return!(!this._events||!this._events[t])}},{key:"event",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this._events||!this._events[t])return!1;var i=this._events[t];if(i.run)i.once&&delete this._events[t],null!=e?i.runWith(e):i.run();else{for(var a=0,n=i.length;a<n;a++){var r=i[a];r&&(null!=e?r.runWith(e):r.run()),r&&!r.once||((0,s.default)(i).call(i,a,1),a--,n--)}0===i.length&&this._events&&delete this._events[t]}return!0}},{key:"on",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._createListener(t,e,i,a,!1)}},{key:"once",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._createListener(t,e,i,a,!0)}},{key:"_createListener",value:function(t,e,i,a,n){var r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];r&&this.off(t,e,i,n);var s=v.create(e||this,i,a,n);this._events||(this._events={});var l=this._events;return l[t]?l[t].run?l[t]=[l[t],s]:l[t].push(s):l[t]=s,this}},{key:"off",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this._events||!this._events[t])return this;var n=this._events[t];if(null!=n)if(n.run)e&&n.caller!==e||null!=i&&n.method!==i||a&&!n.once||(delete this._events[t],n.recover());else{for(var r=0,s=0,l=n.length;s<l;s++){var o=n[s];o?!o||e&&o.caller!==e||null!=i&&o.method!==i||a&&!o.once||(r++,n[s]=null,o.recover()):r++}r===l&&delete this._events[t]}return this}},{key:"offAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this._events;if(!e)return this;if(t)this._recoverHandlers(e[t]),delete e[t];else{for(var i in e)this._recoverHandlers(e[i]);this._events=null}return this}},{key:"offAllCaller",value:function(t){if(t&&this._events)for(var e in this._events)this.off(e,t,null);return this}},{key:"_recoverHandlers",value:function(t){if(t)if(t.run)t.recover();else for(var e=t.length-1;e>-1;e--)t[e]&&(t[e].recover(),t[e]=null)}},{key:"isMouseEvent",value:function(e){return t.MOUSE_EVENTS[e]||!1}}]),t}();e.EventDispatcher=_,(0,d.default)(_,"MOUSE_EVENTS",{rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0});var v=function(t){(0,l.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,u.default)(e);if(i){var r=(0,u.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,o.default)(this,t)});function r(t,e,i,a){return(0,h.default)(this,r),n.call(this,t,e,i,a)}return(0,c.default)(r,[{key:"recover",value:function(){this._id>0&&(this._id=0,r._pool.push(this.clear()))}}],[{key:"create",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return r._pool.length?r._pool.pop().setTo(t,e,i,a):new r(t,e,i,a)}}]),r}(f.Handler);(0,d.default)(v,"_pool",[])},90512:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.KeyBoardManager=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(63969),u=i(93561),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"__init__",value:function(){t._addEvent("keydown"),t._addEvent("keypress"),t._addEvent("keyup")}},{key:"_addEvent",value:function(e){u.ILaya.Browser.document.addEventListener(e,(function(i){t._dispatch(i,e)}),!0)}},{key:"_dispatch",value:function(e,i){if(t.enabled){t._event._stoped=!1,t._event.nativeEvent=e,t._event.keyCode=e.keyCode||e.which||e.charCode,"keydown"===i?t._pressKeys[t._event.keyCode]=!0:"keyup"===i&&(t._pressKeys[t._event.keyCode]=null);for(var a=u.ILaya.stage.focus&&null!=u.ILaya.stage.focus.event&&u.ILaya.stage.focus.displayedInStage?u.ILaya.stage.focus:u.ILaya.stage,n=a;n;)n.event(i,t._event.setTo(i,n,a)),n=n.parent}}},{key:"hasKeyDown",value:function(e){return t._pressKeys[e]}}]),t}();e.KeyBoardManager=h,(0,l.default)(h,"_pressKeys",{}),(0,l.default)(h,"enabled",!0),(0,l.default)(h,"_event",new o.Event)},70153:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.MouseManager=void 0;var r=n(i(92762)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(63969),h=i(60810),c=i(85058),d=i(91020),f=i(63701),_=i(27175),v=i(93561),y=function(){function t(){(0,s.default)(this,t),(0,o.default)(this,"mouseX",0),(0,o.default)(this,"mouseY",0),(0,o.default)(this,"disableMouseEvent",!1),(0,o.default)(this,"mouseDownTime",0),(0,o.default)(this,"mouseMoveAccuracy",2),(0,o.default)(this,"_event",new u.Event),(0,o.default)(this,"_captureSp",null),(0,o.default)(this,"_captureChain",[]),(0,o.default)(this,"_captureExlusiveMode",!1),(0,o.default)(this,"_hitCaputreSp",!1),(0,o.default)(this,"_point",new d.Point),(0,o.default)(this,"_rect",new f.Rectangle),(0,o.default)(this,"_lastMoveTimer",0),(0,o.default)(this,"_prePoint",new d.Point),(0,o.default)(this,"_touchIDs",{}),(0,o.default)(this,"_curTouchID",NaN),(0,o.default)(this,"_id",1)}return(0,l.default)(t,[{key:"__init__",value:function(e,i){this._stage=e;var a=this;i.oncontextmenu=function(e){if(t.enabled)return!1},i.addEventListener("mousedown",(function(e){t.enabled&&(_.Browser.onIE||e.cancelable&&e.preventDefault(),a.mouseDownTime=_.Browser.now(),a.runEvent(e))})),i.addEventListener("mouseup",(function(e){t.enabled&&(e.cancelable&&e.preventDefault(),a.mouseDownTime=-_.Browser.now(),a.runEvent(e))}),!0),i.addEventListener("mousemove",(function(e){if(t.enabled){e.cancelable&&e.preventDefault();var i=_.Browser.now();if(i-a._lastMoveTimer<10)return;a._lastMoveTimer=i,a.runEvent(e)}}),!0),i.addEventListener("mouseout",(function(e){t.enabled&&a.runEvent(e)})),i.addEventListener("mouseover",(function(e){t.enabled&&a.runEvent(e)})),i.addEventListener("touchstart",(function(e){t.enabled&&(t._isFirstTouch||c.Input.isInputting||e.cancelable&&e.preventDefault(),a.mouseDownTime=_.Browser.now(),a.runEvent(e))})),i.addEventListener("touchend",(function(e){t.enabled?(t._isFirstTouch||c.Input.isInputting||e.cancelable&&e.preventDefault(),t._isFirstTouch=!1,a.mouseDownTime=-_.Browser.now(),a.runEvent(e)):a._curTouchID=NaN}),!0),i.addEventListener("touchmove",(function(e){t.enabled&&(e.cancelable&&e.preventDefault(),a.runEvent(e))}),!0),i.addEventListener("touchcancel",(function(e){t.enabled?(e.cancelable&&e.preventDefault(),a.runEvent(e)):a._curTouchID=NaN}),!0),i.addEventListener("mousewheel",(function(e){t.enabled&&a.runEvent(e)})),i.addEventListener("DOMMouseScroll",(function(e){t.enabled&&a.runEvent(e)}))}},{key:"initEvent",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this;a._event._stoped=!1,a._event.nativeEvent=i||t,a._target=null,this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY),this._stage._canvasTransform&&(this._stage._canvasTransform.invertTransformPoint(this._point),a.mouseX=this._point.x,a.mouseY=this._point.y),a._event.touchId=t.identifier||0,this._tTouchID=a._event.touchId,(e=h.TouchManager.I._event)._stoped=!1,e.nativeEvent=a._event.nativeEvent,e.touchId=a._event.touchId}},{key:"checkMouseWheel",value:function(t){this._event.delta=t.wheelDelta?.025*t.wheelDelta:-t.detail;for(var e=h.TouchManager.I.getLastOvers(),i=0,a=e.length;i<a;i++){var n=e[i];n.event(u.Event.MOUSE_WHEEL,this._event.setTo(u.Event.MOUSE_WHEEL,n,this._target))}}},{key:"onMouseMove",value:function(t){h.TouchManager.I.onMouseMove(t,this._tTouchID)}},{key:"onMouseDown",value:function(t){if(c.Input.isInputting&&v.ILaya.stage.focus&&v.ILaya.stage.focus.focus&&!v.ILaya.stage.focus.contains(this._target)){var e=v.ILaya.stage.focus._tf||v.ILaya.stage.focus,i=t._tf||t;i instanceof c.Input&&i.multiline==e.multiline?e._focusOut():e.focus=!1}h.TouchManager.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)}},{key:"onMouseUp",value:function(t){h.TouchManager.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)}},{key:"check",value:function(t,e,i,a){this._point.setTo(e,i),t.fromParentPoint(this._point),e=this._point.x,i=this._point.y;var n=t._style.scrollRect;if(n&&(this._rect.setTo(n.x,n.y,n.width,n.height),!this._rect.contains(e,i)))return!1;if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,i))return!1;for(var r=t._children.length-1;r>-1;r--){var s=t._children[r];if(!s.destroyed&&s._mouseState>1&&s._visible&&this.check(s,e,i,a))return!0}for(r=t._extUIChild.length-1;r>=0;r--){var l=t._extUIChild[r];if(!l.destroyed&&l._mouseState>1&&l._visible&&this.check(l,e,i,a))return!0}}var o=!(!t.hitTestPrior||t.mouseThrough||this.disableMouseEvent)||this.hitTest(t,e,i);return o?(this._target=t,a.call(this,t),this._target==this._hitCaputreSp&&(this._hitCaputreSp=!0)):a===this.onMouseUp&&t===this._stage&&(this._target=this._stage,a.call(this,this._target)),o}},{key:"hitTest",value:function(t,e,i){var a=!1;t.scrollRect&&(e-=t._style.scrollRect.x,i-=t._style.scrollRect.y);var n=t._style.hitArea;return n&&n._hit?n.contains(e,i):((t.width>0&&t.height>0||t.mouseThrough||n)&&(a=t.mouseThrough?t.getGraphicBounds().contains(e,i):(n||this._rect.setTo(0,0,t.width,t.height)).contains(e,i)),a)}},{key:"_checkAllBaseUI",value:function(t,e,i){var a=this.handleExclusiveCapture(this.mouseX,this.mouseY,i);return!!a||(a=this.check(this._stage,this.mouseX,this.mouseY,i),this.handleCapture(this.mouseX,this.mouseY,i)||a)}},{key:"check3DUI",value:function(t,e,i){for(var a=this._stage._3dUI,n=0,r=!1;n<a.length;n++){var s=a[n];this._stage._curUIBase=s,!s.destroyed&&s._mouseState>1&&s._visible&&(r=r||this.check(s,this.mouseX,this.mouseY,i))}return this._stage._curUIBase=this._stage,r}},{key:"handleExclusiveCapture",value:function(t,e,i){if(this._captureExlusiveMode&&this._captureSp&&this._captureChain.length>0){var a;this._point.setTo(t,e);for(var n=0;n<this._captureChain.length;n++)(a=this._captureChain[n]).fromParentPoint(this._point);return this._target=a,i.call(this,a),!0}return!1}},{key:"handleCapture",value:function(t,e,i){if(!this._hitCaputreSp&&this._captureSp&&this._captureChain.length>0){var a;this._point.setTo(t,e);for(var n=0;n<this._captureChain.length;n++)(a=this._captureChain[n]).fromParentPoint(this._point);return this._target=a,i.call(this,a),!0}return!1}},{key:"runEvent",value:function(e){var i,a,n;switch("mousemove"!==e.type&&(this._prePoint.x=this._prePoint.y=-1e6),e.type){case"mousedown":this._touchIDs[0]=this._id++,t._isTouchRespond?t._isTouchRespond=!1:(this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-e.clientX)+Math.abs(this._prePoint.y-e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=e.clientX,this._prePoint.y=e.clientY,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":t._isTouchRespond=!0,this._isLeftMouse=!0;var r=e.changedTouches;for(i=0,a=r.length;i<a;i++)n=r[i],(t.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=n.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[n.identifier]=this._id++,this.initEvent(n,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":t._isTouchRespond=!0,this._isLeftMouse=!0;var s=e.changedTouches;for(i=0,a=s.length;i<a;i++)n=s[i],(t.multiTouchEnabled||n.identifier==this._curTouchID)&&(this._curTouchID=NaN,this.initEvent(n,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null));break;case"touchmove":var l=e.changedTouches;for(i=0,a=l.length;i<a;i++)n=l[i],(t.multiTouchEnabled||n.identifier==this._curTouchID)&&(this.initEvent(n,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(e);break;case"mouseout":h.TouchManager.I.stageMouseOut();break;case"mouseover":this._stage.event(u.Event.MOUSE_OVER,this._event.setTo(u.Event.MOUSE_OVER,this._stage,this._stage))}}},{key:"setCapture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._captureSp=t,this._captureExlusiveMode=e,this._captureChain.length=0,this._captureChain.push(t);for(var i=t;;){var a;if(i==v.ILaya.stage)break;if(i==v.ILaya.stage._curUIBase)break;if(!(i=i.parent))break;(0,r.default)(a=this._captureChain).call(a,0,0,i)}}},{key:"releaseCapture",value:function(){console.log("release capture"),this._captureSp=null}}]),t}();e.MouseManager=y,(0,o.default)(y,"instance",new y),(0,o.default)(y,"enabled",!0),(0,o.default)(y,"multiTouchEnabled",!0),(0,o.default)(y,"_isFirstTouch",!0)},60810:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TouchManager=void 0;var r=n(i(92762)),s=n(i(81643)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(63969),c=i(27175),d=i(89761),f=i(93561),_=function(){function t(){(0,l.default)(this,t),(0,u.default)(this,"preOvers",[]),(0,u.default)(this,"preDowns",[]),(0,u.default)(this,"preRightDowns",[]),(0,u.default)(this,"enable",!0),(0,u.default)(this,"_event",new h.Event),(0,u.default)(this,"_lastClickTime",0)}return(0,o.default)(t,[{key:"_clearTempArrs",value:function(){t._oldArr.length=0,t._newArr.length=0,t._tEleArr.length=0}},{key:"getTouchFromArr",value:function(t,e){var i,a,n;for(a=e.length,i=0;i<a;i++)if((n=e[i]).id==t)return n;return null}},{key:"removeTouchFromArr",value:function(t,e){var i;for(i=e.length-1;i>=0;i--)e[i].id==t&&(0,r.default)(e).call(e,i,1)}},{key:"createTouchO",value:function(t,e){var i;return(i=d.Pool.getItem("TouchData")||{}).id=e,i.tar=t,i}},{key:"onMouseDown",value:function(e,i){var a,n,r,s,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.enable&&(a=this.getTouchFromArr(i,this.preOvers),r=this.getEles(e,null,t._tEleArr),a?a.tar=e:(n=this.createTouchO(e,i),this.preOvers.push(n)),c.Browser.onMobile&&this.sendEvents(r,h.Event.MOUSE_OVER),s=l?this.preDowns:this.preRightDowns,(a=this.getTouchFromArr(i,s))?a.tar=e:(n=this.createTouchO(e,i),s.push(n)),this.sendEvents(r,l?h.Event.MOUSE_DOWN:h.Event.RIGHT_MOUSE_DOWN),this._clearTempArrs())}},{key:"sendEvents",value:function(t,e){var i,a,n;for(a=t.length,this._event._stoped=!1,n=t[0],i=0;i<a;i++){var r=t[i];if(r.destroyed)return;if(r.event(e,this._event.setTo(e,r,n)),this._event._stoped)break}}},{key:"getEles",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(i?i.length=0:i=[];t&&t!=e;)i.push(t),t=t.parent;return i}},{key:"checkMouseOutAndOverOfMove",value:function(e,i){var a,n,l,o;if(i!=e)if(i.contains(e))n=this.getEles(e,i,t._tEleArr),this.sendEvents(n,h.Event.MOUSE_OVER);else if(e.contains(i))n=this.getEles(i,e,t._tEleArr),this.sendEvents(n,h.Event.MOUSE_OUT);else{var u,c,d;for((n=t._tEleArr).length=0,u=this.getEles(i,null,t._oldArr),c=this.getEles(e,null,t._newArr),o=u.length,l=0;l<o;l++){if(a=u[l],(d=(0,s.default)(c).call(c,a))>=0){(0,r.default)(c).call(c,d,c.length-d);break}n.push(a)}n.length>0&&this.sendEvents(n,h.Event.MOUSE_OUT),c.length>0&&this.sendEvents(c,h.Event.MOUSE_OVER)}}},{key:"onMouseMove",value:function(e,i){var a,n;this.enable&&((a=this.getTouchFromArr(i,this.preOvers))?(this.checkMouseOutAndOverOfMove(e,a.tar),a.tar=e,n=this.getEles(e,null,t._tEleArr)):(n=this.getEles(e,null,t._tEleArr),this.sendEvents(n,h.Event.MOUSE_OVER),this.preOvers.push(this.createTouchO(e,i))),this.sendEvents(n,h.Event.MOUSE_MOVE),this._clearTempArrs())}},{key:"getLastOvers",value:function(){return t._tEleArr.length=0,this.preOvers.length>0&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,t._tEleArr):(t._tEleArr.push(f.ILaya.stage),t._tEleArr)}},{key:"stageMouseOut",value:function(){var t;t=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(t,h.Event.MOUSE_OUT)}},{key:"onMouseUp",value:function(e,i){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.enable){var n,r,l,o,u,f,_,v,y=c.Browser.onMobile;if(r=this.getEles(e,null,t._tEleArr),this.sendEvents(r,a?h.Event.MOUSE_UP:h.Event.RIGHT_MOUSE_UP),v=a?this.preDowns:this.preRightDowns,n=this.getTouchFromArr(i,v)){var p,g=c.Browser.now();if(p=g-this._lastClickTime<300,this._lastClickTime=g,e==n.tar)_=r;else for(l=this.getEles(n.tar,null,t._oldArr),(_=t._newArr).length=0,u=l.length,o=0;o<u;o++)f=l[o],(0,s.default)(r).call(r,f)>=0&&_.push(f);_.length>0&&this.sendEvents(_,a?h.Event.CLICK:h.Event.RIGHT_CLICK),a&&p&&this.sendEvents(_,h.Event.DOUBLE_CLICK),this.removeTouchFromArr(i,v),n.tar=null,d.Pool.recover("TouchData",n)}(n=this.getTouchFromArr(i,this.preOvers))&&y&&((_=this.getEles(n.tar,null,_))&&_.length>0&&this.sendEvents(_,h.Event.MOUSE_OUT),this.removeTouchFromArr(i,this.preOvers),n.tar=null,d.Pool.recover("TouchData",n)),this._clearTempArrs()}}}]),t}();e.TouchManager=_,(0,u.default)(_,"I",new _),(0,u.default)(_,"_oldArr",[]),(0,u.default)(_,"_newArr",[]),(0,u.default)(_,"_tEleArr",[])},39168:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.BlurFilter=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(34981),_=i(43170);var v=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return(0,s.default)(this,r),t=n.call(this),(0,d.default)((0,o.default)(t),"strength_sig2_2sig2_gauss1",[]),t.strength=e,t._glRender=new _.BlurFilterGLRender,t}return(0,l.default)(r,[{key:"type",get:function(){return f.Filter.BLUR}},{key:"getStrenth_sig2_2sig2_native",value:function(){this.strength_sig2_native||(this.strength_sig2_native=new Float32Array(4));var t=this.strength/3,e=t*t;return this.strength_sig2_native[0]=this.strength,this.strength_sig2_native[1]=e,this.strength_sig2_native[2]=2*e,this.strength_sig2_native[3]=1/(2*Math.PI*e),this.strength_sig2_native}}]),r}(f.Filter);e.BlurFilter=v},43170:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BlurFilterGLRender=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(34981),u=i(5866),h=i(54347),c=i(54642),d=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"render",value:function(t,e,i,a,n){var r=c.Value2D.create(h.ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(r,n,t.width,t.height),e.drawTarget(t,0,0,i,a,u.Matrix.EMPTY.identity(),r)}},{key:"setShaderInfo",value:function(e,i,a,n){e.defines.add(o.Filter.BLUR);var r=e;t.blurinfo[0]=a,t.blurinfo[1]=n,r.blurInfo=t.blurinfo;var s=i.strength/3,l=s*s;i.strength_sig2_2sig2_gauss1[0]=i.strength,i.strength_sig2_2sig2_gauss1[1]=l,i.strength_sig2_2sig2_gauss1[2]=2*l,i.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*l),r.strength_sig2_2sig2_gauss1=i.strength_sig2_2sig2_gauss1}}]),t}();e.BlurFilterGLRender=d,(0,l.default)(d,"blurinfo",new Array(2))},66356:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ColorFilter=void 0;var s=r(i(77766)),l=r(i(3649)),o=r(i(87368)),u=r(i(28146)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(34981),v=i(53546);var y=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,o.default)(this,r),t=n.call(this),e||(e=t._copyMatrix(r.IDENTITY_MATRIX)),t._mat=new Float32Array(16),t._alpha=new Float32Array(4),t.setByMatrix(e),t}return(0,u.default)(r,[{key:"gray",value:function(){return this.setByMatrix(r.GRAY_MATRIX)}},{key:"color",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.setByMatrix([1,0,0,0,t,0,1,0,0,e,0,0,1,0,i,0,0,0,1,a])}},{key:"setColor",value:function(t){var e=v.ColorUtils.create(t).arrColor,i=[0,0,0,0,256*e[0],0,0,0,0,256*e[1],0,0,0,0,256*e[2],0,0,0,1,0];return this.setByMatrix(i)}},{key:"setByMatrix",value:function(t){this._matrix!=t&&this._copyMatrix(t);for(var e=0,i=0,a=0;a<20;a++)a%5!=4?this._mat[e++]=t[a]:this._alpha[i++]=t[a];return this}},{key:"type",get:function(){return _.Filter.COLOR}},{key:"adjustColor",value:function(t,e,i,a){return this.adjustHue(a),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i),this}},{key:"adjustBrightness",value:function(t){return 0==(t=this._clampValue(t,100))||isNaN(t)?this:this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustContrast",value:function(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e,i=(e=t<0?127+t/100*127:127*(e=0==(e=t%1)?r.DELTA_INDEX[t]:r.DELTA_INDEX[t<<0]*(1-e)+r.DELTA_INDEX[1+(t<<0)]*e)+127)/127,a=.5*(127-e);return this._multiplyMatrix([i,0,0,0,a,0,i,0,0,a,0,0,i,0,a,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustSaturation",value:function(t){if(0==(t=this._clampValue(t,100))||isNaN(t))return this;var e=1+(t>0?3*t/100:t/100),i=1-e,a=.3086*i,n=.6094*i,r=.082*i;return this._multiplyMatrix([a+e,n,r,0,0,a,n+e,r,0,0,a,n,r+e,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustHue",value:function(t){if(0==(t=this._clampValue(t,180)/180*Math.PI)||isNaN(t))return this;var e=Math.cos(t),i=Math.sin(t),a=.213,n=.715,r=.072;return this._multiplyMatrix([a+e*(1-a)+i*-a,n+e*-n+i*-n,r+e*-r+i*(1-r),0,0,a+e*-a+.143*i,n+e*(1-n)+.14*i,r+e*-r+-.283*i,0,0,a+e*-a+-.787*i,n+e*-n+i*n,r+e*(1-r)+i*r,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"reset",value:function(){return this.setByMatrix(this._copyMatrix(r.IDENTITY_MATRIX))}},{key:"_multiplyMatrix",value:function(t){var e=[];this._matrix=this._fixMatrix(this._matrix);for(var i=0;i<5;i++){for(var a=0;a<5;a++)e[a]=this._matrix[a+5*i];for(a=0;a<5;a++){for(var n=0,r=0;r<5;r++)n+=t[a+5*r]*e[r];this._matrix[a+5*i]=n}}return this.setByMatrix(this._matrix)}},{key:"_clampValue",value:function(t,e){return Math.min(e,Math.max(-e,t))}},{key:"_fixMatrix",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==i?r.IDENTITY_MATRIX:(i.length<r.LENGTH?i=(0,s.default)(t=(0,l.default)(i).call(i,0,i.length)).call(t,(0,l.default)(e=r.IDENTITY_MATRIX).call(e,i.length,r.LENGTH)):i.length>r.LENGTH&&(i=(0,l.default)(i).call(i,0,r.LENGTH)),i)}},{key:"_copyMatrix",value:function(t){var e=r.LENGTH;this._matrix||(this._matrix=[]);for(var i=0;i<e;i++)this._matrix[i]=t[i];return this._matrix}}]),r}(_.Filter);e.ColorFilter=y,(0,f.default)(y,"DELTA_INDEX",[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10]),(0,f.default)(y,"GRAY_MATRIX",[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),(0,f.default)(y,"IDENTITY_MATRIX",[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]),(0,f.default)(y,"LENGTH",25)},34981:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Filter=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(5866),u=i(91020),h=i(63701),c=i(43269),d=i(99474),f=i(14972),_=i(54347),v=i(54642),y=i(87328),p=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"type",get:function(){return-1}}]),t}();e.Filter=p,(0,l.default)(p,"BLUR",16),(0,l.default)(p,"COLOR",32),(0,l.default)(p,"GLOW",8),(0,l.default)(p,"_filter",(function(t,e,i,a){var n=e,r=this._next;if(r){var s=t.filters,l=s.length;if(1==l&&s[0].type==p.COLOR)return e.save(),e.setColorFilter(s[0]),r._fun.call(r,t,e,i,a),void e.restore();var g,m=v.Value2D.create(_.ShaderDefines2D.TEXTURE2D,0),x=u.Point.TEMP,T=n._curMat,k=o.Matrix.create();T.copyTo(k);var C=0,S=0,E=null,M=t._cacheStyle.filterCache||null;if(M&&0==t.getRepaint()){if(!!t._cacheStyle.hasGlowFilter&&(C=50,S=25),(g=t.getBounds()).width<=0||g.height<=0)return;g.width+=C,g.height+=C,x.x=g.x*k.a+g.y*k.c,x.y=g.y*k.d+g.x*k.b,g.x=x.x,g.y=x.y,x.x=g.width*k.a+g.height*k.c,x.y=g.height*k.d+g.width*k.b,g.width=x.x,g.height=x.y}else{t._isHaveGlowFilter()&&(C=50,S=25),(g=new h.Rectangle).copyFrom(t.getSelfBounds()),g.x+=t.x,g.y+=t.y,g.x-=t.pivotX+4,g.y-=t.pivotY+4;var L=g.x,b=g.y;if(g.width+=C+8,g.height+=C+8,x.x=g.x*k.a+g.y*k.c,x.y=g.y*k.d+g.x*k.b,g.x=x.x,g.y=x.y,x.x=g.width*k.a+g.height*k.c,x.y=g.height*k.d+g.width*k.b,g.width=x.x,g.height=x.y,g.width<=0||g.height<=0)return;M&&d.WebGLRTMgr.releaseRT(M),E=d.WebGLRTMgr.getRT(g.width,g.height);var I=M=d.WebGLRTMgr.getRT(g.width,g.height);t._getCacheStyle().filterCache=M,n.pushRT(),n.useRT(E);var R=t.x-L+S,w=t.y-b+S;r._fun.call(r,t,e,R,w),n.useRT(I);for(var A=0;A<l;A++){0!=A&&(n.useRT(E),n.drawTarget(I,0,0,g.width,g.height,o.Matrix.TEMP.identity(),m,null,f.BlendMode.TOINT.overlay),n.useRT(I));var B=s[A];switch(B.type){case p.BLUR:case p.GLOW:B._glRender&&B._glRender.render(E,e,g.width,g.height,B);break;case p.COLOR:n.setColorFilter(B),n.drawTarget(E,0,0,g.width,g.height,o.Matrix.EMPTY.identity(),v.Value2D.create(_.ShaderDefines2D.TEXTURE2D,0)),n.setColorFilter(null)}}n.popRT()}if(i=i-S-t.x,a=a-S-t.y,x.setTo(i,a),k.transformPoint(x),i=x.x+g.x,a=x.y+g.y,n._drawRenderTexture(M,i,a,g.width,g.height,o.Matrix.TEMP.identity(),1,c.RenderTexture2D.defuv),E){var D=y.SubmitCMD.create([E],(function(t){t.destroy()}),this);E=null,e.addRenderObject(D)}k.destroy()}}))},33452:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.GlowFilter=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(34981),_=i(52712),v=i(53546),y=i(39168);var p=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return(0,s.default)(this,r),e=n.call(this),(0,d.default)((0,o.default)(e),"_elements",new Float32Array(9)),(0,d.default)((0,o.default)(e),"_sv_blurInfo1",new Array(4)),(0,d.default)((0,o.default)(e),"_sv_blurInfo2",[0,0,1,0]),e._color=new v.ColorUtils(t),e.blur=Math.min(i,20),e.offX=a,e.offY=l,e._sv_blurInfo1[0]=e._sv_blurInfo1[1]=e.blur,e._sv_blurInfo1[2]=a,e._sv_blurInfo1[3]=-l,e._glRender=new _.GlowFilterGLRender,e}return(0,l.default)(r,[{key:"type",get:function(){return y.BlurFilter.GLOW}},{key:"offY",get:function(){return this._elements[6]},set:function(t){this._elements[6]=t,this._sv_blurInfo1[3]=-t}},{key:"offX",get:function(){return this._elements[5]},set:function(t){this._elements[5]=t,this._sv_blurInfo1[2]=t}},{key:"getColor",value:function(){return this._color.arrColor}},{key:"blur",get:function(){return this._elements[4]},set:function(t){this._elements[4]=t,this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=t}},{key:"getColorNative",value:function(){this._color_native||(this._color_native=new Float32Array(4));var t=this.getColor();return this._color_native[0]=t[0],this._color_native[1]=t[1],this._color_native[2]=t[2],this._color_native[3]=t[3],this._color_native}},{key:"getBlurInfo1Native",value:function(){return this._blurInof1_native||(this._blurInof1_native=new Float32Array(4)),this._blurInof1_native[0]=this._blurInof1_native[1]=this.blur,this._blurInof1_native[2]=this.offX,this._blurInof1_native[3]=this.offY,this._blurInof1_native}},{key:"getBlurInfo2Native",value:function(){return this._blurInof2_native||(this._blurInof2_native=new Float32Array(4)),this._blurInof2_native[2]=1,this._blurInof2_native}}]),r}(f.Filter);e.GlowFilter=p},52712:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.GlowFilterGLRender=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(5866),o=i(54347),u=i(54642),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"setShaderInfo",value:function(t,e,i,a){t.defines.add(a.type);var n=t;n.u_blurInfo1=a._sv_blurInfo1;var r=a._sv_blurInfo2;r[0]=e,r[1]=i,n.u_blurInfo2=r,n.u_color=a.getColor()}},{key:"render",value:function(t,e,i,a,n){var r=i,s=a,h=u.Value2D.create(o.ShaderDefines2D.TEXTURE2D,0);this.setShaderInfo(h,r,s,n);var c=u.Value2D.create(o.ShaderDefines2D.TEXTURE2D,0),d=l.Matrix.TEMP.identity();e.drawTarget(t,0,0,r,s,d,h),e.drawTarget(t,0,0,r,s,d,c)}}]),t}();e.GlowFilterGLRender=h},83488:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLBrElement=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(40118),o=i(11205),u=i(89761),h=i(98497),c=i(93561),d=i(89432),f=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"_addToLayout",value:function(t){t.push(this)}},{key:"reset",value:function(){return this}},{key:"destroy",value:function(){u.Pool.recover(l.HTMLElement.getClassName(this),this.reset())}},{key:"_setParent",value:function(t){}},{key:"parent",set:function(t){}},{key:"URI",set:function(t){}},{key:"href",set:function(t){}},{key:"_getCSSStyle",value:function(){return t.brStyle||(t.brStyle=new o.HTMLStyle,t.brStyle.setLineElement(!0),t.brStyle.block=!0),t.brStyle}},{key:"renderSelfToGraphic",value:function(t,e,i,a){}}]),t}();e.HTMLBrElement=f,h.IHtml.HTMLBrElement=f,c.ILaya.regClass(f),d.ClassUtils.regClass("laya.html.dom.HTMLBrElement",f),d.ClassUtils.regClass("Laya.HTMLBrElement",f)},80735:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLDivElement=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(53029),v=i(87210),y=i(63969),p=i(35696),g=i(98497),m=i(29877),x=i(89432);var T=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,f.default)((0,o.default)(t),"_recList",[]),(0,f.default)((0,o.default)(t),"_repaintState",0),t._element=new _.HTMLDivParser,t._element.repaintHandler=new p.Handler((0,o.default)(t),t._htmlDivRepaint),t.mouseEnabled=!0,t.on(y.Event.CLICK,(0,o.default)(t),t._onMouseClick),t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._element&&this._element.reset(),this._element=null,this._doClears(),(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t)}},{key:"_htmlDivRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this._repaintState<2&&(this._repaintState=2):this._repaintState<1&&(this._repaintState=1),this._repaintState>0&&this._setGraphicDirty()}},{key:"_updateGraphicWork",value:function(){switch(this._repaintState){case 1:this._updateGraphic();break;case 2:this._refresh()}}},{key:"_setGraphicDirty",value:function(){this.callLater(this._updateGraphicWork)}},{key:"_doClears",value:function(){if(this._recList){var t,e=this._recList.length;for(t=0;t<e;t++)this._recList[t].recover();this._recList.length=0}}},{key:"_updateGraphic",value:function(){this._doClears(),this.graphics.clear(!0),this._repaintState=0,this._element.drawToGraphic(this.graphics,-this._element.x,-this._element.y,this._recList);var t=this._element.getBounds();t&&this.setSelfBounds(t),this.size(t.width,t.height)}},{key:"style",get:function(){return this._element.style}},{key:"innerHTML",set:function(t){this._innerHTML!=t&&(this._repaintState=1,this._innerHTML=t,this._element.innerHTML=t,this._setGraphicDirty())}},{key:"_refresh",value:function(){this._repaintState=1,this._innerHTML&&(this._element.innerHTML=this._innerHTML),this._setGraphicDirty()}},{key:"width",get:function(){return this._element.width},set:function(t){this._element.width=t}},{key:"height",get:function(){return this._element.height},set:function(t){this._element.height=t}},{key:"contextWidth",get:function(){return this._element.contextWidth}},{key:"contextHeight",get:function(){return this._element.contextHeight}},{key:"_onMouseClick",value:function(){var t,e,i,a=this.mouseX,n=this.mouseY;for(e=this._recList.length,t=0;t<e;t++)(i=this._recList[t]).rec.contains(a,n)&&this._eventLink(i.href)}},{key:"_eventLink",value:function(t){this.event(y.Event.LINK,[t])}}]),r}(v.Sprite);e.HTMLDivElement=T,g.IHtml.HTMLDivElement=T,g.IHtml.HTMLParse=m.HTMLParse,x.ClassUtils.regClass("laya.html.dom.HTMLDivElement",T),x.ClassUtils.regClass("Laya.HTMLDivElement",T)},53029:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLDivParser=void 0;var s=r(i(77766)),l=r(i(78914)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(52605)),d=r(i(92135)),f=r(i(13383)),_=r(i(78310)),v=r(i(82669)),y=r(i(17454)),p=i(40118),g=i(13557),m=i(89765),x=i(11205),T=i(84491),k=i(63701),C=i(98497),S=i(93561),E=i(89432);var M=function(t){(0,f.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,_.default)(this,t)});function r(){var t,e;(0,o.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,y.default)((0,h.default)(e),"repaintHandler",null),e}return(0,u.default)(r,[{key:"reset",value:function(){return g.HTMLStyleElement,m.HTMLLinkElement,(0,d.default)((0,v.default)(r.prototype),"reset",this).call(this),this._style.block=!0,this._style.setLineElement(!0),this._style.width=200,this._style.height=200,this.repaintHandler=null,this.contextHeight=0,this.contextWidth=0,this}},{key:"innerHTML",set:function(t){this.destroyChildren(),this.appendHTML(t)}},{key:"width",get:function(){return this._width?this._width:this.contextWidth},set:function(t){var e;e=0===t?t!=this._width:t!=this.width,(0,c.default)((0,v.default)(r.prototype),"width",t,this,!0),e&&this.layout()}},{key:"appendHTML",value:function(t){C.IHtml.HTMLParse.parse(this,t,this.URI),this.layout()}},{key:"_addChildsToLayout",value:function(t){var e=this._getWords();if(null==e&&(!this._children||0==this._children.length))return!1;e&&(0,l.default)(e).call(e,(function(e){t.push(e)}));for(var i=!0,a=0,n=this._children.length;a<n;a++){var r=this._children[a];i?i=!1:t.push(null),r._addToLayout(t)}return!0}},{key:"_addToLayout",value:function(t){this.layout(),!this.style.absolute&&t.push(this)}},{key:"getBounds",value:function(){return this._htmlBounds?(this._boundsRec||(this._boundsRec=k.Rectangle.create()),this._boundsRec.copyFrom(this._htmlBounds)):null}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,d.default)((0,v.default)(r.prototype),"parentRepaint",this).call(this),this.repaintHandler&&this.repaintHandler.runWith(t)}},{key:"layout",value:function(){this.style._type|=x.HTMLStyle.ADDLAYOUTED;var t=T.Layout.layout(this);if(t){this._htmlBounds||(this._htmlBounds=k.Rectangle.create());var e=this._htmlBounds;e.x=e.y=0,e.width=this.contextWidth=t[0],e.height=this.contextHeight=t[1]}}},{key:"height",get:function(){return this._height?this._height:this.contextHeight},set:function(t){(0,c.default)((0,v.default)(r.prototype),"height",t,this,!0)}}]),r}(p.HTMLElement);e.HTMLDivParser=M,C.IHtml.HTMLDivParser=M,S.ILaya.regClass(M),E.ClassUtils.regClass("laya.html.dom.HTMLDivParser",M),E.ClassUtils.regClass("Laya.HTMLDivParser",M)},55573:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLDocument=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11205),u=i(89432),h=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"all",{}),(0,l.default)(this,"styleSheets",o.HTMLStyle.styleSheets)}return(0,s.default)(t,[{key:"getElementById",value:function(t){return this.all[t]}},{key:"setElementById",value:function(t,e){this.all[t]=e}}]),t}();e.HTMLDocument=h,(0,l.default)(h,"document",new h),u.ClassUtils.regClass("laya.html.dom.HTMLDocument",h),u.ClassUtils.regClass("Laya.HTMLDocument",h)},40118:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLElementType=e.HTMLElement=void 0;var r,s=n(i(78914)),l=n(i(92762)),o=n(i(31238)),u=n(i(94198)),h=n(i(81643)),c=n(i(87368)),d=n(i(28146)),f=n(i(17454)),_=i(55573),v=i(75503),y=i(11205),p=i(84491),g=i(70084),m=i(76869),x=i(89761),T=i(93561),k=i(98497),C=i(89432);e.HTMLElementType=r,function(t){t[t.BASE=0]="BASE",t[t.IMAGE=1]="IMAGE"}(r||(e.HTMLElementType=r={}));var S=function(){function t(){(0,c.default)(this,t),(0,f.default)(this,"eletype",r.BASE),this._creates(),this.reset()}return(0,d.default)(t,[{key:"_creates",value:function(){this._style=y.HTMLStyle.create()}},{key:"reset",value:function(){if(this.URI=null,this.parent=null,this._style.reset(),this._style.ower=this,this._style.valign="middle",this._text&&this._text.words){var e,i,a,n=this._text.words;for(i=n.length,e=0;e<i;e++)(a=n[e])&&a.recover()}return this._text=t._EMPTYTEXT,this._children&&(this._children.length=0),this._x=this._y=this._width=this._height=0,this}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"_addChildsToLayout",value:function(t){var e,i=this._getWords();if(null==i&&(!this._children||0==this._children.length))return!1;if(i)for(var a=0,n=i.length;a<n;a++)t.push(i[a]);return this._children&&(0,s.default)(e=this._children).call(e,(function(e,i,a){var n=e._style;n._enableLayout&&n._enableLayout()&&e._addToLayout(t)})),!0}},{key:"_addToLayout",value:function(t){if(this._style){var e=this._style;e.absolute||(e.block?t.push(this):this._addChildsToLayout(t)&&(this.x=this.y=0))}}},{key:"id",set:function(t){_.HTMLDocument.document.setElementById(t,this)}},{key:"repaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parentRepaint(t)}},{key:"parentRepaint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.parent&&this.parent.repaint(t)}},{key:"innerTEXT",get:function(){return this._text.text},set:function(e){this._text===t._EMPTYTEXT?this._text={text:e,words:null}:(this._text.text=e,this._text.words&&(this._text.words.length=0)),this.repaint()}},{key:"_setParent",value:function(e){if(e instanceof t){var i=e;this.URI||(this.URI=i.URI),this.style&&this.style.inherit(i.style)}}},{key:"appendChild",value:function(t){return this.addChild(t)}},{key:"addChild",value:function(t){return t.parent&&t.parent.removeChild(t),this._children||(this._children=[]),this._children.push(t),t.parent=this,t._setParent(this),this.repaint(),t}},{key:"removeChild",value:function(t){if(!this._children)return null;var e,i;for(i=this._children.length,e=0;e<i;e++){var a;if(this._children[e]==t)return(0,l.default)(a=this._children).call(a,e,1),t}return null}},{key:"destroy",value:function(){this._children&&(this.destroyChildren(),this._children.length=0),x.Pool.recover(t.getClassName(this),this.reset())}},{key:"destroyChildren",value:function(){if(this._children){for(var t=this._children.length-1;t>-1;t--)this._children[t].destroy();this._children.length=0}}},{key:"style",get:function(){return this._style}},{key:"_getWords",value:function(){if(!this._text)return null;var t=this._text.text;if(!t||0===t.length)return null;var e,i=this._text.words;if(i&&i.length===t.length)return i;null===i&&(this._text.words=i=[]),i.length=t.length;for(var a=this.style,n=a.font,r=0,s=t.length;r<s;r++)e=T.ILaya.Browser.measureText(t.charAt(r),n),i[r]=m.HTMLChar.create().setData(t.charAt(r),e.width,e.height||a.fontSize,a);return i}},{key:"_isChar",value:function(){return!1}},{key:"_layoutLater",value:function(){var t=this.style;t._type&y.HTMLStyle.ADDLAYOUTED||(t.widthed(this)&&(this._children&&this._children.length>0||null!=this._getWords())&&t.block?(p.Layout.later(this),t._type|=y.HTMLStyle.ADDLAYOUTED):this.parent&&this.parent._layoutLater())}},{key:"x",get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.parentRepaint())}},{key:"y",get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.parentRepaint())}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.repaint())}},{key:"height",get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this.repaint())}},{key:"_setAttributes",value:function(t,e){switch(t){case"style":this.style.cssText(e);break;case"class":this.className=e;break;case"x":this.x=(0,o.default)(e);break;case"y":this.y=(0,o.default)(e);break;case"width":this.width=(0,o.default)(e);break;case"height":this.height=(0,o.default)(e);break;default:this[t]=e}}},{key:"href",get:function(){return this._style?this._style.href:null},set:function(t){this._style&&t!=this._style.href&&(this._style.href=t,this.repaint())}},{key:"formatURL",value:function(e){return this.URI?t.formatURL1(e,this.URI?this.URI.path:null):e}},{key:"color",set:function(t){this.style.color=t}},{key:"className",set:function(t){this.style.attrs(_.HTMLDocument.document.styleSheets["."+t])}},{key:"drawToGraphic",value:function(t,e,i,a){e+=this.x,i+=this.y;var n,r,s,l=this.style;if(l.paddingLeft&&(e+=l.paddingLeft),l.paddingTop&&(i+=l.paddingTop),(null!=l.bgColor||l.borderColor)&&t.drawRect(e,i,this.width,this.height,l.bgColor,l.borderColor,1),this.renderSelfToGraphic(t,e,i,a),this._children&&this._children.length>0)for(r=this._children.length,n=0;n<r;n++)null!=(s=this._children[n]).drawToGraphic&&s.drawToGraphic(t,e,i,a)}},{key:"renderSelfToGraphic",value:function(t,e,i,a){var n=this.style,r=this._getWords();if(r&&(r.length,n)){var s=n.font,l=n.color;if(n.stroke){var o=n.stroke;o=(0,u.default)(o);var h=n.strokeColor;t.fillBorderWords(r,e,i,s,l,h,o)}else t.fillWords(r,e,i,s,l);if(this.href){var c=r[r.length-1],d=c.y+c.height;if(c.y==r[0].y){"none"!=n.textDecoration&&t.drawLine(r[0].x,d,c.x+c.width,d,l,1);var f=v.HTMLHitRect.create();f.rec.setTo(r[0].x,c.y,c.x+c.width-r[0].x,c.height),f.href=this.href,a.push(f)}else this.workLines(r,t,a)}}}},{key:"workLines",value:function(t,e,i){var a;a="none"!=this.style.textDecoration;var n,r,s,l=0;if(n=t.length,s=r=t[l],r){var o;for(l=1;l<n;l++)(o=t[l]).y!=r.y?(this.createOneLine(r,s,a,e,i),r=o,s=o):s=o;this.createOneLine(r,s,a,e,i)}}},{key:"createOneLine",value:function(t,e,i,a,n){var r=e.y+e.height;i&&a.drawLine(t.x,r,e.x+e.width,r,this.style.color,1);var s=v.HTMLHitRect.create();s.rec.setTo(t.x,e.y,e.x+e.width-t.x,e.height),s.href=this.href,n.push(s)}}],[{key:"formatURL1",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return"null path";if(e||(e=g.URL.basePath),(0,h.default)(t).call(t,":")>0)return t;if(null!=g.URL.customFormat&&(t=g.URL.customFormat(t)),(0,h.default)(t).call(t,":")>0)return t;var i=t.charAt(0);if("."===i)return g.URL._formatRelativePath(e+t);if("~"===i)return g.URL.rootPath+t.substring(1);if("d"===i){if(0===(0,h.default)(t).call(t,"data:image"))return t}else if("/"===i)return t;return e+t}},{key:"getClassName",value:function(t){return t instanceof Function?t.name:t.constructor.name}}]),t}();e.HTMLElement=S,(0,f.default)(S,"_EMPTYTEXT",{text:null,words:null}),T.ILaya.regClass(S),k.IHtml.HTMLElementType=r,C.ClassUtils.regClass("laya.html.dom.HTMLElement",S),C.ClassUtils.regClass("Laya.HTMLElement",S)},75503:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLHitRect=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(63701),o=i(89761),u=i(89432),h=function(){function t(){(0,r.default)(this,t),this.rec=new l.Rectangle,this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){return this.rec.reset(),this.href=null,this}},{key:"recover",value:function(){o.Pool.recover("HTMLHitRect",this.reset())}}],[{key:"create",value:function(){return o.Pool.getItemByClass("HTMLHitRect",t)}}]),t}();e.HTMLHitRect=h,u.ClassUtils.regClass("laya.html.dom.HTMLHitRect",h),u.ClassUtils.regClass("Laya.HTMLHitRect",h)},46150:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLImageElement=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=i(40118),f=i(63969),_=i(84581),v=i(29148),y=i(98497),p=i(93561),g=i(89432);var m=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t;return(0,s.default)(this,r),(t=n.call(this)).eletype=d.HTMLElementType.IMAGE,t}return(0,l.default)(r,[{key:"reset",value:function(){return(0,o.default)((0,c.default)(r.prototype),"reset",this).call(this),this._tex&&this._tex.off(f.Event.LOADED,this,this.onloaded),this._tex=null,this._url=null,this}},{key:"src",set:function(t){if(t=this.formatURL(t),this._url!==t){this._url=t;var e=this._tex=_.Loader.getRes(t);e||(this._tex=e=new v.Texture,e.load(t),_.Loader.cacheTexture(t,e)),e.getIsReady()?this.onloaded():e.once(f.Event.READY,this,this.onloaded)}}},{key:"onloaded",value:function(){if(this._style){var t=this._style;t.widthed(this)||this._tex.width,t.heighted(this)||this._tex.height,t.widthed(this)||this._width==this._tex.width||(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),t.heighted(this)||this._height==this._tex.height||(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),this.repaint()}}},{key:"_addToLayout",value:function(t){!this._style.absolute&&t.push(this)}},{key:"renderSelfToGraphic",value:function(t,e,i,a){this._tex&&t.drawImage(this._tex,e,i,this.width||this._tex.width,this.height||this._tex.height)}}]),r}(d.HTMLElement);e.HTMLImageElement=m,y.IHtml.HTMLImageElement=m,p.ILaya.regClass(m),g.ClassUtils.regClass("laya.html.dom.HTMLImageElement",m),g.ClassUtils.regClass("Laya.HTMLImageElement",m)},89765:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLLinkElement=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(40118),_=i(84581),v=i(63969),y=i(11205),p=i(70084),g=i(93561),m=i(89432);var x=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"_creates",value:function(){}},{key:"drawToGraphic",value:function(t,e,i,a){}},{key:"reset",value:function(){return this._loader&&this._loader.off(v.Event.COMPLETE,this,this._onload),this._loader=null,this}},{key:"_onload",value:function(t){this._loader&&(this._loader=null),"text/css"===this.type&&y.HTMLStyle.parseCSS(t,this.URI),this.repaint(!0)}},{key:"href",get:function(){return(0,o.default)((0,c.default)(r.prototype),"href",this)},set:function(t){t&&(t=this.formatURL(t),this.URI=new p.URL(t),this._loader&&this._loader.off(v.Event.COMPLETE,this,this._onload),_.Loader.getRes(t)?"text/css"==this.type&&y.HTMLStyle.parseCSS(_.Loader.getRes(t),this.URI):(this._loader=new _.Loader,this._loader.once(v.Event.COMPLETE,this,this._onload),this._loader.load(t,_.Loader.TEXT)))}}]),r}(f.HTMLElement);e.HTMLLinkElement=x,(0,d.default)(x,"_cuttingStyle",new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")),g.ILaya.regClass(x),m.ClassUtils.regClass("laya.html.dom.HTMLLinkElement",x),m.ClassUtils.regClass("Laya.HTMLLinkElement",x)},13557:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLStyleElement=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=i(40118),f=i(11205),_=i(93561),v=i(89432);var y=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"_creates",value:function(){}},{key:"drawToGraphic",value:function(t,e,i,a){}},{key:"reset",value:function(){return this}},{key:"innerTEXT",get:function(){return(0,o.default)((0,c.default)(r.prototype),"innerTEXT",this)},set:function(t){f.HTMLStyle.parseCSS(t,null)}}]),r}(d.HTMLElement);e.HTMLStyleElement=y,_.ILaya.regClass(y),v.ClassUtils.regClass("laya.html.dom.HTMLStyleElement",y),v.ClassUtils.regClass("Laya.HTMLStyleElement",y)},42218:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLExtendStyle=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=i(89432),h=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"reset",value:function(){return this.stroke=0,this.strokeColor="#000000",this.leading=0,this.lineHeight=0,this.letterSpacing=0,this.href=null,this}},{key:"recover",value:function(){this!=t.EMPTY&&o.Pool.recover("HTMLExtendStyle",this.reset())}}],[{key:"create",value:function(){return o.Pool.getItemByClass("HTMLExtendStyle",t)}}]),t}();e.HTMLExtendStyle=h,(0,l.default)(h,"EMPTY",new h),u.ClassUtils.regClass("laya.html.utils.HTMLExtendStyle",h),u.ClassUtils.regClass("Laya.HTMLExtendStyle",h)},29877:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLParse=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(53029),u=i(40118),h=i(89761),c=i(89432),d=i(11179),f=i(98497),_=i(83488),v=i(13557),y=i(89765),p=i(46150),g=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getInstance",value:function(e){var i=h.Pool.getItem(t._htmlClassMapShort[e]);return i||(i=c.ClassUtils.getInstance(e)),i}},{key:"parse",value:function(e,i,a){i=(i="<root>"+(i=i.replace(/<br>/g,"<br/>"))+"</root>").replace(t.spacePattern,t.char255);var n=d.Utils.parseXMLFromString(i);t._parseXML(e,n.childNodes[0].childNodes,a)}},{key:"_parseXML",value:function(e,i,a){var n,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i.join||i.item)for(n=0,r=i.length;n<r;++n)t._parseXML(e,i[n],a,s);else{var l,o;if(3==i.nodeType){var h;if(e instanceof f.IHtml.HTMLDivParser)null==i.nodeName&&(i.nodeName="#text"),o=i.nodeName.toLowerCase(),(h=i.textContent.replace(/^\s+|\s+$/g,"")).length>0&&(l=t.getInstance(o))&&(e.addChild(l),l.innerTEXT=h.replace(t.char255AndOneSpacePattern," "));else if((h=i.textContent.replace(/^\s+|\s+$/g,"")).length>0){var c=e;if(e instanceof u.HTMLElement&&e.innerTEXT&&e.innerTEXT.length>0){var d=t.getInstance("p");d&&(e.addChild(d),c=d)}c.innerTEXT=h.replace(t.char255AndOneSpacePattern," ")}return}if("#comment"==(o=i.nodeName.toLowerCase()))return;if(l=t.getInstance(o)){"p"==o?(e.addChild(t.getInstance("br")),l=e.addChild(l),e.addChild(t.getInstance("br"))):l=e.addChild(l),l.URI=a,l.href=s;var _=i.attributes;if(_&&_.length>0)for(n=0,r=_.length;n<r;++n){var v=_[n],y=v.nodeName,p=v.value;l._setAttributes(y,p)}t._parseXML(l,i.childNodes,a,l.href)}else t._parseXML(e,i.childNodes,a,s)}}}]),t}();e.HTMLParse=g,(0,l.default)(g,"char255",String.fromCharCode(255)),(0,l.default)(g,"spacePattern",/&nbsp;|&#160;/g),(0,l.default)(g,"char255AndOneSpacePattern",new RegExp(String.fromCharCode(255)+"|(\\s+)","g")),(0,l.default)(g,"_htmlClassMapShort",{div:o.HTMLDivParser,p:u.HTMLElement,img:p.HTMLImageElement,span:u.HTMLElement,br:_.HTMLBrElement,style:v.HTMLStyleElement,font:u.HTMLElement,a:u.HTMLElement,"#text":u.HTMLElement,link:y.HTMLLinkElement}),f.IHtml.HTMLParse=g,c.ClassUtils.regClass("div",o.HTMLDivParser),c.ClassUtils.regClass("p",u.HTMLElement),c.ClassUtils.regClass("img",p.HTMLImageElement),c.ClassUtils.regClass("span",u.HTMLElement),c.ClassUtils.regClass("br",_.HTMLBrElement),c.ClassUtils.regClass("style",v.HTMLStyleElement),c.ClassUtils.regClass("font",u.HTMLElement),c.ClassUtils.regClass("a",u.HTMLElement),c.ClassUtils.regClass("#text",u.HTMLElement),c.ClassUtils.regClass("link",y.HTMLLinkElement),c.ClassUtils.regClass("laya.html.utils.HTMLParse",g),c.ClassUtils.regClass("Laya.HTMLParse",g)},11205:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLStyle=void 0;var r=n(i(81643)),s=n(i(94198)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(42218),c=i(93561),d=i(89761),f=i(89432),_=function(){function t(){(0,l.default)(this,t),(0,u.default)(this,"padding",t._PADDING),this.reset()}return(0,o.default)(t,[{key:"_getExtendStyle",value:function(){return this._extendStyle===h.HTMLExtendStyle.EMPTY&&(this._extendStyle=h.HTMLExtendStyle.create()),this._extendStyle}},{key:"href",get:function(){return this._extendStyle.href},set:function(t){t!==this._extendStyle.href&&(this._getExtendStyle().href=t)}},{key:"stroke",get:function(){return this._extendStyle.stroke},set:function(t){this._extendStyle.stroke!==t&&(this._getExtendStyle().stroke=t)}},{key:"strokeColor",get:function(){return this._extendStyle.strokeColor},set:function(t){this._extendStyle.strokeColor!==t&&(this._getExtendStyle().strokeColor=t)}},{key:"leading",get:function(){return this._extendStyle.leading},set:function(t){this._extendStyle.leading!==t&&(this._getExtendStyle().leading=t)}},{key:"lineHeight",get:function(){return this._extendStyle.lineHeight},set:function(t){this._extendStyle.lineHeight!==t&&(this._getExtendStyle().lineHeight=t)}},{key:"align",get:function(){var e=this._type&t._ALIGN;return t.align_Value[e]},set:function(e){e in t.alignVDic&&(this._type&=~t._ALIGN,this._type|=t.alignVDic[e])}},{key:"valign",get:function(){var e=this._type&t._VALIGN;return t.vAlign_Value[e]},set:function(e){e in t.alignVDic&&(this._type&=~t._VALIGN,this._type|=t.alignVDic[e])}},{key:"font",get:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(c.ILaya.Browser.onIPhone&&c.ILaya.Text.fontFamilyMap[this.family]||this.family)},set:function(t){for(var e=t.split(" "),i=0,a=e.length;i<a;i++){var n=e[i];switch(n){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}(0,r.default)(n).call(n,"px")>0&&(this.fontSize=(0,s.default)(n),this.family=e[i+1],i++)}}},{key:"block",get:function(){return 0!=(this._type&t._CSS_BLOCK)},set:function(e){e?this._type|=t._CSS_BLOCK:this._type&=~t._CSS_BLOCK}},{key:"reset",value:function(){return this.ower=null,this._type=0,this.wordWrap=!0,this.fontSize=c.ILaya.Text.defaultFontSize,this.family=c.ILaya.Text.defaultFont,this.color="#000000",this.valign=t.VALIGN_TOP,this.padding=t._PADDING,this.bold=!1,this.italic=!1,this.align=t.ALIGN_LEFT,this.textDecoration=null,this.bgColor=null,this.borderColor=null,this._extendStyle&&this._extendStyle.recover(),this._extendStyle=h.HTMLExtendStyle.EMPTY,this}},{key:"recover",value:function(){d.Pool.recover("HTMLStyle",this.reset())}},{key:"inherit",value:function(e){var i,a,n,r;for(a=(n=t._inheritProps).length,i=0;i<a;i++)this[r=n[i]]=e[r]}},{key:"wordWrap",get:function(){return 0==(this._type&t._NOWARP)},set:function(e){e?this._type&=~t._NOWARP:this._type|=t._NOWARP}},{key:"bold",get:function(){return 0!=(this._type&t._BOLD)},set:function(e){e?this._type|=t._BOLD:this._type&=~t._BOLD}},{key:"fontWeight",get:function(){return this._type&t._BOLD?"bold":"none"},set:function(e){"bold"==e?this._type|=t._BOLD:this._type&=~t._BOLD}},{key:"italic",get:function(){return 0!=(this._type&t._ITALIC)},set:function(e){e?this._type|=t._ITALIC:this._type&=~t._ITALIC}},{key:"_widthAuto",value:function(){return 0!=(this._type&t._WIDTHAUTO)}},{key:"widthed",value:function(e){return 0!=(this._type&t._WIDTH_SET)}},{key:"whiteSpace",get:function(){return this._type&t._NOWARP?"nowrap":""},set:function(e){"nowrap"===e&&(this._type|=t._NOWARP),"none"===e&&(this._type&=~t._NOWARP)}},{key:"_calculation",value:function(t,e){return!1}},{key:"width",set:function(e){if(this._type|=t._WIDTH_SET,"string"==typeof e){var i=(0,r.default)(e).call(e,"auto");if(i>=0&&(this._type|=t._WIDTHAUTO,e=e.substr(0,i)),this._calculation("width",e))return;e=(0,s.default)(e)}this.size(e,-1)}},{key:"height",set:function(e){if(this._type|=t._HEIGHT_SET,"string"==typeof e){if(this._calculation("height",e))return;e=(0,s.default)(e)}this.size(-1,e)}},{key:"heighted",value:function(e){return 0!=(this._type&t._HEIGHT_SET)}},{key:"size",value:function(e,i){var a=this.ower,n=!1;-1!==e&&e!=a.width&&(this._type|=t._WIDTH_SET,a.width=e,n=!0),-1!==i&&i!=a.height&&(this._type|=t._HEIGHT_SET,a.height=i,n=!0),n&&a._layoutLater()}},{key:"getLineElement",value:function(){return 0!=(this._type&t._LINE_ELEMENT)}},{key:"setLineElement",value:function(e){e?this._type|=t._LINE_ELEMENT:this._type&=~t._LINE_ELEMENT}},{key:"_enableLayout",value:function(){return 0==(this._type&t._DISPLAY_NONE)&&0==(this._type&t._ABSOLUTE)}},{key:"letterSpacing",get:function(){return this._extendStyle.letterSpacing},set:function(t){"string"==typeof t&&(t=(0,s.default)(t+"")),t!=this._extendStyle.letterSpacing&&(this._getExtendStyle().letterSpacing=t)}},{key:"cssText",value:function(e){this.attrs(t.parseOneCSS(e,";"))}},{key:"attrs",value:function(t){if(t)for(var e=0,i=t.length;e<i;e++){var a=t[e];this[a[0]]=a[1]}}},{key:"position",get:function(){return this._type&t._ABSOLUTE?"absolute":""},set:function(e){"absolute"===e?this._type|=t._ABSOLUTE:this._type&=~t._ABSOLUTE}},{key:"absolute",get:function(){return 0!=(this._type&t._ABSOLUTE)}},{key:"paddingLeft",get:function(){return this.padding[3]}},{key:"paddingTop",get:function(){return this.padding[0]}}],[{key:"create",value:function(){return d.Pool.getItemByClass("HTMLStyle",t)}},{key:"parseOneCSS",value:function(e,i){for(var a,n=[],l=e.split(i),o=0,u=l.length;o<u;o++){var h=l[o],c=(0,r.default)(h).call(h,":"),d=h.substr(0,c).replace(/^\s+|\s+$/g,"");if(0!==d.length){var f=h.substr(c+1).replace(/^\s+|\s+$/g,""),_=[d,f];switch(d){case"italic":case"bold":_[1]="true"==f;break;case"font-weight":"bold"==f&&(_[1]=!0,_[0]="bold");break;case"line-height":_[0]="lineHeight",_[1]=(0,s.default)(f);break;case"font-size":_[0]="fontSize",_[1]=(0,s.default)(f);break;case"stroke":_[0]="stroke",_[1]=(0,s.default)(f);break;case"padding":(a=f.split(" ")).length>1||(a[1]=a[2]=a[3]=a[0]),_[1]=[(0,s.default)(a[0]),(0,s.default)(a[1]),(0,s.default)(a[2]),(0,s.default)(a[3])];break;default:(_[0]=t._CSSTOVALUE[d])||(_[0]=d)}n.push(_)}}return n}},{key:"parseCSS",value:function(e,i){for(var a;null!=(a=t._parseCSSRegExp.exec(e));)t.styleSheets[a[1]]=t.parseOneCSS(a[2],";")}}]),t}();e.HTMLStyle=_,(0,u.default)(_,"_CSSTOVALUE",{"letter-spacing":"letterSpacing","white-space":"whiteSpace","line-height":"lineHeight","font-family":"family","vertical-align":"valign","text-decoration":"textDecoration","background-color":"bgColor","border-color":"borderColor"}),(0,u.default)(_,"_parseCSSRegExp",new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g")),(0,u.default)(_,"_inheritProps",["italic","align","valign","leading","letterSpacing","stroke","strokeColor","bold","fontWeight","fontSize","lineHeight","wordWrap","color"]),(0,u.default)(_,"ALIGN_LEFT","left"),(0,u.default)(_,"ALIGN_CENTER","center"),(0,u.default)(_,"ALIGN_RIGHT","right"),(0,u.default)(_,"VALIGN_TOP","top"),(0,u.default)(_,"VALIGN_MIDDLE","middle"),(0,u.default)(_,"VALIGN_BOTTOM","bottom"),(0,u.default)(_,"styleSheets",{}),(0,u.default)(_,"ADDLAYOUTED",512),(0,u.default)(_,"_PADDING",[0,0,0,0]),(0,u.default)(_,"_HEIGHT_SET",8192),(0,u.default)(_,"_LINE_ELEMENT",65536),(0,u.default)(_,"_NOWARP",131072),(0,u.default)(_,"_WIDTHAUTO",262144),(0,u.default)(_,"_BOLD",1024),(0,u.default)(_,"_ITALIC",2048),(0,u.default)(_,"_CSS_BLOCK",1),(0,u.default)(_,"_DISPLAY_NONE",2),(0,u.default)(_,"_ABSOLUTE",4),(0,u.default)(_,"_WIDTH_SET",8),(0,u.default)(_,"alignVDic",{left:0,center:16,right:32,top:0,middle:64,bottom:128}),(0,u.default)(_,"align_Value",{0:"left",16:"center",32:"right"}),(0,u.default)(_,"vAlign_Value",{0:"top",64:"middle",128:"bottom"}),(0,u.default)(_,"_ALIGN",48),(0,u.default)(_,"_VALIGN",192),f.ClassUtils.regClass("laya.html.utils.HTMLStyle",_),f.ClassUtils.regClass("Laya.HTMLStyle",_)},98497:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.IHtml=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.IHtml=o,(0,l.default)(o,"HTMLDivElement",null),(0,l.default)(o,"HTMLImageElement",null),(0,l.default)(o,"HTMLBrElement",null),(0,l.default)(o,"HTMLDivParser",null),(0,l.default)(o,"HTMLParse",null),(0,l.default)(o,"HTMLElementType",null)},84491:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Layout=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11205),u=i(93561),h=i(82008),c=i(98497),d=i(89432),f=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"later",value:function(e){null==t._will&&(t._will=[],u.ILaya.stage.frameLoop(1,null,(function(){if(!(t._will.length<1)){for(var e=0;e<t._will.length;e++)t.layout(t._will[e]);t._will.length=0}}))),t._will.push(e)}},{key:"layout",value:function(e){return e&&e._style?0==(e._style._type&o.HTMLStyle.ADDLAYOUTED)?null:(e.style._type&=~o.HTMLStyle.ADDLAYOUTED,t._multiLineLayout(e)):null}},{key:"_multiLineLayout",value:function(e){var i=[];e._addChildsToLayout(i);var a,n,r,s,l,u,d,f=i.length,_=e._getCSSStyle(),v=_.letterSpacing,y=_.leading,p=_.lineHeight,g=_._widthAuto()||!_.wordWrap,m=g?999999:e.width,x=(e.height,0),T=_.italic?_.fontSize/3:0,k=_.align,C=_.valign,S=C!==o.HTMLStyle.VALIGN_TOP||k!==o.HTMLStyle.ALIGN_LEFT||0!=p,E=0,M=0,L=0,b=0,I=[],R=I[0]=new h.LayoutLine,w=!1;R.h=0,_.italic&&(m-=_.fontSize/3);var A=0,B=!0;function D(){R.y=M,M+=R.h+y,R.mWidth=A,A=0,R=new h.LayoutLine,I.push(R),R.h=0,E=0,B=!0,l=!1}for(a=0;a<f;a++)if(null!=(n=i[a]))if(B=!1,n instanceof c.IHtml.HTMLBrElement)D(),R.y=M,R.h=p;else{if(n._isChar()){if(L=(u=n).width+u.style.letterSpacing,b=u.height,u.isWord)l=w||"\n"===u.char,R.wordStartIndex=R.elements.length;else{if(I.length>0&&E+L>m&&R.wordStartIndex>0){var P;P=R.elements.length-R.wordStartIndex+1,R.elements.length=R.wordStartIndex,a-=P,D();continue}l=!1,A+=u.width}w=!1,(l=l||E+L>m)&&D(),R.minTextHeight=Math.min(R.minTextHeight,n.height)}else r=n._getCSSStyle(),d=n,s=r.padding,l=w||r.getLineElement(),L=d.width+s[1]+s[3]+r.letterSpacing,b=d.height+s[0]+s[2],w=r.getLineElement(),(l=l||E+L>m&&r.wordWrap)&&D();R.elements.push(n),R.h=Math.max(R.h,b),n.x=E,n.y=M,E+=L,R.w=E-v,R.y=M,x=Math.max(E+T,x)}else B||(E+=t.DIV_ELEMENT_PADDING),R.wordStartIndex=R.elements.length;if(M=R.y+R.h,S){var F=0,O=m;for(g&&e.width>0&&(O=e.width),a=0,f=I.length;a<f;a++)I[a].updatePos(0,O,a,F,k,C,p),F+=Math.max(p,I[a].h+y);M=F}return g&&(e.width=x),M>e.height&&(e.height=M),[x,M]}}]),t}();e.Layout=f,(0,l.default)(f,"DIV_ELEMENT_PADDING",0),d.ClassUtils.regClass("laya.html.utils.Layout",f),d.ClassUtils.regClass("Laya.Layout",f)},82008:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.LayoutLine=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11205),u=i(98497),h=i(89432),c=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"elements",[]),(0,l.default)(this,"x",0),(0,l.default)(this,"y",0),(0,l.default)(this,"w",0),(0,l.default)(this,"h",0),(0,l.default)(this,"wordStartIndex",0),(0,l.default)(this,"minTextHeight",99999),(0,l.default)(this,"mWidth",0)}return(0,s.default)(t,[{key:"updatePos",value:function(t,e,i,a,n,r,s){var l,h=0;this.elements.length>0&&(h=(l=this.elements[this.elements.length-1]).x+l.width-this.elements[0].x),s=s||this.h;var c,d=0;n===o.HTMLStyle.ALIGN_CENTER&&(d=(e-h)/2),n===o.HTMLStyle.ALIGN_RIGHT&&(d=e-h);for(var f=0,_=this.elements.length;f<_;f++){var v=(l=this.elements[f])._getCSSStyle();switch(0!==d&&(l.x+=d),v.valign){case"top":l.y=a;break;case"middle":var y=0;99999!=this.minTextHeight&&(y=this.minTextHeight);var p=(y+s)/2;p=Math.max(p,this.h),l.eletype,u.IHtml.HTMLElementType.IMAGE,c=a+p-l.height,l.y=c;break;case"bottom":l.y=a+(s-l.height)}}}}]),t}();e.LayoutLine=c,h.ClassUtils.regClass("laya.html.utils.LayoutLine",c),h.ClassUtils.regClass("Laya.LayoutLine",c)},54008:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.LayaGL=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.LayaGL=o,(0,l.default)(o,"ARRAY_BUFFER_TYPE_DATA",0),(0,l.default)(o,"ARRAY_BUFFER_TYPE_CMD",1),(0,l.default)(o,"ARRAY_BUFFER_REF_REFERENCE",0),(0,l.default)(o,"ARRAY_BUFFER_REF_COPY",1),(0,l.default)(o,"UPLOAD_SHADER_UNIFORM_TYPE_ID",0),(0,l.default)(o,"UPLOAD_SHADER_UNIFORM_TYPE_DATA",1)},13212:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Bezier=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(91020),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_controlPoints",[new o.Point,new o.Point,new o.Point]),(0,l.default)(this,"_calFun",this.getPoint2)}return(0,s.default)(t,[{key:"_switchPoint",value:function(t,e){var i=this._controlPoints.shift();i.setTo(t,e),this._controlPoints.push(i)}},{key:"getPoint2",value:function(t,e){var i=this._controlPoints[0],a=this._controlPoints[1],n=this._controlPoints[2],r=Math.pow(1-t,2)*i.x+2*t*(1-t)*a.x+Math.pow(t,2)*n.x,s=Math.pow(1-t,2)*i.y+2*t*(1-t)*a.y+Math.pow(t,2)*n.y;e.push(r,s)}},{key:"getPoint3",value:function(t,e){var i=this._controlPoints[0],a=this._controlPoints[1],n=this._controlPoints[2],r=this._controlPoints[3],s=Math.pow(1-t,3)*i.x+3*a.x*t*(1-t)*(1-t)+3*n.x*t*t*(1-t)+r.x*Math.pow(t,3),l=Math.pow(1-t,3)*i.y+3*a.y*t*(1-t)*(1-t)+3*n.y*t*t*(1-t)+r.y*Math.pow(t,3);e.push(s,l)}},{key:"insertPoints",value:function(t,e){var i,a;for(a=1/(t=t>0?t:5),i=0;i<=1;i+=a)this._calFun(i,e)}},{key:"getBezierPoints",value:function(t){var e,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if((i=t.length)<2*(n+1))return[];var r=[];switch(n){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=n;)this._controlPoints.push(o.Point.create());for(e=0;e<2*n;e+=2)this._switchPoint(t[e],t[e+1]);for(e=2*n;e<i;e+=2)this._switchPoint(t[e],t[e+1]),e/2%n==0&&this.insertPoints(a,r);return r}}]),t}();e.Bezier=u,(0,l.default)(u,"I",new u)},92356:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.GrahamScan=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(91020),u=i(11179),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"multiply",value:function(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)}},{key:"dis",value:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}},{key:"_getPoints",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(t._mPointList||(t._mPointList=[]);t._mPointList.length<e;)t._mPointList.push(new o.Point);return a||(a=[]),a.length=0,i?t.getFrom(a,t._mPointList,e):t.getFromR(a,t._mPointList,e),a}},{key:"getFrom",value:function(t,e,i){var a;for(a=0;a<i;a++)t.push(e[a]);return t}},{key:"getFromR",value:function(t,e,i){var a;for(a=0;a<i;a++)t.push(e.pop());return t}},{key:"pListToPointList",value:function(e){var i,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length/2,r=t._getPoints(n,a,t._tempPointList);for(i=0;i<n;i++)r[i].setTo(e[i+i],e[i+i+1]);return r}},{key:"pointListToPlist",value:function(e){var i,a,n=e.length,r=t._temPList;for(r.length=0,i=0;i<n;i++)a=e[i],r.push(a.x,a.y);return r}},{key:"scanPList",value:function(e){return u.Utils.copyArray(e,t.pointListToPlist(t.scan(t.pListToPointList(e,!0))))}},{key:"scan",value:function(e){var i,a,n,r,s,l=0,o=e.length,h={};for((r=t._temArr).length=0,i=e.length-1;i>=0;i--)(s=(n=e[i]).x+"_"+n.y)in h||(h[s]=!0,r.push(n));for(o=r.length,u.Utils.copyArray(e,r),i=1;i<o;i++)(e[i].y<e[l].y||e[i].y==e[l].y&&e[i].x<e[l].x)&&(l=i);for(n=e[0],e[0]=e[l],e[l]=n,i=1;i<o-1;i++){for(l=i,a=i+1;a<o;a++)(t.multiply(e[a],e[l],e[0])>0||0==t.multiply(e[a],e[l],e[0])&&t.dis(e[0],e[a])<t.dis(e[0],e[l]))&&(l=a);n=e[i],e[i]=e[l],e[l]=n}if((r=t._temArr).length=0,e.length<3)return u.Utils.copyArray(r,e);for(r.push(e[0],e[1],e[2]),i=3;i<o;i++){for(;r.length>=2&&t.multiply(e[i],r[r.length-1],r[r.length-2])>=0;)r.pop();e[i]&&r.push(e[i])}return r}}]),t}();e.GrahamScan=h,(0,l.default)(h,"_tempPointList",[]),(0,l.default)(h,"_temPList",[]),(0,l.default)(h,"_temArr",[])},44329:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.MathUtil=void 0;var r=n(i(31238)),s=n(i(87368)),l=n(i(28146)),o=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"subtractVector3",value:function(t,e,i){i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2]}},{key:"lerp",value:function(t,e,i){return t*(1-i)+e*i}},{key:"scaleVector3",value:function(t,e,i){i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e}},{key:"lerpVector3",value:function(t,e,i,a){var n=t[0],r=t[1],s=t[2];a[0]=n+i*(e[0]-n),a[1]=r+i*(e[1]-r),a[2]=s+i*(e[2]-s)}},{key:"lerpVector4",value:function(t,e,i,a){var n=t[0],r=t[1],s=t[2],l=t[3];a[0]=n+i*(e[0]-n),a[1]=r+i*(e[1]-r),a[2]=s+i*(e[2]-s),a[3]=l+i*(e[3]-l)}},{key:"slerpQuaternionArray",value:function(t,e,i,a,n,r,s){var l,o,u,h,c,d=t[e+0],f=t[e+1],_=t[e+2],v=t[e+3],y=i[a+0],p=i[a+1],g=i[a+2],m=i[a+3];return(o=d*y+f*p+_*g+v*m)<0&&(o=-o,y=-y,p=-p,g=-g,m=-m),1-o>1e-6?(l=Math.acos(o),u=Math.sin(l),h=Math.sin((1-n)*l)/u,c=Math.sin(n*l)/u):(h=1-n,c=n),r[s+0]=h*d+c*y,r[s+1]=h*f+c*p,r[s+2]=h*_+c*g,r[s+3]=h*v+c*m,r}},{key:"getRotation",value:function(t,e,i,a){return Math.atan2(a-e,i-t)/Math.PI*180}},{key:"sortBigFirst",value:function(t,e){return t==e?0:e>t?1:-1}},{key:"sortSmallFirst",value:function(t,e){return t==e?0:e>t?-1:1}},{key:"sortNumBigFirst",value:function(t,e){return(0,r.default)(e)-(0,r.default)(t)}},{key:"sortNumSmallFirst",value:function(t,e){return(0,r.default)(t)-(0,r.default)(e)}},{key:"sortByKey",value:function(e){var i,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i=a?n?t.sortNumBigFirst:t.sortBigFirst:n?t.sortNumSmallFirst:t.sortSmallFirst,function(t,a){return i(t[e],a[e])}}}]),t}();e.MathUtil=o},5866:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Matrix=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if((0,r.default)(this,t),(0,l.default)(this,"_bTransform",!1),null!=t._createFun)return t._createFun(e,i,a,n,s,o,u);this.a=e,this.b=i,this.c=a,this.d=n,this.tx=s,this.ty=o,this._checkTransform()}return(0,s.default)(t,[{key:"identity",value:function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this._bTransform=!1,this}},{key:"_checkTransform",value:function(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d}},{key:"setTranslate",value:function(t,e){return this.tx=t,this.ty=e,this}},{key:"translate",value:function(t,e){return this.tx+=t,this.ty+=e,this}},{key:"scale",value:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this._bTransform=!0,this}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),a=this.a,n=this.c,r=this.tx;return this.a=a*e-this.b*i,this.b=a*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this._bTransform=!0,this}},{key:"skew",value:function(t,e){var i=Math.tan(t),a=Math.tan(e),n=this.a,r=this.b;return this.a+=a*this.c,this.b+=a*this.d,this.c+=i*n,this.d+=i*r,this}},{key:"invertTransformPoint",value:function(t){var e=this.a,i=this.b,a=this.c,n=this.d,r=this.tx,s=e*n-i*a,l=n/s,o=-i/s,u=-a/s,h=e/s,c=(a*this.ty-n*r)/s,d=-(e*this.ty-i*r)/s;return t.setTo(l*t.x+u*t.y+c,o*t.x+h*t.y+d)}},{key:"transformPoint",value:function(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)}},{key:"transformPointN",value:function(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)}},{key:"getScaleX",value:function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)}},{key:"getScaleY",value:function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)}},{key:"invert",value:function(){var t=this.a,e=this.b,i=this.c,a=this.d,n=this.tx,r=t*a-e*i;return this.a=a/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-a*n)/r,this.ty=-(t*this.ty-e*n)/r,this}},{key:"setTo",value:function(t,e,i,a,n,r){return this.a=t,this.b=e,this.c=i,this.d=a,this.tx=n,this.ty=r,this}},{key:"concat",value:function(t){var e=this.a,i=this.c,a=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d,this.tx=a*t.a+this.ty*t.c+t.tx,this.ty=a*t.b+this.ty*t.d+t.ty,this}},{key:"scaleEx",value:function(t,e){var i=this.a,a=this.b,n=this.c,r=this.d;0!==a||0!==n?(this.a=t*i,this.b=t*a,this.c=e*n,this.d=e*r):(this.a=t*i,this.b=0*r,this.c=0*i,this.d=e*r),this._bTransform=!0}},{key:"rotateEx",value:function(t){var e=Math.cos(t),i=Math.sin(t),a=this.a,n=this.b,r=this.c,s=this.d;0!==n||0!==r?(this.a=e*a+i*r,this.b=e*n+i*s,this.c=-i*a+e*r,this.d=-i*n+e*s):(this.a=e*a,this.b=i*s,this.c=-i*a,this.d=e*s),this._bTransform=!0}},{key:"clone",value:function(){var e=t.create();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e._bTransform=this._bTransform,e}},{key:"copyTo",value:function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t._bTransform=this._bTransform,t}},{key:"toString",value:function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty}},{key:"destroy",value:function(){this.recover()}},{key:"recover",value:function(){o.Pool.recover("Matrix",this.identity())}}],[{key:"mul",value:function(t,e,i){var a=t.a,n=t.b,r=t.c,s=t.d,l=t.tx,o=t.ty,u=e.a,h=e.b,c=e.c,d=e.d,f=e.tx,_=e.ty;return 0!==h||0!==c?(i.a=a*u+n*c,i.b=a*h+n*d,i.c=r*u+s*c,i.d=r*h+s*d,i.tx=u*l+c*o+f,i.ty=h*l+d*o+_):(i.a=a*u,i.b=n*d,i.c=r*u,i.d=s*d,i.tx=u*l+f,i.ty=d*o+_),i}},{key:"mul16",value:function(t,e,i){var a=t.a,n=t.b,r=t.c,s=t.d,l=t.tx,o=t.ty,u=e.a,h=e.b,c=e.c,d=e.d,f=e.tx,_=e.ty;return 0!==h||0!==c?(i[0]=a*u+n*c,i[1]=a*h+n*d,i[4]=r*u+s*c,i[5]=r*h+s*d,i[12]=u*l+c*o+f,i[13]=h*l+d*o+_):(i[0]=a*u,i[1]=n*d,i[4]=r*u,i[5]=s*d,i[12]=u*l+f,i[13]=d*o+_),i}},{key:"create",value:function(){return o.Pool.getItemByClass("Matrix",t)}}]),t}();e.Matrix=u,(0,l.default)(u,"EMPTY",new u),(0,l.default)(u,"TEMP",new u),(0,l.default)(u,"_createFun",null)},91020:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Point=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,r.default)(this,t),this.x=e,this.y=i}return(0,s.default)(t,[{key:"setTo",value:function(t,e){return this.x=t,this.y=e,this}},{key:"reset",value:function(){return this.x=this.y=0,this}},{key:"recover",value:function(){o.Pool.recover("Point",this.reset())}},{key:"distance",value:function(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))}},{key:"toString",value:function(){return this.x+","+this.y}},{key:"normalize",value:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e,this.y*=e}}},{key:"copy",value:function(t){return this.setTo(t.x,t.y)}}],[{key:"create",value:function(){return o.Pool.getItemByClass("Point",t)}}]),t}();e.Point=u,(0,l.default)(u,"TEMP",new u),(0,l.default)(u,"EMPTY",new u)},63701:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Rectangle=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=i(91020),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.default)(this,t),this.x=e,this.y=i,this.width=a,this.height=n}return(0,s.default)(t,[{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"setTo",value:function(t,e,i,a){return this.x=t,this.y=e,this.width=i,this.height=a,this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this}},{key:"recover",value:function(){this!=t.TEMP&&this!=t.EMPTY?o.Pool.recover("Rectangle",this.reset()):console.log("recover Temp or Empty:",this)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.right&&e>=this.y&&e<this.bottom}},{key:"intersects",value:function(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)}},{key:"intersection",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.intersects(e)?(i||(i=new t),i.x=Math.max(this.x,e.x),i.y=Math.max(this.y,e.y),i.width=Math.min(this.right,e.right)-i.x,i.height=Math.min(this.bottom,e.bottom)-i.y,i):null}},{key:"union",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i||(i=new t),this.clone(i),e.width<=0||e.height<=0?i:(i.addPoint(e.x,e.y),i.addPoint(e.right,e.bottom),this)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=new t),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}},{key:"toString",value:function(){return this.x+","+this.y+","+this.width+","+this.height}},{key:"equals",value:function(t){return!(!t||t.x!==this.x||t.y!==this.y||t.width!==this.width||t.height!==this.height)}},{key:"addPoint",value:function(t,e){return this.x>t&&(this.width+=this.x-t,this.x=t),this.y>e&&(this.height+=this.y-e,this.y=e),this.width<t-this.x&&(this.width=t-this.x),this.height<e-this.y&&(this.height=e-this.y),this}},{key:"_getBoundPoints",value:function(){var e=t._temB;return e.length=0,0==this.width||0==this.height||e.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),e}},{key:"isEmpty",value:function(){return this.width<=0||this.height<=0}}],[{key:"create",value:function(){return o.Pool.getItemByClass("Rectangle",t)}},{key:"_getBoundPointS",value:function(e,i,a,n){var r=t._temA;return r.length=0,0==a||0==n||r.push(e,i,e+a,i,e,i+n,e+a,i+n),r}},{key:"_getWrapRec",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||e.length<1)return i?i.setTo(0,0,0,0):t.TEMP.setTo(0,0,0,0);i=i||t.create();var a,n,r,s,l,o=e.length,h=u.Point.TEMP;for(r=l=-(n=s=99999),a=0;a<o;a+=2)h.x=e[a],h.y=e[a+1],n=n<h.x?n:h.x,s=s<h.y?s:h.y,r=r>h.x?r:h.x,l=l>h.y?l:h.y;return i.setTo(n,s,r-n,l-s)}}]),t}();e.Rectangle=h,(0,l.default)(h,"EMPTY",new h),(0,l.default)(h,"TEMP",new h),(0,l.default)(h,"_temB",[]),(0,l.default)(h,"_temA",[])},12560:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.SoundChannel=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454));var _=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,f.default)((0,u.default)(e),"isStopped",!1),e}return(0,o.default)(r,[{key:"volume",get:function(){return 1},set:function(t){}},{key:"position",get:function(){return 0}},{key:"duration",get:function(){return 0}},{key:"play",value:function(){}},{key:"stop",value:function(){this.completeHandler&&this.completeHandler.runWith(!1)}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"__runComplete",value:function(t){t&&t.runWith(!0)}}]),r}(i(65700).EventDispatcher);e.SoundChannel=_},5072:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SoundManager=void 0;var r=n(i(81643)),s=n(i(92762)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(63969),c=i(68499),d=i(59056),f=i(70084),_=i(11179),v=i(93561),y=i(27175),p=function(){function t(){(0,l.default)(this,t)}return(0,o.default)(t,null,[{key:"__init__",value:function(){var e=v.ILaya.Browser.window,i=!!(e.AudioContext||e.webkitAudioContext||e.mozAudioContext);return i&&d.WebAudioSound.initWebAudio(),t._soundClass=i?d.WebAudioSound:c.AudioSound,y.Browser.onTBMiniGame||c.AudioSound._initMusicAudio(),t._musicClass=c.AudioSound,i}},{key:"addChannel",value:function(e){var i;(0,r.default)(i=t._channels).call(i,e)>=0||t._channels.push(e)}},{key:"removeChannel",value:function(e){var i;for(i=t._channels.length-1;i>=0;i--){var a;t._channels[i]==e&&(0,s.default)(a=t._channels).call(a,i,1)}}},{key:"disposeSoundLater",value:function(e){t._lastSoundUsedTimeDic[e]=v.ILaya.Browser.now(),t._isCheckingDispose||(t._isCheckingDispose=!0,v.ILaya.timer.loop(5e3,null,t._checkDisposeSound))}},{key:"_checkDisposeSound",value:function(){var e,i=v.ILaya.Browser.now(),a=!1;for(e in t._lastSoundUsedTimeDic)i-t._lastSoundUsedTimeDic[e]>3e4?(delete t._lastSoundUsedTimeDic[e],t.disposeSoundIfNotUsed(e)):a=!0;a||(t._isCheckingDispose=!1,v.ILaya.timer.clear(null,t._checkDisposeSound))}},{key:"disposeSoundIfNotUsed",value:function(e){var i;for(i=t._channels.length-1;i>=0;i--)if(t._channels[i].url==e)return;t.destroySound(e)}},{key:"autoStopMusic",get:function(){return t._autoStopMusic},set:function(e){v.ILaya.stage.off(h.Event.BLUR,null,t._stageOnBlur),v.ILaya.stage.off(h.Event.FOCUS,null,t._stageOnFocus),v.ILaya.stage.off(h.Event.VISIBILITY_CHANGE,null,t._visibilityChange),t._autoStopMusic=e,e&&(v.ILaya.stage.on(h.Event.BLUR,null,t._stageOnBlur),v.ILaya.stage.on(h.Event.FOCUS,null,t._stageOnFocus),v.ILaya.stage.on(h.Event.VISIBILITY_CHANGE,null,t._visibilityChange))}},{key:"_visibilityChange",value:function(){v.ILaya.stage.isVisibility?t._stageOnFocus():t._stageOnBlur()}},{key:"_stageOnBlur",value:function(){t._isActive=!1,t._musicChannel&&(t._musicChannel.isStopped||(t._blurPaused=!0,t._musicChannel.pause())),t.stopAllSound(),v.ILaya.stage.once(h.Event.MOUSE_DOWN,null,t._stageOnFocus)}},{key:"_recoverWebAudio",value:function(){d.WebAudioSound.ctx&&"running"!=d.WebAudioSound.ctx.state&&d.WebAudioSound.ctx.resume&&d.WebAudioSound.ctx.resume()}},{key:"_stageOnFocus",value:function(){t._isActive=!0,t._recoverWebAudio(),v.ILaya.stage.off(h.Event.MOUSE_DOWN,null,t._stageOnFocus),t._blurPaused&&t._musicChannel&&t._musicChannel.isStopped&&(t._blurPaused=!1,t._musicChannel.resume())}},{key:"muted",get:function(){return t._muted},set:function(e){e!=t._muted&&(e&&t.stopAllSound(),t.musicMuted=e,t._muted=e)}},{key:"soundMuted",get:function(){return t._soundMuted},set:function(e){t._soundMuted=e}},{key:"musicMuted",get:function(){return t._musicMuted},set:function(e){e!=t._musicMuted&&(e?(t._bgMusic&&t._musicChannel&&!t._musicChannel.isStopped?v.ILaya.Render.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!0):t._musicChannel.pause():t._musicChannel=null,t._musicMuted=e):(t._musicMuted=e,t._bgMusic&&t._musicChannel&&(v.ILaya.Render.isConchApp?t._musicChannel._audio&&(t._musicChannel._audio.muted=!1):t._musicChannel.resume())))}},{key:"useAudioMusic",get:function(){return t._useAudioMusic},set:function(e){t._useAudioMusic=e,t._musicClass=e?c.AudioSound:null}},{key:"playSound",value:function(e){var i,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!t._isActive||!e)return null;if(t._muted)return null;if(t._recoverWebAudio(),(e=f.URL.formatURL(e))==t._bgMusic){if(t._musicMuted)return null}else{if(v.ILaya.Render.isConchApp){var o=_.Utils.getFileExtension(e);if("wav"!=o&&"ogg"!=o)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(t._soundMuted)return null}return y.Browser._isMiniGame||(i=v.ILaya.loader.getRes(e)),s||(s=t._soundClass),i||((i=new s).load(e),y.Browser._isMiniGame||v.ILaya.Loader.cacheRes(e,i)),(a=i.play(l,n))?(a.url=e,a.volume=e==t._bgMusic?t.musicVolume:t.soundVolume,a.completeHandler=r,a):null}},{key:"destroySound",value:function(t){var e=v.ILaya.loader.getRes(t);e&&(v.ILaya.Loader.clearRes(t),e.dispose())}},{key:"playMusic",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e=f.URL.formatURL(e),t._bgMusic=e,t._musicChannel&&t._musicChannel.stop(),t._musicChannel=t.playSound(e,i,a,t._musicClass,n)}},{key:"stopSound",value:function(e){var i,a;for(e=f.URL.formatURL(e),i=t._channels.length-1;i>=0;i--)(a=t._channels[i]).url==e&&a.stop()}},{key:"stopAll",value:function(){var e;for(t._bgMusic=null,e=t._channels.length-1;e>=0;e--)t._channels[e].stop()}},{key:"stopAllSound",value:function(){var e,i;for(e=t._channels.length-1;e>=0;e--)(i=t._channels[e]).url!=t._bgMusic&&i.stop()}},{key:"stopMusic",value:function(){t._musicChannel&&t._musicChannel.stop(),t._bgMusic=null}},{key:"setSoundVolume",value:function(e){var i,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n)n=f.URL.formatURL(n),t._setVolume(n,e);else for(t.soundVolume=e,i=t._channels.length-1;i>=0;i--)(a=t._channels[i]).url!=t._bgMusic&&(a.volume=e)}},{key:"setMusicVolume",value:function(e){t.musicVolume=e,t._setVolume(t._bgMusic,e)}},{key:"_setVolume",value:function(e,i){var a,n;for(e=f.URL.formatURL(e),a=t._channels.length-1;a>=0;a--)(n=t._channels[a]).url==e&&(n.volume=i)}}]),t}();e.SoundManager=p,(0,u.default)(p,"musicVolume",1),(0,u.default)(p,"soundVolume",1),(0,u.default)(p,"playbackRate",1),(0,u.default)(p,"_useAudioMusic",!0),(0,u.default)(p,"_muted",!1),(0,u.default)(p,"_soundMuted",!1),(0,u.default)(p,"_musicMuted",!1),(0,u.default)(p,"_bgMusic",null),(0,u.default)(p,"_musicChannel",null),(0,u.default)(p,"_channels",[]),(0,u.default)(p,"_blurPaused",!1),(0,u.default)(p,"_isActive",!0),(0,u.default)(p,"_lastSoundUsedTimeDic",{}),(0,u.default)(p,"_isCheckingDispose",!1),(0,u.default)(p,"autoReleaseSound",!0)},68499:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.AudioSound=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(69508),v=i(63969),y=i(65700),p=i(70084),g=i(3117),m=i(27175),x=i(89761),T=i(93561);var k=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,f.default)((0,u.default)(e),"loaded",!1),e}return(0,o.default)(r,[{key:"dispose",value:function(){var t=r._audioCache[this.url];x.Pool.clearBySign("audio:"+this.url),t&&(g.Render.isConchApp||(t.src=""),delete r._audioCache[this.url])}},{key:"load",value:function(t){var e;if(t=p.URL.formatURL(t),this.url=t,t==T.ILaya.SoundManager._bgMusic?(r._initMusicAudio(),(e=r._musicAudio).src!=t&&(delete r._audioCache[e.src],e=null)):e=r._audioCache[t],e&&e.readyState>=2)this.event(v.Event.COMPLETE);else{e||(t==T.ILaya.SoundManager._bgMusic?(r._initMusicAudio(),e=r._musicAudio):e=m.Browser.createElement("audio"),r._audioCache[t]=e,e.src=t),e.addEventListener("canplaythrough",a),e.addEventListener("error",n);var i=this;this.audio=e,e.load?e.load():n()}function a(){s(),i.loaded=!0,i.event(v.Event.COMPLETE)}function n(){e.load=null,s(),i.event(v.Event.ERROR)}function s(){e.removeEventListener("canplaythrough",a),e.removeEventListener("error",n)}}},{key:"play",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.url)return null;if(this.url==T.ILaya.SoundManager._bgMusic?""!=(t=r._musicAudio).src&&t.src!=this.url&&(delete r._audioCache[t.src],r._audioCache[this.url]=t):t=r._audioCache[this.url],!t)return null;e=x.Pool.getItem("audio:"+this.url),g.Render.isConchApp?e||((e=m.Browser.createElement("audio")).src=this.url):this.url==T.ILaya.SoundManager._bgMusic?(r._initMusicAudio(),(e=r._musicAudio).src=this.url):e=e||t.cloneNode(!0);var n=new _.AudioSoundChannel(e);return n.url=this.url,n.loops=a,n.startTime=i,n.play(),T.ILaya.SoundManager.addChannel(n),n}},{key:"duration",get:function(){var t;return(t=r._audioCache[this.url])?t.duration:0}}],[{key:"_initMusicAudio",value:function(){r._musicAudio||(r._musicAudio||(r._musicAudio=m.Browser.createElement("audio")),g.Render.isConchApp||m.Browser.document.addEventListener("mousedown",r._makeMusicOK))}},{key:"_makeMusicOK",value:function(){m.Browser.document.removeEventListener("mousedown",r._makeMusicOK),r._musicAudio.src?r._musicAudio.play():(r._musicAudio.src="",r._musicAudio.load())}}]),r}(y.EventDispatcher);e.AudioSound=k,(0,f.default)(k,"_audioCache",{})},69508:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.AudioSoundChannel=void 0;var s=r(i(54103)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(63969),y=i(12560),p=i(27175),g=i(93561);var m=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(t){var e,i,a;return(0,l.default)(this,r),a=n.call(this),(0,_.default)((0,u.default)(a),"_audio",null),a._onEnd=(0,s.default)(e=a.__onEnd).call(e,(0,u.default)(a)),a._resumePlay=(0,s.default)(i=a.__resumePlay).call(i,(0,u.default)(a)),t.addEventListener("ended",a._onEnd),a._audio=t,a}return(0,o.default)(r,[{key:"__onEnd",value:function(t){if(1==this.loops)return this.completeHandler&&(g.ILaya.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(v.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}},{key:"__resumePlay",value:function(){if(this._audio&&this._audio.removeEventListener("canplay",this._resumePlay),!this.isStopped)try{this._audio.currentTime=this.startTime,p.Browser.container.appendChild(this._audio),this._audio.play()}catch(t){this.event(v.Event.ERROR)}}},{key:"play",value:function(){this.isStopped=!1;try{this._audio.playbackRate=g.ILaya.SoundManager.playbackRate,this._audio.currentTime=this.startTime}catch(t){return void this._audio.addEventListener("canplay",this._resumePlay)}g.ILaya.SoundManager.addChannel(this),p.Browser.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()}},{key:"position",get:function(){return this._audio?this._audio.currentTime:0}},{key:"duration",get:function(){return this._audio?this._audio.duration:0}},{key:"stop",value:function(){(0,h.default)((0,f.default)(r.prototype),"stop",this).call(this),this.isStopped=!0,g.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&g.ILaya.Render.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),g.ILaya.Browser.onIE||this._audio!=g.ILaya.AudioSound._musicAudio&&g.ILaya.Pool.recover("audio:"+this.url,this._audio),p.Browser.removeElement(this._audio),this._audio=null,g.ILaya.SoundManager.autoReleaseSound&&g.ILaya.SoundManager.disposeSoundLater(this.url))}},{key:"pause",value:function(){this.isStopped=!0,g.ILaya.SoundManager.removeChannel(this),this._audio&&("pause"in this._audio&&this._audio.pause(),g.ILaya.SoundManager.autoReleaseSound&&g.ILaya.SoundManager.disposeSoundLater(this.url))}},{key:"resume",value:function(){var t=this._audio;t&&(this.isStopped=!1,0==t.readyState&&(t.src=this.url,t.addEventListener("canplay",this._resumePlay),t.load()),g.ILaya.SoundManager.addChannel(this),"play"in t&&t.play())}},{key:"volume",get:function(){return this._audio?this._audio.volume:1},set:function(t){this._audio&&(this._audio.volume=t)}}]),r}(y.SoundChannel);e.AudioSoundChannel=m},59056:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.WebAudioSound=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(52401),v=i(63969),y=i(65700),p=i(70084),g=i(93561);var m=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,f.default)((0,u.default)(e),"loaded",!1),(0,f.default)((0,u.default)(e),"_disposed",!1),e}return(0,o.default)(r,[{key:"load",value:function(t){var e=this;if(t=p.URL.formatURL(t),this.url=t,this.audioBuffer=r._dataCache[t],this.audioBuffer)this._loaded(this.audioBuffer);else if(r.e.on("loaded:"+t,this,this._loaded),r.e.on("err:"+t,this,this._err),!r.__loadingSound[t]){r.__loadingSound[t]=!0;var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){e._disposed?e._removeLoadEvents():(e.data=i.response,r.buffs.push({buffer:e.data,url:e.url}),r.decode())},i.onerror=function(t){e._err()},i.send()}}},{key:"_err",value:function(){this._removeLoadEvents(),r.__loadingSound[this.url]=!1,this.event(v.Event.ERROR)}},{key:"_loaded",value:function(t){this._removeLoadEvents(),this._disposed||(this.audioBuffer=t,r._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event(v.Event.COMPLETE))}},{key:"_removeLoadEvents",value:function(){r.e.off("loaded:"+this.url,this,this._loaded),r.e.off("err:"+this.url,this,this._err)}},{key:"__playAfterLoaded",value:function(){if(this.__toPlays){var t,e,i,a;for(e=(i=this.__toPlays).length,t=0;t<e;t++)(a=i[t])[2]&&!a[2].isStopped&&this.play(a[0],a[1],a[2]);this.__toPlays.length=0}}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return i=i||new _.WebAudioSoundChannel,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([t,e,i]),this.once(v.Event.COMPLETE,this,this.__playAfterLoaded),this.load(this.url)),i.url=this.url,i.loops=e,i.audioBuffer=this.audioBuffer,i.startTime=t,i.play(),g.ILaya.SoundManager.addChannel(i),i}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"dispose",value:function(){this._disposed=!0,delete r._dataCache[this.url],delete r.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]}}],[{key:"decode",value:function(){r.buffs.length<=0||r.isDecoding||(r.isDecoding=!0,r.tInfo=r.buffs.shift(),r.ctx.decodeAudioData(r.tInfo.buffer,r._done,r._fail))}},{key:"_done",value:function(t){r.e.event("loaded:"+r.tInfo.url,t),r.isDecoding=!1,r.decode()}},{key:"_fail",value:function(){r.e.event("err:"+r.tInfo.url,null),r.isDecoding=!1,r.decode()}},{key:"_playEmptySound",value:function(){if(null!=r.ctx){var t=r.ctx.createBufferSource();t.buffer=r._miniBuffer,t.connect(r.ctx.destination),t.start(0,0,0)}}},{key:"_unlock",value:function(){r._unlocked||(r._playEmptySound(),"running"==r.ctx.state&&(window.document.removeEventListener("mousedown",r._unlock,!0),window.document.removeEventListener("touchend",r._unlock,!0),window.document.removeEventListener("touchstart",r._unlock,!0),r._unlocked=!0))}},{key:"initWebAudio",value:function(){"running"!=r.ctx.state&&(r._unlock(),window.document.addEventListener("mousedown",r._unlock,!0),window.document.addEventListener("touchend",r._unlock,!0),window.document.addEventListener("touchstart",r._unlock,!0))}}]),r}(y.EventDispatcher);e.WebAudioSound=m,(0,f.default)(m,"_dataCache",{}),(0,f.default)(m,"webAudioEnabled",window.AudioContext||window.webkitAudioContext||window.mozAudioContext),(0,f.default)(m,"ctx",m.webAudioEnabled?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0),(0,f.default)(m,"buffs",[]),(0,f.default)(m,"isDecoding",!1),(0,f.default)(m,"_miniBuffer",m.ctx?m.ctx.createBuffer(1,1,22050):void 0),(0,f.default)(m,"e",new y.EventDispatcher),(0,f.default)(m,"_unlocked",!1),(0,f.default)(m,"__loadingSound",{})},52401:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.WebAudioSoundChannel=void 0;var s=r(i(54103)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(63969),y=i(12560),p=i(27175),g=i(11179),m=i(93561);var x=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,l.default)(this,r),t=n.call(this),(0,_.default)((0,u.default)(t),"bufferSource",null),(0,_.default)((0,u.default)(t),"_currentTime",0),(0,_.default)((0,u.default)(t),"_volume",1),(0,_.default)((0,u.default)(t),"_startTime",0),(0,_.default)((0,u.default)(t),"_pauseTime",0),(0,_.default)((0,u.default)(t),"context",m.ILaya.WebAudioSound.ctx),t._onPlayEnd=(0,s.default)(g.Utils).call(g.Utils,t.__onPlayEnd,(0,u.default)(t)),t.context.createGain?t.gain=t.context.createGain():t.gain=t.context.createGainNode(),t}return(0,o.default)(r,[{key:"play",value:function(){if(m.ILaya.SoundManager.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){if(this.startTime>=this.duration)return stop();var t=this.context,e=this.gain,i=t.createBufferSource();this.bufferSource=i,i.buffer=this.audioBuffer,i.connect(e),e&&e.disconnect(),e.connect(t.destination),i.onended=this._onPlayEnd,this._startTime=p.Browser.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,r.SetTargetDelay):this.gain.gain.value=this._volume,0==this.loops&&(i.loop=!0),i.playbackRate.setTargetAtTime?i.playbackRate.setTargetAtTime(m.ILaya.SoundManager.playbackRate,this.context.currentTime,r.SetTargetDelay):i.playbackRate.value=m.ILaya.SoundManager.playbackRate,i.start(0,this.startTime),this._currentTime=0}}},{key:"__onPlayEnd",value:function(){if(1==this.loops)return this.completeHandler&&(m.ILaya.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(v.Event.COMPLETE);this.loops>0&&this.loops--,this.startTime=0,this.play()}},{key:"position",get:function(){return this.bufferSource?(p.Browser.now()-this._startTime)/1e3+this.startTime:0}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"_clearBufferSource",value:function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.disconnect(0),t.onended=null,r._tryCleanFailed||this._tryClearBuffer(t),this.bufferSource=null}}},{key:"_tryClearBuffer",value:function(t){try{t.buffer=null}catch(t){r._tryCleanFailed=!0}}},{key:"stop",value:function(){(0,h.default)((0,f.default)(r.prototype),"stop",this).call(this),this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,m.ILaya.SoundManager.removeChannel(this),this.completeHandler=null,m.ILaya.SoundManager.autoReleaseSound&&m.ILaya.SoundManager.disposeSoundLater(this.url)}},{key:"pause",value:function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,m.ILaya.SoundManager.removeChannel(this),m.ILaya.SoundManager.autoReleaseSound&&m.ILaya.SoundManager.disposeSoundLater(this.url)}},{key:"resume",value:function(){this.startTime=this._pauseTime,this.play()}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t,this.isStopped||(this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(t,this.context.currentTime,r.SetTargetDelay):this.gain.gain.value=t)}}]),r}(y.SoundChannel);e.WebAudioSoundChannel=x,(0,_.default)(x,"_tryCleanFailed",!1),(0,_.default)(x,"SetTargetDelay",.001)},34426:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AtlasInfoManager=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(35696),u=i(93561),h=i(84581),c=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"enable",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;u.ILaya.loader.load(e,o.Handler.create(null,t._onInfoLoaded,[i]),null,h.Loader.JSON)}},{key:"_onInfoLoaded",value:function(e,i){var a,n,r,s,l;for(a in i)for(n=(r=i[a])[0],l=(r=r[1]).length,s=0;s<l;s++)t._fileLoadDic[n+r[s]]=a;e&&e.run()}},{key:"getFileLoadPath",value:function(e){return t._fileLoadDic[e]||e}}]),t}();e.AtlasInfoManager=c,(0,l.default)(c,"_fileLoadDic",{})},31856:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HttpRequest=void 0;var s=r(i(77766)),l=r(i(59340)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(63969),y=i(65700),p=i(11179),g=i(27175);var m=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e;(0,o.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,_.default)((0,h.default)(e),"_http",new XMLHttpRequest),e}return(0,u.default)(r,[{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._responseType=a,this._data=null,(g.Browser.onVVMiniGame||g.Browser.onQGMiniGame||g.Browser.onQQMiniGame||g.Browser.onAlipayMiniGame||g.Browser.onBLMiniGame||g.Browser.onHWMiniGame||g.Browser.onTTMiniGame||g.Browser.onTBMiniGame)&&(t=r._urlEncode(t)),this._url=t;var s=this,o=this._http;o.open(i,t,!0);var u=!1;if(n)for(var h=0;h<n.length;h++)o.setRequestHeader(n[h++],n[h]);else window.conch||(e&&"string"!=typeof e?(o.setRequestHeader("Content-Type","application/json"),e instanceof ArrayBuffer||"string"==typeof e||(u=!0)):o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));var c="arraybuffer"!==a?"text":"arraybuffer";o.responseType=c,o.dataType&&(o.dataType=c),o.onerror=function(t){s._onError(t)},o.onabort=function(t){s._onAbort(t)},o.onprogress=function(t){s._onProgress(t)},o.onload=function(t){s._onLoad(t)},g.Browser.onBLMiniGame&&g.Browser.onAndroid&&!e&&(e={}),o.send(u?(0,l.default)(e):e)}},{key:"_onProgress",value:function(t){t&&t.lengthComputable&&this.event(v.Event.PROGRESS,t.loaded/t.total)}},{key:"_onAbort",value:function(t){this.error("Request was aborted by user")}},{key:"_onError",value:function(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}},{key:"_onLoad",value:function(t){var e=this._http,i=void 0!==e.status?e.status:200;200===i||204===i||0===i?this.complete():this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}},{key:"error",value:function(t){this.clear(),console.warn(this.url,t),this.event(v.Event.ERROR,t)}},{key:"complete",value:function(){this.clear();var t=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=p.Utils.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(e){t=!1,this.error(e.message)}t&&this.event(v.Event.COMPLETE,this._data instanceof Array?[this._data]:this._data)}},{key:"clear",value:function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}},{key:"url",get:function(){return this._url}},{key:"data",get:function(){return this._data}},{key:"http",get:function(){return this._http}}]),r}(y.EventDispatcher);e.HttpRequest=m,(0,_.default)(m,"_urlEncode",encodeURI)},84581:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Loader=void 0;var s=r(i(77766)),l=r(i(81643)),o=r(i(23054)),u=r(i(97093)),h=r(i(31238)),c=r(i(78914)),d=r(i(87368)),f=r(i(28146)),_=r(i(43714)),v=r(i(13383)),y=r(i(78310)),p=r(i(82669)),g=r(i(17454)),m=i(93561),x=i(88587),T=i(23699),k=i(63969),C=i(65700),S=i(5072),E=i(29148),M=i(41009),L=i(27175),b=i(8245),I=i(35696),R=i(11179),w=i(86431),A=i(31856),B=i(70084),D=i(96719),P=i(13156);var F=function(t){(0,v.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,p.default)(e);if(i){var r=(0,p.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,y.default)(this,t)});function r(){var t,e;(0,d.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,g.default)((0,_.default)(e),"_customParse",!1),e}return(0,f.default)(r,[{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:m.ILaya.WorkerLoader.enable;if(t){var o;if(r.setGroup(t,"666"),this._url=t,0!==(0,l.default)(t).call(t,"data:image")||e?t=B.URL.formatURL(t):e=r.IMAGE,this._type=e||(e=r.getTypeFromUrl(this._url)),this._cache=i,this._useWorkerLoader=s,this._data=null,s&&m.ILaya.WorkerLoader.enableWorkerLoader(),e==r.IMAGE?(o=r.textureMap[t])&&o.bitmap&&o.bitmap.destroyed&&(o=null):o=r.loadedMap[t],!n&&o)return this._data=o,this.event(k.Event.PROGRESS,1),void this.event(k.Event.COMPLETE,this._data);if(a&&r.setGroup(t,a),null!=r.parserMap[e])return this._customParse=!0,void(r.parserMap[e]instanceof I.Handler?r.parserMap[e].runWith(this):r.parserMap[e].call(null,this));this._loadResourceFilter(e,t)}else this.onLoaded(null)}},{key:"_loadResourceFilter",value:function(t,e){this._loadResource(t,e)}},{key:"_loadResource",value:function(t,e){switch(t){case r.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(e);break;case r.SOUND:this._loadSound(e);break;case r.TTF:this._loadTTF(e);break;case r.ATLAS:case r.PREFAB:case r.PLF:this._loadHttpRequestWhat(e,r.JSON);break;case r.FONT:this._loadHttpRequestWhat(e,r.XML);break;case r.PLFB:this._loadHttpRequestWhat(e,r.BUFFER);break;default:this._loadHttpRequestWhat(e,t)}}},{key:"_loadHttpRequest",value:function(t,e,i,a,n,r,s,l){L.Browser.onVVMiniGame||L.Browser.onHWMiniGame?this._http=new A.HttpRequest:this._http||(this._http=new A.HttpRequest),r&&this._http.on(k.Event.PROGRESS,n,r),a&&this._http.on(k.Event.COMPLETE,i,a),this._http.on(k.Event.ERROR,s,l),this._http.send(t,null,"get",e)}},{key:"_loadHtmlImage",value:function(t,e,i,a,n){var s;function l(){var e=s;e.onload=null,e.onerror=null,delete r._imgCache[t]}(s=new L.Browser.window.Image).crossOrigin="",s.onload=function(){l(),i.call(e,s)},s.onerror=function(){l(),n.call(a)},s.src=t,r._imgCache[t]=s}},{key:"_loadHttpRequestWhat",value:function(t,e){r.preLoadedMap[t]?this.onLoaded(r.preLoadedMap[t]):this._loadHttpRequest(t,e,this,this.onLoaded,this,this.onProgress,this,this.onError)}},{key:"_loadTTF",value:function(t){t=B.URL.formatURL(t);var e=new m.ILaya.TTFLoader;e.complete=I.Handler.create(this,this.onLoaded),e.load(t)}},{key:"_loadImage",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this;e&&(t=B.URL.formatURL(t));var a=function(){i.event(k.Event.ERROR,"Load image failed")};if("nativeimage"===this._type)this._loadHtmlImage(t,this,this.onLoaded,this,a);else{var n=R.Utils.getFileExtension(t);"bin"==n&&this._url&&(n=R.Utils.getFileExtension(this._url)),"ktx"===n||"pvr"===n?this._loadHttpRequest(t,r.BUFFER,this,this.onLoaded,this,this.onProgress,this,this.onError):this._loadHtmlImage(t,this,this.onLoaded,this,a)}}},{key:"_loadSound",value:function(t){var e=new S.SoundManager._soundClass,i=this;function a(){e.offAll()}e.on(k.Event.COMPLETE,this,(function(){a(),i.onLoaded(e)})),e.on(k.Event.ERROR,this,(function(){a(),e.dispose(),i.event(k.Event.ERROR,"Load sound failed")})),e.load(t)}},{key:"onProgress",value:function(t){this._type===r.ATLAS?this.event(k.Event.PROGRESS,.3*t):this._originType==r.HIERARCHY?this.event(k.Event.PROGRESS,t/3):this.event(k.Event.PROGRESS,t)}},{key:"onError",value:function(t){this.event(k.Event.ERROR,t)}},{key:"onLoaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if((S=this._type)==r.PLFB)this.parsePLFBData(t),this.complete(t);else if(S==r.PLF)this.parsePLFData(t),this.complete(t);else if(S===r.IMAGE){var e;if(t instanceof ArrayBuffer){var i;switch(C=R.Utils.getFileExtension(this._url)){case"ktx":i=D.TextureFormat.ETC1RGB;break;case"pvr":i=D.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",C)}(e=new M.Texture2D(0,0,i,!1,!1)).wrapModeU=P.WarpMode.Clamp,e.wrapModeV=P.WarpMode.Clamp,e.setCompressData(t),e._setCreateURL(this.url)}else t instanceof M.Texture2D?e=t:((e=new M.Texture2D(t.width,t.height,1,!1,!1)).wrapModeU=P.WarpMode.Clamp,e.wrapModeV=P.WarpMode.Clamp,e.loadImageSource(t,!0),e._setCreateURL(t.src));var a=new E.Texture(e);a.url=this._url,this.complete(a)}else if(S===r.SOUND||"nativeimage"===S)this.complete(t);else if("htmlimage"===S){var n=new M.Texture2D(t.width,t.height,1,!1,!1);n.wrapModeU=P.WarpMode.Clamp,n.wrapModeV=P.WarpMode.Clamp,n.loadImageSource(t,!0),n._setCreateURL(t.src),this.complete(n)}else if(S===r.ATLAS){if(t.frames){var s=[];if(!this._data){if(this._data=t,t.meta&&t.meta.image){var c,d;s=t.meta.image.split(",");var f=(0,l.default)(c=this._url).call(c,"/")>=0?"/":"\\",_=(0,o.default)(d=this._url).call(d,f),v=_>=0?this._url.substr(0,_+1):"",y=null;L.Browser.onAndroid&&t.meta.compressTextureAndroid&&(y=".ktx"),L.Browser.onIOS&&t.meta.compressTextureIOS&&(y=t.meta.astc?".ktx":".pvr");for(var p=0,g=s.length;p<g;p++)s[p]=y?v+s[p].replace(".png",y):v+s[p]}else s=[this._url.replace(".json",".png")];(0,u.default)(s).call(s),t.toLoads=s,t.pics=[]}this.event(k.Event.PROGRESS,.3+1/s.length*.6);var m=B.URL.formatURL(s.pop()),C=R.Utils.getFileExtension(m),S=r.IMAGE;return"pvr"!=C&&"ktx"!=C||(S=r.BUFFER),this._loadResourceFilter(S,m)}if(!(t instanceof M.Texture2D))if(t instanceof ArrayBuffer){var b,I=this._http?this._http.url:this._url;switch(C=R.Utils.getFileExtension(I)){case"ktx":b=D.TextureFormat.ETC1RGB;break;case"pvr":b=D.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",C)}var A=new M.Texture2D(0,0,b,!1,!1);A.wrapModeU=P.WarpMode.Clamp,A.wrapModeV=P.WarpMode.Clamp,A.setCompressData(t),A._setCreateURL(I),t=A}else{var F=new M.Texture2D(t.width,t.height,1,!1,!1);F.wrapModeU=P.WarpMode.Clamp,F.wrapModeV=P.WarpMode.Clamp,F.loadImageSource(t,!0),F._setCreateURL(t.src),t=F}if(this._data.pics.push(t),this._data.toLoads.length>0)return this.event(k.Event.PROGRESS,.3+1/this._data.toLoads.length*.6),m=B.URL.formatURL(this._data.toLoads.pop()),C=R.Utils.getFileExtension(m),S=r.IMAGE,"pvr"!=C&&"ktx"!=C||(S=r.BUFFER),this._loadResourceFilter(S,m);var O=this._data.frames,U=this._url.split("?")[0],N=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:U.substring(0,(0,o.default)(U).call(U,"."))+"/",G=this._data.pics,H=B.URL.formatURL(this._url),W=r.atlasMap[H]||(r.atlasMap[H]=[]);W.dir=N;var V=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Y in V=(0,h.default)(this._data.meta.scale),O){var X,z=O[Y],K=G[z.frame.idx?z.frame.idx:0];m=B.URL.formatURL(N+Y),K.scaleRate=V,X=E.Texture._create(K,z.frame.x,z.frame.y,z.frame.w,z.frame.h,z.spriteSourceSize.x,z.spriteSourceSize.y,z.sourceSize.w,z.sourceSize.h,r.getRes(m)),r.cacheTexture(m,X),X.url=m,W.push(m)}else for(Y in O)K=G[(z=O[Y]).frame.idx?z.frame.idx:0],m=B.URL.formatURL(N+Y),X=E.Texture._create(K,z.frame.x,z.frame.y,z.frame.w,z.frame.h,z.spriteSourceSize.x,z.spriteSourceSize.y,z.sourceSize.w,z.sourceSize.h,r.getRes(m)),r.cacheTexture(m,X),X.url=m,W.push(m);delete this._data.pics,this.complete(this._data)}else if(S===r.FONT){if(!t._source)return this._data=t,this.event(k.Event.PROGRESS,.5),this._loadResourceFilter(r.IMAGE,this._url.replace(".fnt",".png"));var j=new w.BitmapFont;j.parseFont(this._data,new E.Texture(t));var q=this._url.split(".fnt")[0].split("/"),Z=q[q.length-1];T.Text.registerBitmapFont(Z,j),this._data=j,this.complete(this._data)}else if(S===r.PREFAB){var Q=new x.Prefab;Q.json=t,this.complete(Q)}else this.complete(t)}},{key:"parsePLFData",value:function(t){var e,i,a;for(e in t)for(i in a=t[e])r.preLoadedMap[B.URL.formatURL(i)]=a[i]}},{key:"parsePLFBData",value:function(t){var e,i,a;for(a=(e=new b.Byte(t)).getInt32(),i=0;i<a;i++)this.parseOnePLFBFile(e)}},{key:"parseOnePLFBFile",value:function(t){var e,i,a;i=t.getUTFString(),e=t.getInt32(),a=t.readArrayBuffer(e),r.preLoadedMap[B.URL.formatURL(i)]=a}},{key:"complete",value:function(t){this._data=t,this._customParse?this.event(k.Event.LOADED,t instanceof Array?[t]:t):(r._loaders.push(this),r._isWorking||r.checkNext())}},{key:"endLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this._data=t),this._cache&&r.cacheRes(this._url,this._data),this.event(k.Event.PROGRESS,1),this.event(k.Event.COMPLETE,this.data instanceof Array?[this.data]:this.data)}},{key:"url",get:function(){return this._url}},{key:"type",get:function(){return this._type}},{key:"cache",get:function(){return this._cache}},{key:"data",get:function(){return this._data}}],[{key:"getTypeFromUrl",value:function(t){var e=R.Utils.getFileExtension(t);return e?r.typeMap[e]:(console.warn("Not recognize the resources suffix",t),"text")}},{key:"checkNext",value:function(){r._isWorking=!0;for(var t=L.Browser.now();r._startIndex<r._loaders.length;)if(r._loaders[r._startIndex].endLoad(),r._startIndex++,L.Browser.now()-t>r.maxTimeOut)return console.warn("loader callback cost a long time:"+(L.Browser.now()-t)+" url="+r._loaders[r._startIndex-1].url),void m.ILaya.systemTimer.frameOnce(1,null,r.checkNext);r._loaders.length=0,r._startIndex=0,r._isWorking=!1}},{key:"clearRes",value:function(t){t=B.URL.formatURL(t);var e=r.getAtlas(t);if(e){for(var i=0,a=e.length;i<a;i++){var n=e[i],s=r.getRes(n);delete r.textureMap[n],s&&s.destroy()}e.length=0,delete r.atlasMap[t]}var l=r.textureMap[t];l&&(l.destroy(),delete r.textureMap[t]),r.loadedMap[t]&&delete r.loadedMap[t]}},{key:"clearTextureRes",value:function(t){t=B.URL.formatURL(t);var e=r.getAtlas(t);if(e&&e.length>0)(0,c.default)(e).call(e,(function(t){var e=r.getRes(t);e instanceof E.Texture&&e.disposeBitmap()}));else{var i=r.getRes(t);i instanceof E.Texture&&i.disposeBitmap()}}},{key:"getRes",value:function(t){return r.textureMap[B.URL.formatURL(t)]||r.loadedMap[B.URL.formatURL(t)]}},{key:"getAtlas",value:function(t){return r.atlasMap[B.URL.formatURL(t)]}},{key:"cacheRes",value:function(t,e){t=B.URL.formatURL(t),null!=r.loadedMap[t]?console.warn("Resources already exist,is repeated loading:",t):e instanceof E.Texture?(r.loadedMap[t]=e.bitmap,r.textureMap[t]=e):r.loadedMap[t]=e}},{key:"cacheResForce",value:function(t,e){r.loadedMap[t]=e}},{key:"cacheTexture",value:function(t,e){t=B.URL.formatURL(t),null!=r.textureMap[t]?console.warn("Resources already exist,is repeated loading:",t):r.textureMap[t]=e}},{key:"setGroup",value:function(t,e){r.groupMap[e]||(r.groupMap[e]=[]),r.groupMap[e].push(t)}},{key:"clearResByGroup",value:function(t){if(r.groupMap[t]){var e,i=r.groupMap[t],a=i.length;for(e=0;e<a;e++)r.clearRes(i[e]);i.length=0}}}]),r}(C.EventDispatcher);e.Loader=F,(0,g.default)(F,"TEXT","text"),(0,g.default)(F,"JSON","json"),(0,g.default)(F,"PREFAB","prefab"),(0,g.default)(F,"XML","xml"),(0,g.default)(F,"BUFFER","arraybuffer"),(0,g.default)(F,"IMAGE","image"),(0,g.default)(F,"SOUND","sound"),(0,g.default)(F,"ATLAS","atlas"),(0,g.default)(F,"FONT","font"),(0,g.default)(F,"TTF","ttf"),(0,g.default)(F,"PLF","plf"),(0,g.default)(F,"PLFB","plfb"),(0,g.default)(F,"HIERARCHY","HIERARCHY"),(0,g.default)(F,"MESH","MESH"),(0,g.default)(F,"MATERIAL","MATERIAL"),(0,g.default)(F,"TEXTURE2D","TEXTURE2D"),(0,g.default)(F,"TEXTURECUBE","TEXTURECUBE"),(0,g.default)(F,"ANIMATIONCLIP","ANIMATIONCLIP"),(0,g.default)(F,"AVATAR","AVATAR"),(0,g.default)(F,"TERRAINHEIGHTDATA","TERRAINHEIGHTDATA"),(0,g.default)(F,"TERRAINRES","TERRAIN"),(0,g.default)(F,"typeMap",{ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer",wasm:"arraybuffer"}),(0,g.default)(F,"parserMap",{}),(0,g.default)(F,"maxTimeOut",100),(0,g.default)(F,"groupMap",{}),(0,g.default)(F,"loadedMap",{}),(0,g.default)(F,"atlasMap",{}),(0,g.default)(F,"textureMap",{}),(0,g.default)(F,"preLoadedMap",{}),(0,g.default)(F,"_imgCache",{}),(0,g.default)(F,"_loaders",[]),(0,g.default)(F,"_isWorking",!1),(0,g.default)(F,"_startIndex",0)},33321:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.LoaderManager=void 0;var s=r(i(81643)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(93561),v=i(63969),y=i(65700),p=i(70084),g=i(8865),m=i(29148),x=i(35696),T=i(11179),k=i(34426),C=i(84581);function S(t){var e=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;i=a(n,arguments,r)}else i=n.apply(this,arguments);return(0,c.default)(this,i)}}var E=function(t){(0,h.default)(i,t);var e=S(i);function i(){var t;(0,l.default)(this,i),t=e.call(this),(0,f.default)((0,u.default)(t),"retryNum",1),(0,f.default)((0,u.default)(t),"retryDelay",0),(0,f.default)((0,u.default)(t),"maxLoader",5),(0,f.default)((0,u.default)(t),"_loaders",[]),(0,f.default)((0,u.default)(t),"_loaderCount",0),(0,f.default)((0,u.default)(t),"_resInfos",[]),(0,f.default)((0,u.default)(t),"_infoPool",[]),(0,f.default)((0,u.default)(t),"_maxPriority",5),(0,f.default)((0,u.default)(t),"_failRes",{}),(0,f.default)((0,u.default)(t),"_statInfo",{count:1,loaded:1});for(var a=0;a<t._maxPriority;a++)t._resInfos[a]=[];return t}return(0,o.default)(i,[{key:"getProgress",value:function(){return this._statInfo.loaded/this._statInfo.count}},{key:"resetProgress",value:function(){this._statInfo.count=this._statInfo.loaded=1}},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];this._create(t,!0,e,i,a,n,r,s,l)}},{key:"_create",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,o=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];if(t instanceof Array){var u=!0,h=t,c=h.length,d=0;if(a)var f=x.Handler.create(a.caller,a?a.method:null,a.args,!1);for(var _=0;_<c;_++){var v=h[_];"string"==typeof v&&(v=h[_]={url:v}),v.progress=0}for(_=0;_<c;_++){v=h[_];var y=a?x.Handler.create(null,(function(t,e){t.progress=e;for(var i=0,a=0;a<c;a++)i+=h[a].progress;var n=i/c;f.runWith(n)}),[v],!1):null,p=a||i?x.Handler.create(null,(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;d++,t.progress=1,e||(u=!1),d===c&&i&&i.runWith(u)}),[v]):null;this._createOne(v.url,e,p,y,v.type||n,v.constructParams||r,v.propertyParams||s,v.priority||l,o)}}else this._createOne(t,e,i,a,n,r,s,l,o)}},{key:"_createOne",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],h=this.getRes(t);if(h)!e&&h instanceof g.Resource&&h._addReference(),n&&n.runWith(1),a&&a.runWith(h);else{var c=i.createMap[T.Utils.getFilecompatibleExtension(t)]?T.Utils.getFilecompatibleExtension(t):T.Utils.getFileExtension(t);if(r||(r=i.createMap[c]?i.createMap[c][0]:null),!r)return void this.load(t,a,n,r,o,u);var d=C.Loader.parserMap;if(!d[r])return void this.load(t,a,n,r,o,u);this._createLoad(t,x.Handler.create(null,(function(i){i&&(!e&&i instanceof g.Resource&&i._addReference(),i._setCreateURL(t)),a&&a.runWith(i),_.ILaya.loader.event(t)})),n,r,s,l,o,u,!0)}}},{key:"load",value:function(t){var e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:_.ILaya.WorkerLoader.enable;if(t instanceof Array)return this._loadAssets(t,a,n,r,l,o,u);if(r||(r=0===(0,s.default)(t).call(t,"data:image")?C.Loader.IMAGE:C.Loader.getTypeFromUrl(t)),r===C.Loader.IMAGE?(e=C.Loader.textureMap[p.URL.formatURL(t)])&&e.bitmap&&e.bitmap.destroyed&&(e=null):e=C.Loader.loadedMap[p.URL.formatURL(t)],h||null==e){var d;d=t,(t=k.AtlasInfoManager.getFileLoadPath(t))!=d&&"nativeimage"!==r?r=C.Loader.ATLAS:d=null;var f=i._resMap[t];f?(a&&(d?a&&f._createListener(v.Event.COMPLETE,this,this._resInfoLoaded,[d,a],!1,!1):a&&f._createListener(v.Event.COMPLETE,a.caller,a.method,a.args,!1,!1)),n&&f._createListener(v.Event.PROGRESS,n.caller,n.method,n.args,!1,!1)):((f=this._infoPool.length?this._infoPool.pop():new M).url=t,f.type=r,f.cache=o,f.group=u,f.ignoreCache=h,f.useWorkerLoader=c,f.originalUrl=d,a&&f.on(v.Event.COMPLETE,a.caller,a.method,a.args),n&&f.on(v.Event.PROGRESS,n.caller,n.method,n.args),i._resMap[t]=f,l=l<this._maxPriority?l:this._maxPriority-1,this._resInfos[l].push(f),this._statInfo.count++,this.event(v.Event.PROGRESS,this.getProgress()),this._next())}else _.ILaya.systemTimer.callLater(this,(function(){n&&n.runWith(1),a&&a.runWith(e instanceof Array?[e]:e),this._loaderCount||this.event(v.Event.COMPLETE)}));return this}},{key:"_resInfoLoaded",value:function(t,e){e.runWith(C.Loader.getRes(t))}},{key:"_createLoad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(t instanceof Array)return this._loadAssets(t,e,a,n,l,o);var h=C.Loader.getRes(t);if(null!=h)_.ILaya.systemTimer.frameOnce(1,this,(function(){a&&a.runWith(1),e&&e.runWith(h),this._loaderCount||this.event(v.Event.COMPLETE)}));else{var c=i._resMap[t];c?(e&&c._createListener(v.Event.COMPLETE,e.caller,e.method,e.args,!1,!1),a&&c._createListener(v.Event.PROGRESS,a.caller,a.method,a.args,!1,!1)):((c=this._infoPool.length?this._infoPool.pop():new M).url=t,c.type=n,c.cache=!1,c.ignoreCache=u,c.originalUrl=null,c.group=null,c.createCache=o,c.createConstructParams=r,c.createPropertyParams=s,e&&c.on(v.Event.COMPLETE,e.caller,e.method,e.args),a&&c.on(v.Event.PROGRESS,a.caller,a.method,a.args),i._resMap[t]=c,l=l<this._maxPriority?l:this._maxPriority-1,this._resInfos[l].push(c),this._statInfo.count++,this.event(v.Event.PROGRESS,this.getProgress()),this._next())}return this}},{key:"_next",value:function(){if(!(this._loaderCount>=this.maxLoader)){for(var t=0;t<this._maxPriority;t++)for(var e=this._resInfos[t];e.length>0;){var i=e.shift();if(i)return this._doLoad(i)}this._loaderCount||this.event(v.Event.COMPLETE)}}},{key:"_doLoad",value:function(t){this._loaderCount++;var e=this._loaders.length?this._loaders.pop():new C.Loader;e.on(v.Event.COMPLETE,null,a),e.on(v.Event.PROGRESS,null,(function(e){t.event(v.Event.PROGRESS,e)})),e.on(v.Event.ERROR,null,(function(t){a(null)}));var i=this;function a(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.offAll(),e._data=null,e._customParse=!1,i._loaders.push(e),i._endLoad(t,a instanceof Array?[a]:a),i._loaderCount--,i._next()}e._constructParams=t.createConstructParams,e._propertyParams=t.createPropertyParams,e._createCache=t.createCache,e.load(t.url,t.type,t.cache,t.group,t.ignoreCache,t.useWorkerLoader)}},{key:"_endLoad",value:function(t,e){var a=t.url;if(null==e){var n=this._failRes[a]||0;if(n<this.retryNum)return console.warn("[warn]Retry to load:",a),this._failRes[a]=n+1,void _.ILaya.systemTimer.once(this.retryDelay,this,this._addReTry,[t],!1);C.Loader.clearRes(a),console.warn("[error]Failed to load:",a),this.event(v.Event.ERROR,a)}this._failRes[a]&&(this._failRes[a]=0),delete i._resMap[a],t.originalUrl&&(e=C.Loader.getRes(t.originalUrl)),t.event(v.Event.COMPLETE,e),t.offAll(),this._infoPool.push(t),this._statInfo.loaded++,this.event(v.Event.PROGRESS,this.getProgress())}},{key:"_addReTry",value:function(t){this._resInfos[this._maxPriority-1].push(t),this._next()}},{key:"clearRes",value:function(t){C.Loader.clearRes(t)}},{key:"clearTextureRes",value:function(t){C.Loader.clearTextureRes(t)}},{key:"getRes",value:function(t){return C.Loader.getRes(t)}},{key:"cacheRes",value:function(t,e){C.Loader.cacheRes(t,e)}},{key:"setGroup",value:function(t,e){C.Loader.setGroup(t,e)}},{key:"clearResByGroup",value:function(t){C.Loader.clearResByGroup(t)}},{key:"clearUnLoaded",value:function(){for(var t=0;t<this._maxPriority;t++){for(var e=this._resInfos[t],a=e.length-1;a>-1;a--){var n=e[a];n&&(n.offAll(),this._infoPool.push(n))}e.length=0}this._loaderCount=0,i._resMap={}}},{key:"cancelLoadByUrls",value:function(t){if(t)for(var e=0,i=t.length;e<i;e++)this.cancelLoadByUrl(t[e])}},{key:"cancelLoadByUrl",value:function(t){for(var e=0;e<this._maxPriority;e++)for(var a=this._resInfos[e],n=a.length-1;n>-1;n--){var r=a[n];r&&r.url===t&&(a[n]=null,r.offAll(),this._infoPool.push(r))}i._resMap[t]&&delete i._resMap[t]}},{key:"_loadAssets",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=t.length,o=0,u=0,h=[],c=!0,d=0;d<l;d++){var f=t[d],_=void 0;(_="string"==typeof f?{url:f,type:a,size:1,priority:n}:f).size||(_.size=1),_.progress=0,u+=_.size,h.push(_);var v=i?x.Handler.create(null,g,[_],!1):null,y=e||i?x.Handler.create(null,p,[_]):null;this.load(_.url,y,v,_.type,_.priority||1,r,_.group||s,!1,_.useWorkerLoader)}function p(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o++,t.progress=1,i||(c=!1),o===l&&e&&e.runWith(c)}function g(t,e){if(null!=i){t.progress=e;for(var a=0,n=0;n<h.length;n++){var r=h[n];if(r){var s=null==r.progress?0:r.progress;a+=null==r.size?0:r.size*s}}var l=a/u;i.runWith(l)}}return this}},{key:"decodeBitmaps",value:function(t){var e,i,a=t.length;for(i=_.ILaya.Render._context,e=0;e<a;e++){var n,r;(n=C.Loader.getAtlas(t[e]))?this._decodeTexture(n[0],i):(r=this.getRes(t[e]))&&r instanceof m.Texture&&this._decodeTexture(r,i)}}},{key:"_decodeTexture",value:function(t,e){var i=t.bitmap;if(t&&i){var a=i.source||i.image;a&&a instanceof HTMLImageElement&&(e.drawImage(a,0,0,1,1),e.getImageData(0,0,1,1))}}}],[{key:"cacheRes",value:function(t,e){C.Loader.cacheRes(t,e)}}]),i}(y.EventDispatcher);e.LoaderManager=E,(0,f.default)(E,"_resMap",{}),(0,f.default)(E,"createMap",{atlas:[null,C.Loader.ATLAS]});var M=function(t){(0,h.default)(i,t);var e=S(i);function i(){return(0,l.default)(this,i),e.apply(this,arguments)}return(0,o.default)(i)}(y.EventDispatcher)},71658:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.LocalStorage=void 0;var r=n(i(59340)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"__init__",value:function(){return t._baseClass||(t._baseClass=h,h.init()),t.items=t._baseClass.items,t.support=t._baseClass.support,t.support}},{key:"setItem",value:function(e,i){t._baseClass.setItem(e,i)}},{key:"getItem",value:function(e){return t._baseClass.getItem(e)}},{key:"setJSON",value:function(e,i){t._baseClass.setJSON(e,i)}},{key:"getJSON",value:function(e){return t._baseClass.getJSON(e)}},{key:"removeItem",value:function(e){t._baseClass.removeItem(e)}},{key:"clear",value:function(){t._baseClass.clear()}}]),t}();e.LocalStorage=u,(0,o.default)(u,"support",!1);var h=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"init",value:function(){try{t.support=!0,t.items=window.localStorage,t.setItem("laya","1"),t.removeItem("laya")}catch(e){t.support=!1}t.support||console.log("LocalStorage is not supprot or browser is private mode.")}},{key:"setItem",value:function(e,i){try{t.support&&t.items.setItem(e,i)}catch(t){console.warn("set localStorage failed",t)}}},{key:"getItem",value:function(e){return t.support?t.items.getItem(e):null}},{key:"setJSON",value:function(e,i){try{t.support&&t.items.setItem(e,(0,r.default)(i))}catch(t){console.warn("set localStorage failed",t)}}},{key:"getJSON",value:function(e){try{return JSON.parse(t.support?t.items.getItem(e):null)}catch(i){return t.items.getItem(e)}}},{key:"removeItem",value:function(e){t.support&&t.items.removeItem(e)}},{key:"clear",value:function(){t.support&&t.items.clear()}}]),t}();(0,o.default)(h,"support",!1)},38263:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.SceneLoader=void 0;var s=r(i(81643)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(84581),v=i(93561),y=i(34426),p=i(33321),g=i(88587),m=i(63969),x=i(65700),T=i(35696),k=i(11179);var C=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t;return(0,l.default)(this,r),(t=n.call(this))._completeHandler=new T.Handler((0,u.default)(t),t.onOneLoadComplete),t.reset(),t}return(0,o.default)(r,[{key:"reset",value:function(){this._toLoadList=[],this._isLoading=!1,this.totalCount=0}},{key:"leftCount",get:function(){return this._isLoading?this._toLoadList.length+1:this._toLoadList.length}},{key:"loadedCount",get:function(){return this.totalCount-this.leftCount}},{key:"load",value:function(t){var e,i,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t instanceof Array)for(i=t.length,e=0;e<i;e++)this._addToLoadList(t[e],a);else this._addToLoadList(t,a);n&&this._checkNext()}},{key:"_addToLoadList",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,s.default)(e=this._toLoadList).call(e,t)>=0||_.Loader.getRes(t)||(i?this._toLoadList.push({url:t}):this._toLoadList.push(t),this.totalCount++)}},{key:"_checkNext",value:function(){if(!this._isLoading){if(0==this._toLoadList.length)return void this.event(m.Event.COMPLETE);var t;"string"==typeof(t=this._toLoadList.pop())?this.loadOne(t):this.loadOne(t.url,!0)}}},{key:"loadOne",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._curUrl=t;var i=k.Utils.getFileExtension(this._curUrl);e?v.ILaya.loader.create(t,this._completeHandler):r.LoadableExtensions[i]?v.ILaya.loader.load(t,this._completeHandler,null,r.LoadableExtensions[i]):t!=y.AtlasInfoManager.getFileLoadPath(t)||r.No3dLoadTypes[i]||!p.LoaderManager.createMap[i]?v.ILaya.loader.load(t,this._completeHandler):v.ILaya.loader.create(t,this._completeHandler)}},{key:"onOneLoadComplete",value:function(){this._isLoading=!1,_.Loader.getRes(this._curUrl)||console.log("Fail to load:",this._curUrl);var t,e=k.Utils.getFileExtension(this._curUrl);r.LoadableExtensions[e]&&((t=_.Loader.getRes(this._curUrl))&&t instanceof g.Prefab&&(t=t.json),t&&(t.loadList&&this.load(t.loadList,!1,!1),t.loadList3D&&this.load(t.loadList3D,!0,!1))),"sk"==e&&this.load(this._curUrl.replace(".sk",".png"),!1,!1),this.event(m.Event.PROGRESS,this.getProgress()),this._checkNext()}},{key:"getProgress",value:function(){return this.loadedCount/this.totalCount}}]),r}(x.EventDispatcher);e.SceneLoader=C,(0,f.default)(C,"LoadableExtensions",{scene:_.Loader.JSON,scene3d:_.Loader.JSON,ani:_.Loader.JSON,ui:_.Loader.JSON,prefab:_.Loader.PREFAB}),(0,f.default)(C,"No3dLoadTypes",{png:!0,jpg:!0,txt:!0})},68837:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TTFLoader=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(93561),u=i(63969),h=i(27175),c=i(31856),d=i(84581),f=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"load",value:function(t){this._url=t;var e=t.toLowerCase().split(".ttf")[0].split("/");this.fontName=e[e.length-1],o.ILaya.Render.isConchApp?this._loadConch():window.FontFace?this._loadWithFontFace():this._loadWithCSS()}},{key:"_loadConch",value:function(){this._http=new c.HttpRequest,this._http.on(u.Event.ERROR,this,this._onErr),this._http.on(u.Event.COMPLETE,this,this._onHttpLoaded),this._http.send(this._url,null,"get",d.Loader.BUFFER)}},{key:"_onHttpLoaded",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,t),this._clearHttp(),this._complete()}},{key:"_clearHttp",value:function(){this._http&&(this._http.off(u.Event.ERROR,this,this._onErr),this._http.off(u.Event.COMPLETE,this,this._onHttpLoaded),this._http=null)}},{key:"_onErr",value:function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)}},{key:"_complete",value:function(){o.ILaya.systemTimer.clear(this,this._complete),o.ILaya.systemTimer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)}},{key:"_checkComplete",value:function(){o.ILaya.Browser.measureText(t._testString,this._fontTxt).width!=this._txtWidth&&this._complete()}},{key:"_loadWithFontFace",value:function(){var t=new window.FontFace(this.fontName,"url('"+this._url+"')");document.fonts.add(t);var e=this;t.loaded.then((function(){e._complete()})),t.load()}},{key:"_createDiv",value:function(){this._div=h.Browser.createElement("div"),this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName,t.position="absolute",t.left="-100px",t.top="-100px",document.body.appendChild(this._div)}},{key:"_loadWithCSS",value:function(){var e=h.Browser.createElement("style");e.type="text/css",document.body.appendChild(e),e.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=h.Browser.measureText(t._testString,this._fontTxt).width;var i=this;e.onload=function(){o.ILaya.systemTimer.once(1e4,i,i._complete)},o.ILaya.systemTimer.loop(20,this,this._checkComplete),this._createDiv()}}]),t}();e.TTFLoader=f,(0,l.default)(f,"_testString","LayaTTFFont")},70084:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.URL=void 0;var r=n(i(81643)),s=n(i(92762)),l=n(i(23054)),o=n(i(87368)),u=n(i(28146)),h=n(i(17454)),c=i(93561),d=function(){function t(e){(0,o.default)(this,t),this._url=t.formatURL(e),this._path=t.getPath(e)}return(0,u.default)(t,[{key:"url",get:function(){return this._url}},{key:"path",get:function(){return this._path}}],[{key:"basePath",get:function(){return t._basePath},set:function(e){t._basePath=c.ILaya.Laya._getUrlPath(),t._basePath=t.formatURL(e)}},{key:"formatURL",value:function(e){if(!e)return"null path";if((0,r.default)(e).call(e,":")>0)return e;if(t.exportSceneToJson&&(e=t.getAdptedFilePath(e)),null!=t.customFormat&&(e=t.customFormat(e)),(0,r.default)(e).call(e,":")>0)return e;var i=e.charAt(0);if("."===i)return t._formatRelativePath(t._basePath+e);if("~"===i)return t.rootPath+e.substring(1);if("d"===i){if(0===(0,r.default)(e).call(e,"data:image"))return e}else if("/"===i)return e;return t._basePath+e}},{key:"_formatRelativePath",value:function(t){for(var e=t.split("/"),i=0,a=e.length;i<a;i++)".."==e[i]&&((0,s.default)(e).call(e,i-1,2),i-=2);return e.join("/")}},{key:"getPath",value:function(t){var e=(0,l.default)(t).call(t,"/");return e>0?t.substr(0,e+1):""}},{key:"getFileName",value:function(t){var e=(0,l.default)(t).call(t,"/");return e>0?t.substr(e+1):t}},{key:"getAdptedFilePath",value:function(e){if(!t.exportSceneToJson||!e)return e;var i,a,n;for(a=t._adpteTypeList.length,i=0;i<a;i++)n=t._adpteTypeList[i],e=e.replace(n[0],n[1]);return e}}]),t}();e.URL=d,(0,h.default)(d,"version",{}),(0,h.default)(d,"exportSceneToJson",!1),(0,h.default)(d,"_basePath",""),(0,h.default)(d,"rootPath",""),(0,h.default)(d,"customFormat",(function(t){var e=d.version[t];return!window.conch&&e&&(t+="?v="+e),t})),(0,h.default)(d,"_adpteTypeList",[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]])},83219:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.WorkerLoader=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(84581),_=i(70084),v=i(65700),y=i(41009);var p=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t;(0,s.default)(this,r),(t=n.call(this)).worker=new Worker(r.workerPath);var e=(0,o.default)(t);return t.worker.onmessage=function(t){e.workerMessage(t.data)},t}return(0,l.default)(r,[{key:"workerMessage",value:function(t){if(t)switch(t.type){case"Image":this.imageLoaded(t);break;case"Disable":r.enable=!1}}},{key:"imageLoaded",value:function(t){if(t.dataType&&"imageBitmap"==t.dataType){var e=t.imageBitmap;console.log("load:",t.url),this.event(t.url,e)}else this.event(t.url,null)}},{key:"loadImage",value:function(t){this.worker.postMessage(t)}},{key:"_loadImage",value:function(t){var e=this,i=e.type;if(this._useWorkerLoader&&r._enable){t=_.URL.formatURL(t);var a=function(n){if(r.I.off(t,e,a),n){var s=n;"nativeimage"!==i&&(s=new y.Texture2D).loadImageSource(n),e.onLoaded(s)}else r._preLoadFun.call(e,t)};r.I.on(t,e,a),r.I.loadImage(t)}else r._preLoadFun.call(e,t)}}],[{key:"__init__",value:function(){return null==r._preLoadFun&&!!Worker&&(r._preLoadFun=f.Loader.prototype._loadImage,f.Loader.prototype._loadImage=r.prototype._loadImage,r.I||(r.I=new r),!0)}},{key:"workerSupported",value:function(){return!!Worker}},{key:"enableWorkerLoader",value:function(){r._tryEnabled||(r.enable=!0,r._tryEnabled=!0)}},{key:"enable",get:function(){return r._enable},set:function(t){r._enable!=t&&(r._enable=t,t&&null==r._preLoadFun&&(r._enable=r.__init__()))}}]),r}(v.EventDispatcher);e.WorkerLoader=p,(0,d.default)(p,"workerPath","libs/workerloader.js"),(0,d.default)(p,"_enable",!1),(0,d.default)(p,"_tryEnabled",!1)},72448:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.LayaGLQuickRunner=void 0;var r=n(i(2991)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(46222),h=i(46791),c=i(5866),d=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"__init__",value:function(){(0,r.default)(t)[h.SpriteConst.ALPHA|h.SpriteConst.TRANSFORM|h.SpriteConst.GRAPHICS]=t.alpha_transform_drawLayaGL,(0,r.default)(t)[h.SpriteConst.ALPHA|h.SpriteConst.GRAPHICS]=t.alpha_drawLayaGL,(0,r.default)(t)[h.SpriteConst.TRANSFORM|h.SpriteConst.GRAPHICS]=t.transform_drawLayaGL,(0,r.default)(t)[h.SpriteConst.TRANSFORM|h.SpriteConst.CHILDS]=t.transform_drawNodes,(0,r.default)(t)[h.SpriteConst.ALPHA|h.SpriteConst.TRANSFORM|h.SpriteConst.TEXTURE]=t.alpha_transform_drawTexture,(0,r.default)(t)[h.SpriteConst.ALPHA|h.SpriteConst.TEXTURE]=t.alpha_drawTexture,(0,r.default)(t)[h.SpriteConst.TRANSFORM|h.SpriteConst.TEXTURE]=t.transform_drawTexture,(0,r.default)(t)[h.SpriteConst.GRAPHICS|h.SpriteConst.CHILDS]=t.drawLayaGL_drawNodes}},{key:"transform_drawTexture",value:function(e,i,a,n){e._style;var r=e.texture;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,a,n);var s=e._width||r.sourceWidth,l=e._height||r.sourceHeight,o=s/r.sourceWidth,u=l/r.sourceHeight;if(s=r.width*o,l=r.height*u,s<=0||l<=0)return null;var h=-e.pivotX+r.offsetX*o,c=-e.pivotY+r.offsetY*u;i.drawTexture(r,h,c,s,l),i.restoreTransform(t.curMat)}},{key:"alpha_drawTexture",value:function(t,e,i,a){var n,r=t._style,s=t.texture;if((n=r.alpha)>.01||t._needRepaint()){var l=e.globalAlpha;e.globalAlpha*=n;var o=t._width||s.width,u=t._height||s.height,h=o/s.sourceWidth,c=u/s.sourceHeight;if(o=s.width*h,u=s.height*c,o<=0||u<=0)return null;var d=i-r.pivotX+s.offsetX*h,f=a-r.pivotY+s.offsetY*c;e.drawTexture(s,d,f,o,u),e.globalAlpha=l}}},{key:"alpha_transform_drawTexture",value:function(e,i,a,n){var r,s=e._style,l=e.texture;if((r=s.alpha)>.01||e._needRepaint()){var o=i.globalAlpha;i.globalAlpha*=r,i.saveTransform(t.curMat),i.transformByMatrix(e.transform,a,n);var u=e._width||l.sourceWidth,h=e._height||l.sourceHeight,c=u/l.sourceWidth,d=h/l.sourceHeight;if(u=l.width*c,h=l.height*d,u<=0||h<=0)return null;var f=-s.pivotX+l.offsetX*c,_=-s.pivotY+l.offsetY*d;i.drawTexture(l,f,_,u,h),i.restoreTransform(t.curMat),i.globalAlpha=o}}},{key:"alpha_transform_drawLayaGL",value:function(e,i,a,n){var r,s=e._style;if((r=s.alpha)>.01||e._needRepaint()){var l=i.globalAlpha;i.globalAlpha*=r,i.saveTransform(t.curMat),i.transformByMatrix(e.transform,a,n),e._graphics&&e._graphics._render(e,i,-s.pivotX,-s.pivotY),i.restoreTransform(t.curMat),i.globalAlpha=l}}},{key:"alpha_drawLayaGL",value:function(t,e,i,a){var n,r=t._style;if((n=r.alpha)>.01||t._needRepaint()){var s=e.globalAlpha;e.globalAlpha*=n,t._graphics&&t._graphics._render(t,e,i-r.pivotX,a-r.pivotY),e.globalAlpha=s}}},{key:"transform_drawLayaGL",value:function(e,i,a,n){var r=e._style;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,a,n),e._graphics&&e._graphics._render(e,i,-r.pivotX,-r.pivotY),i.restoreTransform(t.curMat)}},{key:"transform_drawNodes",value:function(e,i,a,n){var r=e._getBit(u.Const.DRAWCALL_OPTIMIZE)&&i.drawCallOptimize(!0),s=e._style;i.saveTransform(t.curMat),i.transformByMatrix(e.transform,a,n),a=-s.pivotX,n=-s.pivotY;var l,o=e._children,h=o.length;if(s.viewport){var c,d,f=s.viewport,_=f.x,v=f.y,y=f.right,p=f.bottom;for(g=0;g<h;++g)(l=o[g])._visible&&(c=l._x)<y&&c+l.width>_&&(d=l._y)<p&&d+l.height>v&&l.render(i,a,n)}else for(var g=0;g<h;++g)(l=o[g])._visible&&l.render(i,a,n);i.restoreTransform(t.curMat),r&&i.drawCallOptimize(!1)}},{key:"drawLayaGL_drawNodes",value:function(t,e,i,a){var n=t._getBit(u.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0),r=t._style;i-=r.pivotX,a-=r.pivotY,t._graphics&&t._graphics._render(t,e,i,a);var s,l=t._children,o=l.length;if(r.viewport){var h,c,d=r.viewport,f=d.x,_=d.y,v=d.right,y=d.bottom;for(p=0;p<o;++p)(s=l[p])._visible&&(h=s._x)<v&&h+s.width>f&&(c=s._y)<y&&c+s.height>_&&s.render(e,i,a)}else for(var p=0;p<o;++p)(s=l[p])._visible&&s.render(e,i,a);n&&e.drawCallOptimize(!1)}}]),t}();e.LayaGLQuickRunner=d,(0,o.default)(d,"map",[]),(0,o.default)(d,"curMat",new c.Matrix)},3117:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Render=void 0;var r=n(i(31581)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(93561),h=i(20516),c=i(54008),d=i(23395),f=i(56843),_=i(52379),v=i(14972),y=i(80795),p=i(54347),g=i(54642),m=i(80510),x=i(97806),T=i(1974),k=i(27175),C=i(39498),S=function(){function t(e,i,a){(0,s.default)(this,t),(0,o.default)(this,"_timeId",0),t._mainCanvas=a;var n=t._mainCanvas.source;n.id="layaCanvas",n.width=e,n.height=i,t.isConchApp&&document.body.appendChild(n),this.initRender(t._mainCanvas,e,i),window.requestAnimationFrame((function t(e){u.ILaya.stage._loop(),window.requestAnimationFrame(t)})),u.ILaya.stage.on("visibilitychange",this,this._onVisibilitychange)}return(0,l.default)(t,[{key:"_onVisibilitychange",value:function(){u.ILaya.stage.isVisibility?0!=this._timeId&&window.clearInterval(this._timeId):this._timeId=(0,r.default)(this._enterFrame,1e3)}},{key:"initRender",value:function(e,i,a){var n=c.LayaGL.instance=_.WebGLContext.mainContext=function(t){var e,i=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];h.Config.useWebGL2&&!k.Browser.onBDMiniGame||i.shift();for(var a=0;a<i.length;a++){try{e=t.getContext(i[a],{stencil:h.Config.isStencil,alpha:h.Config.isAlpha,antialias:h.Config.isAntialias,premultipliedAlpha:h.Config.premultipliedAlpha,preserveDrawingBuffer:h.Config.preserveDrawingBuffer})}catch(t){}if(e)return"webgl2"===i[a]&&(f.WebGL._isWebGL2=!0),new c.LayaGL,e}return null}(t._mainCanvas.source);if(h.Config.printWebglOrder&&this._replaceWebglcall(n),!n)return!1;c.LayaGL.instance=n,c.LayaGL.layaGPUInstance=new T.LayaGPU(n,f.WebGL._isWebGL2),e.size(i,a),d.Context.__init__(),x.SubmitBase.__init__();var r=new d.Context;return r.isMain=!0,t._context=r,e._setContext(r),p.ShaderDefines2D.__init__(),g.Value2D.__init__(),y.Shader2D.__init__(),m.Buffer2D.__int__(n),v.BlendMode._init_(n),!0}},{key:"_replaceWebglcall",value:function(t){var e={},i=function(i){"function"==typeof t[i]&&"getError"!=i&&"__SPECTOR_Origin_getError"!=i&&"__proto__"!=i&&(e[i]=t[i],t[i]=function(){for(var a=[],n=0;n<arguments.length;n++)a.push(arguments[n]);var r=e[i].apply(t,a);console.log(C.RenderInfo.loopCount+":gl."+i+":"+a);var s=t.getError();return s&&console.log(s),r})};for(var a in t)i(a)}},{key:"_enterFrame",value:function(){u.ILaya.stage._loop()}}],[{key:"context",get:function(){return t._context}},{key:"canvas",get:function(){return t._mainCanvas.source}}]),t}();e.Render=S,(0,o.default)(S,"supportWebGLPlusAnimation",!1),(0,o.default)(S,"supportWebGLPlusRendering",!1),(0,o.default)(S,"isConchApp",!1),S.isConchApp=null!=window.conch,(S.isConchApp||null!=window.qq&&null!=window.qq.webglPlus)&&(S.supportWebGLPlusRendering=!1)},39498:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.RenderInfo=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.RenderInfo=o,(0,l.default)(o,"loopStTm",0),(0,l.default)(o,"loopCount",0)},99036:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.RenderSprite=void 0;var r=n(i(2991)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(46222),h=i(46791),c=i(34981),d=i(5866),f=i(63701),_=i(29148),v=i(99474),y=i(14880),p=i(14972),g=i(19511),m=i(54347),x=i(54642),T=i(87328),k=i(52379),C=i(72448),S=i(93561),E=function(){function t(e,i){if((0,s.default)(this,t),(0,r.default)(C.LayaGLQuickRunner)[e])return this._fun=(0,r.default)(C.LayaGLQuickRunner)[e],void(this._next=t.NORENDER);switch(this._next=i||t.NORENDER,e){case 0:return void(this._fun=this._no);case h.SpriteConst.ALPHA:return void(this._fun=this._alpha);case h.SpriteConst.TRANSFORM:return void(this._fun=this._transform);case h.SpriteConst.BLEND:return void(this._fun=this._blend);case h.SpriteConst.CANVAS:return void(this._fun=this._canvas);case h.SpriteConst.MASK:return void(this._fun=this._mask);case h.SpriteConst.CLIP:return void(this._fun=this._clip);case h.SpriteConst.STYLE:return void(this._fun=this._style);case h.SpriteConst.GRAPHICS:return void(this._fun=this._graphics);case h.SpriteConst.CHILDS:return void(this._fun=this._children);case h.SpriteConst.CUSTOM:return void(this._fun=this._custom);case h.SpriteConst.TEXTURE:return void(this._fun=this._texture);case h.SpriteConst.FILTERS:return void(this._fun=c.Filter._filter);case t.INIT:return void(this._fun=t._initRenderFun)}this.onCreate(e)}return(0,l.default)(t,[{key:"onCreate",value:function(t){}},{key:"_style",value:function(t,e,i,a){var n=t._style;null!=n.render&&n.render(t,e,i,a);var r=this._next;r._fun.call(r,t,e,i,a)}},{key:"_no",value:function(t,e,i,a){}},{key:"_custom",value:function(t,e,i,a){t.customRender(e,i,a),this._next._fun.call(this._next,t,e,0,0)}},{key:"_clip",value:function(e,i,a,n){var r=this._next;if(r!=t.NORENDER){var s=e._style.scrollRect,l=s.width,o=s.height;0!==l&&0!==o&&(i.save(),i.clipRect(a,n,l,o),r._fun.call(r,e,i,a-s.x,n-s.y),i.restore())}}},{key:"_texture",value:function(e,i,a,n){var r=e.texture;if(r._getSource()){var s=e._width||r.sourceWidth,l=e._height||r.sourceHeight,o=s/r.sourceWidth,u=l/r.sourceHeight;if(s=r.width*o,l=r.height*u,s<=0||l<=0)return;var h=a-e.pivotX+r.offsetX*o,c=n-e.pivotY+r.offsetY*u;i.drawTexture(r,h,c,s,l)}var d=this._next;d!=t.NORENDER&&d._fun.call(d,e,i,a,n)}},{key:"_graphics",value:function(e,i,a,n){var r=e._style,s=e._graphics;s&&s._render(e,i,a-r.pivotX,n-r.pivotY);var l=this._next;l!=t.NORENDER&&l._fun.call(l,e,i,a,n)}},{key:"_image",value:function(t,e,i,a){var n=t._style;e.drawTexture2(i,a,n.pivotX,n.pivotY,t.transform,t._graphics._one)}},{key:"_image2",value:function(t,e,i,a){var n=t._style;e.drawTexture2(i,a,n.pivotX,n.pivotY,t.transform,t._graphics._one)}},{key:"_alpha",value:function(t,e,i,a){var n;if((n=t._style.alpha)>.01||t._needRepaint()){var r=e.globalAlpha;e.globalAlpha*=n;var s=this._next;s._fun.call(s,t,e,i,a),e.globalAlpha=r}}},{key:"_transform",value:function(e,i,a,n){var r=e.transform,s=this._next;e._style,r&&s!=t.NORENDER?(i.save(),i.transform(r.a,r.b,r.c,r.d,r.tx+a,r.ty+n),s._fun.call(s,e,i,0,0),i.restore()):s!=t.NORENDER&&s._fun.call(s,e,i,a,n)}},{key:"_children",value:function(t,e,i,a){var n,r=t._style,s=t._children,l=s.length;i-=t.pivotX,a-=t.pivotY;var o=t._getBit(u.Const.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(!0);if(r.viewport){var h,c,d=r.viewport,f=d.x,_=d.y,v=d.right,y=d.bottom;for(p=0;p<l;++p)(n=s[p])._visible&&(h=n._x)<v&&h+n.width>f&&(c=n._y)<y&&c+n.height>_&&n.render(e,i,a)}else for(var p=0;p<l;++p)(n=s[p])._visible&&n.render(e,i,a);o&&e.drawCallOptimize(!1)}},{key:"_canvas",value:function(t,e,i,a){var n=t._cacheStyle,r=this._next;if(n.enableCanvasRender){"bitmap"===n.cacheAs?y.Stat.canvasBitmap++:y.Stat.canvasNormal++;var s=!1,l=!1;if(n.canvas){var o=n.canvas,u=(o.context,o.touches);if(u)for(var h=0;h<u.length;h++)if(u[h].deleted){l=!0;break}s=o.isCacheValid&&!o.isCacheValid()}if(t._needRepaint()||!n.canvas||l||s||S.ILaya.stage.isGlobalRepaint())if("normal"===n.cacheAs){if(e._targets)return void r._fun.call(r,t,e,i,a);this._canvas_webgl_normal_repaint(t,e)}else this._canvas_repaint(t,e,i,a);var c=n.cacheRect;e.drawCanvas(n.canvas,i+c.x,a+c.y,c.width,c.height)}else r._fun.call(r,t,e,i,a)}},{key:"_canvas_repaint",value:function(t,e,i,a){var n,r,s,l,o,u,h,c,d,f=t._cacheStyle,_=this._next,v=f.canvas,p=f.cacheAs;if(h=(d=f._calculateCacheRect(t,p,i,a)).x,c=d.y,o=(l=f.cacheRect).width*h,u=l.height*c,r=l.x,s=l.y,"bitmap"===p&&(o>2048||u>2048))return console.warn("cache bitmap size larger than 2048,cache ignored"),f.releaseContext(),void _._fun.call(_,t,e,i,a);if(v||(f.createContext(),v=f.canvas),(n=v.context).sprite=t,(v.width!=o||v.height!=u)&&v.size(o,u),"bitmap"===p?n.asBitmap=!0:"normal"===p&&(n.asBitmap=!1),n.clear(),1!=h||1!=c){var g=n;g.save(),g.scale(h,c),_._fun.call(_,t,n,-r,-s),g.restore(),t._applyFilters()}else g=n,_._fun.call(_,t,n,-r,-s),t._applyFilters();f.staticCache&&(f.reCache=!1),y.Stat.canvasReCache++}},{key:"_canvas_webgl_normal_repaint",value:function(t,e){var i=t._cacheStyle,a=this._next,n=i.canvas,r=i.cacheAs;i._calculateCacheRect(t,r,0,0),n||(n=new g.WebGLCacheAsNormalCanvas(e,t),i.canvas=n);var s=n.context;n.startRec(),a._fun.call(a,t,s,t.pivotX,t.pivotY),t._applyFilters(),y.Stat.canvasReCache++,n.endRec()}},{key:"_blend",value:function(t,e,i,a){var n=t._style,r=this._next;n.blendMode?(e.save(),e.globalCompositeOperation=n.blendMode,r._fun.call(r,t,e,i,a),e.restore()):r._fun.call(r,t,e,i,a)}},{key:"_mask",value:function(e,i,a,n){var r=this._next,s=e.mask,l=i;if(s){l.save();var o=l.globalCompositeOperation,u=new f.Rectangle;if(u.copyFrom(s.getBounds()),u.width=Math.round(u.width),u.height=Math.round(u.height),u.x=Math.round(u.x),u.y=Math.round(u.y),u.width>0&&u.height>0){var h=u.width,c=u.height,y=v.WebGLRTMgr.getRT(h,c);l.breakNextMerge(),l.pushRT(),l.addRenderObject(T.SubmitCMD.create([l,y,h,c],t.tmpTarget,this)),s.render(l,-u.x,-u.y),l.breakNextMerge(),l.popRT(),l.save();l.clipRect(a+u.x-e.getStyle().pivotX+.1,n+u.y-e.getStyle().pivotY+.1,h-.2,c-.2),r._fun.call(r,e,l,a,n),l.restore(),o=l.globalCompositeOperation,l.addRenderObject(T.SubmitCMD.create(["mask"],t.setBlendMode,this));var p=x.Value2D.create(m.ShaderDefines2D.TEXTURE2D,0),g=_.Texture.INV_UV;l.drawTarget(y,a+u.x-e.getStyle().pivotX,n+u.y-e.getStyle().pivotY,h,c,d.Matrix.TEMP.identity(),p,g,6),l.addRenderObject(T.SubmitCMD.create([y],t.recycleTarget,this)),l.addRenderObject(T.SubmitCMD.create([o],t.setBlendMode,this))}l.restore()}else r._fun.call(r,e,i,a,n)}}],[{key:"__init__",value:function(){var e,i,a;for(C.LayaGLQuickRunner.__init__(),a=new t(t.INIT,null),i=t.renders.length=2*h.SpriteConst.CHILDS,e=0;e<i;e++)t.renders[e]=a;t.renders[0]=new t(0,null)}},{key:"_initRenderFun",value:function(e,i,a,n){var r=e._renderType;(t.renders[r]=t._getTypeRender(r))._fun(e,i,a,n)}},{key:"_getTypeRender",value:function(e){if((0,r.default)(C.LayaGLQuickRunner)[e])return new t(e,null);for(var i=null,a=h.SpriteConst.CHILDS;a>0;)a&e&&(i=new t(a,i)),a>>=1;return i}},{key:"tmpTarget",value:function(t,e,i,a){e.start(),e.clear(0,0,0,0)}},{key:"recycleTarget",value:function(t){v.WebGLRTMgr.releaseRT(t)}},{key:"setBlendMode",value:function(t){var e=k.WebGLContext.mainContext;p.BlendMode.targetFns[p.BlendMode.TOINT[t]](e)}}]),t}();e.RenderSprite=E,(0,o.default)(E,"INIT",69905),(0,o.default)(E,"renders",[]),(0,o.default)(E,"NORENDER",new E(0,null)),(0,o.default)(E,"tempUV",new Array(8))},18195:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.BaseTexture=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(54008),f=i(52379),_=i(74935),v=i(63454),y=i(96719),p=i(13156);var g=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(t,e){var i;return(0,s.default)(this,r),(i=n.call(this))._wrapModeU=p.WarpMode.Repeat,i._wrapModeV=p.WarpMode.Repeat,i._filterMode=v.FilterMode.Bilinear,i._readyed=!1,i._width=-1,i._height=-1,i._format=t,i._mipmap=e,i._anisoLevel=1,i._glTexture=d.LayaGL.instance.createTexture(),i}return(0,l.default)(r,[{key:"mipmap",get:function(){return this._mipmap}},{key:"format",get:function(){return this._format}},{key:"wrapModeU",get:function(){return this._wrapModeU},set:function(t){this._wrapModeU!==t&&(this._wrapModeU=t,-1!==this._width&&this._setWarpMode(d.LayaGL.instance.TEXTURE_WRAP_S,t))}},{key:"wrapModeV",get:function(){return this._wrapModeV},set:function(t){this._wrapModeV!==t&&(this._wrapModeV=t,-1!==this._height&&this._setWarpMode(d.LayaGL.instance.TEXTURE_WRAP_T,t))}},{key:"filterMode",get:function(){return this._filterMode},set:function(t){t!==this._filterMode&&(this._filterMode=t,-1!==this._width&&-1!==this._height&&this._setFilterMode(t))}},{key:"anisoLevel",get:function(){return this._anisoLevel},set:function(t){t!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,t)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(t))}},{key:"mipmapCount",get:function(){return this._mipmapCount}},{key:"defaulteTexture",get:function(){throw"BaseTexture:must override it."}},{key:"_getFormatByteCount",value:function(){switch(this._format){case y.TextureFormat.R8G8B8:return 3;case y.TextureFormat.R8G8B8A8:return 4;case y.TextureFormat.R5G6B5:case y.TextureFormat.Alpha8:return 1;case y.TextureFormat.R16G16B16A16:return 2;case y.TextureFormat.R32G32B32A32:return 4;default:throw"Texture2D: unknown format."}}},{key:"_isPot",value:function(t){return 0==(t&t-1)}},{key:"_getGLFormat",value:function(){var t,e=d.LayaGL.instance,i=d.LayaGL.layaGPUInstance;switch(this._format){case y.TextureFormat.R8G8B8:case y.TextureFormat.R5G6B5:t=e.RGB;break;case y.TextureFormat.R8G8B8A8:t=e.RGBA;break;case y.TextureFormat.Alpha8:t=e.ALPHA;break;case y.TextureFormat.R32G32B32A32:case y.TextureFormat.R16G16B16A16:t=e.RGBA;break;case y.TextureFormat.DXT1:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";t=i._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case y.TextureFormat.DXT5:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";t=i._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case y.TextureFormat.ETC1RGB:if(!i._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";t=i._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case y.TextureFormat.ETC2RGB:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2RGB format.";t=i._compressedTextureETC.COMPRESSED_RGB8_ETC2;break;case y.TextureFormat.ETC2RGBA:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2RGBA format.";t=i._compressedTextureETC.COMPRESSED_RGBA8_ETC2_EAC;break;case y.TextureFormat.ETC2RGB_Alpha8:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2SRGB_Alpha8 format.";t=i._compressedTextureETC.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC;break;case y.TextureFormat.ETC2SRGB:if(!i._compressedTextureETC)throw"BaseTexture: not support ETC2SRGB format.";t=i._compressedTextureETC.COMPRESSED_SRGB8_ETC2;break;case y.TextureFormat.PVRTCRGB_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case y.TextureFormat.PVRTCRGBA_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case y.TextureFormat.PVRTCRGB_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case y.TextureFormat.PVRTCRGBA_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";t=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case y.TextureFormat.ASTC4x4:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC4x4 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_4x4_KHR;break;case y.TextureFormat.ASTC4x4SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC4x4_KHR format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case y.TextureFormat.ASTC6x6:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC6x6 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_6x6_KHR;break;case y.TextureFormat.ASTC6x6SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC6x6_KHR format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR;break;case y.TextureFormat.ASTC8x8:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC8x8 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_8x8_KHR;break;case y.TextureFormat.ASTC8x8SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC8x8 format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR;break;case y.TextureFormat.ASTC10x10:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC10x10 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_10x10_KHR;break;case y.TextureFormat.ASTC10x10SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC10x10 format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR;break;case y.TextureFormat.ASTC12x12:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC12x12 format.";t=i._compressedTextureASTC.COMPRESSED_RGBA_ASTC_12x12_KHR;break;case y.TextureFormat.ASTC12x12SRGB:if(!i._compressedTextureASTC)throw"BaseTexture: not support ASTC12x12 format.";t=i._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR;break;default:throw"BaseTexture: unknown texture format."}return t}},{key:"_setFilterMode",value:function(t){var e=d.LayaGL.instance;switch(f.WebGLContext.bindTexture(e,this._glTextureType,this._glTexture),t){case v.FilterMode.Point:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.NEAREST);break;case v.FilterMode.Bilinear:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case v.FilterMode.Trilinear:this._mipmap?e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR):e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.")}}},{key:"_setWarpMode",value:function(t,e){var i=d.LayaGL.instance;if(f.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(e){case p.WarpMode.Repeat:i.texParameteri(this._glTextureType,t,i.REPEAT);break;case p.WarpMode.Clamp:i.texParameteri(this._glTextureType,t,i.CLAMP_TO_EDGE)}else i.texParameteri(this._glTextureType,t,i.CLAMP_TO_EDGE)}},{key:"_setAnisotropy",value:function(t){var e=d.LayaGL.layaGPUInstance._extTextureFilterAnisotropic;if(e){t=Math.max(t,1);var i=d.LayaGL.instance;f.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture),t=Math.min(i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t),i.texParameterf(this._glTextureType,e.TEXTURE_MAX_ANISOTROPY_EXT,t)}}},{key:"_disposeResource",value:function(){this._glTexture&&(d.LayaGL.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))}},{key:"_getSource",value:function(){return this._readyed?this._glTexture:null}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)&&d.LayaGL.instance.generateMipmap(this._glTextureType)}}]),r}(_.Bitmap);e.BaseTexture=g,(0,c.default)(g,"_rgbmRange",5),(0,c.default)(g,"FORMAT_R8G8B8",0),(0,c.default)(g,"FORMAT_R8G8B8A8",1),(0,c.default)(g,"FORMAT_ALPHA8",2),(0,c.default)(g,"FORMAT_DXT1",3),(0,c.default)(g,"FORMAT_DXT5",4),(0,c.default)(g,"FORMAT_ETC1RGB",5),(0,c.default)(g,"FORMAT_PVRTCRGB_2BPPV",9),(0,c.default)(g,"FORMAT_PVRTCRGBA_2BPPV",10),(0,c.default)(g,"FORMAT_PVRTCRGB_4BPPV",11),(0,c.default)(g,"FORMAT_PVRTCRGBA_4BPPV",12),(0,c.default)(g,"RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT",14),(0,c.default)(g,"FORMAT_R32G32B32A32",15),(0,c.default)(g,"FORMAT_DEPTH_16",0),(0,c.default)(g,"FORMAT_STENCIL_8",1),(0,c.default)(g,"FORMAT_DEPTHSTENCIL_16_8",2),(0,c.default)(g,"FORMAT_DEPTHSTENCIL_NONE",3),(0,c.default)(g,"FILTERMODE_POINT",0),(0,c.default)(g,"FILTERMODE_BILINEAR",1),(0,c.default)(g,"FILTERMODE_TRILINEAR",2),(0,c.default)(g,"WARPMODE_REPEAT",0),(0,c.default)(g,"WARPMODE_CLAMP",1)},74935:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Bitmap=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669));var c=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t;return(0,s.default)(this,r),(t=n.call(this))._width=-1,t._height=-1,t}return(0,l.default)(r,[{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"_getSource",value:function(){throw"Bitmap: must override it."}}]),r}(i(8865).Resource);e.Bitmap=c},23395:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Context=void 0;var r=n(i(3649)),s=n(i(44494)),l=n(i(77766)),o=n(i(78914)),u=n(i(87368)),h=n(i(28146)),c=n(i(17454)),d=i(93561),f=i(54008),_=i(13212),v=i(5866),y=i(91020),p=i(63701),g=i(14880),m=i(14972),x=i(57552),T=i(23418),k=i(11426),C=i(79870),S=i(51498),E=i(47314),M=i(56790),L=i(19511),b=i(83530),I=i(80795),R=i(54347),w=i(48991),A=i(54642),B=i(33761),D=i(30582),P=i(73943),F=i(97806),O=i(61888),U=i(87328),N=i(84666),G=i(58585),H=i(59445),W=i(47198),V=i(74433),Y=i(93543),X=i(45147),z=i(50642),K=i(33965),j=i(52379),q=i(43269),Z=i(52719),Q=i(29148),$=i(41009),J=function(){function t(){if((0,u.default)(this,t),(0,c.default)(this,"_tmpMatrix",new v.Matrix),(0,c.default)(this,"_drawTexToDrawTri_Vert",new Float32Array(8)),(0,c.default)(this,"_drawTexToDrawTri_Index",new Uint16Array([0,1,2,0,2,3])),(0,c.default)(this,"_tempUV",new Float32Array(8)),(0,c.default)(this,"_drawTriUseAbsMatrix",!1),(0,c.default)(this,"_id",++t._COUNT),(0,c.default)(this,"_other",null),(0,c.default)(this,"_renderNextSubmitIndex",0),(0,c.default)(this,"_path",null),(0,c.default)(this,"_drawCount",1),(0,c.default)(this,"_width",t._MAXSIZE),(0,c.default)(this,"_height",t._MAXSIZE),(0,c.default)(this,"_renderCount",0),(0,c.default)(this,"_submits",null),(0,c.default)(this,"_curSubmit",null),(0,c.default)(this,"_submitKey",new N.SubmitKey),(0,c.default)(this,"_pathMesh",null),(0,c.default)(this,"_triangleMesh",null),(0,c.default)(this,"meshlist",[]),(0,c.default)(this,"_transedPoints",new Array(8)),(0,c.default)(this,"_temp4Points",new Array(8)),(0,c.default)(this,"_clipRect",t.MAXCLIPRECT),(0,c.default)(this,"_globalClipMatrix",new v.Matrix(t._MAXSIZE,0,0,t._MAXSIZE,0,0)),(0,c.default)(this,"_clipInCache",!1),(0,c.default)(this,"_clipInfoID",0),(0,c.default)(this,"_clipID_Gen",0),(0,c.default)(this,"_lastMatScaleX",1),(0,c.default)(this,"_lastMatScaleY",1),(0,c.default)(this,"_lastMat_a",1),(0,c.default)(this,"_lastMat_b",0),(0,c.default)(this,"_lastMat_c",0),(0,c.default)(this,"_lastMat_d",1),(0,c.default)(this,"_nBlendType",0),(0,c.default)(this,"_save",null),(0,c.default)(this,"_targets",null),(0,c.default)(this,"_charSubmitCache",null),(0,c.default)(this,"_saveMark",null),(0,c.default)(this,"_shader2D",new I.Shader2D),(0,c.default)(this,"sprite",null),(0,c.default)(this,"_italicDeg",0),(0,c.default)(this,"_lastTex",null),(0,c.default)(this,"_fillColor",0),(0,c.default)(this,"_flushCnt",0),(0,c.default)(this,"defTexture",null),(0,c.default)(this,"_colorFiler",null),(0,c.default)(this,"drawTexAlign",!1),(0,c.default)(this,"_incache",!1),(0,c.default)(this,"isMain",!1),t._contextcount++,t._textRender=t._textRender||new V.TextRender,!this.defTexture){var e=new $.Texture2D(2,2);e.setPixels(new Uint8Array(16)),e.lock=!0,this.defTexture=new Q.Texture(e)}this._lastTex=this.defTexture,this.clear()}return(0,h.default)(t,[{key:"drawImage",value:function(){}},{key:"getImageData",value:function(){}},{key:"measureText",value:function(t){return null}},{key:"setTransform",value:function(){}},{key:"$transform",value:function(t,e,i,a,n,r){}},{key:"lineJoin",get:function(){return""},set:function(t){}},{key:"lineCap",get:function(){return""},set:function(t){}},{key:"miterLimit",get:function(){return""},set:function(t){}},{key:"clearRect",value:function(t,e,i,a){}},{key:"_drawRect",value:function(t,e,i,a,n){g.Stat.renderBatches++,n&&(this.fillStyle=n),this.fillRect(t,e,i,a,null)}},{key:"drawTexture2",value:function(t,e,i,a,n,r){}},{key:"transformByMatrix",value:function(t,e,i){this.transform(t.a,t.b,t.c,t.d,t.tx+e,t.ty+i)}},{key:"saveTransform",value:function(t){this.save()}},{key:"restoreTransform",value:function(t){this.restore()}},{key:"drawRect",value:function(t,e,i,a,n,r,s){var l=this;null!=n&&(l.fillStyle=n,l.fillRect(t,e,i,a)),null!=r&&(l.strokeStyle=r,l.lineWidth=s,l.strokeRect(t,e,i,a))}},{key:"alpha",value:function(t){this.globalAlpha*=t}},{key:"_transform",value:function(t,e,i){this.translate(e,i),this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty),this.translate(-e,-i)}},{key:"_rotate",value:function(t,e,i){this.translate(e,i),this.rotate(t),this.translate(-e,-i)}},{key:"_scale",value:function(t,e,i,a){this.translate(i,a),this.scale(t,e),this.translate(-i,-a)}},{key:"_drawLine",value:function(t,e,i,a,n,r,s,l,o){this.beginPath(),this.strokeStyle=s,this.lineWidth=l,this.moveTo(t+i,e+a),this.lineTo(t+n,e+r),this.stroke()}},{key:"_drawLines",value:function(t,e,i,a,n,s){this.beginPath(),this.strokeStyle=a,this.lineWidth=n,this.addPath((0,r.default)(i).call(i),!1,!1,t,e),this.stroke()}},{key:"drawCurves",value:function(t,e,i,a,n){this.beginPath(),this.strokeStyle=a,this.lineWidth=n,this.moveTo(t+i[0],e+i[1]);for(var r=2,s=i.length;r<s;)this.quadraticCurveTo(t+i[r++],e+i[r++],t+i[r++],e+i[r++]);this.stroke()}},{key:"_fillAndStroke",value:function(t,e,i){null!=t&&(this.fillStyle=t,(0,s.default)(this).call(this)),null!=e&&i>0&&(this.strokeStyle=e,this.lineWidth=i,this.stroke())}},{key:"_drawCircle",value:function(e,i,a,n,r,s,l){g.Stat.renderBatches++,this.beginPath(!0),this.arc(e,i,a,0,t.PI2),this.closePath(),this._fillAndStroke(n,r,s)}},{key:"_drawPie",value:function(t,e,i,a,n,r,s,l,o){this.beginPath(),this.moveTo(t,e),this.arc(t,e,i,a,n),this.closePath(),this._fillAndStroke(r,s,l)}},{key:"_drawPoly",value:function(t,e,i,a,n,s,l,o){this.beginPath(),this.addPath((0,r.default)(i).call(i),!0,l,t,e),this.closePath(),this._fillAndStroke(a,n,s,l)}},{key:"_drawPath",value:function(t,e,i,a,n){this.beginPath();for(var r=0,l=i.length;r<l;r++){var o=i[r];switch(o[0]){case"moveTo":this.moveTo(t+o[1],e+o[2]);break;case"lineTo":this.lineTo(t+o[1],e+o[2]);break;case"arcTo":this.arcTo(t+o[1],e+o[2],t+o[3],e+o[4],o[5]);break;case"closePath":this.closePath()}}null!=a&&(this.fillStyle=a.fillStyle,(0,s.default)(this).call(this)),null!=n&&(this.strokeStyle=n.strokeStyle,this.lineWidth=n.lineWidth||1,this.lineJoin=n.lineJoin,this.lineCap=n.lineCap,this.miterLimit=n.miterLimit,this.stroke())}},{key:"clearBG",value:function(t,e,i,a){var n=j.WebGLContext.mainContext;n.clearColor(t,e,i,a),n.clear(n.COLOR_BUFFER_BIT)}},{key:"_getSubmits",value:function(){return this._submits}},{key:"_releaseMem",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._submits){this._curMat&&this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null,this._charSubmitCache.clear();for(var e=0,i=this._submits._length;e<i;e++)this._submits[e].releaseRender();var a;for(this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null,e=0,a=this.meshlist.length;e<a;e++){var n=this.meshlist[e];n.destroy()}this.meshlist.length=0,this.sprite=null,t||(this._targets&&this._targets.destroy(),this._targets=null)}}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];--t._contextcount,this.sprite=null,this._releaseMem(e),this._charSubmitCache&&this._charSubmitCache.destroy(),this._mesh.destroy(),e||(this._targets&&this._targets.destroy(),this._targets=null)}},{key:"clear",value:function(){this._submits||(this._other=tt.DEFAULT,this._curMat=v.Matrix.create(),this._charSubmitCache=new W.CharSubmitCache,this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),this._pathMesh=z.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._triangleMesh=X.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[S.SaveMark.Create(this)],this._save.length=10,this._shader2D=new I.Shader2D),this._submitKey.clear(),this._mesh.clearVB(),this._drawCount=1,this._other=tt.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=t.MAXCLIPRECT,this._curSubmit=F.SubmitBase.RENDERBASE,F.SubmitBase.RENDERBASE._ref=16777215,F.SubmitBase.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=x.DrawStyle.DEFAULT;for(var e=0,i=this._submits._length;e<i;e++)this._submits[e].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1}},{key:"size",value:function(t,e){this._width==t&&this._height==e||(this._width=t,this._height=e,this._targets&&(this._targets.destroy(),this._targets=new q.RenderTexture2D(t,e,Z.RenderTextureFormat.R8G8B8A8,-1)),this.isMain&&(j.WebGLContext.mainContext.viewport(0,0,t,e),K.RenderState2D.width=t,K.RenderState2D.height=e)),0===t&&0===e&&this._releaseMem()}},{key:"asBitmap",set:function(t){if(t){var e=this._targets;if(!this._width||!this._height)throw Error("asBitmap no size!");e&&e.width==this._width&&e.height==this._height||(e&&e.destroy(),this._targets=new q.RenderTexture2D(this._width,this._height,Z.RenderTextureFormat.R8G8B8A8,-1))}else this._targets&&this._targets.destroy(),this._targets=null}},{key:"getMatScaleX",value:function(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b||(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b),this._lastMatScaleX}},{key:"getMatScaleY",value:function(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d||(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d),this._lastMatScaleY}},{key:"setFillColor",value:function(t){this._fillColor=t}},{key:"getFillColor",value:function(){return this._fillColor}},{key:"fillStyle",get:function(){return this._shader2D.fillStyle},set:function(t){this._shader2D.fillStyle.equal(t)||(k.SaveBase.save(this,k.SaveBase.TYPE_FILESTYLE,this._shader2D,!1),this._shader2D.fillStyle=x.DrawStyle.create(t),this._submitKey.other=-this._shader2D.fillStyle.toInt())}},{key:"globalAlpha",get:function(){return this._shader2D.ALPHA},set:function(t){(t=Math.floor(1e3*t)/1e3)!=this._shader2D.ALPHA&&(k.SaveBase.save(this,k.SaveBase.TYPE_ALPHA,this._shader2D,!1),this._shader2D.ALPHA=t)}},{key:"textAlign",get:function(){return this._other.textAlign},set:function(t){this._other.textAlign===t||(this._other=this._other.make(),k.SaveBase.save(this,k.SaveBase.TYPE_TEXTALIGN,this._other,!1),this._other.textAlign=t)}},{key:"textBaseline",get:function(){return this._other.textBaseline},set:function(t){this._other.textBaseline===t||(this._other=this._other.make(),k.SaveBase.save(this,k.SaveBase.TYPE_TEXTBASELINE,this._other,!1),this._other.textBaseline=t)}},{key:"globalCompositeOperation",get:function(){return m.BlendMode.NAMES[this._nBlendType]},set:function(t){var e=m.BlendMode.TOINT[t];null==e||this._nBlendType===e||(k.SaveBase.save(this,k.SaveBase.TYPE_GLOBALCOMPOSITEOPERATION,this,!0),this._curSubmit=F.SubmitBase.RENDERBASE,this._nBlendType=e)}},{key:"strokeStyle",get:function(){return this._shader2D.strokeStyle},set:function(t){this._shader2D.strokeStyle.equal(t)||(k.SaveBase.save(this,k.SaveBase.TYPE_STROKESTYLE,this._shader2D,!1),this._shader2D.strokeStyle=x.DrawStyle.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}},{key:"translate",value:function(t,e){0===t&&0===e||(M.SaveTranslate.save(this),this._curMat._bTransform?(E.SaveTransform.save(this),this._curMat.tx+=t*this._curMat.a+e*this._curMat.c,this._curMat.ty+=t*this._curMat.b+e*this._curMat.d):(this._curMat.tx=t,this._curMat.ty=e))}},{key:"lineWidth",get:function(){return this._other.lineWidth},set:function(t){this._other.lineWidth===t||(this._other=this._other.make(),k.SaveBase.save(this,k.SaveBase.TYPE_LINEWIDTH,this._other,!1),this._other.lineWidth=t)}},{key:"save",value:function(){this._save[this._save._length++]=S.SaveMark.Create(this)}},{key:"restore",value:function(){var t=this._save._length,e=this._nBlendType;if(!(t<1)){for(var i=t-1;i>=0;i--){var a=this._save[i];if(a.restore(this),a.isSaveMark())return void(this._save._length=i)}e!=this._nBlendType&&(this._curSubmit=F.SubmitBase.RENDERBASE)}}},{key:"font",set:function(t){this._other=this._other.make(),k.SaveBase.save(this,k.SaveBase.TYPE_FONT,this._other,!1)}},{key:"fillText",value:function(e,i,a,n,r,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";t._textRender.filltext(this,e,i,a,n,r,o,l,s)}},{key:"drawText",value:function(e,i,a,n,r,s){t._textRender.filltext(this,e,i,a,n,r,null,0,s)}},{key:"fillWords",value:function(e,i,a,n,r){t._textRender.fillWords(this,e,i,a,n,r,null,0)}},{key:"strokeWord",value:function(e,i,a,n,r,s,l){t._textRender.filltext(this,e,i,a,n,null,r,s,l)}},{key:"fillBorderText",value:function(e,i,a,n,r,s,l,o){t._textRender.filltext(this,e,i,a,n,r,s,l,o)}},{key:"fillBorderWords",value:function(e,i,a,n,r,s,l){t._textRender.fillWords(this,e,i,a,n,r,s,l)}},{key:"_fast_filltext",value:function(e,i,a,n,r,s,l,o){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;t._textRender._fast_filltext(this,e,null,i,a,n,r,s,l,o,u)}},{key:"_fillRect",value:function(e,i,a,n,r){var s=this._curSubmit,l=s&&s._key.submitType===F.SubmitBase.KEY_DRAWTEXTURE&&s._key.blendShader===this._nBlendType;this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh),l=!1),l&&(l=l&&this.isSameClipInfo(s)),this.transformQuad(e,i,a,n,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,Q.Texture.NO_UV,r,!1),l||(s=this._curSubmit=H.SubmitTexture.create(this,this._mesh,A.Value2D.create(R.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=s,this._copyClipInfo(s,this._globalClipMatrix),s.shaderValue.textureHost=this._lastTex,s._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1,s._renderType=F.SubmitBase.TYPE_TEXTURE),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"fillRect",value:function(t,e,i,a,n){var r=n?x.DrawStyle.create(n):this._shader2D.fillStyle,s=this.mixRGBandAlpha(r.toInt());this._fillRect(t,e,i,a,s)}},{key:"fillTexture",value:function(t,e,i,a,n,r,s,l){t._getSource()?this._fillTexture(t,t.width,t.height,t.uvrect,e,i,a,n,r,s.x,s.y):this.sprite&&d.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"_fillTexture",value:function(e,i,a,n,r,s,o,u,h,c,d){var f=this._curSubmit;this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var _=!0,v=!0;switch(h){case"repeat":default:break;case"repeat-x":v=!1;break;case"repeat-y":_=!1;break;case"no-repeat":_=v=!1}var y=this._temp4Points,p=0,g=0,m=0,x=0,T=0,k=0;if(c<0?(m=r,p=-c%i/i):m=r+c,d<0?(x=s,g=-d%a/a):x=s+d,T=r+o,k=s+u,!_&&(T=Math.min(T,r+c+i)),!v&&(k=Math.min(k,s+d+a)),!(T<r||k<s||m>T||x>k)){var C=(T-r-c)/i,S=(k-s-d)/a;if(this.transformQuad(m,x,T-m,k-x,0,this._curMat,this._transedPoints),y[0]=p,y[1]=g,y[2]=C,y[3]=g,y[4]=C,y[5]=S,y[6]=p,y[7]=S,!this.clipedOff(this._transedPoints)){var E=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,y,E,!0);var M=A.Value2D.create(R.ShaderDefines2D.TEXTURE2D,0);M.defines.add(R.ShaderDefines2D.FILLTEXTURE),M.u_TexRange=(0,l.default)(n).call(n),f=this._curSubmit=H.SubmitTexture.create(this,this._mesh,M),this._submits[this._submits._length++]=f,this._copyClipInfo(f,this._globalClipMatrix),f.shaderValue.textureHost=e,f._renderType=F.SubmitBase.TYPE_TEXTURE,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4}this.breakNextMerge()}}},{key:"setColorFilter",value:function(t){k.SaveBase.save(this,k.SaveBase.TYPE_COLORFILTER,this,!0),this._colorFiler=t,this._curSubmit=F.SubmitBase.RENDERBASE}},{key:"drawTexture",value:function(t,e,i,a,n){this._drawTextureM(t,e,i,a,n,null,1,null)}},{key:"drawTextures",value:function(t,e,i,a){if(t._getSource())for(var n=e.length/2,r=0,s=t.bitmap.id,l=0;l<n;l++)this._inner_drawTexture(t,s,e[r++]+i,e[r++]+a,0,0,null,null,1,!1);else this.sprite&&d.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"_drawTextureAddSubmit",value:function(t,e){var i=null;i=H.SubmitTexture.create(this,this._mesh,A.Value2D.create(R.ShaderDefines2D.TEXTURE2D,0)),this._submits[this._submits._length++]=i,i.shaderValue.textureHost=e,i._key.other=t,i._renderType=F.SubmitBase.TYPE_TEXTURE,this._curSubmit=i}},{key:"_drawTextureM",value:function(t,e,i,a,n,r,s,l){var o=this.sprite;return!!t._getSource((function(){o&&o.repaint()}))&&this._inner_drawTexture(t,t.bitmap.id,e,i,a,n,r,l,s,!1)}},{key:"_drawRenderTexture",value:function(t,e,i,a,n,r,s,l){return this._inner_drawTexture(t,-1,e,i,a,n,r,l,1,!1)}},{key:"submitDebugger",value:function(){this._submits[this._submits._length++]=U.SubmitCMD.create([],(function(){}),this)}},{key:"_copyClipInfo",value:function(t,e){var i=t.shaderValue.clipMatDir;i[0]=e.a,i[1]=e.b,i[2]=e.c,i[3]=e.d;var a=t.shaderValue.clipMatPos;a[0]=e.tx,a[1]=e.ty,t.clipInfoID=this._clipInfoID,this._clipInCache&&(t.shaderValue.clipOff[0]=1)}},{key:"isSameClipInfo",value:function(t){return t.clipInfoID===this._clipInfoID}},{key:"_useNewTex2DSubmit",value:function(e,i){this._mesh.vertNum+i>t._MAXVERTNUM&&(this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh));var a=H.SubmitTexture.create(this,this._mesh,A.Value2D.create(R.ShaderDefines2D.TEXTURE2D,0));this._submits[this._submits._length++]=this._curSubmit=a,a.shaderValue.textureHost=e,this._copyClipInfo(a,this._globalClipMatrix)}},{key:"_drawTexRect",value:function(t,e,i,a,n){this.transformQuad(t,e,i,a,this._italicDeg,this._curMat,this._transedPoints);var r=this._transedPoints;r[0]=r[0]+.5|0,r[1]=r[1]+.5|0,r[2]=r[2]+.5|0,r[3]=r[3]+.5|0,r[4]=r[4]+.5|0,r[5]=r[5]+.5|0,r[6]=r[6]+.5|0,r[7]=r[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,n,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"drawCallOptimize",value:function(t){return this._charSubmitCache.enable(t,this),t}},{key:"_inner_drawTexture",value:function(e,i,a,n,r,s,l,o,u,h){if(r<=0||s<=0)return!1;var c=this._curSubmit._key;if(o=o||e._uv,c.submitType===F.SubmitBase.KEY_TRIANGLES&&c.other===i){var d=this._drawTexToDrawTri_Vert;d[0]=a,d[1]=n,d[2]=a+r,d[3]=n,d[4]=a+r,d[5]=n+s,d[6]=a,d[7]=n+s,this._drawTriUseAbsMatrix=!0;var f=this._tempUV;return f[0]=o[0],f[1]=o[1],f[2]=o[2],f[3]=o[3],f[4]=o[4],f[5]=o[5],f[6]=o[6],f[7]=o[7],this.drawTriangles(e,0,0,d,f,this._drawTexToDrawTri_Index,l,u,null,null),this._drawTriUseAbsMatrix=!1,!0}var _=this._mesh,v=this._curSubmit,y=h?this._charSubmitCache.getPos():this._transedPoints;if(this.transformQuad(a,n,r||e.width,s||e.height,this._italicDeg,l||this._curMat,y),this.drawTexAlign){var p=Math.round;y[0]=p(y[0]),y[1]=p(y[1]),y[2]=p(y[2]),y[3]=p(y[3]),y[4]=p(y[4]),y[5]=p(y[5]),y[6]=p(y[6]),y[7]=p(y[7]),this.drawTexAlign=!1}var g=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*u);if(h)return this._charSubmitCache.add(this,e,i,y,o,g),!0;this._drawCount++;var m=i>=0&&c.submitType===F.SubmitBase.KEY_DRAWTEXTURE&&c.other===i;return m&&(m=m&&this.isSameClipInfo(v)),this._lastTex=e,_.vertNum+4>t._MAXVERTNUM&&(_=this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(_),m=!1),_.addQuad(y,o,g,!0),m||(this._submits[this._submits._length++]=this._curSubmit=v=H.SubmitTexture.create(this,_,A.Value2D.create(R.ShaderDefines2D.TEXTURE2D,0)),v.shaderValue.textureHost=e,v._key.other=i,this._copyClipInfo(v,this._globalClipMatrix)),v._numEle+=6,_.indexNum+=6,_.vertNum+=4,!0}},{key:"transform4Points",value:function(t,e,i){var a=e.tx,n=e.ty,r=e.a,s=e.b,l=e.c,o=e.d,u=t[0],h=t[1],c=t[2],d=t[3],f=t[4],_=t[5],v=t[6],y=t[7];e._bTransform?(i[0]=u*r+h*l+a,i[1]=u*s+h*o+n,i[2]=c*r+d*l+a,i[3]=c*s+d*o+n,i[4]=f*r+_*l+a,i[5]=f*s+_*o+n,i[6]=v*r+y*l+a,i[7]=v*s+y*o+n):(i[0]=u+a,i[1]=h+n,i[2]=c+a,i[3]=d+n,i[4]=f+a,i[5]=_+n,i[6]=v+a,i[7]=y+n)}},{key:"clipedOff",value:function(t){return this._clipRect.width<=0||this._clipRect.height<=0}},{key:"transformQuad",value:function(t,e,i,a,n,r,s){var l=0;0!=n&&(l=Math.tan(n*Math.PI/180)*a);var o=t+i,u=e+a,h=r.tx,c=r.ty,d=r.a,f=r.b,_=r.c,v=r.d,y=t+l,p=e,g=o+l,m=e,x=o,T=u,k=t,C=u;r._bTransform?(s[0]=y*d+p*_+h,s[1]=y*f+p*v+c,s[2]=g*d+m*_+h,s[3]=g*f+m*v+c,s[4]=x*d+T*_+h,s[5]=x*f+T*v+c,s[6]=k*d+C*_+h,s[7]=k*f+C*v+c):(s[0]=y+h,s[1]=p+c,s[2]=g+h,s[3]=m+c,s[4]=x+h,s[5]=T+c,s[6]=k+h,s[7]=C+c)}},{key:"pushRT",value:function(){this.addRenderObject(U.SubmitCMD.create(null,q.RenderTexture2D.pushRT,this))}},{key:"popRT",value:function(){this.addRenderObject(U.SubmitCMD.create(null,q.RenderTexture2D.popRT,this)),this.breakNextMerge()}},{key:"useRT",value:function(t){this.addRenderObject(U.SubmitCMD.create([t],(function(t){if(!t)throw"error useRT";t.start(),t.clear(0,0,0,0)}),this)),this.breakNextMerge()}},{key:"RTRestore",value:function(t){this.addRenderObject(U.SubmitCMD.create([t],(function(t){t.restore()}),this)),this.breakNextMerge()}},{key:"breakNextMerge",value:function(){this._curSubmit=F.SubmitBase.RENDERBASE}},{key:"_repaintSprite",value:function(){this.sprite&&this.sprite.repaint()}},{key:"drawTextureWithTransform",value:function(t,e,i,a,n,r,s,l,o,u){var h,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,d=arguments.length>11?arguments[11]:void 0,f=this._curMat;u&&(h=this.globalCompositeOperation,this.globalCompositeOperation=u);var _=this._colorFiler;if(c&&this.setColorFilter(c),!r)return this._drawTextureM(t,e+s,i+l,a,n,f,o,d),u&&(this.globalCompositeOperation=h),void(c&&this.setColorFilter(_));var y=this._tmpMatrix;y.a=r.a,y.b=r.b,y.c=r.c,y.d=r.d,y.tx=r.tx+s,y.ty=r.ty+l,y._bTransform=r._bTransform,r&&f._bTransform?(v.Matrix.mul(y,f,y),(r=y)._bTransform=!0):(y.tx+=f.tx,y.ty+=f.ty,r=y),this._drawTextureM(t,e,i,a,n,r,o,d),u&&(this.globalCompositeOperation=h),c&&this.setColorFilter(_)}},{key:"_flushToTarget",value:function(t,e){K.RenderState2D.worldScissorTest=!1;var i=f.LayaGL.instance;i.disable(i.SCISSOR_TEST);var a=K.RenderState2D.worldAlpha,n=K.RenderState2D.worldMatrix4,r=K.RenderState2D.worldMatrix;K.RenderState2D.worldShaderDefines,K.RenderState2D.worldMatrix=v.Matrix.EMPTY,K.RenderState2D.restoreTempArray(),K.RenderState2D.worldMatrix4=K.RenderState2D.TEMPMAT4_ARRAY,K.RenderState2D.worldAlpha=1,b.BaseShader.activeShader=null,e.start(),t._submits._length>0&&e.clear(0,0,0,0),t._curSubmit=F.SubmitBase.RENDERBASE,t.flush(),t.clear(),e.restore(),t._curSubmit=F.SubmitBase.RENDERBASE,b.BaseShader.activeShader=null,K.RenderState2D.worldAlpha=a,K.RenderState2D.worldMatrix4=n,K.RenderState2D.worldMatrix=r}},{key:"drawCanvas",value:function(t,e,i,a,n){if(t){var r,s=t.context;if(s._targets)s._submits._length>0&&(r=U.SubmitCMD.create([s,s._targets],this._flushToTarget,this),this._submits[this._submits._length++]=r),this._drawRenderTexture(s._targets,e,i,a,n,null,1,q.RenderTexture2D.flipyuv),this._curSubmit=F.SubmitBase.RENDERBASE;else{var l,u=t;u.touches&&(0,o.default)(l=u.touches).call(l,(function(t){t.touch()})),r=O.SubmitCanvas.create(t,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=r,r._key.clear();var h=r._matrix;this._curMat.copyTo(h);var c=h.tx,d=h.ty;h.tx=h.ty=0,h.transformPoint(y.Point.TEMP.setTo(e,i)),h.translate(y.Point.TEMP.x+c,y.Point.TEMP.y+d),v.Matrix.mul(u.invMat,h,h),this._curSubmit=F.SubmitBase.RENDERBASE}}}},{key:"drawTarget",value:function(e,i,a,n,r,s,l){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:-1;if(this._drawCount++,this._mesh.vertNum+4>t._MAXVERTNUM&&(this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh)),this.transformQuad(i,a,n,r,0,s||this._curMat,this._transedPoints),!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,o||Q.Texture.DEF_UV,4294967295,!0);var h=this._curSubmit=G.SubmitTarget.create(this,this._mesh,l,e);return h.blendType=-1==u?this._nBlendType:u,this._copyClipInfo(h,this._globalClipMatrix),h._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._submits[this._submits._length++]=h,this._curSubmit=F.SubmitBase.RENDERBASE,!0}return this._curSubmit=F.SubmitBase.RENDERBASE,!1}},{key:"drawTriangles",value:function(e,i,a,n,r,s,l,o,u,h){var c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:4294967295;if(e._getSource()){var f=null;h&&(f=this.globalCompositeOperation,this.globalCompositeOperation=h),this._drawCount++;var _=this._tmpMatrix,y=this._triangleMesh,p=null,g=!1;u&&(p=this._colorFiler,this._colorFiler=u,this._curSubmit=F.SubmitBase.RENDERBASE,g=p!=u);var m=e.bitmap,x=this._curSubmit._key,T=x.submitType===F.SubmitBase.KEY_TRIANGLES&&x.other===m.id&&x.blendShader==this._nBlendType;if(y.vertNum+n.length/2>t._MAXVERTNUM&&(y=this._triangleMesh=X.MeshTexture.getAMesh(this.isMain),this.meshlist.push(y),T=!1),!T){var k=this._curSubmit=H.SubmitTexture.create(this,y,A.Value2D.create(R.ShaderDefines2D.TEXTURE2D,0));k.shaderValue.textureHost=e,k._renderType=F.SubmitBase.TYPE_TEXTURE,k._key.submitType=F.SubmitBase.KEY_TRIANGLES,k._key.other=m.id,this._copyClipInfo(k,this._globalClipMatrix),this._submits[this._submits._length++]=k}var C=this._mixRGBandAlpha(c,this._shader2D.ALPHA*o);this._drawTriUseAbsMatrix?y.addData(n,r,s,l,C):(l?(_.a=l.a,_.b=l.b,_.c=l.c,_.d=l.d,_.tx=l.tx+i,_.ty=l.ty+a):(_.a=1,_.b=0,_.c=0,_.d=1,_.tx=i,_.ty=a),v.Matrix.mul(_,this._curMat,_),y.addData(n,r,s,_||this._curMat,C)),this._curSubmit._numEle+=s.length,g&&(this._colorFiler=p,this._curSubmit=F.SubmitBase.RENDERBASE),h&&(this.globalCompositeOperation=f)}else this.sprite&&d.ILaya.systemTimer.callLater(this,this._repaintSprite)}},{key:"transform",value:function(t,e,i,a,n,r){E.SaveTransform.save(this),v.Matrix.mul(v.Matrix.TEMP.setTo(t,e,i,a,n,r),this._curMat,this._curMat),this._curMat._checkTransform()}},{key:"_transformByMatrix",value:function(t,e,i){t.setTranslate(e,i),v.Matrix.mul(t,this._curMat,this._curMat),t.setTranslate(0,0),this._curMat._bTransform=!0}},{key:"setTransformByMatrix",value:function(t){t.copyTo(this._curMat)}},{key:"rotate",value:function(t){E.SaveTransform.save(this),this._curMat.rotateEx(t)}},{key:"scale",value:function(t,e){E.SaveTransform.save(this),this._curMat.scaleEx(t,e)}},{key:"clipRect",value:function(e,i,a,n){C.SaveClipRect.save(this),this._clipRect==t.MAXCLIPRECT?this._clipRect=new p.Rectangle(e,i,a,n):(this._clipRect.width=a,this._clipRect.height=n,this._clipRect.x=e,this._clipRect.y=i),this._clipID_Gen++,this._clipID_Gen%=1e4,this._clipInfoID=this._clipID_Gen;var r=this._globalClipMatrix,s=r.tx,l=r.ty,o=s+r.a,u=l+r.d;if(this._clipRect.width>=t._MAXSIZE?(r.a=r.d=t._MAXSIZE,r.b=r.c=r.tx=r.ty=0):(this._curMat._bTransform?(r.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,r.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,r.a=this._clipRect.width*this._curMat.a,r.b=this._clipRect.width*this._curMat.b,r.c=this._clipRect.height*this._curMat.c,r.d=this._clipRect.height*this._curMat.d):(r.tx=this._clipRect.x+this._curMat.tx,r.ty=this._clipRect.y+this._curMat.ty,r.a=this._clipRect.width,r.b=r.c=0,r.d=this._clipRect.height),this._incache&&(this._clipInCache=!0)),r.a>0&&r.d>0){var h=r.tx+r.a,c=r.ty+r.d;h<=s||c<=l||r.tx>=o||r.ty>=u?(r.a=-.1,r.d=-.1):(r.tx<s&&(r.a-=s-r.tx,r.tx=s),h>o&&(r.a-=h-o),r.ty<l&&(r.d-=l-r.ty,r.ty=l),c>u&&(r.d-=c-u),r.a<=0&&(r.a=-.1),r.d<=0&&(r.d=-.1))}}},{key:"drawMesh",value:function(t,e,i,a,n,r,s,l){}},{key:"addRenderObject",value:function(t){this._submits[this._submits._length++]=t}},{key:"submitElement",value:function(t,e){this.isMain;var i=this._submits,a=i._length;e<0&&(e=i._length);for(var n=F.SubmitBase.RENDERBASE;t<e;)this._renderNextSubmitIndex=t+1,i[t]!==F.SubmitBase.RENDERBASE?(F.SubmitBase.preRender=n,t+=(n=i[t]).renderSubmit()):t++;return a}},{key:"flush",value:function(){this._clipID_Gen=0;var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),w.SkinMeshBuffer.instance&&w.SkinMeshBuffer.getInstance().reset(),this._curSubmit=F.SubmitBase.RENDERBASE;for(var e=0,i=this.meshlist.length;e<i;e++){var a=this.meshlist[e];a.canReuse?a.releaseMesh():a.destroy()}return this.meshlist.length=0,this._mesh=Y.MeshQuadTexture.getAMesh(this.isMain),this._pathMesh=z.MeshVG.getAMesh(this.isMain),this._triangleMesh=X.MeshTexture.getAMesh(this.isMain),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%60==0&&this.isMain&&V.TextRender.textRenderInst&&V.TextRender.textRenderInst.GC(),t}},{key:"beginPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._getPath();e.beginPath(t)}},{key:"closePath",value:function(){this._path.closePath()}},{key:"addPath",value:function(t,e,i,a,n){for(var r=0,s=0,l=t.length/2;s<l;s++){var o=t[r]+a,u=t[r+1]+n;t[r]=o,t[r+1]=u,r+=2}this._getPath().push(t,i)}},{key:"fill",value:function(){var e=this._curMat,i=this._getPath(),a=this._curSubmit,n=a._key.submitType===F.SubmitBase.KEY_VG&&a._key.blendShader===this._nBlendType;n&&(n=n&&this.isSameClipInfo(a)),n||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var r,s=this.mixRGBandAlpha(this.fillStyle.toInt()),o=0,u=0,h=i.paths.length;u<h;u++){var c,d=i.paths[u],f=d.path.length/2;if(!(f<3||3==f&&!d.convex)){var _,v,y,p,g=(0,l.default)(c=d.path).call(c),m=0;if(e._bTransform)for(m=0;m<f;m++)v=1+(_=m<<1),y=g[_],p=g[v],g[_]=e.a*y+e.c*p+e.tx,g[v]=e.b*y+e.d*p+e.ty;else for(m=0;m<f;m++)v=1+(_=m<<1),y=g[_],p=g[v],g[_]=y+e.tx,g[v]=p+e.ty;this._pathMesh.vertNum+f>t._MAXVERTNUM&&(this._curSubmit._numEle+=o,o=0,this._pathMesh=z.MeshVG.getAMesh(this.isMain),this._curSubmit=this.addVGSubmit(this._pathMesh));var x=this._pathMesh.vertNum;if(d.convex){var T=f-2;r=new Array(3*T);for(var k=0,C=0;C<T;C++)r[k++]=x,r[k++]=C+1+x,r[k++]=C+2+x}else if(r=D.Earcut.earcut(g,null,2),x>0)for(var S=0;S<r.length;S++)r[S]+=x;this._pathMesh.addVertAndIBToMesh(this,g,s,r),o+=r.length}}this._curSubmit._numEle+=o}},{key:"addVGSubmit",value:function(t){var e=P.Submit.createShape(this,t,0,A.Value2D.create(R.ShaderDefines2D.PRIMITIVE,0));return e._key.submitType=F.SubmitBase.KEY_VG,this._submits[this._submits._length++]=e,this._copyClipInfo(e,this._globalClipMatrix),e}},{key:"stroke",value:function(){if(this.lineWidth>0){var e=this.mixRGBandAlpha(this.strokeStyle._color.numColor),i=this._getPath(),a=this._curSubmit,n=a._key.submitType===F.SubmitBase.KEY_VG&&a._key.blendShader===this._nBlendType;n&&(n=n&&this.isSameClipInfo(a)),n||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var r=0,s=0,l=i.paths.length;s<l;s++){var o=i.paths[s];if(!(o.path.length<=0)){var u=[],h=[],c=2*o.path.length;if(!(c<2)){this._pathMesh.vertNum+c>t._MAXVERTNUM&&(this._curSubmit._numEle+=r,r=0,this._pathMesh=z.MeshVG.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),B.BasePoly.createLine2(o.path,u,this.lineWidth,this._pathMesh.vertNum,h,o.loop);var d,f,_,v,y=h.length/2,p=this._curMat,g=0;if(p._bTransform)for(g=0;g<y;g++)f=1+(d=g<<1),_=h[d],v=h[f],h[d]=p.a*_+p.c*v+p.tx,h[f]=p.b*_+p.d*v+p.ty;else for(g=0;g<y;g++)f=1+(d=g<<1),_=h[d],v=h[f],h[d]=_+p.tx,h[f]=v+p.ty;this._pathMesh.addVertAndIBToMesh(this,h,e,u),r+=u.length}}}this._curSubmit._numEle+=r}}},{key:"moveTo",value:function(t,e){var i=this._getPath();i.newPath(),i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e)}},{key:"lineTo",value:function(t,e){var i=this._getPath();Math.abs(t-i._lastOriX)<.001&&Math.abs(e-i._lastOriY)<.001||(i._lastOriX=t,i._lastOriY=e,i.addPoint(t,e))}},{key:"arcTo",value:function(e,i,a,n,r){var s=0,l=0,o=0,u=this._path._lastOriX-e,h=this._path._lastOriY-i,c=Math.sqrt(u*u+h*h);if(!(c<=1e-6)){var d=u/c,f=h/c,_=a-e,v=n-i,y=_*_+v*v,p=Math.sqrt(y);if(!(p<=1e-6)){var g=_/p,m=v/p,x=d+g,T=f+m,k=Math.sqrt(x*x+T*T);if(!(k<=1e-6)){var C=x/k,S=T/k,E=Math.acos(C*d+S*f),M=Math.PI/2-E,L=(c=r/Math.tan(M))*d+e,b=c*f+i,I=Math.sqrt(c*c+r*r),R=e+C*I,w=i+S*I,A=0,B=0;if(d*m-f*g>=0){var D=2*M/t.SEGNUM;A=Math.sin(D),B=Math.cos(D)}else D=2*-M/t.SEGNUM,A=Math.sin(D),B=Math.cos(D);var P=this._path._lastOriX,F=this._path._lastOriY,O=L,U=b;(Math.abs(O-this._path._lastOriX)>.1||Math.abs(U-this._path._lastOriY)>.1)&&(l=O,o=U,P=O,F=U,this._path._lastOriX=l,this._path._lastOriY=o,this._path.addPoint(l,o));var N=L-R,G=b-w;for(s=0;s<t.SEGNUM;s++){var H=N*B+G*A,W=-N*A+G*B;l=H+R,o=W+w,(Math.abs(P-l)>.1||Math.abs(F-o)>.1)&&(this._path._lastOriX=l,this._path._lastOriY=o,this._path.addPoint(l,o),P=l,F=o),N=H,G=W}}}}}},{key:"arc",value:function(t,e,i,a,n){var r,s,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=0,u=0,h=0,c=0,d=0,f=0,_=0;if(u=n-a,l)if(Math.abs(u)>=2*Math.PI)u=2*-Math.PI;else for(;u>0;)u-=2*Math.PI;else if(Math.abs(u)>=2*Math.PI)u=2*Math.PI;else for(;u<0;)u+=2*Math.PI;var v=this.getMatScaleX(),y=this.getMatScaleY(),p=i*(v>y?v:y),g=2*Math.PI*p;h=u/(s=0|Math.max(g/10,10))/2,c=Math.abs(4/3*(1-Math.cos(h))/Math.sin(h)),l&&(c=-c);var m=this._getPath();for(r=0;r<=s;r++)o=a+u*(r/s),d=Math.cos(o),_=e+Math.sin(o)*i,(f=t+d*i)==this._path._lastOriX&&_==this._path._lastOriY||m.addPoint(f,_);d=Math.cos(n),_=e+Math.sin(n)*i,(f=t+d*i)==this._path._lastOriX&&_==this._path._lastOriY||m.addPoint(f,_)}},{key:"quadraticCurveTo",value:function(t,e,i,a){for(var n=_.Bezier.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,i,a],30,2),r=0,s=n.length/2;r<s;r++)this.lineTo(n[2*r],n[2*r+1]);this.lineTo(i,a)}},{key:"mixRGBandAlpha",value:function(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)}},{key:"_mixRGBandAlpha",value:function(t,e){if(e>=1)return t;var i=(4278190080&t)>>>24;return 0!=i?i*=e:i=255*e,16777215&t|i<<24}},{key:"strokeRect",value:function(t,e,i,a,n){if(this.lineWidth>0){var r=this.mixRGBandAlpha(this.strokeStyle._color.numColor),s=this.lineWidth/2;this._fillRect(t-s,e-s,i+this.lineWidth,this.lineWidth,r),this._fillRect(t-s,e-s+a,i+this.lineWidth,this.lineWidth,r),this._fillRect(t-s,e+s,this.lineWidth,a-this.lineWidth,r),this._fillRect(t-s+i,e+s,this.lineWidth,a-this.lineWidth,r)}}},{key:"clip",value:function(){}},{key:"drawParticle",value:function(t,e,i){i.x=t,i.y=e,this._submits[this._submits._length++]=i}},{key:"_getPath",value:function(){return this._path||(this._path=new T.Path)}},{key:"canvas",get:function(){return this._canvas}},{key:"_fillTexture_h",value:function(e,i,a,n,r,s,l,o){n<=0&&console.error("_fillTexture_h error: oriw must>0");for(var u=s,h=Math.floor(o/n),c=o%n,d=0;d<h;d++)this._inner_drawTexture(e,i,u,l,n,r,this._curMat,a,1,!1),u+=n;if(c>0){var f=a[2]-a[0],_=a[0]+f*(c/n),v=t.tmpuv1;v[0]=a[0],v[1]=a[1],v[2]=_,v[3]=a[3],v[4]=_,v[5]=a[5],v[6]=a[6],v[7]=a[7],this._inner_drawTexture(e,i,u,l,c,r,this._curMat,v,1,!1)}}},{key:"_fillTexture_v",value:function(e,i,a,n,r,s,l,o){r<=0&&console.error("_fillTexture_v error: orih must>0");for(var u=l,h=Math.floor(o/r),c=o%r,d=0;d<h;d++)this._inner_drawTexture(e,i,s,u,n,r,this._curMat,a,1,!1),u+=r;if(c>0){var f=a[7]-a[1],_=a[1]+f*(c/r),v=t.tmpuv1;v[0]=a[0],v[1]=a[1],v[2]=a[2],v[3]=a[3],v[4]=a[4],v[5]=_,v[6]=a[6],v[7]=_,this._inner_drawTexture(e,i,s,u,n,c,this._curMat,v,1,!1)}}},{key:"drawTextureWithSizeGrid",value:function(e,i,a,n,r,s,l,o){if(e._getSource()){i+=l,a+=o;var u=e.uv,h=e.bitmap.width,c=e.bitmap.height,d=s[0],f=s[3],_=s[1],v=s[2],y=s[4],p=!1;n==h&&(f=_=0),r==c&&(d=v=0);var g=d/c,m=f/h,x=_/h,T=v/c;if(f+_>n){var k=n;p=!0,n=f+_,this.save(),this.clipRect(0+i,0+a,k,r)}var C=e.bitmap.id,S=this._curMat,E=this._tempUV,M=u[0],L=u[1],b=u[4],I=u[5],R=M,w=L,A=b,B=I;if(f&&d&&(A=M+m,B=L+g,E[0]=M,E[1]=L,E[2]=A,E[3]=L,E[4]=A,E[5]=B,E[6]=M,E[7]=B,this._inner_drawTexture(e,C,i,a,f,d,S,E,1,!1)),_&&d&&(R=b-x,w=L,A=b,B=L+g,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,this._inner_drawTexture(e,C,n-_+i,0+a,_,d,S,E,1,!1)),f&&v&&(R=M,w=I-T,A=M+m,B=I,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,this._inner_drawTexture(e,C,0+i,r-v+a,f,v,S,E,1,!1)),_&&v&&(R=b-x,w=I-T,A=b,B=I,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,this._inner_drawTexture(e,C,n-_+i,r-v+a,_,v,S,E,1,!1)),d&&(R=M+m,w=L,A=b-x,B=L+g,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,y?this._fillTexture_h(e,C,E,e.width-f-_,d,f+i,a,n-f-_):this._inner_drawTexture(e,C,f+i,a,n-f-_,d,S,E,1,!1)),v&&(R=M+m,w=I-T,A=b-x,B=I,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,y?this._fillTexture_h(e,C,E,e.width-f-_,v,f+i,r-v+a,n-f-_):this._inner_drawTexture(e,C,f+i,r-v+a,n-f-_,v,S,E,1,!1)),f&&(R=M,w=L+g,A=M+m,B=I-T,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,y?this._fillTexture_v(e,C,E,f,e.height-d-v,i,d+a,r-d-v):this._inner_drawTexture(e,C,i,d+a,f,r-d-v,S,E,1,!1)),_&&(R=b-x,w=L+g,A=b,B=I-T,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,y?this._fillTexture_v(e,C,E,_,e.height-d-v,n-_+i,d+a,r-d-v):this._inner_drawTexture(e,C,n-_+i,d+a,_,r-d-v,S,E,1,!1)),R=M+m,w=L+g,A=b-x,B=I-T,E[0]=R,E[1]=w,E[2]=A,E[3]=w,E[4]=A,E[5]=B,E[6]=R,E[7]=B,y){var D=t.tmpUVRect;D[0]=R,D[1]=w,D[2]=A-R,D[3]=B-w,this._fillTexture(e,e.width-f-_,e.height-d-v,D,f+i,d+a,n-f-_,r-d-v,"repeat",0,0)}else this._inner_drawTexture(e,C,f+i,d+a,n-f-_,r-d-v,S,E,1,!1);p&&this.restore()}}}],[{key:"__init__",value:function(){t.MAXCLIPRECT=new p.Rectangle(0,0,t._MAXSIZE,t._MAXSIZE),tt.DEFAULT=new tt,L.WebGLCacheAsNormalCanvas}},{key:"set2DRenderConfig",value:function(){var t=f.LayaGL.instance;j.WebGLContext.setBlend(t,!0),j.WebGLContext.setBlendEquation(t,t.FUNC_ADD),m.BlendMode.activeBlendFunction=null,j.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA),j.WebGLContext.setDepthTest(t,!1),j.WebGLContext.setCullFace(t,!1),j.WebGLContext.setDepthMask(t,!0),j.WebGLContext.setFrontFace(t,t.CCW),t.viewport(0,0,K.RenderState2D.width,K.RenderState2D.height)}}]),t}();e.Context=J,(0,c.default)(J,"ENUM_TEXTALIGN_DEFAULT",0),(0,c.default)(J,"ENUM_TEXTALIGN_CENTER",1),(0,c.default)(J,"ENUM_TEXTALIGN_RIGHT",2),(0,c.default)(J,"_SUBMITVBSIZE",32e3),(0,c.default)(J,"_MAXSIZE",99999999),(0,c.default)(J,"_MAXVERTNUM",65535),(0,c.default)(J,"MAXCLIPRECT",null),(0,c.default)(J,"_COUNT",0),(0,c.default)(J,"SEGNUM",32),(0,c.default)(J,"_contextcount",0),(0,c.default)(J,"PI2",2*Math.PI),(0,c.default)(J,"_textRender",null),(0,c.default)(J,"tmpuv1",[0,0,0,0,0,0,0,0]),(0,c.default)(J,"tmpUV",[0,0,0,0,0,0,0,0]),(0,c.default)(J,"tmpUVRect",[0,0,0,0]);var tt=function(){function t(){(0,u.default)(this,t),(0,c.default)(this,"lineWidth",1)}return(0,h.default)(t,[{key:"clear",value:function(){this.lineWidth=1,this.textAlign=this.textBaseline=null}},{key:"make",value:function(){return this===t.DEFAULT?new t:this}}]),t}()},63454:(t,e,i)=>{"use strict";var a;i(63978)(e,"__esModule",{value:!0}),e.FilterMode=void 0,e.FilterMode=a,function(t){t[t.Point=0]="Point",t[t.Bilinear=1]="Bilinear",t[t.Trilinear=2]="Trilinear"}(a||(e.FilterMode=a={}))},54013:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLCanvas=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=i(74935),_=i(29148),v=i(41009),y=i(93561),p=i(27175);var g=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,s.default)(this,r),(t=n.call(this))._source=e?p.Browser.createElement("canvas"):(0,o.default)(t),t.lock=!0,t}return(0,l.default)(r,[{key:"source",get:function(){return this._source}},{key:"_getSource",value:function(){return this._source}},{key:"clear",value:function(){this._ctx&&(this._ctx.clear?this._ctx.clear():this._ctx.clearRect(0,0,this._width,this._height)),this._texture&&(this._texture.destroy(),this._texture=null)}},{key:"destroy",value:function(){(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this),this._setCPUMemory(0),this._ctx&&this._ctx.destroy&&this._ctx.destroy(),this._ctx=null}},{key:"release",value:function(){}},{key:"context",get:function(){return this._ctx||(this._source==this?this._ctx=new y.ILaya.Context:this._ctx=this._source.getContext(y.ILaya.Render.isConchApp?"layagl":"2d"),this._ctx._canvas=this),this._ctx}},{key:"_setContext",value:function(t){this._ctx=t}},{key:"getContext",value:function(t){return this.context}},{key:"getMemSize",value:function(){return 0}},{key:"size",value:function(t,e){(this._width!=t||this._height!=e||this._source&&(this._source.width!=t||this._source.height!=e))&&(this._width=t,this._height=e,this._setCPUMemory(t*e*4),this._ctx&&this._ctx.size&&this._ctx.size(t,e),this._source&&(this._source.height=e,this._source.width=t),this._texture&&(this._texture.destroy(),this._texture=null))}},{key:"getTexture",value:function(){if(!this._texture){var t=new v.Texture2D;t.loadImageSource(this.source),this._texture=new _.Texture(t)}return this._texture}},{key:"toBase64",value:function(t,e){if(this._source){if(y.ILaya.Render.isConchApp){var i=window;if(2==i.conchConfig.threadMode)throw"native 2 thread mode use toBase64Async";var a=this._ctx._targets.sourceWidth,n=this._ctx._targets.sourceHeight,r=this._ctx._targets.getData(0,0,a,n);return i.conchToBase64FlipY?i.conchToBase64FlipY(t,e,r.buffer,a,n):i.conchToBase64(t,e,r.buffer,a,n)}return this._source.toDataURL(t,e)}return null}},{key:"toBase64Async",value:function(t,e,i){var a=this._ctx._targets.sourceWidth,n=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,a,n,(function(r){var s=window,l=s.conchToBase64FlipY?s.conchToBase64FlipY(t,e,r.buffer,a,n):s.conchToBase64(t,e,r.buffer,a,n);i(l)}))}}]),r}(f.Bitmap);e.HTMLCanvas=g},99706:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HTMLImage=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(74935),f=i(41009),_=i(13156);var v=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,l.default)(this,r),n.apply(this,arguments)}return(0,s.default)(r)}(d.Bitmap);e.HTMLImage=v,(0,c.default)(v,"create",(function(t,e,i){var a=new f.Texture2D(t,e,i,!1,!1);return a.wrapModeU=_.WarpMode.Clamp,a.wrapModeV=_.WarpMode.Clamp,a}))},43269:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.RenderTexture2D=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(41009),_=i(54008),v=i(18195),y=i(52379),p=i(83530),g=i(33965),m=i(93561),x=i(52719);var T=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(t,e){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.RenderTextureFormat.R8G8B8,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x.RenderTextureDepthFormat.DEPTH_16;return(0,s.default)(this,r),i=n.call(this,a,!1),(0,d.default)((0,o.default)(i),"_mgrKey",0),i._glTextureType=_.LayaGL.instance.TEXTURE_2D,i._width=t,i._height=e,i._depthStencilFormat=l,i._create(t,e),i.lock=!0,i}return(0,l.default)(r,[{key:"depthStencilFormat",get:function(){return this._depthStencilFormat}},{key:"defaulteTexture",get:function(){return f.Texture2D.grayTexture}},{key:"getIsReady",value:function(){return!0}},{key:"sourceWidth",get:function(){return this._width}},{key:"sourceHeight",get:function(){return this._height}},{key:"offsetX",get:function(){return 0}},{key:"offsetY",get:function(){return 0}},{key:"_create",value:function(t,e){var i=_.LayaGL.instance;this._frameBuffer=i.createFramebuffer(),y.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture);var a=this._getGLFormat();if(i.texImage2D(this._glTextureType,0,a,t,e,0,a,i.UNSIGNED_BYTE,null),this._setGPUMemory(t*e*4),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this._glTexture,0),this._depthStencilFormat!==x.RenderTextureDepthFormat.DEPTHSTENCIL_NONE)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._depthStencilBuffer),this._depthStencilFormat){case x.RenderTextureDepthFormat.DEPTH_16:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case x.RenderTextureDepthFormat.STENCIL_8:i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX8,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case x.RenderTextureDepthFormat.DEPTHSTENCIL_24_8:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer)}i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindRenderbuffer(i.RENDERBUFFER,null),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,_.LayaGL.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))}},{key:"start",value:function(){var t=_.LayaGL.instance;_.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this._lastRT=r._currentActive,r._currentActive=this,this._readyed=!0,t.viewport(0,0,this._width,this._height),this._lastWidth=g.RenderState2D.width,this._lastHeight=g.RenderState2D.height,g.RenderState2D.width=this._width,g.RenderState2D.height=this._height,p.BaseShader.activeShader=null}},{key:"end",value:function(){var t=_.LayaGL.instance;t.bindFramebuffer(t.FRAMEBUFFER,null),r._currentActive=null,this._readyed=!0}},{key:"restore",value:function(){var t=_.LayaGL.instance;this._lastRT!=r._currentActive&&(_.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null),r._currentActive=this._lastRT),this._readyed=!0,t.viewport(0,0,this._lastWidth,this._lastHeight),g.RenderState2D.width=this._lastWidth,g.RenderState2D.height=this._lastHeight,p.BaseShader.activeShader=null}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=_.LayaGL.instance;n.clearColor(t,e,i,a);var r=n.COLOR_BUFFER_BIT;switch(this._depthStencilFormat){case n.DEPTH_COMPONENT16:r|=n.DEPTH_BUFFER_BIT;break;case n.STENCIL_INDEX8:r|=n.STENCIL_BUFFER_BIT;break;case n.DEPTH_STENCIL:r|=n.DEPTH_BUFFER_BIT,r|=n.STENCIL_BUFFER_BIT}n.clear(r)}},{key:"getData",value:function(t,e,i,a){if(m.ILaya.Render.isConchApp&&2==window.conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var n=_.LayaGL.instance;if(n.bindFramebuffer(n.FRAMEBUFFER,this._frameBuffer),n.checkFramebufferStatus(n.FRAMEBUFFER)!==n.FRAMEBUFFER_COMPLETE)return n.bindFramebuffer(n.FRAMEBUFFER,null),null;var r=new Uint8Array(this._width*this._height*4),s=this._getGLFormat();return n.readPixels(t,e,i,a,s,n.UNSIGNED_BYTE,r),n.bindFramebuffer(n.FRAMEBUFFER,null),r}},{key:"getDataAsync",value:function(t,e,i,a,n){var r=_.LayaGL.instance;r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer),r.readPixelsAsync(t,e,i,a,r.RGBA,r.UNSIGNED_BYTE,(function(t){n(new Uint8Array(t))})),r.bindFramebuffer(r.FRAMEBUFFER,null)}},{key:"recycle",value:function(){}},{key:"_disposeResource",value:function(){if(this._frameBuffer){var t=_.LayaGL.instance;t.deleteTexture(this._glTexture),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0)}}}],[{key:"currentActive",get:function(){return r._currentActive}},{key:"pushRT",value:function(){r.rtStack.push({rt:r._currentActive,w:g.RenderState2D.width,h:g.RenderState2D.height})}},{key:"popRT",value:function(){var t=_.LayaGL.instance,e=r.rtStack.pop();e&&(r._currentActive!=e.rt&&(_.LayaGL.instance.bindFramebuffer(t.FRAMEBUFFER,e.rt?e.rt._frameBuffer:null),r._currentActive=e.rt),t.viewport(0,0,e.w,e.h),g.RenderState2D.width=e.w,g.RenderState2D.height=e.h)}}]),r}(v.BaseTexture);e.RenderTexture2D=T,(0,d.default)(T,"rtStack",[]),(0,d.default)(T,"defuv",[0,0,1,0,1,1,0,1]),(0,d.default)(T,"flipyuv",[0,1,1,1,1,0,0,0])},52719:(t,e,i)=>{"use strict";var a,n;i(63978)(e,"__esModule",{value:!0}),e.RenderTextureFormat=e.RenderTextureDepthFormat=void 0,e.RenderTextureFormat=a,function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.Alpha8=2]="Alpha8",t[t.R16G16B16A16=14]="R16G16B16A16",t[t.Depth=15]="Depth",t[t.ShadowMap=16]="ShadowMap"}(a||(e.RenderTextureFormat=a={})),e.RenderTextureDepthFormat=n,function(t){t[t.DEPTH_16=0]="DEPTH_16",t[t.STENCIL_8=1]="STENCIL_8",t[t.DEPTHSTENCIL_24_8=2]="DEPTHSTENCIL_24_8",t[t.DEPTHSTENCIL_NONE=3]="DEPTHSTENCIL_NONE",t[t.DEPTHSTENCIL_16_8=2]="DEPTHSTENCIL_16_8"}(n||(e.RenderTextureDepthFormat=n={}))},8865:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Resource=void 0;var s=r(i(92762)),l=r(i(81643)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(93561),y=i(65700),p=i(70084);var g=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,o.default)(this,r),t=n.call(this),(0,_.default)((0,h.default)(t),"_id",0),(0,_.default)((0,h.default)(t),"_url",null),(0,_.default)((0,h.default)(t),"_cpuMemory",0),(0,_.default)((0,h.default)(t),"_gpuMemory",0),(0,_.default)((0,h.default)(t),"_destroyed",!1),(0,_.default)((0,h.default)(t),"_referenceCount",0),(0,_.default)((0,h.default)(t),"lock",!1),(0,_.default)((0,h.default)(t),"name",null),t._id=++r._uniqueIDCounter,t._destroyed=!1,t._referenceCount=0,r._idResourcesMap[t.id]=(0,h.default)(t),t.lock=!1,t}return(0,u.default)(r,[{key:"id",get:function(){return this._id}},{key:"url",get:function(){return this._url}},{key:"cpuMemory",get:function(){return this._cpuMemory}},{key:"gpuMemory",get:function(){return this._gpuMemory}},{key:"destroyed",get:function(){return this._destroyed}},{key:"referenceCount",get:function(){return this._referenceCount}},{key:"_setCPUMemory",value:function(t){var e=t-this._cpuMemory;this._cpuMemory=t,r._addCPUMemory(e)}},{key:"_setGPUMemory",value:function(t){var e=t-this._gpuMemory;this._gpuMemory=t,r._addGPUMemory(e)}},{key:"_setCreateURL",value:function(t){var e;t=p.URL.formatURL(t),this._url!==t&&(this._url&&(e=r._urlResourcesMap[this._url],(0,s.default)(e).call(e,(0,l.default)(e).call(e,this),1),0===e.length&&delete r._urlResourcesMap[this._url]),t&&((e=r._urlResourcesMap[t])||(r._urlResourcesMap[t]=e=[]),e.push(this)),this._url=t)}},{key:"_addReference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._referenceCount+=t}},{key:"_removeReference",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._referenceCount-=t}},{key:"_clearReference",value:function(){this._referenceCount=0}},{key:"_recoverResource",value:function(){}},{key:"_disposeResource",value:function(){}},{key:"_activeResource",value:function(){}},{key:"destroy",value:function(){var t;this._destroyed||(this._destroyed=!0,this.lock=!1,this._disposeResource(),delete r._idResourcesMap[this.id],this._url&&((t=r._urlResourcesMap[this._url])&&((0,s.default)(t).call(t,(0,l.default)(t).call(t,this),1),0===t.length&&delete r._urlResourcesMap[this._url]),v.ILaya.Loader.loadedMap[this._url]==this&&delete v.ILaya.Loader.loadedMap[this._url]))}}],[{key:"cpuMemory",get:function(){return r._cpuMemory}},{key:"gpuMemory",get:function(){return r._gpuMemory}},{key:"_addCPUMemory",value:function(t){r._cpuMemory+=t}},{key:"_addGPUMemory",value:function(t){r._gpuMemory+=t}},{key:"_addMemory",value:function(t,e){r._cpuMemory+=t,r._gpuMemory+=e}},{key:"getResourceByID",value:function(t){return r._idResourcesMap[t]}},{key:"getResourceByURL",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r._urlResourcesMap[t][e]}},{key:"destroyUnusedResources",value:function(){for(var t in r._idResourcesMap){var e=r._idResourcesMap[t];e.lock||0!==e._referenceCount||e.destroy()}}}]),r}(y.EventDispatcher);e.Resource=g,(0,_.default)(g,"_uniqueIDCounter",0),(0,_.default)(g,"_idResourcesMap",{}),(0,_.default)(g,"_urlResourcesMap",{}),(0,_.default)(g,"_cpuMemory",0),(0,_.default)(g,"_gpuMemory",0)},29148:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Texture=void 0;var s=r(i(3649)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(63969),v=i(65700),y=i(63701),p=i(35696),g=i(93561);var m=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return(0,l.default)(this,r),t=n.call(this),(0,f.default)((0,u.default)(t),"uvrect",[0,0,1,1]),(0,f.default)((0,u.default)(t),"_destroyed",!1),(0,f.default)((0,u.default)(t),"_referenceCount",0),(0,f.default)((0,u.default)(t),"$_GID",0),(0,f.default)((0,u.default)(t),"offsetX",0),(0,f.default)((0,u.default)(t),"offsetY",0),(0,f.default)((0,u.default)(t),"_w",0),(0,f.default)((0,u.default)(t),"_h",0),(0,f.default)((0,u.default)(t),"sourceWidth",0),(0,f.default)((0,u.default)(t),"sourceHeight",0),(0,f.default)((0,u.default)(t),"url",null),(0,f.default)((0,u.default)(t),"scaleRate",1),t.setTo(e,i,a,s),t}return(0,o.default)(r,[{key:"uv",get:function(){return this._uv},set:function(t){this.uvrect[0]=Math.min(t[0],t[2],t[4],t[6]),this.uvrect[1]=Math.min(t[1],t[3],t[5],t[7]),this.uvrect[2]=Math.max(t[0],t[2],t[4],t[6])-this.uvrect[0],this.uvrect[3]=Math.max(t[1],t[3],t[5],t[7])-this.uvrect[1],this._uv=t}},{key:"width",get:function(){return this._w?this._w:this.bitmap?this.uv&&this.uv!==r.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0},set:function(t){this._w=t,this.sourceWidth||(this.sourceWidth=t)}},{key:"height",get:function(){return this._h?this._h:this.bitmap?this.uv&&this.uv!==r.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0},set:function(t){this._h=t,this.sourceHeight||(this.sourceHeight=t)}},{key:"bitmap",get:function(){return this._bitmap},set:function(t){this._bitmap&&this._bitmap._removeReference(this._referenceCount),this._bitmap=t,t&&t._addReference(this._referenceCount)}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_addReference",value:function(){this._bitmap&&this._bitmap._addReference(),this._referenceCount++}},{key:"_removeReference",value:function(){this._bitmap&&this._bitmap._removeReference(),this._referenceCount--}},{key:"_getSource",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._destroyed||!this._bitmap?null:(this.recoverBitmap(t),this._bitmap.destroyed?null:this.bitmap._getSource())}},{key:"_onLoaded",value:function(t,e){if(e)if(e==this);else if(e instanceof r){var i=e;r._create(e,0,0,i.width,i.height,0,0,i.sourceWidth,i.sourceHeight,this)}else this.bitmap=e,this.sourceWidth=this._w=e.width,this.sourceHeight=this._h=e.height;t&&t.run(),this.event(_.Event.READY,this)}},{key:"getIsReady",value:function(){return!this._destroyed&&!!this._bitmap}},{key:"setTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.bitmap=t,this.sourceWidth=i,this.sourceHeight=a,t&&(this._w=t.width,this._h=t.height,this.sourceWidth=this.sourceWidth||t.width,this.sourceHeight=this.sourceHeight||t.height),this.uv=e||r.DEF_UV}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._destroyed||g.ILaya.loader.load(t,p.Handler.create(this,this._onLoaded,[e]),null,"htmlimage",1,!0)}},{key:"getTexturePixels",value:function(t,e,i,a){var n,r,l,o=this.bitmap,u=this._w,h=this._h,c=this.sourceWidth,d=this.sourceHeight,f=o.width,_=o.height,v=this.offsetX,y=this.offsetY,p=i,m=a;if(t+i>u+v&&(p-=t+i-u-v),t+i>c&&(i-=t+i-c),e+a>h+y&&(m-=e+a-h-y),e+a>d&&(a-=e+a-d),i<=0||a<=0)return null;var x=v>t?v-t:0,T=y>e?y-e:0,k=t>v?t-v:0,C=e>y?e-y:0;p-=x,m-=T;var S=4*i,E=null;try{E=o.getPixels()}catch(t){}if(E){var M;if(0==t&&0==e&&i==f&&a==_)return E;var L=(0,s.default)(M=this._uv).call(M),b=Math.round(L[0]*f),I=Math.round(L[1]*_),R=new Uint8Array(i*a*4);for(n=4*b+4*k+(r=(I+C)*(S=4*f)),l=0;l<m;l++)R.set((0,s.default)(E).call(E,n,n+4*p),4*i*(l+T)+4*x),n+=S;return R}var w=new g.ILaya.Context;w.size(i,a),w.asBitmap=!0;var A=null;if(0!=t||0!=e||i!=f||a!=_){var B,D=(A=(0,s.default)(B=this._uv).call(B))[0],P=A[1],F=(A[2]-D)/u,O=(A[7]-P)/h;A=[D+k*F,P+C*O,D+(k+p)*F,P+C*O,D+(k+p)*F,P+(C+m)*O,D+k*F,P+(C+m)*O]}w._drawTextureM(this,x,T,p,m,null,1,A),w._targets.start(),w.flush(),w._targets.end(),w._targets.restore();var U=w._targets.getData(0,0,i,a);for(w.destroy(),R=new Uint8Array(i*a*4),n=0,r=(a-1)*S,l=a-1;l>=0;l--)R.set((0,s.default)(U).call(U,r,r+S),n),n+=S,r-=S;return R}},{key:"getPixels",value:function(t,e,i,a){return window.conch?this._nativeObj.getImageData(t,e,i,a):this.getTexturePixels(t,e,i,a)}},{key:"recoverBitmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this._bitmap.url;if(!this._destroyed&&(!this._bitmap||this._bitmap.destroyed)&&i){var a=g.ILaya.Loader.loadedMap[i];a?(this.bitmap=a,e&&e()):g.ILaya.loader.load(i,p.Handler.create(this,(function(i){t.bitmap=i,e&&e()})),null,"htmlimage",1,!0)}}},{key:"disposeBitmap",value:function(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._destroyed){this._destroyed=!0;var e=this._bitmap;e&&(e._removeReference(this._referenceCount),(0===e.referenceCount||t)&&e.destroy(),e=null),this.url&&this===g.ILaya.loader.getRes(this.url)&&g.ILaya.Loader.clearRes(this.url)}}}],[{key:"moveUV",value:function(t,e,i){for(var a=0;a<8;a+=2)i[a]+=t,i[a+1]+=e;return i}},{key:"create",value:function(t,e,i,a,n){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return r._create(t,e,i,a,n,s,l,o,u)}},{key:"_create",value:function(t,e,i,a,n){var s,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=t instanceof r,f=d?t.uv:r.DEF_UV,_=d?t.bitmap:t;_.width&&e+a>_.width&&(a=_.width-e),_.height&&i+n>_.height&&(n=_.height-i),c?(s=c).setTo(_,null,u||a,h||n):s=new r(_,null,u||a,h||n),s.width=a,s.height=n,s.offsetX=l,s.offsetY=o;var v=1/_.width,y=1/_.height;e*=v,i*=y,a*=v,n*=y;var p=s.uv[0],g=s.uv[1],m=s.uv[4],x=s.uv[5],T=m-p,k=x-g,C=r.moveUV(f[0],f[1],[e,i,e+a,i,e+a,i+n,e,i+n]);s.uv=new Float32Array([p+C[0]*T,g+C[1]*k,m-(1-C[2])*T,g+C[3]*k,m-(1-C[4])*T,x-(1-C[5])*k,p+C[6]*T,x-(1-C[7])*k]);var S=_.scaleRate;return S&&1!=S?(s.sourceWidth/=S,s.sourceHeight/=S,s.width/=S,s.height/=S,s.scaleRate=S):s.scaleRate=1,s}},{key:"createFromTexture",value:function(t,e,i,a,n){var s=t.scaleRate;1!=s&&(e*=s,i*=s,a*=s,n*=s);var l=y.Rectangle.TEMP.setTo(e-t.offsetX,i-t.offsetY,a,n),o=l.intersection(r._rect1.setTo(0,0,t.width,t.height),r._rect2);return o?r.create(t,o.x,o.y,o.width,o.height,o.x-l.x,o.y-l.y,a,n):null}}]),r}(v.EventDispatcher);e.Texture=m,(0,f.default)(m,"DEF_UV",new Float32Array([0,0,1,0,1,1,0,1])),(0,f.default)(m,"NO_UV",new Float32Array([0,0,0,0,0,0,0,0])),(0,f.default)(m,"INV_UV",new Float32Array([0,1,1,1,1,0,0,0])),(0,f.default)(m,"_rect1",new y.Rectangle),(0,f.default)(m,"_rect2",new y.Rectangle)},41009:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Texture2D=void 0;var s=r(i(86029)),l=r(i(87368)),o=r(i(28146)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(93561),_=i(54008),v=i(52379),y=i(18195),p=i(96719),g=i(8245),m=i(63454),x=i(27218),T=i(64774);var k=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.TextureFormat.R8G8B8A8,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,l.default)(this,r),t=n.call(this,a,o);var h=_.LayaGL.instance;t._glTextureType=h.TEXTURE_2D,t._width=e,t._height=i,t._canRead=u,t._setWarpMode(h.TEXTURE_WRAP_S,t._wrapModeU),t._setWarpMode(h.TEXTURE_WRAP_T,t._wrapModeV),t._setFilterMode(t._filterMode),t._setAnisotropy(t._anisoLevel);var c=t._gpuCompressFormat();if(o){var d=Math.max(Math.ceil((0,s.default)(e))+1,Math.ceil((0,s.default)(i))+1);if(!c)for(var f=0;f<d;f++)t._setPixels(null,f,Math.max(e>>f,1),Math.max(i>>f,1));t._mipmapCount=d,t._setGPUMemory(e*i*4*(1+1/3))}else c||t._setPixels(null,0,e,i),t._mipmapCount=1,t._setGPUMemory(e*i*4);return t}return(0,o.default)(r,[{key:"defaulteTexture",get:function(){return r.grayTexture}},{key:"_gpuCompressFormat",value:function(){return this._format!=p.TextureFormat.R8G8B8A8&&this._format!=p.TextureFormat.R8G8B8&&this._format!=p.TextureFormat.R16G16B16A16&&this._format!=p.TextureFormat.R32G32B32A32&&this._format!=p.TextureFormat.R5G6B5&&this._format!=p.TextureFormat.Alpha8}},{key:"_setPixels",value:function(t,e,i,a){var n=_.LayaGL.instance,r=this._glTextureType,s=this._getGLFormat();switch(v.WebGLContext.bindTexture(n,r,this._glTexture),this.format){case p.TextureFormat.R8G8B8:n.pixelStorei(n.UNPACK_ALIGNMENT,1),n.texImage2D(r,e,s,i,a,0,s,n.UNSIGNED_BYTE,t),n.pixelStorei(n.UNPACK_ALIGNMENT,4);break;case p.TextureFormat.R5G6B5:n.pixelStorei(n.UNPACK_ALIGNMENT,2),n.texImage2D(r,e,s,i,a,0,s,n.UNSIGNED_SHORT_5_6_5,t),n.pixelStorei(n.UNPACK_ALIGNMENT,4);break;case p.TextureFormat.R32G32B32A32:_.LayaGL.layaGPUInstance._isWebGL2?n.texImage2D(r,e,n.RGBA32F,i,a,0,s,n.FLOAT,t):n.texImage2D(r,e,n.RGBA,i,a,0,s,n.FLOAT,t);break;case p.TextureFormat.R16G16B16A16:_.LayaGL.layaGPUInstance._isWebGL2?n.texImage2D(r,e,n.RGBA16F,i,a,0,s,n.HALF_FLOAT,t):n.texImage2D(r,e,n.RGBA,i,a,0,s,_.LayaGL.layaGPUInstance._oesTextureHalfFloat.HALF_FLOAT_OES,t);break;default:n.texImage2D(r,e,s,i,a,0,s,n.UNSIGNED_BYTE,t)}}},{key:"_calcualatesCompressedDataSize",value:function(t,e,i){switch(t){case p.TextureFormat.DXT1:return(e+3>>2)*(i+3>>2)*8;case p.TextureFormat.DXT5:return(e+3>>2)*(i+3>>2)*16;case p.TextureFormat.PVRTCRGB_4BPPV:case p.TextureFormat.PVRTCRGBA_4BPPV:return Math.floor((Math.max(e,8)*Math.max(i,8)*4+7)/8);case p.TextureFormat.PVRTCRGB_2BPPV:case p.TextureFormat.PVRTCRGBA_2BPPV:return Math.floor((Math.max(e,16)*Math.max(i,8)*2+7)/8);default:return 0}}},{key:"_pharseDDS",value:function(t){var e=new Int32Array(t,0,31);if(542327876!=e[0])throw"Invalid magic number in DDS header";if(!(4&e[20]))throw"Unsupported format, must contain a FourCC code";var i=e[21];switch(this._format){case p.TextureFormat.DXT1:if(827611204!==i)throw"the FourCC code is not same with texture format.";break;case p.TextureFormat.DXT5:if(894720068!==i)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var a=1;if(131072&e[2]){if(a=Math.max(1,e[7]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var n=e[4],r=e[3];this._width=n,this._height=r;var s=e[1]+4;this._upLoadCompressedTexImage2D(t,n,r,a,s,0)}},{key:"_pharseKTX",value:function(t){var e=new Uint8Array(t,0,12);if(171!=e[0]||75!=e[1]||84!=e[2]||88!=e[3]||32!=e[4]||49!=e[5]||49!=e[6]||187!=e[7]||13!=e[8]||10!=e[9]||26!=e[10]||10!=e[11])throw"Invalid fileIdentifier in KTX header";var i=new Int32Array(e.buffer,e.length,13),a=i[4];if(this._format=-1,_.LayaGL.layaGPUInstance._compressedTextureASTC)switch(a){case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_4x4_KHR:this._format=p.TextureFormat.ASTC4x4;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:this._format=p.TextureFormat.ASTC4x4SRGB;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:this._format=p.TextureFormat.ASTC6x6SRGB;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:this._format=p.TextureFormat.ASTC8x8SRGB;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:this._format=p.TextureFormat.ASTC10x10SRGB;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:this._format=p.TextureFormat.ASTC12x12SRGB;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_6x6_KHR:this._format=p.TextureFormat.ASTC6x6;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_8x8_KHR:this._format=p.TextureFormat.ASTC8x8;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_10x10_KHR:this._format=p.TextureFormat.ASTC10x10;break;case _.LayaGL.layaGPUInstance._compressedTextureASTC.COMPRESSED_RGBA_ASTC_12x12_KHR:this._format=p.TextureFormat.ASTC12x12}if(_.LayaGL.layaGPUInstance._compressedTextureEtc1&&a===_.LayaGL.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL&&(this._format=p.TextureFormat.ETC1RGB),_.LayaGL.layaGPUInstance._compressedTextureETC)switch(a){case _.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_RGBA8_ETC2_EAC:this._format=p.TextureFormat.ETC2RGBA;break;case _.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_RGB8_ETC2:this._format=p.TextureFormat.ETC2RGB;break;case _.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:this._format=p.TextureFormat.ETC2RGB_Alpha8;break;case _.LayaGL.layaGPUInstance._compressedTextureETC.COMPRESSED_SRGB8_ETC2:this._format=p.TextureFormat.ETC2SRGB}if(-1==this._format)throw"unknown texture format.";var n=i[11],r=i[6],s=i[7];this._width=r,this._height=s;var l=64+i[12];this._upLoadKTXCompressedTexImage2D(t,r,s,n,l,4)}},{key:"_pharsePVR",value:function(t){var e=new Int32Array(t,0,13);if(55727696!=e[0])throw"Invalid magic number in PVR header";switch(e[2]){case 0:this._format=p.TextureFormat.PVRTCRGB_2BPPV;break;case 2:this._format=p.TextureFormat.PVRTCRGB_4BPPV;break;case 1:this._format=p.TextureFormat.PVRTCRGBA_2BPPV;break;case 3:this._format=p.TextureFormat.PVRTCRGBA_4BPPV;break;default:throw"Texture2D:unknown PVR format."}var i=e[11],a=e[7],n=e[6];this._width=a,this._height=n;var r=e[12]+52;this._upLoadCompressedTexImage2D(t,a,n,i,r,0)}},{key:"_upLoadCompressedTexImage2D",value:function(t,e,i,a,n,r){var s=_.LayaGL.instance,l=this._glTextureType;v.WebGLContext.bindTexture(s,l,this._glTexture);for(var o=this._getGLFormat(),u=n,h=0;h<a;h++){u+=r;var c=this._calcualatesCompressedDataSize(this._format,e,i),d=new Uint8Array(t,u,c);s.compressedTexImage2D(l,h,o,e,i,0,d),e=Math.max(e>>1,1),i=Math.max(i>>1,1),u+=c}var f=u;this._setGPUMemory(f),this._readyed=!0,this._activeResource()}},{key:"_upLoadKTXCompressedTexImage2D",value:function(t,e,i,a,n,r){var s=_.LayaGL.instance,l=this._glTextureType;v.WebGLContext.bindTexture(s,l,this._glTexture);for(var o=this._getGLFormat(),u=n,h=0;h<a;h++){var c=new Int32Array(t,u,1)[0];u+=r;var d=new Uint8Array(t,u,c);s.compressedTexImage2D(l,h,o,e,i,0,d),e=Math.max(e>>1,1),i=Math.max(i>>1,1),u+=c,u+=3-(c+3)%4}var f=u;this._setGPUMemory(f),this._readyed=!0,this._activeResource()}},{key:"loadImageSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=_.LayaGL.instance,a=t.width,n=t.height;this._width=a,this._height=n,this._isPot(a)&&this._isPot(n)||(this._mipmap=!1),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),v.WebGLContext.bindTexture(i,this._glTextureType,this._glTexture);var r=this._getGLFormat();f.ILaya.Render.isConchApp?(t.setPremultiplyAlpha&&t.setPremultiplyAlpha(e),i.texImage2D(this._glTextureType,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)):(e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.format==p.TextureFormat.R5G6B5?i.texImage2D(this._glTextureType,0,i.RGB,i.RGB,i.UNSIGNED_SHORT_5_6_5,t):i.texImage2D(this._glTextureType,0,r,r,i.UNSIGNED_BYTE,t),e&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)),this._mipmap?(i.generateMipmap(this._glTextureType),this._setGPUMemory(a*n*4*(1+1/3))):this._setGPUMemory(a*n*4),this._canRead&&(f.ILaya.Render.isConchApp?this._pixels=new Uint8Array(t._nativeObj.getImageData(0,0,a,n)):(f.ILaya.Browser.canvas.size(a,n),f.ILaya.Browser.canvas.clear(),f.ILaya.Browser.context.drawImage(t,0,0,a,n),this._pixels=new Uint8Array(f.ILaya.Browser.context.getImageData(0,0,a,n).data.buffer))),this._readyed=!0,this._activeResource()}},{key:"setPixels",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!t)throw"Texture2D:pixels can't be null.";var i=Math.max(this._width>>e,1),a=Math.max(this._height>>e,1),n=i*a*this._getFormatByteCount();if(t.length<n)throw"Texture2D:pixels length should at least "+n+".";this._setPixels(t,e,i,a),this._canRead&&(this._pixels=t),this._readyed=!0,this._activeResource()}},{key:"setSubPixels",value:function(t,e,i,a,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!n)throw"Texture2D:pixels can't be null.";var s=_.LayaGL.instance,l=this._glTextureType;v.WebGLContext.bindTexture(s,l,this._glTexture);var o=this._getGLFormat();switch(this.format){case p.TextureFormat.R8G8B8:s.pixelStorei(s.UNPACK_ALIGNMENT,1),s.texSubImage2D(l,r,t,e,i,a,o,s.UNSIGNED_BYTE,n),s.pixelStorei(s.UNPACK_ALIGNMENT,4);break;case p.TextureFormat.R5G6B5:s.pixelStorei(s.UNPACK_ALIGNMENT,2),s.texSubImage2D(l,r,t,e,i,a,o,s.UNSIGNED_SHORT_5_6_5,n),s.pixelStorei(s.UNPACK_ALIGNMENT,4);break;case p.TextureFormat.R32G32B32A32:s.texSubImage2D(l,r,t,e,i,a,o,s.FLOAT,n);break;default:s.texSubImage2D(l,r,t,e,i,a,o,s.UNSIGNED_BYTE,n)}this._readyed=!0,this._activeResource()}},{key:"setCompressData",value:function(t){switch(this._format){case p.TextureFormat.DXT1:case p.TextureFormat.DXT5:this._pharseDDS(t);break;case p.TextureFormat.ETC1RGB:case p.TextureFormat.ETC2RGB:case p.TextureFormat.ETC2RGBA:case p.TextureFormat.ETC2RGB_Alpha8:case p.TextureFormat.ETC2SRGB:case p.TextureFormat.ASTC4x4:case p.TextureFormat.ASTC4x4SRGB:case p.TextureFormat.ASTC6x6:case p.TextureFormat.ASTC6x6SRGB:case p.TextureFormat.ASTC8x8:case p.TextureFormat.ASTC8x8SRGB:case p.TextureFormat.ASTC10x10:case p.TextureFormat.ASTC10x10SRGB:case p.TextureFormat.ASTC12x12:case p.TextureFormat.ASTC12x12SRGB:case p.TextureFormat.KTXTEXTURE:this._pharseKTX(t);break;case p.TextureFormat.PVRTCRGB_2BPPV:case p.TextureFormat.PVRTCRGBA_2BPPV:case p.TextureFormat.PVRTCRGB_4BPPV:case p.TextureFormat.PVRTCRGBA_4BPPV:case p.TextureFormat.PVRTEXTURE:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}1==this.mipmapCount||this.width!=1<<this.mipmapCount-1&&this.height!=1<<this.mipmapCount?this._mipmap=!1:this._mipmap=!0;var e=_.LayaGL.instance;this._setWarpMode(e.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(e.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode)}},{key:"getPixels",value:function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")}}],[{key:"__init__",value:function(){var t=new Uint8Array(3);t[0]=128,t[1]=128,t[2]=128,r.grayTexture=new r(1,1,p.TextureFormat.R8G8B8,!1,!1),r.grayTexture.setPixels(t),r.grayTexture.lock=!0,t[0]=255,t[1]=255,t[2]=255,r.whiteTexture=new r(1,1,p.TextureFormat.R8G8B8,!1,!1),r.whiteTexture.setPixels(t),r.whiteTexture.lock=!0,t[0]=0,t[1]=0,t[2]=0,r.blackTexture=new r(1,1,p.TextureFormat.R8G8B8,!1,!1),r.blackTexture.setPixels(t),r.blackTexture.lock=!0,r.erroTextur=r.whiteTexture}},{key:"_parse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=i?new r(i[0],i[1],i[2],i[3],i[4]):new r(0,0);switch(e&&(a.wrapModeU=e.wrapModeU,a.wrapModeV=e.wrapModeV,a.filterMode=e.filterMode,a.anisoLevel=e.anisoLevel),a._format){case p.TextureFormat.R8G8B8:case p.TextureFormat.R8G8B8A8:a.loadImageSource(t);break;case p.TextureFormat.DXT1:case p.TextureFormat.DXT5:case p.TextureFormat.ETC1RGB:case p.TextureFormat.PVRTCRGB_2BPPV:case p.TextureFormat.PVRTCRGBA_2BPPV:case p.TextureFormat.PVRTCRGB_4BPPV:case p.TextureFormat.PVRTCRGBA_4BPPV:case p.TextureFormat.ETC2RGB:case p.TextureFormat.ETC2RGBA:case p.TextureFormat.ETC2SRGB:case p.TextureFormat.ASTC4x4:case p.TextureFormat.ASTC6x6:case p.TextureFormat.ASTC8x8:case p.TextureFormat.ASTC10x10:case p.TextureFormat.ASTC12x12:case p.TextureFormat.KTXTEXTURE:case p.TextureFormat.PVRTEXTURE:a.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return a}},{key:"_SimpleAnimatorTextureParse",value:function(t){var e,i,a=new g.Byte(t);switch(a.readUTFString()){case"LAYAANIMATORTEXTURE:0000":var n,s=a.readInt32(),l=a.readInt32();e=new Float32Array(s*s*4),i=new Float32Array(a.readArrayBuffer(4*l)),e.set(i,0),(n=new r(s,s,p.TextureFormat.R32G32B32A32,!1,!1)).setPixels(e,0),n.filterMode=m.FilterMode.Point;break;case"LAYACOMPRESSANIMATORTEXTURE:0000":if(s=a.readInt32(),l=a.readInt32(),e=new Uint16Array(a.readArrayBuffer(2*l)),x.SystemUtils.supportTextureFormat(p.TextureFormat.R16G16B16A16))(i=new Uint16Array(s*s*4)).set(e,0),(n=new r(s,s,p.TextureFormat.R16G16B16A16,!1,!1)).setPixels(i,0),n.filterMode=m.FilterMode.Point;else{console.log("The platform does not support 16-bit floating-point textures"),x.SystemUtils.supportTextureFormat(p.TextureFormat.R32G32B32A32)||console.error("The platform does not support 32-bit floating-point textures"),i=new Float32Array(s*s*4);for(var o=0,u=e.length;o<u;o++)i[o]=T.HalfFloatUtils.convertToNumber(e[o]);(n=new r(s,s,p.TextureFormat.R32G32B32A32,!1,!1)).setPixels(i,0),n.filterMode=m.FilterMode.Point}break;default:throw"Laya3D:unknow version."}return n}},{key:"load",value:function(t,e){f.ILaya.loader.create(t,e,null,f.ILaya.Loader.TEXTURE2D)}}]),r}(y.BaseTexture);e.Texture2D=k,(0,d.default)(k,"TEXTURE2D","TEXTURE2D"),(0,d.default)(k,"grayTexture",null),(0,d.default)(k,"whiteTexture",null),(0,d.default)(k,"blackTexture",null),(0,d.default)(k,"erroTextur",null)},96719:(t,e,i)=>{"use strict";var a;i(63978)(e,"__esModule",{value:!0}),e.TextureFormat=void 0,e.TextureFormat=a,function(t){t[t.R8G8B8=0]="R8G8B8",t[t.R8G8B8A8=1]="R8G8B8A8",t[t.R5G6B5=16]="R5G6B5",t[t.Alpha8=2]="Alpha8",t[t.DXT1=3]="DXT1",t[t.DXT5=4]="DXT5",t[t.ETC1RGB=5]="ETC1RGB",t[t.ETC2RGB=6]="ETC2RGB",t[t.ETC2RGBA=7]="ETC2RGBA",t[t.ETC2RGB_Alpha8=8]="ETC2RGB_Alpha8",t[t.ETC2SRGB=28]="ETC2SRGB",t[t.PVRTCRGB_2BPPV=9]="PVRTCRGB_2BPPV",t[t.PVRTCRGBA_2BPPV=10]="PVRTCRGBA_2BPPV",t[t.PVRTCRGB_4BPPV=11]="PVRTCRGB_4BPPV",t[t.PVRTCRGBA_4BPPV=12]="PVRTCRGBA_4BPPV",t[t.R32G32B32A32=15]="R32G32B32A32",t[t.R16G16B16A16=17]="R16G16B16A16",t[t.ASTC4x4=18]="ASTC4x4",t[t.ASTC4x4SRGB=23]="ASTC4x4SRGB",t[t.ASTC6x6=19]="ASTC6x6",t[t.ASTC6x6SRGB=24]="ASTC6x6SRGB",t[t.ASTC8x8=20]="ASTC8x8",t[t.ASTC8x8SRGB=25]="ASTC8x8SRGB",t[t.ASTC10x10=21]="ASTC10x10",t[t.ASTC10x10SRGB=26]="ASTC10x10SRGB",t[t.ASTC12x12=22]="ASTC12x12",t[t.ASTC12x12SRGB=27]="ASTC12x12SRGB",t[t.KTXTEXTURE=-1]="KTXTEXTURE",t[t.PVRTEXTURE=-2]="PVRTEXTURE"}(a||(e.TextureFormat=a={}))},99474:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.WebGLRTMgr=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(43269),u=i(52719),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getRT",value:function(t,e){return e|=0,(t|=0)>=1e4&&console.error("getRT error! w too big"),new o.RenderTexture2D(t,e,u.RenderTextureFormat.R8G8B8A8,-1)}},{key:"releaseRT",value:function(t){t.destroy()}}]),t}();e.WebGLRTMgr=h,(0,l.default)(h,"dict",{})},13156:(t,e,i)=>{"use strict";var a;i(63978)(e,"__esModule",{value:!0}),e.WarpMode=void 0,e.WarpMode=a,function(t){t[t.Repeat=0]="Repeat",t[t.Clamp=1]="Clamp"}(a||(e.WarpMode=a={}))},19492:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.AutoBitmap=void 0;var s=r(i(77766)),l=r(i(2991)),o=r(i(92762)),u=r(i(87368)),h=r(i(28146)),c=r(i(43714)),d=r(i(92135)),f=r(i(13383)),_=r(i(78310)),v=r(i(82669)),y=r(i(17454)),p=i(22010),g=i(29148),m=i(11179),x=i(89432),T=i(93561),k=i(32487),C=i(5831),S=i(46791);var E=function(t){(0,f.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,_.default)(this,t)});function r(){var t,e;(0,u.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,y.default)((0,c.default)(e),"autoCacheCmd",!0),(0,y.default)((0,c.default)(e),"_width",0),(0,y.default)((0,c.default)(e),"_height",0),(0,y.default)((0,c.default)(e),"uv",null),e}return(0,h.default)(r,[{key:"destroy",value:function(){(0,d.default)((0,v.default)(r.prototype),"destroy",this).call(this),this._source=null,this._sizeGrid=null,this._offset=null}},{key:"sizeGrid",get:function(){return this._sizeGrid},set:function(t){this._sizeGrid=(0,l.default)(t).call(t,(function(t){return+t})),this._setChanged()}},{key:"width",get:function(){return this._width?this._width:this._source?this._source.sourceWidth:0},set:function(t){this._width!=t&&(this._width=t,this._setChanged())}},{key:"height",get:function(){return this._height?this._height:this._source?this._source.sourceHeight:0},set:function(t){this._height!=t&&(this._height=t,this._setChanged())}},{key:"source",get:function(){return this._source},set:function(t){if(t)this._source=t,this._setChanged();else if(this._source=null,this._drawGridCmd){this._one&&this._one==this._drawGridCmd&&this.clear();var e=this.cmds;e&&e.length>0&&e[0]==this._drawGridCmd&&(0,o.default)(e).call(e,0,1)}}},{key:"_setChanged",value:function(){this._isChanged||(this._isChanged=!0,T.ILaya.timer.callLater(this,this.changeSource))}},{key:"_createDrawTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9?arguments[9]:void 0;if(!t||s<.01)return null;if(!t.getIsReady())return null;if(a||(a=t.sourceWidth),n||(n=t.sourceHeight),t.getIsReady()){var h=a/t.sourceWidth,c=n/t.sourceHeight;if(a=t.width*h,n=t.height*c,a<=0||n<=0)return null;e+=t.offsetX*h,i+=t.offsetY*c}return this._sp&&(this._sp._renderType|=S.SpriteConst.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),C.DrawTextureCmd.create.call(this,t,e,i,a,n,r,s,l,o,u)}},{key:"changeSource",value:function(){this._isChanged=!1;var t=this._source;if(t&&t.bitmap){var e=this.width,i=this.height,a=this._sizeGrid,n=t.sourceWidth,r=t.sourceHeight;if(!a||n===e&&r===i){var s=this._createDrawTexture(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,e,i,null,1,null,null,this.uv);s&&this._setDrawGridCmd(s)}else{var l=k.Draw9GridTexture.create(t,0,0,e,i,a);this._setDrawGridCmd(l)}this._repaint()}}},{key:"drawBitmap",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;n<.1||r<.1||(!t||e.width==n&&e.height==r?this.drawImage(e,i,a,n,r):this.fillTexture(e,i,a,n,r))}},{key:"_setDrawGridCmd",value:function(t){var e=this._source;if(e&&e.bitmap){var i=this.cmds;if(this._one||i&&!(i.length<=0)){var a=this._one;a?a==this._drawGridCmd?this._one=t:(this.clear(),this._saveToCmd(null,t),this._saveToCmd(null,a)):(0,o.default)(i).call(i,0,0,t)}else this._saveToCmd(null,t);this._drawGridCmd=t}}}],[{key:"getTexture",value:function(t,e,i,a,n){var r;return a<=0&&(a=1),n<=0&&(n=1),t.$_GID||(t.$_GID=m.Utils.getGID()),r&&r._getSource()||(r=g.Texture.createFromTexture(t,e,i,a,n)),r}}]),r}(p.Graphics);e.AutoBitmap=E,x.ClassUtils.regClass("laya.ui.AutoBitmap",E),x.ClassUtils.regClass("Laya.AutoBitmap",E)},65810:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Box=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=i(60414),f=i(63969),_=i(93561),v=i(89432);var y=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"dataSource",get:function(){return(0,o.default)((0,c.default)(r.prototype),"dataSource",this)},set:function(t){for(var e in this._dataSource=t,t){var i=this.getChildByName(e);i?i.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,t?(this._onResize(null),this.on(f.Event.RESIZE,this,this._onResize)):(this.graphics.clear(),this.off(f.Event.RESIZE,this,this._onResize))}},{key:"_onResize",value:function(t){this.graphics.clear(),this.graphics.drawRect(0,0,this.width,this.height,this._bgColor)}}]),r}(d.UIComponent);e.Box=y,_.ILaya.regClass(y),v.ClassUtils.regClass("laya.ui.Box",y),v.ClassUtils.regClass("Laya.Box",y)},65869:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Button=void 0;var s=r(i(94198)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(60414),y=i(51630),p=i(46222),g=i(23699),m=i(63969),x=i(84581),T=i(29148),k=i(19492),C=i(44451),S=i(35696),E=i(11179),M=i(57964),L=i(93561),b=i(89432);var I=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,l.default)(this,r),t=n.call(this),(0,_.default)((0,u.default)(t),"_labelColors",y.Styles.buttonLabelColors),(0,_.default)((0,u.default)(t),"_state",0),(0,_.default)((0,u.default)(t),"_autoSize",!0),(0,_.default)((0,u.default)(t),"_stateNum",y.Styles.buttonStateNum),(0,_.default)((0,u.default)(t),"_stateChanged",!1),t.skin=e,t.label=i,t}return(0,o.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(t),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new k.AutoBitmap}},{key:"createText",value:function(){this._text||(this._text=new g.Text,this._text.overflow=g.Text.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)}},{key:"initialize",value:function(){1!==this._mouseState&&(this.mouseEnabled=!0,this._setBit(p.Const.HAS_MOUSE,!0)),this._createListener(m.Event.MOUSE_OVER,this,this.onMouse,null,!1,!1),this._createListener(m.Event.MOUSE_OUT,this,this.onMouse,null,!1,!1),this._createListener(m.Event.MOUSE_DOWN,this,this.onMouse,null,!1,!1),this._createListener(m.Event.MOUSE_UP,this,this.onMouse,null,!1,!1),this._createListener(m.Event.CLICK,this,this.onMouse,null,!1,!1)}},{key:"onMouse",value:function(t){if(!1!==this.toggle||!this._selected)return t.type===m.Event.CLICK?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=r.stateMap[t.type]))}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,t?x.Loader.getRes(t)?this._skinLoaded():L.ILaya.loader.load(this._skin,S.Handler.create(this,this._skinLoaded),null,x.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.callLater(this.changeClips),this._setStateChanged(),this._sizeChanged(),this.event(m.Event.LOADED)}},{key:"stateNum",get:function(){return this._stateNum},set:function(t){"string"==typeof t&&(t=(0,s.default)(t)),this._stateNum!=t&&(this._stateNum=t<1?1:t>3?3:t,this.callLater(this.changeClips))}},{key:"changeClips",value:function(){var t=x.Loader.getRes(this._skin);if(t){var e=t.sourceWidth,i=t.sourceHeight/this._stateNum;t.$_GID||(t.$_GID=E.Utils.getGID());var a=t.$_GID+"-"+this._stateNum,n=M.WeakObject.I.get(a);if(E.Utils.isOkTextureList(n)||(n=null),n)this._sources=n;else{if(this._sources=[],1===this._stateNum)this._sources.push(t);else for(var r=0;r<this._stateNum;r++)this._sources.push(T.Texture.createFromTexture(t,0,i*r,e,i));M.WeakObject.I.set(a,this._sources)}this._autoSize?(this._bitmap.width=this._width||e,this._bitmap.height=this._height||i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=e)}else console.log("lose skin",this._skin)}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}},{key:"label",get:function(){return this._text?this._text.text:null},set:function(t){(this._text||t)&&(this.createText(),this._text.text!=t&&(t&&!this._text.parent&&this.addChild(this._text),this._text.text=(t+"").replace(/\\n/g,"\n"),this._setStateChanged()))}},{key:"selected",get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.state=this._selected?2:0,this.event(m.Event.CHANGE))}},{key:"state",get:function(){return this._state},set:function(t){this._state!=t&&(this._state=t,this._setStateChanged())}},{key:"changeState",value:function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[t]),this.label&&(this._text.color=this._labelColors[t],this._strokeColors&&(this._text.strokeColor=this._strokeColors[t]))}},{key:"labelColors",get:function(){return this._labelColors.join(",")},set:function(t){this._labelColors=C.UIUtils.fillArray(y.Styles.buttonLabelColors,t,String),this._setStateChanged()}},{key:"strokeColors",get:function(){return this._strokeColors?this._strokeColors.join(","):""},set:function(t){this._strokeColors=C.UIUtils.fillArray(y.Styles.buttonLabelColors,t,String),this._setStateChanged()}},{key:"labelPadding",get:function(){return this.createText(),this._text.padding.join(",")},set:function(t){this.createText(),this._text.padding=C.UIUtils.fillArray(y.Styles.labelPadding,t,Number)}},{key:"labelSize",get:function(){return this.createText(),this._text.fontSize},set:function(t){this.createText(),this._text.fontSize=t}},{key:"labelStroke",get:function(){return this.createText(),this._text.stroke},set:function(t){this.createText(),this._text.stroke=t}},{key:"labelStrokeColor",get:function(){return this.createText(),this._text.strokeColor},set:function(t){this.createText(),this._text.strokeColor=t}},{key:"labelBold",get:function(){return this.createText(),this._text.bold},set:function(t){this.createText(),this._text.bold=t}},{key:"labelFont",get:function(){return this.createText(),this._text.font},set:function(t){this.createText(),this._text.font=t}},{key:"labelAlign",get:function(){return this.createText(),this._text.align},set:function(t){this.createText(),this._text.align=t}},{key:"clickHandler",get:function(){return this._clickHandler},set:function(t){this._clickHandler=t}},{key:"text",get:function(){return this.createText(),this._text}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=C.UIUtils.fillArray(y.Styles.defaultSizeGrid,t,Number)}},{key:"width",get:function(){return(0,h.default)((0,f.default)(r.prototype),"get_width",this).call(this)},set:function(t){(0,h.default)((0,f.default)(r.prototype),"set_width",this).call(this,t),this._autoSize&&(this._bitmap.width=t,this._text&&(this._text.width=t))}},{key:"height",get:function(){return(0,h.default)((0,f.default)(r.prototype),"get_height",this).call(this)},set:function(t){(0,h.default)((0,f.default)(r.prototype),"set_height",this).call(this,t),this._autoSize&&(this._bitmap.height=t,this._text&&(this._text.height=t))}},{key:"dataSource",get:function(){return(0,h.default)((0,f.default)(r.prototype),"get_dataSource",this).call(this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.label=t+"":(0,h.default)((0,f.default)(r.prototype),"set_dataSource",this).call(this,t)}},{key:"iconOffset",get:function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},set:function(t){this._bitmap._offset=t?C.UIUtils.fillArray([1,1],t,Number):[]}},{key:"_setStateChanged",value:function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))}}]),r}(v.UIComponent);e.Button=I,(0,_.default)(I,"stateMap",{mouseup:0,mouseover:1,mousedown:2,mouseout:0}),L.ILaya.regClass(I),b.ClassUtils.regClass("laya.ui.Button",I),b.ClassUtils.regClass("Laya.Button",I)},32673:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.CheckBox=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(52605)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=i(65869),_=i(93561),v=i(89432);var y=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,s.default)(this,r),(t=n.call(this,e,i)).toggle=!0,t._autoSize=!1,t}return(0,l.default)(r,[{key:"preinitialize",value:function(){(0,u.default)((0,d.default)(r.prototype),"preinitialize",this).call(this),this.toggle=!0,this._autoSize=!1}},{key:"initialize",value:function(){(0,u.default)((0,d.default)(r.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,t instanceof Boolean?this.selected=t:"string"==typeof t?this.selected="true"===t:(0,o.default)((0,d.default)(r.prototype),"dataSource",t,this,!0)}}]),r}(f.Button);e.CheckBox=y,_.ILaya.regClass(y),v.ClassUtils.regClass("laya.ui.CheckBox",y),v.ClassUtils.regClass("Laya.CheckBox",y)},60008:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Clip=void 0;var s=r(i(94198)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(52605)),c=r(i(92135)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=r(i(17454)),y=i(60414),p=i(19492),g=i(44451),m=i(51630),x=i(46222),T=i(63969),k=i(84581),C=i(29148),S=i(35696),E=i(11179),M=i(57964),L=i(93561),b=i(89432);var I=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,l.default)(this,r),t=n.call(this),(0,v.default)((0,u.default)(t),"_clipX",1),(0,v.default)((0,u.default)(t),"_clipY",1),(0,v.default)((0,u.default)(t),"_clipWidth",0),(0,v.default)((0,u.default)(t),"_clipHeight",0),(0,v.default)((0,u.default)(t),"_interval",50),(0,v.default)((0,u.default)(t),"_index",0),(0,v.default)((0,u.default)(t),"_toIndex",-1),t._clipX=i,t._clipY=a,t.skin=e,t}return(0,o.default)(r,[{key:"destroy",value:function(){(0,c.default)((0,_.default)(r.prototype),"destroy",this).call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null}},{key:"dispose",value:function(){this.destroy(!0),L.ILaya.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new p.AutoBitmap}},{key:"_onDisplay",value:function(t){this._isPlaying?this._getBit(x.Const.DISPLAYED_INSTAGE)?this.play():this.stop():this._autoPlay&&this.play()}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,t?k.Loader.getRes(t)?this._skinLoaded():L.ILaya.loader.load(this._skin,S.Handler.create(this,this._skinLoaded),null,k.Loader.IMAGE,1):this._bitmap.source=null)}},{key:"_skinLoaded",value:function(){this._setClipChanged(),this._sizeChanged(),this.event(T.Event.LOADED)}},{key:"clipX",get:function(){return this._clipX},set:function(t){this._clipX=t||1,this._setClipChanged()}},{key:"clipY",get:function(){return this._clipY},set:function(t){this._clipY=t||1,this._setClipChanged()}},{key:"clipWidth",get:function(){return this._clipWidth},set:function(t){this._clipWidth=t,this._setClipChanged()}},{key:"clipHeight",get:function(){return this._clipHeight},set:function(t){this._clipHeight=t,this._setClipChanged()}},{key:"changeClip",value:function(){if(this._clipChanged=!1,this._skin&&!this.destroyed){var t=k.Loader.getRes(this._skin);t?this.loadComplete(this._skin,t):L.ILaya.loader.load(this._skin,S.Handler.create(this,this.loadComplete,[this._skin]))}}},{key:"loadComplete",value:function(t,e){if(t===this._skin&&e){var i=this._clipWidth||Math.ceil(e.sourceWidth/this._clipX),a=this._clipHeight||Math.ceil(e.sourceHeight/this._clipY),n=this._skin+i+a,r=M.WeakObject.I.get(n);if(E.Utils.isOkTextureList(r)||(r=null),r)this._sources=r;else{this._sources=[];for(var s=0;s<this._clipY;s++)for(var l=0;l<this._clipX;l++)this._sources.push(C.Texture.createFromTexture(e,i*l,a*s,i,a));M.WeakObject.I.set(n,this._sources)}this.index=this._index,this.event(T.Event.LOADED),this.onCompResize()}}},{key:"sources",get:function(){return this._sources},set:function(t){this._sources=t,this.index=this._index,this.event(T.Event.LOADED)}},{key:"group",get:function(){return this._group},set:function(t){t&&this._skin&&k.Loader.setGroup(this._skin,t),this._group=t}},{key:"width",get:function(){return(0,c.default)((0,_.default)(r.prototype),"width",this)},set:function(t){(0,h.default)((0,_.default)(r.prototype),"width",t,this,!0),this._bitmap.width=t}},{key:"height",get:function(){return(0,c.default)((0,_.default)(r.prototype),"height",this)},set:function(t){(0,h.default)((0,_.default)(r.prototype),"height",t,this,!0),this._bitmap.height=t}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClip),this._bitmap.width}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClip),this._bitmap.height}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=g.UIUtils.fillArray(m.Styles.defaultSizeGrid,t,Number)}},{key:"index",get:function(){return this._index},set:function(t){this._index=t,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[t]),this.event(T.Event.CHANGE)}},{key:"total",get:function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}},{key:"autoPlay",get:function(){return this._autoPlay},set:function(t){this._autoPlay!=t&&(this._autoPlay=t,t?this.play():this.stop())}},{key:"interval",get:function(){return this._interval},set:function(t){this._interval!=t&&(this._interval=t,this._isPlaying&&this.play())}},{key:"isPlaying",get:function(){return this._isPlaying},set:function(t){this._isPlaying=t}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this._isPlaying=!0,this.index=t,this._toIndex=e,this._index++,L.ILaya.timer.loop(this.interval,this,this._loop),this.on(T.Event.DISPLAY,this,this._onDisplay),this.on(T.Event.UNDISPLAY,this,this._onDisplay)}},{key:"_loop",value:function(){this._visible&&this._sources&&(this._index++,this._toIndex>-1&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)}},{key:"stop",value:function(){this._isPlaying=!1,L.ILaya.timer.clear(this,this._loop),this.event(T.Event.COMPLETE)}},{key:"dataSource",get:function(){return(0,c.default)((0,_.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.index=(0,s.default)(t):(0,h.default)((0,_.default)(r.prototype),"dataSource",t,this,!0)}},{key:"bitmap",get:function(){return this._bitmap}},{key:"_setClipChanged",value:function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))}}]),r}(y.UIComponent);e.Clip=I,L.ILaya.regClass(I),b.ClassUtils.regClass("laya.ui.Clip",I),b.ClassUtils.regClass("Laya.Clip",I)},49537:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ColorPicker=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(60414),v=i(65810),y=i(65869),p=i(44451),g=i(85058),m=i(87210),x=i(63969),T=i(91020),k=i(93561),C=i(89432);var S=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,s.default)(this,r),t=n.call(this,!1),(0,f.default)((0,o.default)(t),"_gridSize",11),(0,f.default)((0,o.default)(t),"_bgColor","#ffffff"),(0,f.default)((0,o.default)(t),"_borderColor","#000000"),(0,f.default)((0,o.default)(t),"_inputColor","#000000"),(0,f.default)((0,o.default)(t),"_inputBgColor","#efefef"),(0,f.default)((0,o.default)(t),"_colors",[]),(0,f.default)((0,o.default)(t),"_selectedColor","#000000"),e&&(t.preinitialize(),t.createChildren(),t.initialize()),t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];k.ILaya.stage.off(x.Event.MOUSE_DOWN,this,this.removeColorBox),(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t),this._colorPanel&&this._colorPanel.destroy(t),this._colorButton&&this._colorButton.destroy(t),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._colorButton=new y.Button),this._colorPanel=new v.Box,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new m.Sprite),this._colorPanel.addChild(this._colorBlock=new m.Sprite),this._colorPanel.addChild(this._colorInput=new g.Input)}},{key:"initialize",value:function(){this._colorButton.on(x.Event.CLICK,this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on(x.Event.CHANGE,this,this.onColorInputChange),this._colorInput.on(x.Event.KEY_DOWN,this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on(x.Event.MOUSE_MOVE,this,this.onColorTilesMouseMove),this._colorTiles.on(x.Event.CLICK,this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on(x.Event.MOUSE_DOWN,this,this.onPanelMouseDown),this.bgColor=this._bgColor}},{key:"onPanelMouseDown",value:function(t){t.stopPropagation()}},{key:"changePanel",value:function(){this._panelChanged=!1;var t=this._colorPanel.graphics;t.clear(!0),t.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(t=this._colorTiles.graphics).clear(!0);for(var e=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],i=0;i<12;i++)for(var a=0;a<20;a++){var n;n=0===a?e[i]:1===a?0:51*(((3*i+a/6)%3<<0)+3*(i/6<<0))<<16|a%6*51<<8|(i<<0)%6*51;var r=p.UIUtils.toColor(n);this._colors.push(r);var s=a*this._gridSize,l=i*this._gridSize;t.drawRect(s,l,this._gridSize,this._gridSize,r,"#000000")}}},{key:"onColorButtonClick",value:function(t){this._colorPanel.parent?this.close():this.open()}},{key:"open",value:function(){var t=k.ILaya.stage,e=this.localToGlobal(new T.Point),i=e.x+this._colorPanel.width<=t.width?e.x:t.width-this._colorPanel.width,a=e.y+this._colorButton.height;a=a+this._colorPanel.height<=t.height?a:e.y-this._colorPanel.height,this._colorPanel.pos(i,a),this._colorPanel.zOrder=1001,t.addChild(this._colorPanel),t.on(x.Event.MOUSE_DOWN,this,this.removeColorBox)}},{key:"close",value:function(){k.ILaya.stage.off(x.Event.MOUSE_DOWN,this,this.removeColorBox),this._colorPanel.removeSelf()}},{key:"removeColorBox",value:function(){this.close()}},{key:"onColorFieldKeyDown",value:function(t){13==t.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),t.stopPropagation())}},{key:"onColorInputChange",value:function(){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")}},{key:"onColorTilesClick",value:function(t){this.selectedColor=this.getColorByMouse(),this.close()}},{key:"onColorTilesMouseMove",value:function(t){this._colorInput.focus=!1;var e=this.getColorByMouse();this._colorInput.text=e,this.drawBlock(e)}},{key:"getColorByMouse",value:function(){var t=this._colorTiles.getMousePoint(),e=Math.floor(t.x/this._gridSize),i=Math.floor(t.y/this._gridSize);return this._colors[20*i+e]}},{key:"drawBlock",value:function(t){var e=this._colorBlock.graphics;e.clear(!0);var i=t||"#ffffff";e.drawRect(0,0,50,20,i,this._borderColor),t||e.drawLine(0,0,50,20,"#ff0000")}},{key:"selectedColor",get:function(){return this._selectedColor},set:function(t){this._selectedColor!=t&&(this._selectedColor=this._colorInput.text=t,this.drawBlock(t),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event(x.Event.CHANGE,x.Event.EMPTY.setTo(x.Event.CHANGE,this,this)))}},{key:"skin",get:function(){return this._colorButton.skin},set:function(t){this._colorButton.once(x.Event.LOADED,this,this.changeColor),this._colorButton.skin=t}},{key:"changeColor",value:function(){var t=this.graphics;t.clear(!0);var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)}},{key:"bgColor",get:function(){return this._bgColor},set:function(t){this._bgColor=t,this._setPanelChanged()}},{key:"borderColor",get:function(){return this._borderColor},set:function(t){this._borderColor=t,this._setPanelChanged()}},{key:"inputColor",get:function(){return this._inputColor},set:function(t){this._inputColor=t,this._setPanelChanged()}},{key:"inputBgColor",get:function(){return this._inputBgColor},set:function(t){this._inputBgColor=t,this._setPanelChanged()}},{key:"_setPanelChanged",value:function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))}}]),r}(_.UIComponent);e.ColorPicker=S,k.ILaya.regClass(S),C.ClassUtils.regClass("laya.ui.ColorPicker",S),C.ClassUtils.regClass("Laya.ColorPicker",S)},56059:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ComboBox=void 0;var s=r(i(81643)),l=r(i(94198)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(52605)),d=r(i(92135)),f=r(i(13383)),_=r(i(78310)),v=r(i(82669)),y=r(i(17454)),p=i(60414),g=i(65869),m=i(49501),x=i(51630),T=i(44451),k=i(63969),C=i(91020),S=i(35696),E=i(93561),M=i(89432);var L=function(t){(0,f.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,_.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,o.default)(this,r),t=n.call(this),(0,y.default)((0,h.default)(t),"_visibleNum",6),(0,y.default)((0,h.default)(t),"_itemColors",x.Styles.comboBoxItemColors),(0,y.default)((0,h.default)(t),"_itemSize",12),(0,y.default)((0,h.default)(t),"_labels",[]),(0,y.default)((0,h.default)(t),"_selectedIndex",-1),(0,y.default)((0,h.default)(t),"itemRender",null),t.skin=e,t.labels=i,t}return(0,u.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];E.ILaya.stage.off(k.Event.MOUSE_DOWN,this,this.removeList),E.ILaya.stage.off(k.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),(0,d.default)((0,v.default)(r.prototype),"destroy",this).call(this,t),this._button&&this._button.destroy(t),this._list&&this._list.destroy(t),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null}},{key:"createChildren",value:function(){this.addChild(this._button=new g.Button),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on(k.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"_createList",value:function(){this._list=new m.List,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)}},{key:"_setListEvent",value:function(t){this._list.selectEnable=!0,this._list.on(k.Event.MOUSE_DOWN,this,this.onListDown),this._list.mouseHandler=S.Handler.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on(k.Event.MOUSE_DOWN,this,this.onScrollBarDown)}},{key:"onListDown",value:function(t){t.stopPropagation()}},{key:"onScrollBarDown",value:function(t){t.stopPropagation()}},{key:"onButtonMouseDown",value:function(t){this.callLater(this.switchTo,[!this._isOpen])}},{key:"skin",get:function(){return this._button.skin},set:function(t){this._button.skin!=t&&(this._button.skin=t,this._listChanged=!0)}},{key:"measureWidth",value:function(){return this._button.width}},{key:"measureHeight",value:function(){return this._button.height}},{key:"changeList",value:function(){this._listChanged=!1;var t=this.width-2,e=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}}]},this._list.repeatY=this._visibleNum,this._list.refresh()}},{key:"onlistItemMouse",value:function(t,e){var i=t.type;if(i===k.Event.MOUSE_OVER||i===k.Event.MOUSE_OUT){if(this._isCustomList)return;var a=this._list.getCell(e);if(!a)return;var n=a.getChildByName("label");n&&(i===k.Event.ROLL_OVER?(n.bgColor=this._itemColors[0],n.color=this._itemColors[1]):(n.bgColor=null,n.color=this._itemColors[2]))}else i===k.Event.CLICK&&(this.selectedIndex=e,this.isOpen=!1)}},{key:"switchTo",value:function(t){this.isOpen=t}},{key:"changeOpen",value:function(){this.isOpen=!this._isOpen}},{key:"width",get:function(){return(0,d.default)((0,v.default)(r.prototype),"width",this)},set:function(t){(0,c.default)((0,v.default)(r.prototype),"width",t,this,!0),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}},{key:"height",get:function(){return(0,d.default)((0,v.default)(r.prototype),"height",this)},set:function(t){(0,c.default)((0,v.default)(r.prototype),"height",t,this,!0),this._button.height=this._height}},{key:"labels",get:function(){return this._labels.join(",")},set:function(t){this._labels.length>0&&(this.selectedIndex=-1),t?this._labels=t.split(","):this._labels.length=0,this._itemChanged=!0}},{key:"changeItem",value:function(){if(this._itemChanged=!1,this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var t=this._list.graphics;t.clear(!0),t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var e=this._list.array||[];e.length=0;for(var i=0,a=this._labels.length;i<a;i++)e.push({label:this._labels[i]});this._list.height=this._listHeight,this._list.array=e}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._labels.length>0?this.changeSelected():this.callLater(this.changeSelected),this.event(k.Event.CHANGE,[k.Event.EMPTY.setTo(k.Event.CHANGE,this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}},{key:"changeSelected",value:function(){this._button.label=this.selectedLabel}},{key:"selectHandler",get:function(){return this._selectHandler},set:function(t){this._selectHandler=t}},{key:"selectedLabel",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,s.default)(e=this._labels).call(e,t)}},{key:"visibleNum",get:function(){return this._visibleNum},set:function(t){this._visibleNum=t,this._listChanged=!0}},{key:"itemColors",get:function(){return String(this._itemColors)},set:function(t){this._itemColors=T.UIUtils.fillArray(this._itemColors,t,String),this._listChanged=!0}},{key:"itemSize",get:function(){return this._itemSize},set:function(t){this._itemSize=t,this._listChanged=!0}},{key:"isOpen",get:function(){return this._isOpen},set:function(t){if(this._isOpen!=t)if(this._isOpen=t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var e=this.localToGlobal(C.Point.TEMP.setTo(0,0)),i=e.y+this._button.height;i=i+this._listHeight<=E.ILaya.stage.height?i:e.y-this._listHeight,this._list.pos(e.x,i),this._list.zOrder=1001,E.ILaya.stage.addChild(this._list),E.ILaya.stage.once(k.Event.MOUSE_DOWN,this,this.removeList),E.ILaya.stage.on(k.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}},{key:"_onStageMouseWheel",value:function(t){this._list&&!this._list.contains(t.target)&&this.removeList(null)}},{key:"removeList",value:function(t){E.ILaya.stage.off(k.Event.MOUSE_DOWN,this,this.removeList),E.ILaya.stage.off(k.Event.MOUSE_WHEEL,this,this._onStageMouseWheel),this.isOpen=!1}},{key:"scrollBarSkin",get:function(){return this._scrollBarSkin},set:function(t){this._scrollBarSkin=t}},{key:"sizeGrid",get:function(){return this._button.sizeGrid},set:function(t){this._button.sizeGrid=t}},{key:"scrollBar",get:function(){return this.list.scrollBar}},{key:"button",get:function(){return this._button}},{key:"list",get:function(){return this._list||this._createList(),this._list},set:function(t){t&&(t.removeSelf(),this._isCustomList=!0,this._list=t,this._setListEvent(t),this._itemHeight=t.getCell(0).height+t.spaceY)}},{key:"dataSource",get:function(){return(0,d.default)((0,v.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,l.default)(t):t instanceof Array?this.labels=t.join(","):(0,c.default)((0,v.default)(r.prototype),"dataSource",t,this,!0)}},{key:"labelColors",get:function(){return this._button.labelColors},set:function(t){this._button.labelColors!=t&&(this._button.labelColors=t)}},{key:"labelPadding",get:function(){return this._button.text.padding.join(",")},set:function(t){this._button.text.padding=T.UIUtils.fillArray(x.Styles.labelPadding,t,Number)}},{key:"labelSize",get:function(){return this._button.text.fontSize},set:function(t){this._button.text.fontSize=t}},{key:"labelBold",get:function(){return this._button.text.bold},set:function(t){this._button.text.bold=t}},{key:"labelFont",get:function(){return this._button.text.font},set:function(t){this._button.text.font=t}},{key:"stateNum",get:function(){return this._button.stateNum},set:function(t){this._button.stateNum=t}}]),r}(p.UIComponent);e.ComboBox=L,E.ILaya.regClass(L),M.ClassUtils.regClass("laya.ui.ComboBox",L),M.ClassUtils.regClass("Laya.ComboBox",L)},20738:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Dialog=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(52605)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(76486),y=i(1026),p=i(44451),g=i(63969),m=i(63701),x=i(60918),T=i(93561),k=i(89432);var C=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,_.default)((0,o.default)(t),"isShowEffect",!0),(0,_.default)((0,o.default)(t),"isPopupCenter",!0),t.popupEffect=r.manager.popupEffectHandler,t.closeEffect=r.manager.closeEffectHandler,t._dealDragArea(),t.on(g.Event.CLICK,(0,o.default)(t),t._onClick),t}return(0,l.default)(r,[{key:"_dealDragArea",value:function(){var t=this.getChildByName("drag");t&&(this.dragArea=t._x+","+t._y+","+t.width+","+t.height,t.removeSelf())}},{key:"dragArea",get:function(){return this._dragArea?this._dragArea.toString():null},set:function(t){if(t){var e=p.UIUtils.fillArray([0,0,0,0],t,Number);this._dragArea=new m.Rectangle(e[0],e[1],e[2],e[3]),this.on(g.Event.MOUSE_DOWN,this,this._onMouseDown)}else this._dragArea=null,this.off(g.Event.MOUSE_DOWN,this,this._onMouseDown)}},{key:"_onMouseDown",value:function(t){var e=this.getMousePoint();this._dragArea.contains(e.x,e.y)?this.startDrag():this.stopDrag()}},{key:"_onClick",value:function(t){var e=t.target;if(e)switch(e.name){case r.CLOSE:case r.CANCEL:case r.SURE:case r.NO:case r.OK:case r.YES:return void this.close(e.name)}}},{key:"open",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._dealDragArea(),this._param=e,r.manager.open(this,t,this.isShowEffect),r.manager.lock(!1)}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.closeType=t,r.manager.close(this)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this._dragArea=null,(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t)}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._open(!1,t,e)}},{key:"popup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._open(!0,t,e)}},{key:"_open",value:function(t,e,i){this.isModal=t,this.isShowEffect=i,r.manager.lock(!0),this.open(e)}},{key:"isPopup",get:function(){return null!=this.parent}},{key:"zOrder",get:function(){return(0,h.default)((0,f.default)(r.prototype),"zOrder",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"zOrder",t,this,!0),r.manager._checkMask()}}],[{key:"manager",get:function(){return r._manager=r._manager||new y.DialogManager},set:function(t){r._manager=t}},{key:"setLockView",value:function(t){r.manager.setLockView(t)}},{key:"lock",value:function(t){r.manager.lock(t)}},{key:"closeAll",value:function(){r.manager.closeAll()}},{key:"getDialogsByGroup",value:function(t){return r.manager.getDialogsByGroup(t)}},{key:"closeByGroup",value:function(t){return r.manager.closeByGroup(t)}}]),r}(v.View);e.Dialog=C,(0,_.default)(C,"CLOSE","close"),(0,_.default)(C,"CANCEL","cancel"),(0,_.default)(C,"SURE","sure"),(0,_.default)(C,"NO","no"),(0,_.default)(C,"YES","yes"),(0,_.default)(C,"OK","ok"),x.IUI.Dialog=C,T.ILaya.regClass(C),k.ClassUtils.regClass("laya.ui.Dialog",C),k.ClassUtils.regClass("Laya.Dialog",C)},1026:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.DialogManager=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(89280),_=i(46222),v=i(87210),y=i(63969),p=i(65810),g=i(96060),m=i(35696),x=i(42461),T=i(60918),k=i(89432),C=i(93561);var S=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,d.default)((0,o.default)(t),"maskLayer",new v.Sprite),(0,d.default)((0,o.default)(t),"popupEffect",(function(e){e.scale(1,1),e._effectTween=x.Tween.from(e,{x:C.ILaya.stage.width/2,y:C.ILaya.stage.height/2,scaleX:0,scaleY:0},300,g.Ease.backOut,m.Handler.create((0,o.default)(t),t.doOpen,[e]),0,!1,!1)})),(0,d.default)((0,o.default)(t),"closeEffect",(function(e){e._effectTween=x.Tween.to(e,{x:C.ILaya.stage.width/2,y:C.ILaya.stage.height/2,scaleX:0,scaleY:0},300,g.Ease.strongOut,m.Handler.create((0,o.default)(t),t.doClose,[e]),0,!1,!1)})),(0,d.default)((0,o.default)(t),"popupEffectHandler",new m.Handler((0,o.default)(t),t.popupEffect)),(0,d.default)((0,o.default)(t),"closeEffectHandler",new m.Handler((0,o.default)(t),t.closeEffect)),t.mouseEnabled=t.maskLayer.mouseEnabled=!0,t.zOrder=1e3,C.ILaya.stage.addChild((0,o.default)(t)),C.ILaya.stage.on(y.Event.RESIZE,(0,o.default)(t),t._onResize),f.UIConfig.closeDialogOnSide&&t.maskLayer.on("click",(0,o.default)(t),t._closeOnSide),t._onResize(null),t}return(0,l.default)(r,[{key:"_closeOnSide",value:function(){var t=this.getChildAt(this.numChildren-1);t instanceof T.IUI.Dialog&&t.close("side")}},{key:"setLockView",value:function(t){this.lockLayer||(this.lockLayer=new p.Box,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(C.ILaya.stage.width,C.ILaya.stage.height)),this.lockLayer.removeChildren(),t&&(t.centerX=t.centerY=0,this.lockLayer.addChild(t))}},{key:"_onResize",value:function(){var t=this.maskLayer.width=C.ILaya.stage.width,e=this.maskLayer.height=C.ILaya.stage.height;this.lockLayer&&this.lockLayer.size(t,e),this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,t,e,f.UIConfig.popupBgColor),this.maskLayer.alpha=f.UIConfig.popupBgAlpha;for(var i=this.numChildren-1;i>-1;i--){var a=this.getChildAt(i);a.isPopupCenter&&this._centerDialog(a)}}},{key:"_centerDialog",value:function(t){t.x=Math.round((C.ILaya.stage.width-t.width>>1)+t.pivotX),t.y=Math.round((C.ILaya.stage.height-t.height>>1)+t.pivotY)}},{key:"open",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&this._closeAll(),this._clearDialogEffect(t),t.isPopupCenter&&this._centerDialog(t),this.addChild(t),(t.isModal||this._getBit(_.Const.HAS_ZORDER))&&C.ILaya.timer.callLater(this,this._checkMask),i&&null!=t.popupEffect?t.popupEffect.runWith(t):this.doOpen(t),this.event(y.Event.OPEN)}},{key:"_clearDialogEffect",value:function(t){t._effectTween&&(x.Tween.clear(t._effectTween),t._effectTween=null)}},{key:"doOpen",value:function(t){t.onOpened(t._param)}},{key:"lock",value:function(t){this.lockLayer&&(t?this.addChild(this.lockLayer):this.lockLayer.removeSelf())}},{key:"close",value:function(t){this._clearDialogEffect(t),t.isShowEffect&&null!=t.closeEffect?t.closeEffect.runWith([t]):this.doClose(t),this.event(y.Event.CLOSE)}},{key:"doClose",value:function(t){t.removeSelf(),t.isModal&&this._checkMask(),t.closeHandler&&t.closeHandler.runWith(t.closeType),t.onClosed(t.closeType),t.autoDestroyAtClosed&&t.destroy()}},{key:"closeAll",value:function(){this._closeAll(),this.event(y.Event.CLOSE)}},{key:"_closeAll",value:function(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);e&&null!=e.close&&this.doClose(e)}}},{key:"getDialogsByGroup",value:function(t){for(var e=[],i=this.numChildren-1;i>-1;i--){var a=this.getChildAt(i);a&&a.group===t&&e.push(a)}return e}},{key:"closeByGroup",value:function(t){for(var e=[],i=this.numChildren-1;i>-1;i--){var a=this.getChildAt(i);a&&a.group===t&&(a.close(),e.push(a))}return e}},{key:"_checkMask",value:function(){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal)return void this.addChildAt(this.maskLayer,t)}}}]),r}(v.Sprite);e.DialogManager=S,k.ClassUtils.regClass("laya.ui.DialogManager",S),k.ClassUtils.regClass("Laya.DialogManager",S)},84127:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.FontClip=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(52605)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(63969),y=i(19492),p=i(60008),g=i(93561),m=i(89432);var x=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,s.default)(this,r),t=n.call(this),(0,_.default)((0,o.default)(t),"_valueArr",""),(0,_.default)((0,o.default)(t),"_indexMap",null),(0,_.default)((0,o.default)(t),"_sheet",null),(0,_.default)((0,o.default)(t),"_direction","horizontal"),(0,_.default)((0,o.default)(t),"_spaceX",0),(0,_.default)((0,o.default)(t),"_spaceY",0),(0,_.default)((0,o.default)(t),"_align","left"),(0,_.default)((0,o.default)(t),"_wordsW",0),(0,_.default)((0,o.default)(t),"_wordsH",0),e&&(t.skin=e),i&&(t.sheet=i),t}return(0,l.default)(r,[{key:"createChildren",value:function(){this._bitmap=new y.AutoBitmap,this.on(v.Event.LOADED,this,this._onClipLoaded)}},{key:"_onClipLoaded",value:function(){this.callLater(this.changeValue)}},{key:"sheet",get:function(){return this._sheet},set:function(t){t+="",this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length,this.clipY=e.length,this._indexMap={};for(var i=0;i<this._clipY;i++)for(var a=e[i].split(""),n=0,r=a.length;n<r;n++)this._indexMap[a[n]]=i*this._clipX+n}},{key:"value",get:function(){return this._valueArr?this._valueArr:""},set:function(t){t+="",this._valueArr=t,this.callLater(this.changeValue)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t,this.callLater(this.changeValue)}},{key:"spaceX",get:function(){return this._spaceX},set:function(t){this._spaceX=t,"horizontal"===this._direction&&this.callLater(this.changeValue)}},{key:"spaceY",get:function(){return this._spaceY},set:function(t){this._spaceY=t,"horizontal"!==this._direction&&this.callLater(this.changeValue)}},{key:"align",get:function(){return this._align},set:function(t){this._align=t,this.callLater(this.changeValue)}},{key:"changeValue",value:function(){var t;if(this._sources&&this._valueArr&&(this.graphics.clear(!0),t=this._sources[0])){var e="horizontal"===this._direction;e?(this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX),this._wordsH=t.sourceHeight):(this._wordsW=t.sourceWidth,this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length);var i=0;if(this._width)switch(this._align){case"center":i=.5*(this._width-this._wordsW);break;case"right":i=this._width-this._wordsW;break;default:i=0}for(var a=0,n=this._valueArr.length;a<n;a++){var r=this._indexMap[this._valueArr.charAt(a)];this.sources[r]&&(t=this.sources[r],e?this.graphics.drawImage(t,i+a*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight):this.graphics.drawImage(t,0+i,a*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight))}this._width||(this._widget.resetLayoutX(),this.callLater(this._sizeChanged)),this._height||(this._widget.resetLayoutY(),this.callLater(this._sizeChanged))}}},{key:"width",get:function(){return(0,u.default)((0,f.default)(r.prototype),"width",this)},set:function(t){(0,h.default)((0,f.default)(r.prototype),"width",t,this,!0),this.callLater(this.changeValue)}},{key:"height",get:function(){return(0,u.default)((0,f.default)(r.prototype),"height",this)},set:function(t){(0,h.default)((0,f.default)(r.prototype),"height",t,this,!0),this.callLater(this.changeValue)}},{key:"measureWidth",value:function(){return this._wordsW}},{key:"measureHeight",value:function(){return this._wordsH}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off(v.Event.LOADED,this,this._onClipLoaded),(0,u.default)((0,f.default)(r.prototype),"destroy",this).call(this,t)}}]),r}(p.Clip);e.FontClip=x,g.ILaya.regClass(x),m.ClassUtils.regClass("laya.ui.FontClip",x),m.ClassUtils.regClass("Laya.FontClip",x)},38252:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HBox=void 0;var s=r(i(47302)),l=r(i(87368)),o=r(i(28146)),u=r(i(92135)),h=r(i(52605)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(67068),y=i(93561),p=i(89432);var g=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){return(0,l.default)(this,r),n.apply(this,arguments)}return(0,o.default)(r,[{key:"sortItem",value:function(t){t&&(0,s.default)(t).call(t,(function(t,e){return t.x-e.x}))}},{key:"height",get:function(){return(0,u.default)((0,f.default)(r.prototype),"height",this)},set:function(t){this._height!=t&&((0,h.default)((0,f.default)(r.prototype),"height",t,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var t=[],e=0,i=0,a=this.numChildren;i<a;i++){var n=this.getChildAt(i);n&&(t.push(n),e=this._height?this._height:Math.max(e,n.height*n.scaleY))}this.sortItem(t);var s=0;for(i=0,a=t.length;i<a;i++)(n=t[i]).x=s,s+=n.width*n.scaleX+this._space,this._align==r.TOP?n.y=0:this._align==r.MIDDLE?n.y=.5*(e-n.height*n.scaleY):this._align==r.BOTTOM&&(n.y=e-n.height*n.scaleY);this._sizeChanged()}}]),r}(v.LayoutBox);e.HBox=g,(0,_.default)(g,"NONE","none"),(0,_.default)(g,"TOP","top"),(0,_.default)(g,"MIDDLE","middle"),(0,_.default)(g,"BOTTOM","bottom"),y.ILaya.regClass(g),p.ClassUtils.regClass("laya.ui.HBox",g),p.ClassUtils.regClass("Laya.HBox",g)},34461:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HScrollBar=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=i(31133),f=i(93561),_=i(89432);var v=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"initialize",value:function(){(0,o.default)((0,c.default)(r.prototype),"initialize",this).call(this),this.slider.isVertical=!1}}]),r}(d.ScrollBar);e.HScrollBar=v,f.ILaya.regClass(v),_.ClassUtils.regClass("laya.ui.HScrollBar",v),_.ClassUtils.regClass("Laya.HScrollBar",v)},26735:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.HSlider=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=i(46606),d=i(93561),f=i(89432);var _=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,l.default)(this,r),(t=n.call(this,e)).isVertical=!1,t}return(0,s.default)(r)}(c.Slider);e.HSlider=_,d.ILaya.regClass(_),f.ClassUtils.regClass("laya.ui.HSlider",_),f.ClassUtils.regClass("Laya.HSlider",_)},60918:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.IUI=void 0;var r=n(i(28146)),s=n(i(87368)),l=(0,r.default)((function t(){(0,s.default)(this,t)}));e.IUI=l},68209:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Image=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(52605)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=i(51630),_=i(63969),v=i(84581),y=i(19492),p=i(60414),g=i(44451),m=i(35696),x=i(93561),T=i(89432);var k=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,r),(t=n.call(this)).skin=e,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t),this._bitmap&&this._bitmap.destroy(),this._bitmap=null}},{key:"dispose",value:function(){this.destroy(!0),x.ILaya.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new y.AutoBitmap,this._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(t){if(this._skin!=t)if(this._skin=t,t){var e=v.Loader.getRes(t);e?(this.source=e,this.onCompResize()):x.ILaya.loader.load(this._skin,m.Handler.create(this,this.setSource,[this._skin]),null,v.Loader.IMAGE,1,!0,this._group)}else this.source=null}},{key:"source",get:function(){return this._bitmap.source},set:function(t){this._bitmap&&(this._bitmap.source=t,this.event(_.Event.LOADED),this.repaint())}},{key:"group",get:function(){return this._group},set:function(t){t&&this._skin&&v.Loader.setGroup(this._skin,t),this._group=t}},{key:"setSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t===this._skin&&e&&(this.source=e,this.onCompResize())}},{key:"measureWidth",value:function(){return this._bitmap.width}},{key:"measureHeight",value:function(){return this._bitmap.height}},{key:"width",get:function(){return(0,u.default)((0,d.default)(r.prototype),"width",this)},set:function(t){(0,o.default)((0,d.default)(r.prototype),"width",t,this,!0),this._bitmap.width=0==t?1e-7:t}},{key:"height",get:function(){return(0,u.default)((0,d.default)(r.prototype),"height",this)},set:function(t){(0,o.default)((0,d.default)(r.prototype),"height",t,this,!0),this._bitmap.height=0==t?1e-7:t}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(t){this._bitmap.sizeGrid=g.UIUtils.fillArray(f.Styles.defaultSizeGrid,t,Number)}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"string"==typeof t?this.skin=t:(0,o.default)((0,d.default)(r.prototype),"dataSource",t,this,!0)}}]),r}(p.UIComponent);e.Image=k,x.ILaya.regClass(k),T.ClassUtils.regClass("laya.ui.Image",k),T.ClassUtils.regClass("Laya.Image",k)},130:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Label=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(52605)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=i(51630),_=i(23699),v=i(63969),y=i(60414),p=i(44451),g=i(93561),m=i(89432);var x=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.default)(this,r),(t=n.call(this)).text=e,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t),this._tf=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new _.Text)}},{key:"text",get:function(){return this._tf.text},set:function(t){this._tf.text!=t&&(t&&(t=p.UIUtils.adptString(t+"")),this._tf.text=t,this.event(v.Event.CHANGE),this._width&&this._height||this.onCompResize())}},{key:"changeText",value:function(t){this._tf.changeText(t)}},{key:"wordWrap",get:function(){return this._tf.wordWrap},set:function(t){this._tf.wordWrap=t}},{key:"color",get:function(){return this._tf.color},set:function(t){this._tf.color=t}},{key:"font",get:function(){return this._tf.font},set:function(t){this._tf.font=t}},{key:"align",get:function(){return this._tf.align},set:function(t){this._tf.align=t}},{key:"valign",get:function(){return this._tf.valign},set:function(t){this._tf.valign=t}},{key:"bold",get:function(){return this._tf.bold},set:function(t){this._tf.bold=t}},{key:"italic",get:function(){return this._tf.italic},set:function(t){this._tf.italic=t}},{key:"leading",get:function(){return this._tf.leading},set:function(t){this._tf.leading=t}},{key:"fontSize",get:function(){return this._tf.fontSize},set:function(t){this._tf.fontSize=t}},{key:"padding",get:function(){return this._tf.padding.join(",")},set:function(t){this._tf.padding=p.UIUtils.fillArray(f.Styles.labelPadding,t,Number)}},{key:"bgColor",get:function(){return this._tf.bgColor},set:function(t){this._tf.bgColor=t}},{key:"borderColor",get:function(){return this._tf.borderColor},set:function(t){this._tf.borderColor=t}},{key:"stroke",get:function(){return this._tf.stroke},set:function(t){this._tf.stroke=t}},{key:"strokeColor",get:function(){return this._tf.strokeColor},set:function(t){this._tf.strokeColor=t}},{key:"textField",get:function(){return this._tf}},{key:"measureWidth",value:function(){return this._tf.width}},{key:"measureHeight",value:function(){return this._tf.height}},{key:"width",get:function(){return this._width||this._tf.text?(0,u.default)((0,d.default)(r.prototype),"width",this):0},set:function(t){(0,o.default)((0,d.default)(r.prototype),"width",t,this,!0),this._tf.width=t}},{key:"height",get:function(){return this._height||this._tf.text?(0,u.default)((0,d.default)(r.prototype),"height",this):0},set:function(t){(0,o.default)((0,d.default)(r.prototype),"height",t,this,!0),this._tf.height=t}},{key:"dataSource",get:function(){return(0,u.default)((0,d.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.text=t+"":(0,o.default)((0,d.default)(r.prototype),"dataSource",t,this,!0)}},{key:"overflow",get:function(){return this._tf.overflow},set:function(t){this._tf.overflow=t}},{key:"underline",get:function(){return this._tf.underline},set:function(t){this._tf.underline=t}},{key:"underlineColor",get:function(){return this._tf.underlineColor},set:function(t){this._tf.underlineColor=t}}]),r}(y.UIComponent);e.Label=x,g.ILaya.regClass(x),m.ClassUtils.regClass("laya.ui.Label",x),m.ClassUtils.regClass("Laya.Label",x)},67068:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.LayoutBox=void 0;var s=r(i(77766)),l=r(i(47302)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(92135)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=r(i(17454)),y=i(65810),p=i(63969),g=i(93561),m=i(89432);var x=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t,e;(0,o.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,v.default)((0,h.default)(e),"_space",0),(0,v.default)((0,h.default)(e),"_align","none"),(0,v.default)((0,h.default)(e),"_itemChanged",!1),e}return(0,u.default)(r,[{key:"addChild",value:function(t){return t.on(p.Event.RESIZE,this,this.onResize),this._setItemChanged(),(0,c.default)((0,_.default)(r.prototype),"addChild",this).call(this,t)}},{key:"onResize",value:function(t){this._setItemChanged()}},{key:"addChildAt",value:function(t,e){return t.on(p.Event.RESIZE,this,this.onResize),this._setItemChanged(),(0,c.default)((0,_.default)(r.prototype),"addChildAt",this).call(this,t,e)}},{key:"removeChildAt",value:function(t){return this.getChildAt(t).off(p.Event.RESIZE,this,this.onResize),this._setItemChanged(),(0,c.default)((0,_.default)(r.prototype),"removeChildAt",this).call(this,t)}},{key:"refresh",value:function(){this._setItemChanged()}},{key:"changeItems",value:function(){this._itemChanged=!1}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._setItemChanged()}},{key:"align",get:function(){return this._align},set:function(t){this._align=t,this._setItemChanged()}},{key:"sortItem",value:function(t){t&&(0,l.default)(t).call(t,(function(t,e){return t.y-e.y}))}},{key:"_setItemChanged",value:function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))}}]),r}(y.Box);e.LayoutBox=x,g.ILaya.regClass(x),m.ClassUtils.regClass("laya.ui.LayoutBox",x),m.ClassUtils.regClass("Laya.LayoutBox",x)},49501:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.List=void 0;var s=r(i(77766)),l=r(i(81643)),o=r(i(94198)),u=r(i(92762)),h=r(i(87368)),c=r(i(28146)),d=r(i(43714)),f=r(i(52605)),_=r(i(92135)),v=r(i(13383)),y=r(i(78310)),p=r(i(82669)),g=r(i(17454)),m=i(65810),x=i(12495),T=i(34461),k=i(44451),C=i(63969),S=i(91020),E=i(63701),M=i(45651),L=i(42461),b=i(93561),I=i(89432);var R=function(t){(0,v.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,p.default)(e);if(i){var r=(0,p.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,y.default)(this,t)});function r(){var t,e;(0,h.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,g.default)((0,d.default)(e),"selectEnable",!1),(0,g.default)((0,d.default)(e),"totalPage",0),(0,g.default)((0,d.default)(e),"_$componentType","List"),(0,g.default)((0,d.default)(e),"_repeatX",0),(0,g.default)((0,d.default)(e),"_repeatY",0),(0,g.default)((0,d.default)(e),"_repeatX2",0),(0,g.default)((0,d.default)(e),"_repeatY2",0),(0,g.default)((0,d.default)(e),"_spaceX",0),(0,g.default)((0,d.default)(e),"_spaceY",0),(0,g.default)((0,d.default)(e),"_cells",[]),(0,g.default)((0,d.default)(e),"_startIndex",0),(0,g.default)((0,d.default)(e),"_selectedIndex",-1),(0,g.default)((0,d.default)(e),"_page",0),(0,g.default)((0,d.default)(e),"_isVertical",!0),(0,g.default)((0,d.default)(e),"_cellSize",20),(0,g.default)((0,d.default)(e),"_cellOffset",0),(0,g.default)((0,d.default)(e),"_createdLine",0),(0,g.default)((0,d.default)(e),"_offset",new S.Point),(0,g.default)((0,d.default)(e),"_usedCache",null),(0,g.default)((0,d.default)(e),"_elasticEnabled",!1),(0,g.default)((0,d.default)(e),"_preLen",0),e}return(0,c.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._content&&this._content.destroy(t),this._scrollBar&&this._scrollBar.destroy(t),(0,_.default)((0,p.default)(r.prototype),"destroy",this).call(this,t),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null}},{key:"createChildren",value:function(){this.addChild(this._content=new m.Box)}},{key:"cacheAs",get:function(){return(0,_.default)((0,p.default)(r.prototype),"cacheAs",this)},set:function(t){(0,f.default)((0,p.default)(r.prototype),"cacheAs",t,this,!0),this._scrollBar&&(this._usedCache=null,"none"!==t?this._scrollBar.on(C.Event.START,this,this.onScrollStart):this._scrollBar.off(C.Event.START,this,this.onScrollStart))}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=(0,_.default)((0,p.default)(r.prototype),"cacheAs",this)),(0,f.default)((0,p.default)(r.prototype),"cacheAs","none",this,!0),this._scrollBar.once(C.Event.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){(0,f.default)((0,p.default)(r.prototype),"cacheAs",this._usedCache||"none",this,!0)}},{key:"content",get:function(){return this._content}},{key:"vScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(t){this._removePreScrollBar();var e=new x.VScrollBar;e.name="scrollBar",e.right=0,e.skin=t,e.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=e,this.addChild(e),this._setCellChanged()}},{key:"_removePreScrollBar",value:function(){var t=this.removeChildByName("scrollBar");t&&t.destroy(!0)}},{key:"hScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(t){this._removePreScrollBar();var e=new T.HScrollBar;e.name="scrollBar",e.bottom=0,e.skin=t,e.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=e,this.addChild(e),this._setCellChanged()}},{key:"scrollBar",get:function(){return this._scrollBar},set:function(t){this._scrollBar!=t&&(this._scrollBar=t,t&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on(C.Event.CHANGE,this,this.onScrollBarChange)))}},{key:"itemRender",get:function(){return this._itemRender},set:function(t){if(this._itemRender!=t){this._itemRender=t;for(var e=this._cells.length-1;e>-1;e--)this._cells[e].destroy();this._cells.length=0,this._setCellChanged()}}},{key:"width",get:function(){return(0,_.default)((0,p.default)(r.prototype),"width",this)},set:function(t){t!=this._width&&((0,f.default)((0,p.default)(r.prototype),"width",t,this,!0),this._setCellChanged())}},{key:"height",get:function(){return(0,_.default)((0,p.default)(r.prototype),"height",this)},set:function(t){t!=this._height&&((0,f.default)((0,p.default)(r.prototype),"height",t,this,!0),this._setCellChanged())}},{key:"repeatX",get:function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},set:function(t){this._repeatX=t,this._setCellChanged()}},{key:"repeatY",get:function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},set:function(t){this._repeatY=t,this._setCellChanged()}},{key:"spaceX",get:function(){return this._spaceX},set:function(t){this._spaceX=t,this._setCellChanged()}},{key:"spaceY",get:function(){return this._spaceY},set:function(t){this._spaceY=t,this._setCellChanged()}},{key:"changeCells",value:function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var t=this._getOneCell(),e=t.width+this._spaceX||1,i=t.height+this._spaceY||1;this._width>0&&(this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e)),this._height>0&&(this._repeatY2=this._isVertical?Math.ceil(this._height/i):Math.round(this._height/i));var a=this._width?this._width:e*this.repeatX-this._spaceX,n=this._height?this._height:i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?i:e,this._cellOffset=this._isVertical?i*Math.max(this._repeatY2,this._repeatY)-n-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-a-this._spaceX,this._isVertical&&this.vScrollBarSkin?this._scrollBar.height=n:!this._isVertical&&this.hScrollBarSkin&&(this._scrollBar.width=a),this.setContentSize(a,n);var r=this._isVertical?this.repeatX:this.repeatY,s=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,r,s),this._createdLine=s,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}}},{key:"_getOneCell",value:function(){if(0===this._cells.length){var t=this.createItem();if(this._offset.setTo(t._x,t._y),this.cacheContent)return t;this._cells.push(t)}return this._cells[0]}},{key:"_createItems",value:function(t,e,i){var a=this._content,n=this._getOneCell(),r=n.width+this._spaceX,s=n.height+this._spaceY;if(this.cacheContent){var l=new m.Box;l.cacheAs="normal",l.pos((this._isVertical?0:t)*r,(this._isVertical?t:0)*s),this._content.addChild(l),a=l}else{for(var o=[],u=this._cells.length-1;u>-1;u--){var h=this._cells[u];h.removeSelf(),o.push(h)}this._cells.length=0}for(var c=t;c<i;c++)for(var d=0;d<e;d++)(n=o&&o.length?o.pop():this.createItem()).x=(this._isVertical?d:c)*r-a._x,n.y=(this._isVertical?c:d)*s-a._y,n.name="item"+(c*e+d),a.addChild(n),this.addCell(n)}},{key:"createItem",value:function(){var t=[];if("function"==typeof this._itemRender)var e=new this._itemRender;else e=M.SceneUtils.createComp(this._itemRender,null,null,t);if(0==t.length&&e._watchMap){var i=e._watchMap;for(var a in i)for(var n=i[a],r=0;r<n.length;r++){var s=n[r];t.push(s.comp,s.prop,s.value)}}return t.length&&(e._$bindData=t),e}},{key:"addCell",value:function(t){t.on(C.Event.CLICK,this,this.onCellMouse),t.on(C.Event.RIGHT_CLICK,this,this.onCellMouse),t.on(C.Event.MOUSE_OVER,this,this.onCellMouse),t.on(C.Event.MOUSE_OUT,this,this.onCellMouse),t.on(C.Event.MOUSE_DOWN,this,this.onCellMouse),t.on(C.Event.MOUSE_UP,this,this.onCellMouse),this._cells.push(t)}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){if(!this._itemRender&&null!=this.getChildByName("item0")){var t;this.repeatX=1,t=0;for(var e=0;e<1e4;e++){var i=this.getChildByName("item"+e);if(!i)break;this.addCell(i),t++}this.repeatY=t}}},{key:"setContentSize",value:function(t,e){this._content.width=t,this._content.height=e,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content._style.scrollRect||(this._content.scrollRect=E.Rectangle.create()),this._content._style.scrollRect.setTo(-this._offset.x,-this._offset.y,t,e),this._content.scrollRect=this._content.scrollRect),this.event(C.Event.RESIZE)}},{key:"onCellMouse",value:function(t){var e;t.type===C.Event.MOUSE_DOWN&&(this._isMoved=!1);var i=t.currentTarget,a=this._startIndex+(0,l.default)(e=this._cells).call(e,i);a<0||(t.type===C.Event.CLICK||t.type===C.Event.RIGHT_CLICK?this.selectEnable&&!this._isMoved?this.selectedIndex=a:this.changeCellState(i,!0,0):t.type!==C.Event.MOUSE_OVER&&t.type!==C.Event.MOUSE_OUT||this._selectedIndex===a||this.changeCellState(i,t.type===C.Event.MOUSE_OVER,0),this.mouseHandler&&this.mouseHandler.runWith([t,a]))}},{key:"changeCellState",value:function(t,e,i){var a=t.getChildByName("selectBox");a&&(this.selectEnable=!0,a.visible=e,a.index=i)}},{key:"_sizeChanged",value:function(){(0,_.default)((0,p.default)(r.prototype),"_sizeChanged",this).call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)}},{key:"onScrollBarChange",value:function(){this.runCallLater(this.changeCells);var t=this._scrollBar.value,e=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,a=Math.floor(t/this._cellSize);if(this.cacheContent)r=i+1,this._createdLine-a<r&&(this._createItems(this._createdLine,e,this._createdLine+r),this.renderItems(this._createdLine*e,0),this._createdLine+=r);else{var n=a*e,r=0,s=!0,l=0;n>this._startIndex?(r=n-this._startIndex,l=this._startIndex+e*(i+1),this._isMoved=!0):n<this._startIndex&&(r=this._startIndex-n,s=!1,l=this._startIndex-1,this._isMoved=!0);for(var o=0;o<r;o++){if(s){var u=this._cells.shift();this._cells[this._cells.length]=u;var h=l+o}else u=this._cells.pop(),this._cells.unshift(u),h=l-o;var c=Math.floor(h/e)*this._cellSize;this._isVertical?u.y=c:u.x=c,this.renderItem(u,h)}this._startIndex=n,this.changeSelectStatus()}var d=this._content._style.scrollRect;this._isVertical?(d.y=t-this._offset.y,d.x=-this._offset.x):(d.y=-this._offset.y,d.x=t-this._offset.x),this._content.scrollRect=d}},{key:"posCell",value:function(t,e){if(this._scrollBar){var i=this._isVertical?this.repeatX:this.repeatY,a=Math.floor(e/i)*this._cellSize;this._isVertical?t._y=a:t.x=a}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this.changeSelectStatus(),this.event(C.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(t),this.startIndex=this._startIndex)}},{key:"changeSelectStatus",value:function(){for(var t=0,e=this._cells.length;t<e;t++)this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)}},{key:"selectedItem",get:function(){return this._array&&-1!=this._selectedIndex?this._array[this._selectedIndex]:null},set:function(t){var e;this._array&&(this.selectedIndex=(0,l.default)(e=this._array).call(e,t))}},{key:"selection",get:function(){return this.getCell(this._selectedIndex)},set:function(t){var e;this.selectedIndex=this._startIndex+(0,l.default)(e=this._cells).call(e,t)}},{key:"startIndex",get:function(){return this._startIndex},set:function(t){this._startIndex=t>0?t:0,this.callLater(this.renderItems)}},{key:"renderItems",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t,a=e||this._cells.length;i<a;i++)this.renderItem(this._cells[i],this._startIndex+i);this.changeSelectStatus()}},{key:"renderItem",value:function(t,e){this._array&&e>=0&&e<this._array.length?(t.visible=!0,t._$bindData?(t._dataSource=this._array[e],this._bindData(t,this._array[e])):t.dataSource=this._array[e],this.cacheContent||this.posCell(t,e),this.hasListener(C.Event.RENDER)&&this.event(C.Event.RENDER,[t,e]),this.renderHandler&&this.renderHandler.runWith([t,e])):(t.visible=!1,t.dataSource=null)}},{key:"_bindData",value:function(t,e){for(var i=t._$bindData,a=0,n=i.length;a<n;a++){var r=i[a++],s=i[a++],l=i[a],o=k.UIUtils.getBindFun(l);r[s]=o.call(this,e)}}},{key:"array",get:function(){return this._array},set:function(t){this.runCallLater(this.changeCells),this._array=t||[],this._preLen=this._array.length;var e=this._array.length;if(this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY,a=this._isVertical?this.repeatY:this.repeatX,n=Math.ceil(e/i);(this._cellOffset>0?this.totalPage+1:this.totalPage)>1&&n>=a?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=a/n,this._scrollBar.setScroll(0,(n-a)*this._cellSize+this._cellOffset,this._scrollBar.value),this._scrollBar.target=this._content):(this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}}},{key:"updateArray",value:function(t){if(this._array=t,this._array){var e=this._preLen-this._startIndex;e>=0&&this.renderItems(e),this._preLen=this._array.length}if(this._scrollBar){var i=t.length,a=this._isVertical?this.repeatX:this.repeatY,n=this._isVertical?this.repeatY:this.repeatX,r=Math.ceil(i/a);r>=n&&(this._scrollBar.thumbPercent=n/r,this._scrollBar.slider._max=(r-n)*this._cellSize+this._cellOffset)}}},{key:"page",get:function(){return this._page},set:function(t){this._page=t,this._array&&(this._page=t>0?t:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}},{key:"length",get:function(){return this._array?this._array.length:0}},{key:"dataSource",get:function(){return(0,_.default)((0,p.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,o.default)(t):t instanceof Array?this.array=t:(0,f.default)((0,p.default)(r.prototype),"dataSource",t,this,!0)}},{key:"cells",get:function(){return this.runCallLater(this.changeCells),this._cells}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(t){this._elasticEnabled=t,this._scrollBar&&(this._scrollBar.elasticDistance=t?200:0)}},{key:"refresh",value:function(){this.array=this._array}},{key:"getItem",value:function(t){return this._array&&t>-1&&t<this._array.length?this._array[t]:null}},{key:"changeItem",value:function(t,e){t>-1&&this._array&&t<this._array.length&&(this._array[t]=e,t>=this._startIndex&&t<this._startIndex+this._cells.length&&this.renderItem(this.getCell(t),t))}},{key:"setItem",value:function(t,e){this.changeItem(t,e)}},{key:"addItem",value:function(t){this.array?this._array.push(t):this.array=[t],this.array=this._array}},{key:"addItemAt",value:function(t,e){var i;(0,u.default)(i=this._array).call(i,e,0,t),this.array=this._array}},{key:"deleteItem",value:function(t){var e;this._array&&((0,u.default)(e=this._array).call(e,t,1),this.array=this._array)}},{key:"getCell",value:function(t){return this.runCallLater(this.changeCells),t>-1&&this._cells?this._cells[(t-this._startIndex)%this._cells.length]:null}},{key:"scrollTo",value:function(t){if(this._scrollBar){var e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else this.startIndex=t}},{key:"tweenTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._scrollBar){this._scrollBar.stopScroll();var a=this._isVertical?this.repeatX:this.repeatY;L.Tween.to(this._scrollBar,{value:Math.floor(t/a)*this._cellSize},e,null,i,0,!0)}else this.startIndex=t,i&&i.run()}},{key:"_setCellChanged",value:function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeCells)}}]),r}(m.Box);e.List=R,b.ILaya.regClass(R),I.ClassUtils.regClass("laya.ui.List",R),I.ClassUtils.regClass("Laya.List",R)},2795:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Panel=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(52605)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(65810),y=i(12495),p=i(34461),g=i(63969),m=i(63701),x=i(93561),T=i(89432);var k=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,_.default)((0,o.default)(t),"_usedCache",null),(0,_.default)((0,o.default)(t),"_elasticEnabled",!1),t.width=t.height=100,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this._content&&this._content.destroy(t),this._vScrollBar&&this._vScrollBar.destroy(t),this._hScrollBar&&this._hScrollBar.destroy(t),this._vScrollBar=null,this._hScrollBar=null,this._content=null}},{key:"destroyChildren",value:function(){this._content.destroyChildren()}},{key:"createChildren",value:function(){(0,h.default)((0,f.default)(r.prototype),"addChild",this).call(this,this._content=new v.Box)}},{key:"addChild",value:function(t){return t.on(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChild(t)}},{key:"onResize",value:function(){this._setScrollChanged()}},{key:"addChildAt",value:function(t,e){return t.on(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChildAt(t,e)}},{key:"removeChild",value:function(t){return t.off(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChild(t)}},{key:"removeChildAt",value:function(t){return this.getChildAt(t).off(g.Event.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(t)}},{key:"removeChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2147483647;return this._content.removeChildren(t,e),this._setScrollChanged(),this}},{key:"getChildAt",value:function(t){return this._content.getChildAt(t)}},{key:"getChildByName",value:function(t){return this._content.getChildByName(t)}},{key:"getChildIndex",value:function(t){return this._content.getChildIndex(t)}},{key:"numChildren",get:function(){return this._content.numChildren}},{key:"changeScroll",value:function(){this._scrollChanged=!1;var t=this.contentWidth||1,e=this.contentHeight||1,i=this._vScrollBar,a=this._hScrollBar,n=i&&e>this._height,r=a&&t>this._width,s=n?this._width-i.width:this._width,l=r?this._height-a.height:this._height;i&&(i.x=this._width-i.width,i.y=0,i.height=this._height-(r?a.height:0),i.scrollSize=Math.max(.033*this._height,1),i.thumbPercent=l/e,i.setScroll(0,e-l,i.value)),a&&(a.x=0,a.y=this._height-a.height,a.width=this._width-(n?i.width:0),a.scrollSize=Math.max(.033*this._width,1),a.thumbPercent=s/t,a.setScroll(0,t-s,a.value))}},{key:"_sizeChanged",value:function(){(0,h.default)((0,f.default)(r.prototype),"_sizeChanged",this).call(this),this.setContentSize(this._width,this._height)}},{key:"contentWidth",get:function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i._x+i.width*i.scaleX-i.pivotX,t)}return t}},{key:"contentHeight",get:function(){for(var t=0,e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i._y+i.height*i.scaleY-i.pivotY,t)}return t}},{key:"setContentSize",value:function(t,e){var i=this._content;i.width=t,i.height=e,i._style.scrollRect||(i.scrollRect=m.Rectangle.create()),i._style.scrollRect.setTo(0,0,t,e),i.scrollRect=i.scrollRect}},{key:"width",get:function(){return(0,h.default)((0,f.default)(r.prototype),"width",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"width",t,this,!0),this._setScrollChanged()}},{key:"height",get:function(){return(0,h.default)((0,f.default)(r.prototype),"height",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"height",t,this,!0),this._setScrollChanged()}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(t){null==this._vScrollBar&&((0,h.default)((0,f.default)(r.prototype),"addChild",this).call(this,this._vScrollBar=new y.VScrollBar),this._vScrollBar.on(g.Event.CHANGE,this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._vScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._vScrollBar.skin=t}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(t){null==this._hScrollBar&&((0,h.default)((0,f.default)(r.prototype),"addChild",this).call(this,this._hScrollBar=new p.HScrollBar),this._hScrollBar.on(g.Event.CHANGE,this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._hScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._hScrollBar.skin=t}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"content",get:function(){return this._content}},{key:"onScrollBarChange",value:function(t){var e=this._content._style.scrollRect;if(e){var i=Math.round(t.value);t.isVertical?e.y=i:e.x=i,this._content.scrollRect=e}}},{key:"scrollTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.vScrollBar&&(this.vScrollBar.value=e),this.hScrollBar&&(this.hScrollBar.value=t)}},{key:"refresh",value:function(){this.changeScroll()}},{key:"cacheAs",get:function(){return(0,h.default)((0,f.default)(r.prototype),"cacheAs",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"cacheAs",t,this,!0),this._usedCache=null,"none"!==t?(this._hScrollBar&&this._hScrollBar.on(g.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on(g.Event.START,this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off(g.Event.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off(g.Event.START,this,this.onScrollStart))}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(t){this._elasticEnabled=t,this._vScrollBar&&(this._vScrollBar.elasticDistance=t?200:0),this._hScrollBar&&(this._hScrollBar.elasticDistance=t?200:0)}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=(0,h.default)((0,f.default)(r.prototype),"cacheAs",this)),(0,u.default)((0,f.default)(r.prototype),"cacheAs","none",this,!0),this._hScrollBar&&this._hScrollBar.once(g.Event.END,this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once(g.Event.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){(0,u.default)((0,f.default)(r.prototype),"cacheAs",this._usedCache,this,!0)}},{key:"_setScrollChanged",value:function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))}}]),r}(v.Box);e.Panel=k,x.ILaya.regClass(k),T.ClassUtils.regClass("laya.ui.Panel",k),T.ClassUtils.regClass("Laya.Panel",k)},73175:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ProgressBar=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(52605)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(63969),y=i(84581),p=i(60414),g=i(68209),m=i(35696),x=i(93561),T=i(89432);var k=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,r),t=n.call(this),(0,_.default)((0,o.default)(t),"_value",.5),t.skin=e,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._bg=this._bar=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new g.Image),this.addChild(this._bar=new g.Image),this._bar._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!y.Loader.getRes(this._skin)?x.ILaya.loader.load(this._skin,m.Handler.create(this,this._skinLoaded),null,y.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.destroyed||(this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue),this._sizeChanged(),this.event(v.Event.LOADED))}},{key:"measureWidth",value:function(){return this._bg.width}},{key:"measureHeight",value:function(){return this._bg.height}},{key:"value",get:function(){return this._value},set:function(t){this._value!=t&&(t=t>1?1:t<0?0:t,this._value=t,this.callLater(this.changeValue),this.event(v.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(t))}},{key:"changeValue",value:function(){if(this.sizeGrid){var t=this.sizeGrid.split(","),e=Number(t[3]),i=Number(t[1]),a=(this.width-e-i)*this._value;this._bar.width=e+i+a,this._bar.visible=this._bar.width>e+i}else this._bar.width=this.width*this._value}},{key:"bar",get:function(){return this._bar}},{key:"bg",get:function(){return this._bg}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(t){this._bg.sizeGrid=this._bar.sizeGrid=t}},{key:"width",get:function(){return(0,h.default)((0,f.default)(r.prototype),"width",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"width",t,this,!0),this._bg.width=this._width,this.callLater(this.changeValue)}},{key:"height",get:function(){return(0,h.default)((0,f.default)(r.prototype),"height",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"height",t,this,!0),this._bg.height=this._height,this._bar.height=this._height}},{key:"dataSource",get:function(){return(0,h.default)((0,f.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):(0,u.default)((0,f.default)(r.prototype),"dataSource",t,this,!0)}}]),r}(p.UIComponent);e.ProgressBar=k,x.ILaya.regClass(k),T.ClassUtils.regClass("laya.ui.ProgressBar",k),T.ClassUtils.regClass("Laya.ProgressBar",k)},96567:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Radio=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=i(63969),f=i(65869),_=i(93561),v=i(89432);var y=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,s.default)(this,r),(t=n.call(this,e,i)).toggle=!1,t._autoSize=!1,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,o.default)((0,c.default)(r.prototype),"destroy",this).call(this,t),this._value=null}},{key:"preinitialize",value:function(){(0,o.default)((0,c.default)(r.prototype),"preinitialize",this).call(this),this.toggle=!1,this._autoSize=!1}},{key:"initialize",value:function(){(0,o.default)((0,c.default)(r.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on(d.Event.CLICK,this,this.onClick)}},{key:"onClick",value:function(t){this.selected=!0}},{key:"value",get:function(){return null!=this._value?this._value:this.label},set:function(t){this._value=t}}]),r}(f.Button);e.Radio=y,_.ILaya.regClass(y),v.ClassUtils.regClass("laya.ui.Radio",y),v.ClassUtils.regClass("Laya.Radio",y)},33175:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.RadioGroup=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=i(39019),d=i(96567),f=i(93561),_=i(89432);var v=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"createItem",value:function(t,e){return new d.Radio(t,e)}}]),r}(c.UIGroup);e.RadioGroup=v,f.ILaya.regClass(v),_.ClassUtils.regClass("laya.ui.RadioGroup",v),_.ClassUtils.regClass("Laya.RadioGroup",v)},85741:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ScaleBox=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(52605)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=r(i(17454)),y=i(65810),p=i(93561),g=i(89432);var m=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,v.default)((0,u.default)(e),"_oldW",0),(0,v.default)((0,u.default)(e),"_oldH",0),e}return(0,o.default)(r,[{key:"onEnable",value:function(){p.ILaya.stage.on("resize",this,this.onResize),this.onResize()}},{key:"onDisable",value:function(){p.ILaya.stage.off("resize",this,this.onResize)}},{key:"onResize",value:function(){var t=p.ILaya.stage;if(this.width>0&&this.height>0){var e=Math.min(t.width/this._oldW,t.height/this._oldH);(0,c.default)((0,_.default)(r.prototype),"width",t.width,this,!0),(0,c.default)((0,_.default)(r.prototype),"height",t.height,this,!0),this.scale(e,e)}}},{key:"width",get:function(){return(0,h.default)((0,_.default)(r.prototype),"width",this)},set:function(t){(0,c.default)((0,_.default)(r.prototype),"width",t,this,!0),this._oldW=t}},{key:"height",get:function(){return(0,h.default)((0,_.default)(r.prototype),"height",this)},set:function(t){(0,c.default)((0,_.default)(r.prototype),"height",t,this,!0),this._oldH=t}}]),r}(y.Box);e.ScaleBox=m,p.ILaya.regClass(m),g.ClassUtils.regClass("laya.ui.ScaleBox",m),g.ClassUtils.regClass("Laya.ScaleBox",m)},31133:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ScrollBar=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(52605)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(60414),y=i(65869),p=i(46606),g=i(89280),m=i(51630),x=i(63969),T=i(91020),k=i(84581),C=i(96060),S=i(35696),E=i(42461),M=i(93561),L=i(89432);var b=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,r),t=n.call(this),(0,_.default)((0,o.default)(t),"rollRatio",.97),(0,_.default)((0,o.default)(t),"scaleBar",!0),(0,_.default)((0,o.default)(t),"autoHide",!1),(0,_.default)((0,o.default)(t),"elasticDistance",0),(0,_.default)((0,o.default)(t),"elasticBackTime",500),(0,_.default)((0,o.default)(t),"_showButtons",g.UIConfig.showButtons),(0,_.default)((0,o.default)(t),"_scrollSize",1),(0,_.default)((0,o.default)(t),"_thumbPercent",1),(0,_.default)((0,o.default)(t),"_lastOffset",0),(0,_.default)((0,o.default)(t),"_checkElastic",!1),(0,_.default)((0,o.default)(t),"_isElastic",!1),(0,_.default)((0,o.default)(t),"_hide",!1),(0,_.default)((0,o.default)(t),"_clickOnly",!0),(0,_.default)((0,o.default)(t),"_touchScrollEnable",g.UIConfig.touchScrollEnable),(0,_.default)((0,o.default)(t),"_mouseWheelEnable",g.UIConfig.mouseWheelEnable),t.skin=e,t.max=1,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopScroll(),this.target=null,(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this.upButton&&this.upButton.destroy(t),this.downButton&&this.downButton.destroy(t),this.slider&&this.slider.destroy(t),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null}},{key:"createChildren",value:function(){this.addChild(this.slider=new p.Slider),this.addChild(this.upButton=new y.Button),this.addChild(this.downButton=new y.Button)}},{key:"initialize",value:function(){this.slider.showLabel=!1,this.slider.tick=0,this.slider.on(x.Event.CHANGE,this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on(x.Event.MOUSE_DOWN,this,this.onButtonMouseDown),this.downButton.on(x.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"onSliderChange",value:function(){this._value!=this.slider.value&&(this.value=this.slider.value)}},{key:"onButtonMouseDown",value:function(t){var e=t.currentTarget===this.upButton;this.slide(e),M.ILaya.timer.once(m.Styles.scrollBarDelayTime,this,this.startLoop,[e]),M.ILaya.stage.once(x.Event.MOUSE_UP,this,this.onStageMouseUp)}},{key:"startLoop",value:function(t){M.ILaya.timer.frameLoop(1,this,this.slide,[t])}},{key:"slide",value:function(t){t?this.value-=this._scrollSize:this.value+=this._scrollSize}},{key:"onStageMouseUp",value:function(t){M.ILaya.timer.clear(this,this.startLoop),M.ILaya.timer.clear(this,this.slide)}},{key:"skin",get:function(){return this._skin},set:function(t){" "!=t&&this._skin!=t&&(this._skin=t,this._skin&&!k.Loader.getRes(this._skin)?M.ILaya.loader.load([this._skin,this._skin.replace(".png","$up.png"),this._skin.replace(".png","$down.png"),this._skin.replace(".png","$bar.png")],S.Handler.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.destroyed||(this.slider.skin=this._skin,this.callLater(this.changeScrollBar),this._sizeChanged(),this.event(x.Event.LOADED))}},{key:"changeScrollBar",value:function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()}},{key:"_sizeChanged",value:function(){(0,h.default)((0,f.default)(r.prototype),"_sizeChanged",this).call(this),this.repaint(),this.resetPositions(),this.event(x.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this.value)}},{key:"resetPositions",value:function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()}},{key:"resetButtonPosition",value:function(){this.slider.isVertical?this.downButton.y=this.slider._y+this.slider.height:this.downButton.x=this.slider._x+this.slider.width}},{key:"measureWidth",value:function(){return this.slider.isVertical?this.slider.width:100}},{key:"measureHeight",value:function(){return this.slider.isVertical?100:this.slider.height}},{key:"setScroll",value:function(t,e,i){this.runCallLater(this._sizeChanged),this.slider.setSlider(t,e,i),this.slider.bar.visible=e>0,!this._hide&&this.autoHide&&(this.visible=!1)}},{key:"max",get:function(){return this.slider.max},set:function(t){this.slider.max=t}},{key:"min",get:function(){return this.slider.min},set:function(t){this.slider.min=t}},{key:"value",get:function(){return this._value},set:function(t){t!==this._value&&(this._value=t,this._isElastic||(this.slider._value!=t&&(this.slider._value=t,this.slider.changeValue()),this._value=this.slider._value),this.event(x.Event.CHANGE),this.changeHandler&&this.changeHandler.runWith(this._value))}},{key:"isVertical",get:function(){return this.slider.isVertical},set:function(t){this.slider.isVertical=t}},{key:"sizeGrid",get:function(){return this.slider.sizeGrid},set:function(t){this.slider.sizeGrid=t}},{key:"scrollSize",get:function(){return this._scrollSize},set:function(t){this._scrollSize=t}},{key:"dataSource",get:function(){return(0,h.default)((0,f.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):(0,u.default)((0,f.default)(r.prototype),"dataSource",t,this,!0)}},{key:"thumbPercent",get:function(){return this._thumbPercent},set:function(t){this.runCallLater(this.changeScrollBar),this.runCallLater(this._sizeChanged),t=t>=1?.99:t,this._thumbPercent=t,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*t,m.Styles.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*t,m.Styles.scrollBarMinNum))}},{key:"target",get:function(){return this._target},set:function(t){this._target&&(this._target.off(x.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._target.off(x.Event.MOUSE_DOWN,this,this.onTargetMouseDown)),this._target=t,t&&(this._mouseWheelEnable&&this._target.on(x.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on(x.Event.MOUSE_DOWN,this,this.onTargetMouseDown))}},{key:"hide",get:function(){return this._hide},set:function(t){this._hide=t,this.visible=!t}},{key:"showButtons",get:function(){return this._showButtons},set:function(t){this._showButtons=t,this.callLater(this.changeScrollBar)}},{key:"touchScrollEnable",get:function(){return this._touchScrollEnable},set:function(t){this._touchScrollEnable=t,this.target=this._target}},{key:"mouseWheelEnable",get:function(){return this._mouseWheelEnable},set:function(t){this._mouseWheelEnable=t,this.target=this._target}},{key:"onTargetMouseWheel",value:function(t){this.value-=t.delta*this._scrollSize,this.target=this._target}},{key:"onTargetMouseDown",value:function(t){this.isLockedFun&&!this.isLockedFun(t)||(this.event(x.Event.END),this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new T.Point),this._lastPoint.setTo(M.ILaya.stage.mouseX,M.ILaya.stage.mouseY),M.ILaya.timer.clear(this,this.tweenMove),E.Tween.clearTween(this),M.ILaya.stage.once(x.Event.MOUSE_UP,this,this.onStageMouseUp2),M.ILaya.stage.once(x.Event.MOUSE_OUT,this,this.onStageMouseUp2),M.ILaya.timer.frameLoop(1,this,this.loop))}},{key:"startDragForce",value:function(){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new T.Point),this._lastPoint.setTo(M.ILaya.stage.mouseX,M.ILaya.stage.mouseY),M.ILaya.timer.clear(this,this.tweenMove),E.Tween.clearTween(this),M.ILaya.stage.once(x.Event.MOUSE_UP,this,this.onStageMouseUp2),M.ILaya.stage.once(x.Event.MOUSE_OUT,this,this.onStageMouseUp2),M.ILaya.timer.frameLoop(1,this,this.loop)}},{key:"cancelDragOp",value:function(){M.ILaya.stage.off(x.Event.MOUSE_UP,this,this.onStageMouseUp2),M.ILaya.stage.off(x.Event.MOUSE_OUT,this,this.onStageMouseUp2),M.ILaya.timer.clear(this,this.tweenMove),M.ILaya.timer.clear(this,this.loop),this._target.mouseEnabled=!0}},{key:"checkTriggers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.value>=0&&this.value-this._lastOffset<=0&&this.triggerDownDragLimit&&this.triggerDownDragLimit(t)?(this.cancelDragOp(),this.value=0,!0):!!(this.value<=this.max&&this.value-this._lastOffset>=this.max&&this.triggerUpDragLimit&&this.triggerUpDragLimit(t))&&(this.cancelDragOp(),this.value=this.max,!0)}},{key:"lastOffset",get:function(){return this._lastOffset}},{key:"startTweenMoveForce",value:function(t){this._lastOffset=t,M.ILaya.timer.frameLoop(1,this,this.tweenMove,[200])}},{key:"loop",value:function(){var t=M.ILaya.stage.mouseY,e=M.ILaya.stage.mouseX;if(this._lastOffset=this.isVertical?t-this._lastPoint.y:e-this._lastPoint.x,this._clickOnly){if(!(Math.abs(this._lastOffset*(this.isVertical?M.ILaya.stage._canvasTransform.getScaleY():M.ILaya.stage._canvasTransform.getScaleX()))>1))return;if(this._clickOnly=!1,this.checkTriggers())return;this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event(x.Event.START)}else if(this.checkTriggers())return;this._offsets.push(this._lastOffset),this._lastPoint.x=e,this._lastPoint.y=t,0!==this._lastOffset&&(this._checkElastic||(this.elasticDistance>0?this._checkElastic||0==this._lastOffset||(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this._lastOffset>0?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value>=this.min&&(this._checkElastic=!1)):this._value>=this.max&&(this._lastOffset<0?this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value<=this.max&&(this._checkElastic=!1))):this.value-=this._lastOffset)}},{key:"onStageMouseUp2",value:function(t){if(M.ILaya.stage.off(x.Event.MOUSE_UP,this,this.onStageMouseUp2),M.ILaya.stage.off(x.Event.MOUSE_OUT,this,this.onStageMouseUp2),M.ILaya.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?E.Tween.to(this,{value:this.min},this.elasticBackTime,C.Ease.sineOut,S.Handler.create(this,this.elasticOver)):this._value>this.max&&E.Tween.to(this,{value:this.max},this.elasticBackTime,C.Ease.sineOut,S.Handler.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?M.ILaya.stage.mouseY-this._lastPoint.y:M.ILaya.stage.mouseX-this._lastPoint.x);for(var e=0,i=Math.min(this._offsets.length,3),a=0;a<i;a++)e+=this._offsets[this._offsets.length-1-a];if(this._lastOffset=e/i,(e=Math.abs(this._lastOffset))<2)return void this.event(x.Event.END);e>250&&(this._lastOffset=this._lastOffset>0?250:-250);var n=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/150)));M.ILaya.timer.frameLoop(1,this,this.tweenMove,[n])}}},{key:"elasticOver",value:function(){this._isElastic=!1,!this.hide&&this.autoHide&&E.Tween.to(this,{alpha:0},500),this.event(x.Event.END)}},{key:"tweenMove",value:function(t){var e;if(this._lastOffset*=this.rollRatio,!this.checkTriggers(!0)&&(t>0&&(this._lastOffset>0&&this.value<=this.min?(this._isElastic=!0,e=.5*-(this.min-t-this.value),this._lastOffset>e&&(this._lastOffset=e)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,e=.5*-(this.max+t-this.value),this._lastOffset<e&&(this._lastOffset=e))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<.1)){if(M.ILaya.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?E.Tween.to(this,{value:this.min},this.elasticBackTime,C.Ease.sineOut,S.Handler.create(this,this.elasticOver)):this._value>this.max?E.Tween.to(this,{value:this.max},this.elasticBackTime,C.Ease.sineOut,S.Handler.create(this,this.elasticOver)):this.elasticOver());this.event(x.Event.END),!this.hide&&this.autoHide&&E.Tween.to(this,{alpha:0},500)}}},{key:"stopScroll",value:function(){this.onStageMouseUp2(null),M.ILaya.timer.clear(this,this.tweenMove),E.Tween.clearTween(this)}},{key:"tick",get:function(){return this.slider.tick},set:function(t){this.slider.tick=t}}]),r}(v.UIComponent);e.ScrollBar=b,M.ILaya.regClass(b),L.ClassUtils.regClass("laya.ui.ScrollBar",b),L.ClassUtils.regClass("Laya.ScrollBar",b)},46606:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Slider=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(52605)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(60414),y=i(130),p=i(68209),g=i(65869),m=i(63969),x=i(91020),T=i(84581),k=i(35696),C=i(93561),S=i(89432);var E=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,s.default)(this,r),t=n.call(this),(0,_.default)((0,o.default)(t),"isVertical",!0),(0,_.default)((0,o.default)(t),"showLabel",!0),(0,_.default)((0,o.default)(t),"_max",100),(0,_.default)((0,o.default)(t),"_min",0),(0,_.default)((0,o.default)(t),"_tick",1),(0,_.default)((0,o.default)(t),"_value",0),r.label||(r.label=new y.Label),t.skin=e,t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(t),this._bar&&this._bar.destroy(t),this._progress&&this._progress.destroy(t),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new p.Image),this.addChild(this._bar=new g.Button)}},{key:"initialize",value:function(){this._bar.on(m.Event.MOUSE_DOWN,this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0}},{key:"onBarMouseDown",value:function(t){var e=C.ILaya;this._globalSacle||(this._globalSacle=new x.Point),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=e.stage.mouseX,this._ty=e.stage.mouseY,e.stage.on(m.Event.MOUSE_MOVE,this,this.mouseMove),e.stage.once(m.Event.MOUSE_UP,this,this.mouseUp),e.stage.once(m.Event.MOUSE_OUT,this,this.mouseUp),this.showValueText()}},{key:"showValueText",value:function(){if(this.showLabel){var t=r.label;this.addChild(t),t.textField.changeText(this._value+""),this.isVertical?(t.x=this._bar._x+20,t.y=.5*(this._bar.height-t.height)+this._bar._y):(t.y=this._bar._y-20,t.x=.5*(this._bar.width-t.width)+this._bar._x)}}},{key:"hideValueText",value:function(){r.label&&r.label.removeSelf()}},{key:"mouseUp",value:function(t){var e=C.ILaya.stage;e.off(m.Event.MOUSE_MOVE,this,this.mouseMove),e.off(m.Event.MOUSE_UP,this,this.mouseUp),e.off(m.Event.MOUSE_OUT,this,this.mouseUp),this.sendChangeEvent(m.Event.CHANGED),this.hideValueText()}},{key:"mouseMove",value:function(t){var e=C.ILaya.stage,i=this._value;if(this.isVertical?(this._bar.y+=(e.mouseY-this._ty)/this._globalSacle.y,this._bar._y>this._maxMove?this._bar.y=this._maxMove:this._bar._y<0&&(this._bar.y=0),this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x+=(e.mouseX-this._tx)/this._globalSacle.x,this._bar._x>this._maxMove?this._bar.x=this._maxMove:this._bar._x<0&&(this._bar.x=0),this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width)),this._tx=e.mouseX,this._ty=e.mouseY,0!=this._tick){var a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*a)/a}this._value!=i&&this.sendChangeEvent(),this.showValueText()}},{key:"sendChangeEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.Event.CHANGE;this.event(t),this.changeHandler&&this.changeHandler.runWith(this._value)}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!T.Loader.getRes(this._skin)?C.ILaya.loader.load([this._skin,this._skin.replace(".png","$bar.png")],k.Handler.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var t=this._skin.replace(".png","$progress.png");T.Loader.getRes(t)&&(this._progress||(this.addChild(this._progress=new p.Image),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=t),this.setBarPoint(),this.callLater(this.changeValue),this._sizeChanged(),this.event(m.Event.LOADED)}},{key:"setBarPoint",value:function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))}},{key:"measureWidth",value:function(){return Math.max(this._bg.width,this._bar.width)}},{key:"measureHeight",value:function(){return Math.max(this._bg.height,this._bar.height)}},{key:"_sizeChanged",value:function(){(0,h.default)((0,f.default)(r.prototype),"_sizeChanged",this).call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(t){this._bg.sizeGrid=t,this._bar.sizeGrid=t,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}},{key:"setSlider",value:function(t,e,i){this._value=-1,this._min=t,this._max=e>t?e:t,this.value=i<t?t:i>e?e:i}},{key:"tick",get:function(){return this._tick},set:function(t){this._tick!=t&&(this._tick=t,this.callLater(this.changeValue))}},{key:"changeValue",value:function(){if(0!=this.tick){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t}this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var e=this._max-this._min;0===e&&(e=1),this.isVertical?(this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width))}},{key:"max",get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.callLater(this.changeValue))}},{key:"min",get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.callLater(this.changeValue))}},{key:"value",get:function(){return this._value},set:function(t){if(this._value!=t){var e=this._value;this._value=t,this.changeValue(),this._value!=e&&this.sendChangeEvent()}}},{key:"allowClickBack",get:function(){return this._allowClickBack},set:function(t){this._allowClickBack!=t&&(this._allowClickBack=t,t?this._bg.on(m.Event.MOUSE_DOWN,this,this.onBgMouseDown):this._bg.off(m.Event.MOUSE_DOWN,this,this.onBgMouseDown))}},{key:"onBgMouseDown",value:function(t){var e=this._bg.getMousePoint();this.isVertical?this.value=e.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=e.x/(this.width-this._bar.width)*(this._max-this._min)+this._min}},{key:"dataSource",get:function(){return(0,h.default)((0,f.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.value=Number(t):(0,u.default)((0,f.default)(r.prototype),"dataSource",t,this,!0)}},{key:"bar",get:function(){return this._bar}}]),r}(v.UIComponent);e.Slider=E,(0,_.default)(E,"label",null),C.ILaya.regClass(E),S.ClassUtils.regClass("laya.ui.Slider",E),S.ClassUtils.regClass("Laya.Slider",E)},51630:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Styles=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.Styles=o,(0,l.default)(o,"defaultSizeGrid",[4,4,4,4,0]),(0,l.default)(o,"labelColor","#000000"),(0,l.default)(o,"labelPadding",[2,2,2,2]),(0,l.default)(o,"inputLabelPadding",[1,1,1,3]),(0,l.default)(o,"buttonStateNum",3),(0,l.default)(o,"buttonLabelColors",["#32556b","#32cc6b","#ff0000","#C0C0C0"]),(0,l.default)(o,"comboBoxItemColors",["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]),(0,l.default)(o,"scrollBarMinNum",15),(0,l.default)(o,"scrollBarDelayTime",500)},89175:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Tab=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=i(65869),d=i(39019),f=i(93561),_=i(89432);var v=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,s.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"createItem",value:function(t,e){return new c.Button(t,e)}}]),r}(d.UIGroup);e.Tab=v,f.ILaya.regClass(v),_.ClassUtils.regClass("laya.ui.Tab",v),_.ClassUtils.regClass("Laya.Tab",v)},89800:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.TextArea=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(52605)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=i(40448),v=i(12495),y=i(34461),p=i(51630),g=i(63969),m=i(93561),x=i(89432);var T=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.default)(this,r),(t=n.call(this,e)).on(g.Event.CHANGE,(0,o.default)(t),t._onTextChange),t}return(0,l.default)(r,[{key:"_onTextChange",value:function(){this.callLater(this.changeScroll)}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null,(0,h.default)((0,f.default)(r.prototype),"destroy",this).call(this,t)}},{key:"initialize",value:function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0}},{key:"width",get:function(){return(0,h.default)((0,f.default)(r.prototype),"width",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"width",t,this,!0),this.callLater(this.changeScroll)}},{key:"height",get:function(){return(0,h.default)((0,f.default)(r.prototype),"height",this)},set:function(t){(0,u.default)((0,f.default)(r.prototype),"height",t,this,!0),this.callLater(this.changeScroll)}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(t){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new v.VScrollBar),this._vScrollBar.on(g.Event.CHANGE,this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=t}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(t){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new y.HScrollBar),this._hScrollBar.on(g.Event.CHANGE,this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=t}},{key:"onVBarChanged",value:function(t){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)}},{key:"onHBarChanged",value:function(t){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"maxScrollY",get:function(){return this._tf.maxScrollY}},{key:"scrollY",get:function(){return this._tf.scrollY}},{key:"maxScrollX",get:function(){return this._tf.maxScrollX}},{key:"scrollX",get:function(){return this._tf.scrollX}},{key:"changeScroll",value:function(){var t=this._vScrollBar&&this._tf.maxScrollY>0,e=this._hScrollBar&&this._tf.maxScrollX>0,i=t?this._width-this._vScrollBar.width:this._width,a=e?this._height-this._hScrollBar.height:this._height,n=this._tf.padding||p.Styles.labelPadding;this._tf.width=i,this._tf.height=a,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-n[2],this._vScrollBar.y=n[1],this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-n[1]-n[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=a/Math.max(this._tf.textHeight,a),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=t),this._hScrollBar&&(this._hScrollBar.x=n[0],this._hScrollBar.y=this._height-this._hScrollBar.height-n[3],this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-n[0]-n[2],this._hScrollBar.scrollSize=Math.max(.033*i,1),this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=e)}},{key:"scrollTo",value:function(t){this.commitMeasure(),this._tf.scrollY=t}}]),r}(_.TextInput);e.TextArea=T,m.ILaya.regClass(T),x.ClassUtils.regClass("laya.ui.TextArea",T),x.ClassUtils.regClass("Laya.TextArea",T)},40448:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.TextInput=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(52605)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=i(130),_=i(85058),v=i(63969),y=i(84581),p=i(19492),g=i(51630),m=i(44451),x=i(35696),T=i(93561),k=i(89432);var C=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,s.default)(this,r),(t=n.call(this)).text=e,t.skin=t.skin,t}return(0,l.default)(r,[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t),this._bg&&this._bg.destroy(),this._bg=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new _.Input),this._tf.padding=g.Styles.inputLabelPadding,this._tf.on(v.Event.INPUT,this,this._onInput),this._tf.on(v.Event.ENTER,this,this._onEnter),this._tf.on(v.Event.BLUR,this,this._onBlur),this._tf.on(v.Event.FOCUS,this,this._onFocus)}},{key:"_onFocus",value:function(){this.event(v.Event.FOCUS,this)}},{key:"_onBlur",value:function(){this.event(v.Event.BLUR,this)}},{key:"_onInput",value:function(){this.event(v.Event.INPUT,this)}},{key:"_onEnter",value:function(){this.event(v.Event.ENTER,this)}},{key:"initialize",value:function(){this.width=128,this.height=22}},{key:"bg",get:function(){return this._bg},set:function(t){this.graphics=this._bg=t}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!y.Loader.getRes(this._skin)?T.ILaya.loader.load(this._skin,x.Handler.create(this,this._skinLoaded),null,y.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg||(this.graphics=this._bg=new p.AutoBitmap),this._bg.source=y.Loader.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height),this._sizeChanged(),this.event(v.Event.LOADED)}},{key:"sizeGrid",get:function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},set:function(t){this._bg||(this.graphics=this._bg=new p.AutoBitmap),this._bg.sizeGrid=m.UIUtils.fillArray(g.Styles.defaultSizeGrid,t,Number)}},{key:"text",get:function(){return(0,u.default)((0,d.default)(r.prototype),"text",this)},set:function(t){this._tf.text!=t&&(t+="",this._tf.text=t,this.event(v.Event.CHANGE))}},{key:"width",get:function(){return(0,u.default)((0,d.default)(r.prototype),"width",this)},set:function(t){(0,o.default)((0,d.default)(r.prototype),"width",t,this,!0),this._bg&&(this._bg.width=t)}},{key:"height",get:function(){return(0,u.default)((0,d.default)(r.prototype),"height",this)},set:function(t){(0,o.default)((0,d.default)(r.prototype),"height",t,this,!0),this._bg&&(this._bg.height=t)}},{key:"multiline",get:function(){return this._tf.multiline},set:function(t){this._tf.multiline=t}},{key:"editable",get:function(){return this._tf.editable},set:function(t){this._tf.editable=t}},{key:"select",value:function(){this._tf.select()}},{key:"restrict",get:function(){return this._tf.restrict},set:function(t){this._tf.restrict=t}},{key:"prompt",get:function(){return this._tf.prompt},set:function(t){this._tf.prompt=t}},{key:"promptColor",get:function(){return this._tf.promptColor},set:function(t){this._tf.promptColor=t}},{key:"maxChars",get:function(){return this._tf.maxChars},set:function(t){this._tf.maxChars=t}},{key:"focus",get:function(){return this._tf.focus},set:function(t){this._tf.focus=t}},{key:"type",get:function(){return this._tf.type},set:function(t){this._tf.type=t}},{key:"setSelection",value:function(t,e){this._tf.setSelection(t,e)}}]),r}(f.Label);e.TextInput=C,T.ILaya.regClass(C),k.ClassUtils.regClass("laya.ui.TextInput",C),k.ClassUtils.regClass("Laya.TextInput",C)},20186:(t,e,i)=>{"use strict";var a=i(1068),n=i(3649),r=i(66419),s=i(65420),l=i(19996),o=i(41511),u=i(63978),h=i(56363);u(e,"__esModule",{value:!0}),e.Tree=void 0;var c=h(i(81643)),d=h(i(87368)),f=h(i(28146)),_=h(i(43714)),v=h(i(52605)),y=h(i(92135)),p=h(i(13383)),g=h(i(78310)),m=h(i(82669)),x=h(i(17454)),T=i(65810),k=i(49501),C=i(63969),S=i(35696),E=i(93561),M=i(89432);function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var b=function(t){(0,p.default)(h,t);var e,i,u=(e=h,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,m.default)(e);if(i){var r=(0,m.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,g.default)(this,t)});function h(){var t;return(0,d.default)(this,h),t=u.call(this),(0,x.default)((0,_.default)(t),"_spaceLeft",10),(0,x.default)((0,_.default)(t),"_spaceBottom",0),(0,x.default)((0,_.default)(t),"_keepStatus",!0),t.width=t.height=200,t}return(0,f.default)(h,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,y.default)((0,m.default)(h.prototype),"destroy",this).call(this,t),this._list&&this._list.destroy(t),this._list=null,this._source=null,this._renderHandler=null}},{key:"createChildren",value:function(){this.addChild(this._list=new k.List),this._list.renderHandler=S.Handler.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on(C.Event.CHANGE,this,this.onListChange)}},{key:"onListChange",value:function(){this.event(C.Event.CHANGE)}},{key:"keepStatus",get:function(){return this._keepStatus},set:function(t){this._keepStatus=t}},{key:"array",get:function(){return this._list.array},set:function(t){this._keepStatus&&this._list.array&&t&&this.parseOpenStatus(this._list.array,t),this._source=t,this._list.array=this.getArray()}},{key:"source",get:function(){return this._source}},{key:"list",get:function(){return this._list}},{key:"itemRender",get:function(){return this._list.itemRender},set:function(t){this._list.itemRender=t}},{key:"scrollBarSkin",get:function(){return this._list.vScrollBarSkin},set:function(t){this._list.vScrollBarSkin=t}},{key:"scrollBar",get:function(){return this._list.scrollBar}},{key:"mouseHandler",get:function(){return this._list.mouseHandler},set:function(t){this._list.mouseHandler=t}},{key:"renderHandler",get:function(){return this._renderHandler},set:function(t){this._renderHandler=t}},{key:"spaceLeft",get:function(){return this._spaceLeft},set:function(t){this._spaceLeft=t}},{key:"spaceBottom",get:function(){return this._list.spaceY},set:function(t){this._list.spaceY=t}},{key:"selectedIndex",get:function(){return this._list.selectedIndex},set:function(t){this._list.selectedIndex=t}},{key:"selectedItem",get:function(){return this._list.selectedItem},set:function(t){this._list.selectedItem=t}},{key:"width",get:function(){return(0,y.default)((0,m.default)(h.prototype),"width",this)},set:function(t){(0,v.default)((0,m.default)(h.prototype),"width",t,this,!0),this._list.width=t}},{key:"height",get:function(){return(0,y.default)((0,m.default)(h.prototype),"height",this)},set:function(t){(0,v.default)((0,m.default)(h.prototype),"height",t,this,!0),this._list.height=t}},{key:"getArray",value:function(){var t=[];for(var e in this._source){var i=this._source[e];this.getParentOpenStatus(i)&&(i.x=this._spaceLeft*this.getDepth(i),t.push(i))}return t}},{key:"getDepth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==t.nodeParent?e:this.getDepth(t.nodeParent,e+1)}},{key:"getParentOpenStatus",value:function(t){var e=t.nodeParent;return null==e||!!e.isOpen&&(null==e.nodeParent||this.getParentOpenStatus(e))}},{key:"renderItem",value:function(t,e){var i=t.dataSource;if(i){t.left=i.x;var a=t.getChildByName("arrow");a&&(i.hasChild?(a.visible=!0,a.index=i.isOpen?1:0,a.tag=e,a.off(C.Event.CLICK,this,this.onArrowClick),a.on(C.Event.CLICK,this,this.onArrowClick)):a.visible=!1);var n=t.getChildByName("folder");n&&(2==n.clipY?n.index=i.isDirectory?0:1:n.index=i.isDirectory?i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([t,e])}}},{key:"onArrowClick",value:function(t){var e=t.currentTarget.tag;this._list.array[e].isOpen=!this._list.array[e].isOpen,this.event(C.Event.OPEN),this._list.array=this.getArray()}},{key:"setItemState",value:function(t,e){this._list.array[t]&&(this._list.array[t].isOpen=e,this._list.array=this.getArray())}},{key:"fresh",value:function(){this._list.array=this.getArray(),this.repaint()}},{key:"dataSource",get:function(){return(0,y.default)((0,m.default)(h.prototype),"dataSource",this)},set:function(t){this._dataSource=t,(0,v.default)((0,m.default)(h.prototype),"dataSource",t,this,!0)}},{key:"xml",set:function(t){var e=[];this.parseXml(t.childNodes[0],e,null,!0),this.array=e}},{key:"parseXml",value:function(t,e,i,a){var n,r=t.childNodes,s=r.length;if(!a){n={};var l=t.attributes;for(var o in l){var u=l[o],h=u.nodeName,c=u.nodeValue;n[h]="true"==c||"false"!=c&&c}n.nodeParent=i,s>0&&(n.isDirectory=!0),n.hasChild=s>0,e.push(n)}for(var d=0;d<s;d++){var f=r[d];this.parseXml(f,e,n,!1)}}},{key:"parseOpenStatus",value:function(t,e){for(var i=0,a=e.length;i<a;i++){var n=e[i];if(n.isDirectory)for(var r=0,s=t.length;r<s;r++){var l=t[r];if(l.isDirectory&&this.isSameParent(l,n)&&n.label==l.label){n.isOpen=l.isOpen;break}}}}},{key:"isSameParent",value:function(t,e){return null==t.nodeParent&&null==e.nodeParent||null!=t.nodeParent&&null!=e.nodeParent&&t.nodeParent.label==e.nodeParent.label&&this.isSameParent(t.nodeParent,e.nodeParent)}},{key:"selectedPath",get:function(){return this._list.selectedItem?this._list.selectedItem.path:null}},{key:"filter",value:function(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t),this._list.array=e}else this._list.array=this.getArray()}},{key:"getFilterSource",value:function(t,e,i){i=i.toLocaleLowerCase();var a,u=function(t,e){var i=void 0!==s&&l(t)||t["@@iterator"];if(!i){if(o(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return L(t,e);var a=n(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?r(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?L(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var a=0,u=function(){};return{s:u,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h,c=!0,d=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return c=t.done,t},e:function(t){d=!0,h=t},f:function(){try{c||null==i.return||i.return()}finally{if(d)throw h}}}}(t);try{for(u.s();!(a=u.n()).done;){var h,d=a.value;!d.isDirectory&&(0,c.default)(h=String(d.label).toLowerCase()).call(h,i)>-1&&(d.x=0,e.push(d)),d.child&&d.child.length>0&&this.getFilterSource(d.child,e,i)}}catch(t){u.e(t)}finally{u.f()}}}]),h}(T.Box);e.Tree=b,E.ILaya.regClass(b),M.ClassUtils.regClass("laya.ui.Tree",b),M.ClassUtils.regClass("Laya.Tree",b)},60414:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.UIComponent=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(88792),v=i(62004),y=i(44451),p=i(87210),g=i(63969),m=i(93561),x=i(89432);var T=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,s.default)(this,r),t=n.call(this),(0,f.default)((0,o.default)(t),"_anchorX",NaN),(0,f.default)((0,o.default)(t),"_anchorY",NaN),(0,f.default)((0,o.default)(t),"_widget",_.Widget.EMPTY),e&&(t.preinitialize(),t.createChildren(),t.initialize()),t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t),this._dataSource=null,this._tag=null,this._toolTip=null}},{key:"preinitialize",value:function(){}},{key:"createChildren",value:function(){}},{key:"initialize",value:function(){}},{key:"width",get:function(){return this.get_width()},set:function(t){this.set_width(t)}},{key:"get_width",value:function(){return this._width?this._width:this.measureWidth()}},{key:"measureWidth",value:function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._x+i.width*i.scaleX,t))}return t}},{key:"commitMeasure",value:function(){}},{key:"height",get:function(){return this.get_height()},set:function(t){this.set_height(t)}},{key:"get_height",value:function(){return this._height?this._height:this.measureHeight()}},{key:"measureHeight",value:function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);i._visible&&(t=Math.max(i._y+i.height*i.scaleY,t))}return t}},{key:"dataSource",get:function(){return this.get_dataSource()},set:function(t){this.set_dataSource(t)}},{key:"get_dataSource",value:function(){return this._dataSource}},{key:"set_dataSource",value:function(t){for(var e in this._dataSource=t,this._dataSource)e in this&&"function"!=typeof this[e]&&(this[e]=this._dataSource[e])}},{key:"top",get:function(){return this.get_top()},set:function(t){this.set_top(t)}},{key:"get_top",value:function(){return this._widget.top}},{key:"set_top",value:function(t){t!=this._widget.top&&(this._getWidget().top=t)}},{key:"bottom",get:function(){return this.get_bottom()},set:function(t){this.set_bottom(t)}},{key:"get_bottom",value:function(){return this._widget.bottom}},{key:"set_bottom",value:function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}},{key:"left",get:function(){return this._widget.left},set:function(t){t!=this._widget.left&&(this._getWidget().left=t)}},{key:"right",get:function(){return this._widget.right},set:function(t){t!=this._widget.right&&(this._getWidget().right=t)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(g.Event.RESIZE),this._widget!==_.Widget.EMPTY&&this._widget.resetLayout()}},{key:"tag",get:function(){return this._tag},set:function(t){this._tag=t}},{key:"toolTip",get:function(){return this._toolTip},set:function(t){this._toolTip!=t&&(this._toolTip=t,null!=t?(this.on(g.Event.MOUSE_OVER,this,this.onMouseOver),this.on(g.Event.MOUSE_OUT,this,this.onMouseOut)):(this.off(g.Event.MOUSE_OVER,this,this.onMouseOver),this.off(g.Event.MOUSE_OUT,this,this.onMouseOut)))}},{key:"onMouseOver",value:function(t){m.ILaya.stage.event(v.UIEvent.SHOW_TIP,this._toolTip)}},{key:"onMouseOut",value:function(t){m.ILaya.stage.event(v.UIEvent.HIDE_TIP,this._toolTip)}},{key:"gray",get:function(){return this._gray},set:function(t){t!==this._gray&&(this._gray=t,y.UIUtils.gray(this,t))}},{key:"disabled",get:function(){return this._disabled},set:function(t){t!==this._disabled&&(this.gray=this._disabled=t,this.mouseEnabled=!t)}},{key:"_getWidget",value:function(){return this._widget===_.Widget.EMPTY&&(this._widget=this.addComponent(_.Widget)),this._widget}},{key:"scaleX",get:function(){return(0,u.default)((0,d.default)(r.prototype),"scaleX",this)},set:function(t){this.set_scaleX(t)}},{key:"set_scaleX",value:function(t){(0,u.default)((0,d.default)(r.prototype),"get_scaleX",this).call(this)!=t&&((0,u.default)((0,d.default)(r.prototype),"set_scaleX",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"scaleY",get:function(){return(0,u.default)((0,d.default)(r.prototype),"scaleY",this)},set:function(t){this.set_scaleY(t)}},{key:"set_scaleY",value:function(t){(0,u.default)((0,d.default)(r.prototype),"get_scaleY",this).call(this)!=t&&((0,u.default)((0,d.default)(r.prototype),"set_scaleY",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"onCompResize",value:function(){this._sizeChanged()}},{key:"set_width",value:function(t){(0,u.default)((0,d.default)(r.prototype),"get_width",this).call(this)!=t&&((0,u.default)((0,d.default)(r.prototype),"set_width",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"set_height",value:function(t){(0,u.default)((0,d.default)(r.prototype),"get_height",this).call(this)!=t&&((0,u.default)((0,d.default)(r.prototype),"set_height",this).call(this,t),this.callLater(this._sizeChanged))}},{key:"anchorX",get:function(){return this.get_anchorX()},set:function(t){this.set_anchorX(t)}},{key:"get_anchorX",value:function(){return this._anchorX}},{key:"set_anchorX",value:function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this.get_anchorY()},set:function(t){this.set_anchorY(t)}},{key:"get_anchorY",value:function(){return this._anchorY}},{key:"set_anchorY",value:function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}},{key:"_childChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.callLater(this._sizeChanged),(0,u.default)((0,d.default)(r.prototype),"_childChanged",this).call(this,t)}}]),r}(p.Sprite);e.UIComponent=T,m.ILaya.regClass(T),x.ClassUtils.regClass("laya.ui.UIComponent",T),x.ClassUtils.regClass("Laya.UIComponent",T)},62004:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.UIEvent=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(63969),f=i(93561),_=i(89432);var v=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,l.default)(this,r),n.apply(this,arguments)}return(0,s.default)(r)}(d.Event);e.UIEvent=v,(0,c.default)(v,"SHOW_TIP","showtip"),(0,c.default)(v,"HIDE_TIP","hidetip"),f.ILaya.regClass(v),_.ClassUtils.regClass("laya.ui.UIEvent",v),_.ClassUtils.regClass("Laya.UIEvent",v)},39019:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.UIGroup=void 0;var s=r(i(81643)),l=r(i(94198)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(52605)),d=r(i(92135)),f=r(i(13383)),_=r(i(78310)),v=r(i(82669)),y=r(i(17454)),p=i(65810),g=i(63969),m=i(84581),x=i(35696),T=i(93561),k=i(89432);var C=function(t){(0,f.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,_.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,o.default)(this,r),t=n.call(this),(0,y.default)((0,h.default)(t),"_selectedIndex",-1),(0,y.default)((0,h.default)(t),"_direction","horizontal"),(0,y.default)((0,h.default)(t),"_space",0),t.skin=i,t.labels=e,t}return(0,u.default)(r,[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,d.default)((0,v.default)(r.prototype),"destroy",this).call(this,t),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null}},{key:"addItem",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=t,a=this._items.length;if(i.name="item"+a,this.addChild(i),this.initItems(),e&&a>0){var n=this._items[a-1];"horizontal"==this._direction?i.x=n._x+n.width+this._space:i.y=n._y+n.height+this._space}else e&&(i.x=0,i.y=0);return a}},{key:"delItem",value:function(t){var e,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=(0,s.default)(e=this._items).call(e,t);if(-1!=a){var n,r=t;this.removeChild(r);for(var l=a+1,o=this._items.length;l<o;l++){var u=this._items[l];u.name="item"+(l-1),i&&("horizontal"==this._direction?u.x-=r.width+this._space:u.y-=r.height+this._space)}this.initItems(),this._selectedIndex>-1&&(n=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=n)}}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items||(this._items=[]),this._items.length=0;for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.selected=t===this._selectedIndex,e.clickHandler=x.Handler.create(this,this.itemClick,[t],!1)}}},{key:"itemClick",value:function(t){this.selectedIndex=t}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(t,!0),this.event(g.Event.CHANGE),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}},{key:"setSelect",value:function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].selected=e)}},{key:"skin",get:function(){return this._skin},set:function(t){this._skin!=t&&(this._skin=t,this._skin&&!m.Loader.getRes(this._skin)?T.ILaya.loader.load(this._skin,x.Handler.create(this,this._skinLoaded),null,m.Loader.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._setLabelChanged(),this.event(g.Event.LOADED)}},{key:"labels",get:function(){return this._labels},set:function(t){if(this._labels!=t){if(this._labels=t,this.removeChildren(),this._setLabelChanged(),this._labels)for(var e=this._labels.split(","),i=0,a=e.length;i<a;i++){var n=this.createItem(this._skin,e[i]);n.name="item"+i,this.addChild(n)}this.initItems()}}},{key:"createItem",value:function(t,e){return null}},{key:"labelColors",get:function(){return this._labelColors},set:function(t){this._labelColors!=t&&(this._labelColors=t,this._setLabelChanged())}},{key:"labelStroke",get:function(){return this._labelStroke},set:function(t){this._labelStroke!=t&&(this._labelStroke=t,this._setLabelChanged())}},{key:"labelStrokeColor",get:function(){return this._labelStrokeColor},set:function(t){this._labelStrokeColor!=t&&(this._labelStrokeColor=t,this._setLabelChanged())}},{key:"strokeColors",get:function(){return this._strokeColors},set:function(t){this._strokeColors!=t&&(this._strokeColors=t,this._setLabelChanged())}},{key:"labelSize",get:function(){return this._labelSize},set:function(t){this._labelSize!=t&&(this._labelSize=t,this._setLabelChanged())}},{key:"stateNum",get:function(){return this._stateNum},set:function(t){this._stateNum!=t&&(this._stateNum=t,this._setLabelChanged())}},{key:"labelBold",get:function(){return this._labelBold},set:function(t){this._labelBold!=t&&(this._labelBold=t,this._setLabelChanged())}},{key:"labelFont",get:function(){return this._labelFont},set:function(t){this._labelFont!=t&&(this._labelFont=t,this._setLabelChanged())}},{key:"labelPadding",get:function(){return this._labelPadding},set:function(t){this._labelPadding!=t&&(this._labelPadding=t,this._setLabelChanged())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=t,this._setLabelChanged()}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._setLabelChanged()}},{key:"changeLabels",value:function(){if(this._labelChanged=!1,this._items)for(var t=0,e=0,i=this._items.length;e<i;e++){var a=this._items[e];this._skin&&(a.skin=this._skin),this._labelColors&&(a.labelColors=this._labelColors),this._labelSize&&(a.labelSize=this._labelSize),this._labelStroke&&(a.labelStroke=this._labelStroke),this._labelStrokeColor&&(a.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(a.strokeColors=this._strokeColors),this._labelBold&&(a.labelBold=this._labelBold),this._labelPadding&&(a.labelPadding=this._labelPadding),this._labelAlign&&(a.labelAlign=this._labelAlign),this._stateNum&&(a.stateNum=this._stateNum),this._labelFont&&(a.labelFont=this._labelFont),"horizontal"===this._direction?(a.y=0,a.x=t,t+=a.width+this._space):(a.x=0,a.y=t,t+=a.height+this._space)}this._sizeChanged()}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeLabels)}},{key:"items",get:function(){return this._items}},{key:"selection",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,s.default)(e=this._items).call(e,t)}},{key:"dataSource",get:function(){return(0,d.default)((0,v.default)(r.prototype),"dataSource",this)},set:function(t){this._dataSource=t,"number"==typeof t||"string"==typeof t?this.selectedIndex=(0,l.default)(t):t instanceof Array?this.labels=t.join(","):(0,c.default)((0,v.default)(r.prototype),"dataSource",t,this,!0)}},{key:"_setLabelChanged",value:function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))}}]),r}(p.Box);e.UIGroup=C,T.ILaya.regClass(C),k.ClassUtils.regClass("laya.ui.UIGroup",C),k.ClassUtils.regClass("Laya.UIGroup",C)},44451:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.UIUtils=void 0;var r=n(i(77766)),s=n(i(92762)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(66356),c=i(11179),d=i(57964),f=i(89432),_=function(){function t(){(0,l.default)(this,t)}return(0,o.default)(t,null,[{key:"fillArray",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=(0,r.default)(t).call(t);if(e)for(var n=e.split(","),s=0,l=Math.min(a.length,n.length);s<l;s++){var o=n[s];a[s]="true"==o||"false"!=o&&o,null!=i&&(a[s]=i(o))}return a}},{key:"toColor",value:function(t){return c.Utils.toHexColor(t)}},{key:"gray",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i?t.addFilter(e,t.grayFilter):t.clearFilter(e,h.ColorFilter)}},{key:"addFilter",value:function(t,e){var i=t.filters||[];i.push(e),t.filters=i}},{key:"clearFilter",value:function(t,e){var i=t.filters;if(null!=i&&i.length>0){for(var a=i.length-1;a>-1;a--)i[a]instanceof e&&(0,s.default)(i).call(i,a,1);t.filters=i}}},{key:"_getReplaceStr",value:function(e){return t.escapeSequence[e]}},{key:"adptString",value:function(e){return e.replace(/\\(\w)/g,t._getReplaceStr)}},{key:"getBindFun",value:function(e){t._funMap||(t._funMap=new d.WeakObject);var i=t._funMap.get(e);if(null==i){var a='"'+e+'"',n="(function(data){if(data==null)return;with(data){try{\nreturn "+(a=a.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";i=window.Laya._runScript(n),t._funMap.set(e,i)}return i}}]),t}();e.UIUtils=_,(0,u.default)(_,"grayFilter",new h.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])),(0,u.default)(_,"escapeSequence",{"\\n":"\n","\\t":"\t"}),(0,u.default)(_,"_funMap",null),f.ClassUtils.regClass("laya.ui.UIUtils",_),f.ClassUtils.regClass("Laya.UIUtils",_)},25563:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.VBox=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(52605)),d=r(i(13383)),f=r(i(78310)),_=r(i(82669)),v=r(i(17454)),y=i(67068),p=i(93561),g=i(89432);var m=function(t){(0,d.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,_.default)(e);if(i){var r=(0,_.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,f.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,v.default)((0,u.default)(e),"isSortItem",!1),e}return(0,o.default)(r,[{key:"width",get:function(){return(0,h.default)((0,_.default)(r.prototype),"width",this)},set:function(t){this._width!=t&&((0,c.default)((0,_.default)(r.prototype),"width",t,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var t=[],e=0,i=0,a=this.numChildren;i<a;i++){var n=this.getChildAt(i);n&&(t.push(n),e=this._width?this._width:Math.max(e,n.width*n.scaleX))}this.isSortItem&&this.sortItem(t);var s=0;for(i=0,a=t.length;i<a;i++)(n=t[i]).y=s,s+=n.height*n.scaleY+this._space,this._align==r.LEFT?n.x=0:this._align==r.CENTER?n.x=.5*(e-n.width*n.scaleX):this._align==r.RIGHT&&(n.x=e-n.width*n.scaleX);this._sizeChanged()}}]),r}(y.LayoutBox);e.VBox=m,(0,v.default)(m,"NONE","none"),(0,v.default)(m,"LEFT","left"),(0,v.default)(m,"CENTER","center"),(0,v.default)(m,"RIGHT","right"),p.ILaya.regClass(m),g.ClassUtils.regClass("laya.ui.VBox",m),g.ClassUtils.regClass("Laya.VBox",m)},12495:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.VScrollBar=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=i(31133),d=i(93561),f=i(89432);var _=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,l.default)(this,r),n.apply(this,arguments)}return(0,s.default)(r)}(c.ScrollBar);e.VScrollBar=_,d.ILaya.regClass(_),f.ClassUtils.regClass("laya.ui.VScrollBar",_),f.ClassUtils.regClass("Laya.VScrollBar",_)},49610:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.VSlider=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=i(46606),d=i(93561),f=i(89432);var _=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,l.default)(this,r),n.apply(this,arguments)}return(0,s.default)(r)}(c.Slider);e.VSlider=_,d.ILaya.regClass(_),f.ClassUtils.regClass("laya.ui.VSlider",_),f.ClassUtils.regClass("Laya.VSlider",_)},76486:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.View=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(88792),v=i(57650),y=i(53417),p=i(23699),g=i(63969),m=i(65810),x=i(65869),T=i(32673),k=i(68209),C=i(130),S=i(73175),E=i(96567),M=i(33175),L=i(89175),b=i(60414),I=i(2075),R=i(89800),w=i(49537),A=i(85741),B=i(60008),D=i(56059),P=i(34461),F=i(26735),O=i(49501),U=i(2795),N=i(31133),G=i(46606),H=i(40448),W=i(12495),V=i(49610),Y=i(20186),X=i(38252),z=i(25563),K=i(84127),j=i(93561),q=i(89432);var Z=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this,!1),(0,f.default)((0,o.default)(t),"_watchMap",{}),(0,f.default)((0,o.default)(t),"_anchorX",NaN),(0,f.default)((0,o.default)(t),"_anchorY",NaN),t._widget=_.Widget.EMPTY,t.createChildren(),t}return(0,l.default)(r,[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._watchMap=null,(0,u.default)((0,d.default)(r.prototype),"destroy",this).call(this,t)}},{key:"changeData",value:function(t){var e=this._watchMap[t];if(e)for(var i=0,a=e.length;i<a;i++)e[i].exe(this)}},{key:"top",get:function(){return this._widget.top},set:function(t){t!=this._widget.top&&(this._getWidget().top=t)}},{key:"bottom",get:function(){return this._widget.bottom},set:function(t){t!=this._widget.bottom&&(this._getWidget().bottom=t)}},{key:"left",get:function(){return this._widget.left},set:function(t){t!=this._widget.left&&(this._getWidget().left=t)}},{key:"right",get:function(){return this._widget.right},set:function(t){t!=this._widget.right&&(this._getWidget().right=t)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(t){t!=this._widget.centerX&&(this._getWidget().centerX=t)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(t){t!=this._widget.centerY&&(this._getWidget().centerY=t)}},{key:"anchorX",get:function(){return this._anchorX},set:function(t){this._anchorX!=t&&(this._anchorX=t,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this._anchorY},set:function(t){this._anchorY!=t&&(this._anchorY=t,this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(g.Event.RESIZE)}},{key:"_getWidget",value:function(){return this._widget===_.Widget.EMPTY&&(this._widget=this.addComponent(_.Widget)),this._widget}},{key:"loadUI",value:function(t){var e=r.uiMap[t];r.uiMap&&this.createView(e)}},{key:"dataSource",get:function(){return this._dataSource},set:function(t){for(var e in this._dataSource=t,t){var i=this.getChildByName(e);i instanceof b.UIComponent?i.dataSource=t[e]:!(e in this)||this[e]instanceof Function||(this[e]=t[e])}}}],[{key:"__init__",value:function(){j.ILaya.ClassUtils.regShortClassName([I.ViewStack,x.Button,R.TextArea,w.ColorPicker,m.Box,A.ScaleBox,T.CheckBox,B.Clip,D.ComboBox,b.UIComponent,P.HScrollBar,F.HSlider,k.Image,C.Label,O.List,U.Panel,S.ProgressBar,E.Radio,M.RadioGroup,N.ScrollBar,G.Slider,L.Tab,H.TextInput,r,W.VScrollBar,V.VSlider,Y.Tree,X.HBox,z.VBox,v.Animation,p.Text,K.FontClip])}},{key:"regComponent",value:function(t,e){j.ILaya.ClassUtils.regClass(t,e)}},{key:"regViewRuntime",value:function(t,e){j.ILaya.ClassUtils.regClass(t,e)}},{key:"regUI",value:function(t,e){j.ILaya.loader.cacheRes(t,e)}}]),r}(y.Scene);e.View=Z,(0,f.default)(Z,"uiMap",{}),j.ILaya.regClass(Z),q.ClassUtils.regClass("laya.ui.View",Z),q.ClassUtils.regClass("Laya.View",Z)},2075:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ViewStack=void 0;var s=r(i(77766)),l=r(i(81643)),o=r(i(94198)),u=r(i(87368)),h=r(i(28146)),c=r(i(43714)),d=r(i(92135)),f=r(i(13383)),_=r(i(78310)),v=r(i(82669)),y=r(i(17454)),p=i(65810),g=i(35696),m=i(93561),x=i(89432);var T=function(t){(0,f.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,v.default)(e);if(i){var r=(0,v.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,_.default)(this,t)});function r(){var t,e;(0,u.default)(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,y.default)((0,c.default)(e),"_setIndexHandler",g.Handler.create((0,c.default)(e),e.setIndex,null,!1)),e}return(0,h.default)(r,[{key:"setItems",value:function(t){this.removeChildren();for(var e=0,i=0,a=t.length;i<a;i++){var n=t[i];n&&(n.name="item"+e,this.addChild(n),e++)}this.initItems()}},{key:"addItem",value:function(t){t.name="item"+this._items.length,this.addChild(t),this.initItems()}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items=[];for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(null==e)break;this._items.push(e),e.visible=t==this._selectedIndex}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=t,this.setSelect(this._selectedIndex,!0))}},{key:"setSelect",value:function(t,e){this._items&&t>-1&&t<this._items.length&&(this._items[t].visible=e)}},{key:"selection",get:function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(t){var e;this.selectedIndex=(0,l.default)(e=this._items).call(e,t)}},{key:"setIndexHandler",get:function(){return this._setIndexHandler},set:function(t){this._setIndexHandler=t}},{key:"setIndex",value:function(t){this.selectedIndex=t}},{key:"items",get:function(){return this._items}},{key:"dataSource",get:function(){return(0,d.default)((0,v.default)(r.prototype),"dataSource",this)},set:function(t){if(this._dataSource=t,"number"==typeof t||"string"==typeof t)this.selectedIndex=(0,o.default)(t);else for(var e in this._dataSource)e in this&&(this[e]=this._dataSource[e])}}]),r}(p.Box);e.ViewStack=T,m.ILaya.regClass(T),x.ClassUtils.regClass("laya.ui.ViewStack",T),x.ClassUtils.regClass("Laya.ViewStack",T)},88792:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Widget=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(65098),v=i(63969),y=i(93561),p=i(89432);var g=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,f.default)((0,u.default)(e),"_top",NaN),(0,f.default)((0,u.default)(e),"_bottom",NaN),(0,f.default)((0,u.default)(e),"_left",NaN),(0,f.default)((0,u.default)(e),"_right",NaN),(0,f.default)((0,u.default)(e),"_centerX",NaN),(0,f.default)((0,u.default)(e),"_centerY",NaN),e}return(0,o.default)(r,[{key:"onReset",value:function(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=NaN}},{key:"_onEnable",value:function(){this.owner.parent?this._onAdded():this.owner.once(v.Event.ADDED,this,this._onAdded)}},{key:"_onDisable",value:function(){this.owner.off(v.Event.ADDED,this,this._onAdded),this.owner.parent&&this.owner.parent.off(v.Event.RESIZE,this,this._onParentResize)}},{key:"_onAdded",value:function(){this.owner.parent&&this.owner.parent.on(v.Event.RESIZE,this,this._onParentResize),this.resetLayoutX(),this.resetLayoutY()}},{key:"_onParentResize",value:function(){var t=this.resetLayoutX(),e=this.resetLayoutY();(t||e)&&this.owner.event(v.Event.RESIZE)}},{key:"resetLayoutX",value:function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerX)){if(isNaN(this.left))isNaN(this.right)||(t.x=Math.round(e.width-t.displayWidth-this.right+t.pivotX*t.scaleX));else if(t.x=Math.round(this.left+t.pivotX*t.scaleX),!isNaN(this.right)){var i=(e._width-this.left-this.right)/(t.scaleX||.01);if(i!=t.width)return t.width=i,!0}}else t.x=Math.round(.5*(e.width-t.displayWidth)+this.centerX+t.pivotX*t.scaleX);return!1}},{key:"resetLayoutY",value:function(){var t=this.owner;if(!t)return!1;var e=t.parent;if(e)if(isNaN(this.centerY)){if(isNaN(this.top))isNaN(this.bottom)||(t.y=Math.round(e.height-t.displayHeight-this.bottom+t.pivotY*t.scaleY));else if(t.y=Math.round(this.top+t.pivotY*t.scaleY),!isNaN(this.bottom)){var i=(e._height-this.top-this.bottom)/(t.scaleY||.01);if(i!=t.height)return t.height=i,!0}}else t.y=Math.round(.5*(e.height-t.displayHeight)+this.centerY+t.pivotY*t.scaleY);return!1}},{key:"resetLayout",value:function(){this.owner&&(this.resetLayoutX(),this.resetLayoutY())}},{key:"top",get:function(){return this._top},set:function(t){this._top!=t&&(this._top=t,this.resetLayoutY())}},{key:"bottom",get:function(){return this._bottom},set:function(t){this._bottom!=t&&(this._bottom=t,this.resetLayoutY())}},{key:"left",get:function(){return this._left},set:function(t){this._left!=t&&(this._left=t,this.resetLayoutX())}},{key:"right",get:function(){return this._right},set:function(t){this._right!=t&&(this._right=t,this.resetLayoutX())}},{key:"centerX",get:function(){return this._centerX},set:function(t){this._centerX!=t&&(this._centerX=t,this.resetLayoutX())}},{key:"centerY",get:function(){return this._centerY},set:function(t){this._centerY!=t&&(this._centerY=t,this.resetLayoutY())}}]),r}(_.Component);e.Widget=g,(0,f.default)(g,"EMPTY",null),y.ILaya.regClass(g),g.EMPTY=new g,p.ClassUtils.regClass("laya.ui.Widget",g),p.ClassUtils.regClass("Laya.Widget",g)},27175:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Browser=void 0;var r=n(i(81643)),s=n(i(11128)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(93561),c=function(){function t(){(0,l.default)(this,t)}return(0,o.default)(t,null,[{key:"__init__",value:function(){var e=window.Laya||h.ILaya.Laya;if(t._window)return t._window;var i=t._window=window,a=t._document=i.document,n=t.userAgent=i.navigator.userAgent,s=i.navigator.maxTouchPoints||0,l=i.navigator.platform;"my"in t.window&&((0,r.default)(n).call(n,"TB/")>-1||(0,r.default)(n).call(n,"Taobao/")>-1||(0,r.default)(n).call(n,"TM/")>-1?(window.tbMiniGame(e,e),e.TBMiniAdapter?e.TBMiniAdapter.enable():console.error("请先添加淘宝适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0")):(0,r.default)(n).call(n,"AlipayMiniGame")>-1&&(window.aliPayMiniGame(e,e),e.ALIMiniAdapter?e.ALIMiniAdapter.enable():console.error("请先添加阿里小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-6-0"))),-1==(0,r.default)(n).call(n,"OPPO")&&(0,r.default)(n).call(n,"MiniGame")>-1&&"wx"in t.window&&("tt"in t.window?(window.ttMiniGame(e,e),e.TTMiniAdapter?e.TTMiniAdapter.enable():console.error("请引入字节跳动小游戏的适配库")):"bl"in t.window?(window.biliMiniGame(e,e),e.BLMiniAdapter?e.BLMiniAdapter.enable():console.error("请引入bilibili小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-7-0")):"qq"in t.window?(window.qqMiniGame(e,e),e.QQMiniAdapter?e.QQMiniAdapter.enable():console.error("请引入手机QQ小游戏的适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-0-0")):(window.wxMiniGame(e,e),e.MiniAdpter?e.MiniAdpter.enable():console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0"))),"hbs"in t.window&&(window.hwMiniGame(e,e),e.HWMiniAdapter?e.HWMiniAdapter.enable():console.error("请先添加小游戏适配库!")),(0,r.default)(n).call(n,"SwanGame")>-1&&(window.bdMiniGame(e,e),e.BMiniAdapter?e.BMiniAdapter.enable():console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-1-0")),(0,r.default)(n).call(n,"QuickGame")>-1&&(window.miMiniGame(e,e),e.KGMiniAdapter?e.KGMiniAdapter.enable():console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-2-0")),(0,r.default)(n).call(n,"OPPO")>-1&&(0,r.default)(n).call(n,"MiniGame")>-1&&(window.qgMiniGame(e,e),e.QGMiniAdapter?e.QGMiniAdapter.enable():console.error("请先添加OPPO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-3-0")),(0,r.default)(n).call(n,"VVGame")>-1&&(window.vvMiniGame(e,e),e.VVMiniAdapter?e.VVMiniAdapter.enable():console.error("请先添加VIVO小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?language=zh&nav=zh-ts-5-4-0")),i.trace=console.log,i.requestAnimationFrame=i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame||function(t){return i.setTimeout(t,1e3/60)};var o=a.body.style;o.margin=0,o.overflow="hidden",o["-webkit-user-select"]="none",o["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";for(var u=a.getElementsByTagName("meta"),c=0,d=!1,f="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";c<u.length;){var _=u[c];if("viewport"==_.name){_.content=f,d=!0;break}c++}return d||((_=a.createElement("meta")).name="viewport",_.content=f,a.getElementsByTagName("head")[0].appendChild(_)),t.onMobile=!!window.conch||(0,r.default)(n).call(n,"Mobile")>-1,t.onIOS=!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),t.onIPhone=(0,r.default)(n).call(n,"iPhone")>-1,t.onMac=(0,r.default)(n).call(n,"Mac OS X")>-1,t.onIPad=(0,r.default)(n).call(n,"iPad")>-1||"MacIntel"===l&&s>1,t.onAndroid=(0,r.default)(n).call(n,"Android")>-1||(0,r.default)(n).call(n,"Adr")>-1,t.onWP=(0,r.default)(n).call(n,"Windows Phone")>-1,t.onQQBrowser=(0,r.default)(n).call(n,"QQBrowser")>-1,t.onMQQBrowser=(0,r.default)(n).call(n,"MQQBrowser")>-1||(0,r.default)(n).call(n,"Mobile")>-1&&(0,r.default)(n).call(n,"QQ")>-1,t.onIE=!!i.ActiveXObject||"ActiveXObject"in i,t.onWeiXin=(0,r.default)(n).call(n,"MicroMessenger")>-1,t.onSafari=(0,r.default)(n).call(n,"Safari")>-1,t.onPC=!t.onMobile,t.onMiniGame=(0,r.default)(n).call(n,"MiniGame")>-1,t.onBDMiniGame=(0,r.default)(n).call(n,"SwanGame")>-1,t.onLayaRuntime=!!window.conch,(0,r.default)(n).call(n,"OPPO")>-1&&(0,r.default)(n).call(n,"MiniGame")>-1?(t.onQGMiniGame=!0,t.onMiniGame=!1):"qq"in t.window&&(0,r.default)(n).call(n,"MiniGame")>-1?(t.onQQMiniGame=!0,t.onMiniGame=!1):"bl"in t.window&&(0,r.default)(n).call(n,"MiniGame")>-1?(t.onBLMiniGame=!0,t.onMiniGame=!1):"tt"in t.window&&(0,r.default)(n).call(n,"MiniGame")>-1&&(t.onTTMiniGame=!0,t.onMiniGame=!1),t.onHWMiniGame="hbs"in t.window,t.onVVMiniGame=(0,r.default)(n).call(n,"VVGame")>-1,t.onKGMiniGame=(0,r.default)(n).call(n,"QuickGame")>-1,(0,r.default)(n).call(n,"AlipayMiniGame")>-1&&(t.onAlipayMiniGame=!0,t.onMiniGame=!1),((0,r.default)(n).call(n,"TB/")>-1||(0,r.default)(n).call(n,"Taobao/")>-1||(0,r.default)(n).call(n,"TM/")>-1)&&(t.onTBMiniGame=!0),i}},{key:"_isMiniGame",get:function(){return t.onMiniGame||t.onBDMiniGame||t.onQGMiniGame||t.onKGMiniGame||t.onVVMiniGame||t.onAlipayMiniGame||t.onQQMiniGame||t.onBLMiniGame||t.onTTMiniGame||t.onHWMiniGame||t.onTBMiniGame}},{key:"createElement",value:function(e){return t.__init__(),t._document.createElement(e)}},{key:"getElementById",value:function(e){return t.__init__(),t._document.getElementById(e)}},{key:"removeElement",value:function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"now",value:function(){return(0,s.default)()}},{key:"clientWidth",get:function(){return t.__init__(),t._window.innerWidth||t._document.body.clientWidth}},{key:"clientHeight",get:function(){return t.__init__(),t._window.innerHeight||t._document.body.clientHeight||t._document.documentElement.clientHeight}},{key:"width",get:function(){return t.__init__(),(h.ILaya.stage&&h.ILaya.stage.canvasRotation?t.clientHeight:t.clientWidth)*t.pixelRatio}},{key:"height",get:function(){return t.__init__(),(h.ILaya.stage&&h.ILaya.stage.canvasRotation?t.clientWidth:t.clientHeight)*t.pixelRatio}},{key:"pixelRatio",get:function(){var e;return t._pixelRatio<0&&(t.__init__(),(0,r.default)(e=t.userAgent).call(e,"Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1?t._pixelRatio=2:(t._pixelRatio=t._window.devicePixelRatio||1,t._pixelRatio<1&&(t._pixelRatio=1))),t._pixelRatio}},{key:"container",get:function(){return t._container||(t.__init__(),t._container=t.createElement("div"),t._container.id="layaContainer",t._document.body.appendChild(t._container)),t._container},set:function(e){t._container=e}},{key:"window",get:function(){return t._window||t.__init__()}},{key:"document",get:function(){return t.__init__(),t._document}}]),t}();e.Browser=c,(0,u.default)(c,"_pixelRatio",-1),(0,u.default)(c,"mainCanvas",null),(0,u.default)(c,"hanzi",new RegExp("^[一-龥]$")),(0,u.default)(c,"fontMap",{}),(0,u.default)(c,"measureText",(function(t,e){var i=c.hanzi.test(t);if(i&&c.fontMap[e])return c.fontMap[e];var a=c.context;a.font=e;var n=a.measureText(t);return i&&(c.fontMap[e]=n),n}))},8245:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Byte=void 0;var r=n(i(3649)),s=n(i(98926)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(5866),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,l.default)(this,t),(0,u.default)(this,"_xd_",!0),(0,u.default)(this,"_allocated_",8),(0,u.default)(this,"_pos_",0),(0,u.default)(this,"_length",0),e?(this._u8d_=new Uint8Array(e),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}return(0,o.default)(t,[{key:"buffer",get:function(){var t=this._d_.buffer;return t.byteLength===this._length?t:(0,r.default)(t).call(t,0,this._length)}},{key:"endian",get:function(){return this._xd_?t.LITTLE_ENDIAN:t.BIG_ENDIAN},set:function(e){this._xd_=e===t.LITTLE_ENDIAN}},{key:"length",get:function(){return this._length},set:function(t){this._allocated_<t?this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,2*this._allocated_))):this._allocated_>t&&this._resizeBuffer(this._allocated_=t),this._length=t}},{key:"_resizeBuffer",value:function(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}}},{key:"getString",value:function(){return this.readString()}},{key:"readString",value:function(){return this._rUTF(this.getUint16())}},{key:"getFloat32Array",value:function(t,e){return this.readFloat32Array(t,e)}},{key:"readFloat32Array",value:function(t,e){var i,a=t+e;a=a>this._length?this._length:a;var n=new Float32Array((0,r.default)(i=this._d_.buffer).call(i,t,a));return this._pos_=a,n}},{key:"getUint8Array",value:function(t,e){return this.readUint8Array(t,e)}},{key:"readUint8Array",value:function(t,e){var i,a=t+e;a=a>this._length?this._length:a;var n=new Uint8Array((0,r.default)(i=this._d_.buffer).call(i,t,a));return this._pos_=a,n}},{key:"getInt16Array",value:function(t,e){return this.readInt16Array(t,e)}},{key:"readInt16Array",value:function(t,e){var i,a=t+e;a=a>this._length?this._length:a;var n=new Int16Array((0,r.default)(i=this._d_.buffer).call(i,t,a));return this._pos_=a,n}},{key:"getFloat32",value:function(){return this.readFloat32()}},{key:"readFloat32",value:function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"getFloat64",value:function(){return this.readFloat64()}},{key:"readFloat64",value:function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,t}},{key:"writeFloat32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"writeFloat64",value:function(t){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,t,this._xd_),this._pos_+=8}},{key:"getInt32",value:function(){return this.readInt32()}},{key:"readInt32",value:function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"getUint32",value:function(){return this.readUint32()}},{key:"readUint32",value:function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,t}},{key:"writeInt32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"writeUint32",value:function(t){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,t,this._xd_),this._pos_+=4}},{key:"getInt16",value:function(){return this.readInt16()}},{key:"readInt16",value:function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,t}},{key:"getUint16",value:function(){return this.readUint16()}},{key:"readUint16",value:function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,t}},{key:"writeUint16",value:function(t){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,t,this._xd_),this._pos_+=2}},{key:"writeInt16",value:function(t){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,t,this._xd_),this._pos_+=2}},{key:"getUint8",value:function(){return this.readUint8()}},{key:"readUint8",value:function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}},{key:"writeUint8",value:function(t){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,t),this._pos_++}},{key:"_getUInt8",value:function(t){return this._readUInt8(t)}},{key:"_readUInt8",value:function(t){return this._d_.getUint8(t)}},{key:"_getUint16",value:function(t){return this._readUint16(t)}},{key:"_readUint16",value:function(t){return this._d_.getUint16(t,this._xd_)}},{key:"_getMatrix",value:function(){return this._readMatrix()}},{key:"_readMatrix",value:function(){return new h.Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())}},{key:"_rUTF",value:function(t){var e,i,a=this._pos_+t,n=String.fromCharCode,r=this._u8d_,s=[],l=0;for(s.length=1e3;this._pos_<a;)if((e=r[this._pos_++])<128)0!=e&&(s[l++]=n(e));else if(e<224)s[l++]=n((63&e)<<6|127&r[this._pos_++]);else if(e<240)i=r[this._pos_++],s[l++]=n((31&e)<<12|(127&i)<<6|127&r[this._pos_++]);else{var o=(15&e)<<18|(127&(i=r[this._pos_++]))<<12|(127&r[this._pos_++])<<6|127&r[this._pos_++];if(o>=65536){var u=o-65536,h=55296|u>>10,c=56320|1023&u;s[l++]=n(h),s[l++]=n(c)}else s[l++]=n(o)}return s.length=l,s.join("")}},{key:"getCustomString",value:function(t){return this.readCustomString(t)}},{key:"readCustomString",value:function(t){for(var e,i="",a=0,n=String.fromCharCode,r=this._u8d_;t>0;)if((e=r[this._pos_])<128)i+=n(e),this._pos_++,t--;else for(a=e-128,this._pos_++,t-=a;a>0;)e=r[this._pos_++],i+=n(r[this._pos_++]<<8|e),a--;return i}},{key:"pos",get:function(){return this._pos_},set:function(t){this._pos_=t}},{key:"bytesAvailable",get:function(){return this._length-this._pos_}},{key:"clear",value:function(){this._pos_=0,this.length=0}},{key:"__getBuffer",value:function(){return this._d_.buffer}},{key:"writeUTFBytes",value:function(t){for(var e=0,i=(t+="").length;e<i;e++){var a=t.charCodeAt(e);if(a<=127)this.writeByte(a);else if(a<=2047)this._ensureWrite(this._pos_+2),this._u8d_.set([192|a>>6,128|63&a],this._pos_),this._pos_+=2;else if(a>=55296&&a<=56319){e++;var n=t.charCodeAt(e);if(!(0,s.default)(n)&&n>=56320&&n<=57343){var r=64+(1023&a),l=1023&n,o=240|r>>8&63,u=128|r>>2&63,h=128|(3&r)<<4|l>>6&15,c=128|63&l;this._ensureWrite(this._pos_+4),this._u8d_.set([o,u,h,c],this._pos_),this._pos_+=4}}else a<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|a>>12,128|a>>6&63,128|63&a],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a],this._pos_),this._pos_+=4)}}},{key:"writeUTFString",value:function(t){var e=this.pos;this.writeUint16(1),this.writeUTFBytes(t);var i=this.pos-e-2;this._d_.setUint16(e,i,this._xd_)}},{key:"writeUTFString32",value:function(t){var e=this.pos;this.writeUint32(1),this.writeUTFBytes(t);var i=this.pos-e-4;this._d_.setUint32(e,i,this._xd_)}},{key:"readUTFString",value:function(){return this.readUTFBytes(this.getUint16())}},{key:"readUTFString32",value:function(){return this.readUTFBytes(this.getUint32())}},{key:"getUTFString",value:function(){return this.readUTFString()}},{key:"readUTFBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(0===t)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";return t=t>0?t:e,this._rUTF(t)}},{key:"getUTFBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.readUTFBytes(t)}},{key:"writeByte",value:function(t){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,t),this._pos_+=1}},{key:"readByte",value:function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}},{key:"getByte",value:function(){return this.readByte()}},{key:"_ensureWrite",value:function(t){this._length<t&&(this._length=t),this._allocated_<t&&(this.length=t)}},{key:"writeArrayBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e<0||i<0)throw"writeArrayBuffer error - Out of bounds";0==i&&(i=t.byteLength-e),this._ensureWrite(this._pos_+i);var a=new Uint8Array(t);this._u8d_.set(a.subarray(e,e+i),this._pos_),this._pos_+=i}},{key:"readArrayBuffer",value:function(t){var e,i;return i=(0,r.default)(e=this._u8d_.buffer).call(e,this._pos_,this._pos_+t),this._pos_=this._pos_+t,i}}],[{key:"getSystemEndian",value:function(){if(!t._sysEndian){var e=new ArrayBuffer(2);new DataView(e).setInt16(0,256,!0),t._sysEndian=256===new Int16Array(e)[0]?t.LITTLE_ENDIAN:t.BIG_ENDIAN}return t._sysEndian}}]),t}();e.Byte=c,(0,u.default)(c,"BIG_ENDIAN","bigEndian"),(0,u.default)(c,"LITTLE_ENDIAN","littleEndian"),(0,u.default)(c,"_sysEndian",null)},68173:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.CacheManger=void 0;var r=n(i(92762)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(93561),h=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"regCacheByFunction",value:function(e,i){var a;t.unRegCacheByFunction(e,i),a={tryDispose:e,getCacheList:i},t._cacheList.push(a)}},{key:"unRegCacheByFunction",value:function(e,i){var a,n;for(n=t._cacheList.length,a=0;a<n;a++){var s;if(t._cacheList[a].tryDispose==e&&t._cacheList[a].getCacheList==i)return void(0,r.default)(s=t._cacheList).call(s,a,1)}}},{key:"forceDispose",value:function(){var e,i=t._cacheList.length;for(e=0;e<i;e++)t._cacheList[e].tryDispose(!0)}},{key:"beginCheck",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;u.ILaya.systemTimer.loop(e,null,t._checkLoop)}},{key:"stopCheck",value:function(){u.ILaya.systemTimer.clear(null,t._checkLoop)}},{key:"_checkLoop",value:function(){var e=t._cacheList;if(!(e.length<1)){var i,a,n=u.ILaya.Browser.now();for(a=i=e.length;i>0&&(t._index++,t._index=t._index%a,e[t._index].tryDispose(!1),!(u.ILaya.Browser.now()-n>t.loopTimeLimit));)i--}}}]),t}();e.CacheManger=h,(0,o.default)(h,"loopTimeLimit",2),(0,o.default)(h,"_cacheList",[]),(0,o.default)(h,"_index",0)},37444:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.CallLater=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(93561),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_pool",[]),(0,l.default)(this,"_map",{}),(0,l.default)(this,"_laters",[])}return(0,s.default)(t,[{key:"_update",value:function(){var t=this._laters,e=t.length;if(e>0){for(var i=0,a=e-1;i<=a;i++){var n=t[i];this._map[n.key]=null,null!==n.method&&(n.run(),n.clear()),this._pool.push(n),i===a&&(a=t.length-1)}t.length=0}}},{key:"_getHandler",value:function(t,e){var i=t?t.$_GID||(t.$_GID=o.ILaya.Utils.getGID()):0,a=e.$_TID||(e.$_TID=o.ILaya.Timer._mid++);return this._map[i+"."+a]}},{key:"callLater",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==this._getHandler(t,e)){var a;(a=this._pool.length?this._pool.pop():new h).caller=t,a.method=e,a.args=i;var n=t?t.$_GID:0,r=e.$_TID;a.key=n+"."+r,this._map[a.key]=a,this._laters.push(a)}}},{key:"runCallLater",value:function(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(),i.clear())}}]),t}();e.CallLater=u,(0,l.default)(u,"I",new u);var h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(){var t=this.caller;if(t&&t.destroyed)return this.clear();var e=this.method,i=this.args;null!=e&&(i?e.apply(t,i):e.call(t))}}]),t}()},89432:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ClassUtils=void 0;var r=n(i(31238)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(5866),h=i(22010),c=i(93561),d=i(89570),f=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"regClass",value:function(e,i){t._classMap[e]=i}},{key:"regShortClassName",value:function(e){for(var i=0;i<e.length;i++){var a=e[i],n=a.name;t._classMap[n]=a}}},{key:"getRegClass",value:function(e){return t._classMap[e]}},{key:"getClass",value:function(e){var i=t._classMap[e]||t._classMap["Laya."+e]||e,a=c.ILaya.Laya;return"string"==typeof i?c.ILaya.__classMap[i]||a[e]:i}},{key:"getInstance",value:function(e){var i=t.getClass(e);return i?new i:(console.warn("[error] Undefined class:",e),null)}},{key:"createByJson",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;"string"==typeof e&&(e=JSON.parse(e));var s=e.props;if(!i&&!(i=r?r.runWith(e):t.getInstance(s.runtime||e.type)))return null;var l=e.child;if(l)for(var o=0,u=l.length;o<u;o++){var h=l[o];if("render"!==h.props.name&&"render"!==h.props.renderType||!i._$set_itemRender)if("Graphic"==h.type)t._addGraphicsToSprite(h,i);else if(t._isDrawType(h.type))t._addGraphicToSprite(h,i,!0);else{var c=t.createByJson(h,null,a,n,r);"Script"===h.type?"owner"in c?c.owner=i:"target"in c&&(c.target=i):"mask"==h.props.renderType?i.mask=c:i.addChild(c)}else i.itemRender=h}if(s)for(var d in s){var f=s[d];"var"===d&&a?a[f]=i:f instanceof Array&&i[d]instanceof Function?i[d].apply(i,f):i[d]=f}return n&&e.customProps&&n.runWith([i,e]),i.created&&i.created(),i}},{key:"_addGraphicsToSprite",value:function(e,i){var a=e.child;if(a&&!(a.length<1)){var n,r,s=t._getGraphicsFromSprite(e,i),l=0,o=0;for(e.props&&(l=t._getObjVar(e.props,"x",0),o=t._getObjVar(e.props,"y",0)),0!=l&&0!=o&&s.translate(l,o),r=a.length,n=0;n<r;n++)t._addGraphicToGraphics(a[n],s);0!=l&&0!=o&&s.translate(-l,-o)}}},{key:"_addGraphicToSprite",value:function(e,i){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=a?t._getGraphicsFromSprite(e,i):i.graphics;t._addGraphicToGraphics(e,n)}},{key:"_getGraphicsFromSprite",value:function(t,e){if(!t||!t.props)return e.graphics;var i=t.props.renderType;if("hit"===i||"unHit"===i){var a=e._style.hitArea||(e.hitArea=new d.HitArea);a[i]||(a[i]=new h.Graphics);var n=a[i]}return n||(n=e.graphics),n}},{key:"_getTransformData",value:function(e){var i;("pivotX"in e||"pivotY"in e)&&(i=i||new u.Matrix).translate(-t._getObjVar(e,"pivotX",0),-t._getObjVar(e,"pivotY",0));var a=t._getObjVar(e,"scaleX",1),n=t._getObjVar(e,"scaleY",1),r=t._getObjVar(e,"rotation",0);return t._getObjVar(e,"skewX",0),t._getObjVar(e,"skewY",0),1==a&&1==n&&0==r||((i=i||new u.Matrix).scale(a,n),i.rotate(.0174532922222222*r)),i}},{key:"_addGraphicToGraphics",value:function(e,i){var a,n;if((a=e.props)&&(n=t.DrawTypeDic[e.type])){var r=i,s=t._getParams(a,n[1],n[2],n[3]),l=t._tM;(l||1!=t._alpha)&&(r.save(),l&&r.transform(l),1!=t._alpha&&r.alpha(t._alpha)),r[n[0]].apply(r,s),(l||1!=t._alpha)&&r.restore()}}},{key:"_adptLineData",value:function(t){return t[2]=(0,r.default)(t[0])+(0,r.default)(t[2]),t[3]=(0,r.default)(t[1])+(0,r.default)(t[3]),t}},{key:"_adptTextureData",value:function(t){return t[0]=c.ILaya.Loader.getRes(t[0]),t}},{key:"_adptLinesData",value:function(e){return e[2]=t._getPointListByStr(e[2]),e}},{key:"_isDrawType",value:function(e){return"Image"!==e&&e in t.DrawTypeDic}},{key:"_getParams",value:function(e,i){var a,n,r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=t._temParam;for(o.length=i.length,n=i.length,a=0;a<n;a++)o[a]=t._getObjVar(e,i[a][0],i[a][1]);return t._alpha=t._getObjVar(e,"alpha",1),(r=t._getTransformData(e))?(s||(s=0),r.translate(o[s],o[s+1]),o[s]=o[s+1]=0,t._tM=r):t._tM=null,l&&t[l]&&(o=t[l](o)),o}},{key:"_getPointListByStr",value:function(t){var e,i,a=t.split(",");for(i=a.length,e=0;e<i;e++)a[e]=(0,r.default)(a[e]);return a}},{key:"_getObjVar",value:function(t,e,i){return e in t?t[e]:i}}]),t}();e.ClassUtils=f,(0,o.default)(f,"DrawTypeDic",{Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}),(0,o.default)(f,"_temParam",[]),(0,o.default)(f,"_classMap",{})},53546:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ColorUtils=void 0;var r=n(i(81643)),s=n(i(31238)),l=n(i(94198)),o=n(i(87368)),u=n(i(28146)),h=n(i(17454)),c=i(11179),d=function(){function t(e){var i,a,n,u,d,f;if((0,o.default)(this,t),(0,h.default)(this,"arrColor",[]),null==e||"none"==e)return this.strColor="#00000000",this.numColor=0,void(this.arrColor=[0,0,0,0]);if("string"==typeof e)if((0,r.default)(d=e).call(d,"rgba(")>=0||(0,r.default)(f=e).call(f,"rgb(")>=0){var _,v,y=e;for(_=(0,r.default)(y).call(y,"("),v=(0,r.default)(y).call(y,")"),y=y.substring(_+1,v),this.arrColor=y.split(","),n=this.arrColor.length,a=0;a<n;a++)this.arrColor[a]=(0,s.default)(this.arrColor[a]),a<3&&(this.arrColor[a]=Math.round(this.arrColor[a]));u=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2],this.strColor=e}else{if(this.strColor=e,"#"===e.charAt(0)&&(e=e.substr(1)),3===(n=e.length)||4===n){var p="";for(a=0;a<n;a++)p+=e[a]+e[a];e=p}u=(0,l.default)(e,16)}else u=e,this.strColor=c.Utils.toHexColor(u);(0,r.default)(i=this.strColor).call(i,"rgba")>=0||9===this.strColor.length?(this.arrColor=[((4278190080&u)>>>24)/255,((16711680&u)>>16)/255,((65280&u)>>8)/255,(255&u)/255],this.numColor=(4278190080&u)>>>24|(16711680&u)>>8|(65280&u)<<8|(255&u)<<24):(this.arrColor=[((16711680&u)>>16)/255,((65280&u)>>8)/255,(255&u)/255,1],this.numColor=4278190080|(16711680&u)>>16|65280&u|(255&u)<<16),this.arrColor.__id=++t._COLODID}return(0,u.default)(t,null,[{key:"_initDefault",value:function(){for(var e in t._DEFAULT={},t._COLOR_MAP)t._SAVE[e]=t._DEFAULT[e]=new t(t._COLOR_MAP[e]);return t._DEFAULT}},{key:"_initSaveMap",value:function(){for(var e in t._SAVE_SIZE=0,t._SAVE={},t._DEFAULT)t._SAVE[e]=t._DEFAULT[e]}},{key:"create",value:function(e){var i=e+"",a=t._SAVE[i];return null!=a?a:(t._SAVE_SIZE<1e3&&t._initSaveMap(),t._SAVE[i]=new t(e))}}]),t}();e.ColorUtils=d,(0,h.default)(d,"_SAVE",{}),(0,h.default)(d,"_SAVE_SIZE",0),(0,h.default)(d,"_COLOR_MAP",{purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"}),(0,h.default)(d,"_DEFAULT",d._initDefault()),(0,h.default)(d,"_COLODID",1)},50528:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Dragging=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(63969),u=i(70153),h=i(93561),c=i(96060),d=i(35696),f=i(42461),_=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"ratio",.92),(0,l.default)(this,"maxOffset",60),(0,l.default)(this,"_dragging",!1),(0,l.default)(this,"_clickOnly",!0)}return(0,s.default)(t,[{key:"start",value:function(t,e,i,a,n,r,s){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:.92;this.clearTimer(),this.target=t,this.area=e,this.hasInertia=i,this.elasticDistance=e?a:0,this.elasticBackTime=n,this.data=r,this._disableMouseEvent=s,this.ratio=l,this._parent=t.parent,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,h.ILaya.stage.on(o.Event.MOUSE_UP,this,this.onStageMouseUp),h.ILaya.stage.on(o.Event.MOUSE_OUT,this,this.onStageMouseUp),h.ILaya.systemTimer.frameLoop(1,this,this.loop)}},{key:"clearTimer",value:function(){h.ILaya.systemTimer.clear(this,this.loop),h.ILaya.systemTimer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)}},{key:"stop",value:function(){this._dragging&&(u.MouseManager.instance.disableMouseEvent=!1,h.ILaya.stage.off(o.Event.MOUSE_UP,this,this.onStageMouseUp),h.ILaya.stage.off(o.Event.MOUSE_OUT,this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())}},{key:"loop",value:function(){var t=this._parent.getMousePoint(),e=t.x,i=t.y,a=e-this._lastX,n=i-this._lastY;if(this._clickOnly){if(!(Math.abs(a*h.ILaya.stage._canvasTransform.getScaleX())>1||Math.abs(n*h.ILaya.stage._canvasTransform.getScaleY())>1))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event(o.Event.DRAG_START,this.data),u.MouseManager.instance.disableMouseEvent=this._disableMouseEvent}else this._offsets.push(a,n);0===a&&0===n||(this._lastX=e,this._lastY=i,this.target.x+=a*this._elasticRateX,this.target.y+=n*this._elasticRateY,this.area&&this.checkArea(),this.target.event(o.Event.DRAG_MOVE,this.data))}},{key:"checkArea",value:function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target._x<this.area.x)var t=this.area.x-this.target._x;else t=this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-t/this.elasticDistance),this.target._y<this.area.y)var e=this.area.y-this.target.y;else e=this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}}},{key:"backToArea",value:function(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)}},{key:"onStageMouseUp",value:function(t){if(u.MouseManager.instance.disableMouseEvent=!1,h.ILaya.stage.off(o.Event.MOUSE_UP,this,this.onStageMouseUp),h.ILaya.stage.off(o.Event.MOUSE_OUT,this,this.onStageMouseUp),h.ILaya.systemTimer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var e=this._offsets.length,i=Math.min(e,6),a=this._offsets.length-i,n=e-1;n>a;n--)this._offsetY+=this._offsets[n--],this._offsetX+=this._offsets[n];this._offsetX=this._offsetX/i*2,this._offsetY=this._offsetY/i*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset),h.ILaya.systemTimer.frameLoop(1,this,this.tweenMove)}else this.elasticDistance>0?this.checkElastic():this.clear()}},{key:"checkElastic",value:function(){var t=NaN,e=NaN;if(this.target.x<this.area.x?t=this.area.x:this.target._x>this.area.x+this.area.width&&(t=this.area.x+this.area.width),this.target.y<this.area.y?e=this.area.y:this.target._y>this.area.y+this.area.height&&(e=this.area.y+this.area.height),isNaN(t)&&isNaN(e))this.clear();else{var i={};isNaN(t)||(i.x=t),isNaN(e)||(i.y=e),this._tween=f.Tween.to(this.target,i,this.elasticBackTime,c.Ease.sineOut,d.Handler.create(this,this.clear),0,!1,!1)}}},{key:"tweenMove",value:function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event(o.Event.DRAG_MOVE,this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(h.ILaya.systemTimer.clear(this,this.tweenMove),this.elasticDistance>0?this.checkElastic():this.clear())}},{key:"clear",value:function(){if(this.target){this.clearTimer();var t=this.target;this.target=null,this._parent=null,t.event(o.Event.DRAG_END,this.data)}}}]),t}();e.Dragging=_},96060:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Ease=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"linearNone",value:function(t,e,i,a){return i*t/a+e}},{key:"linearIn",value:function(t,e,i,a){return i*t/a+e}},{key:"linearInOut",value:function(t,e,i,a){return i*t/a+e}},{key:"linearOut",value:function(t,e,i,a){return i*t/a+e}},{key:"bounceIn",value:function(e,i,a,n){return a-t.bounceOut(n-e,0,a,n)+i}},{key:"bounceInOut",value:function(e,i,a,n){return e<.5*n?.5*t.bounceIn(2*e,0,a,n)+i:.5*t.bounceOut(2*e-n,0,a,n)+.5*a+i}},{key:"bounceOut",value:function(t,e,i,a){return(t/=a)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}},{key:"backIn",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return i*(t/=a)*t*((n+1)*t-n)+e}},{key:"backInOut",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return(t/=.5*a)<1?.5*i*(t*t*((1+(n*=1.525))*t-n))+e:i/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e}},{key:"backOut",value:function(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1.70158;return i*((t=t/a-1)*t*((n+1)*t+n)+1)+e}},{key:"elasticIn",value:function(e,i,a,n){var r,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?i:1==(e/=n)?i+a:(l||(l=.3*n),!s||a>0&&s<a||a<0&&s<-a?(s=a,r=l/4):r=l/t.PI2*Math.asin(a/s),-s*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*t.PI2/l)+i)}},{key:"elasticInOut",value:function(e,i,a,n){var r,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?i:2==(e/=.5*n)?i+a:(l||(l=n*(.3*1.5)),!s||a>0&&s<a||a<0&&s<-a?(s=a,r=l/4):r=l/t.PI2*Math.asin(a/s),e<1?s*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*t.PI2/l)*-.5+i:s*Math.pow(2,-10*(e-=1))*Math.sin((e*n-r)*t.PI2/l)*.5+a+i)}},{key:"elasticOut",value:function(e,i,a,n){var r,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return 0==e?i:1==(e/=n)?i+a:(l||(l=.3*n),!s||a>0&&s<a||a<0&&s<-a?(s=a,r=l/4):r=l/t.PI2*Math.asin(a/s),s*Math.pow(2,-10*e)*Math.sin((e*n-r)*t.PI2/l)+a+i)}},{key:"strongIn",value:function(t,e,i,a){return i*(t/=a)*t*t*t*t+e}},{key:"strongInOut",value:function(t,e,i,a){return(t/=.5*a)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e}},{key:"strongOut",value:function(t,e,i,a){return i*((t=t/a-1)*t*t*t*t+1)+e}},{key:"sineInOut",value:function(t,e,i,a){return.5*-i*(Math.cos(Math.PI*t/a)-1)+e}},{key:"sineIn",value:function(e,i,a,n){return-a*Math.cos(e/n*t.HALF_PI)+a+i}},{key:"sineOut",value:function(e,i,a,n){return a*Math.sin(e/n*t.HALF_PI)+i}},{key:"quintIn",value:function(t,e,i,a){return i*(t/=a)*t*t*t*t+e}},{key:"quintInOut",value:function(t,e,i,a){return(t/=.5*a)<1?.5*i*t*t*t*t*t+e:.5*i*((t-=2)*t*t*t*t+2)+e}},{key:"quintOut",value:function(t,e,i,a){return i*((t=t/a-1)*t*t*t*t+1)+e}},{key:"quartIn",value:function(t,e,i,a){return i*(t/=a)*t*t*t+e}},{key:"quartInOut",value:function(t,e,i,a){return(t/=.5*a)<1?.5*i*t*t*t*t+e:.5*-i*((t-=2)*t*t*t-2)+e}},{key:"quartOut",value:function(t,e,i,a){return-i*((t=t/a-1)*t*t*t-1)+e}},{key:"cubicIn",value:function(t,e,i,a){return i*(t/=a)*t*t+e}},{key:"cubicInOut",value:function(t,e,i,a){return(t/=.5*a)<1?.5*i*t*t*t+e:.5*i*((t-=2)*t*t+2)+e}},{key:"cubicOut",value:function(t,e,i,a){return i*((t=t/a-1)*t*t+1)+e}},{key:"quadIn",value:function(t,e,i,a){return i*(t/=a)*t+e}},{key:"quadInOut",value:function(t,e,i,a){return(t/=.5*a)<1?.5*i*t*t+e:.5*-i*(--t*(t-2)-1)+e}},{key:"quadOut",value:function(t,e,i,a){return-i*(t/=a)*(t-2)+e}},{key:"expoIn",value:function(t,e,i,a){return 0==t?e:i*Math.pow(2,10*(t/a-1))+e-.001*i}},{key:"expoInOut",value:function(t,e,i,a){return 0==t?e:t==a?e+i:(t/=.5*a)<1?.5*i*Math.pow(2,10*(t-1))+e:.5*i*(2-Math.pow(2,-10*--t))+e}},{key:"expoOut",value:function(t,e,i,a){return t==a?e+i:i*(1-Math.pow(2,-10*t/a))+e}},{key:"circIn",value:function(t,e,i,a){return-i*(Math.sqrt(1-(t/=a)*t)-1)+e}},{key:"circInOut",value:function(t,e,i,a){return(t/=.5*a)<1?.5*-i*(Math.sqrt(1-t*t)-1)+e:.5*i*(Math.sqrt(1-(t-=2)*t)+1)+e}},{key:"circOut",value:function(t,e,i,a){return i*Math.sqrt(1-(t=t/a-1)*t)+e}}]),t}();e.Ease=o,(0,l.default)(o,"HALF_PI",.5*Math.PI),(0,l.default)(o,"PI2",2*Math.PI)},17333:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.FontInfo=void 0;var r=n(i(81643)),s=n(i(94198)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=function(){function t(e){(0,l.default)(this,t),(0,u.default)(this,"_font","14px Arial"),(0,u.default)(this,"_family","Arial"),(0,u.default)(this,"_size",14),(0,u.default)(this,"_italic",!1),(0,u.default)(this,"_bold",!1),this._id=t._gfontID++,this.setFont(e||this._font)}return(0,o.default)(t,[{key:"setFont",value:function(t){this._font=t;var e=t.split(" "),i=e.length;if(i<2){var a;1==i&&(0,r.default)(a=e[0]).call(a,"px")>0&&(this._size=(0,s.default)(e[0]))}else{for(var n=-1,l=0;l<i;l++){var o,u;if((0,r.default)(o=e[l]).call(o,"px")>0||(0,r.default)(u=e[l]).call(u,"pt")>0){n=l,this._size=(0,s.default)(e[l]),this._size<=0&&(console.error("font parse error:"+t),this._size=14);break}}var h=n+1,c=e[h];for(h++;h<i;h++)c+=" "+e[h];this._family=c.split(",")[0],this._italic=(0,r.default)(e).call(e,"italic")>=0,this._bold=(0,r.default)(e).call(e,"bold")>=0}}}],[{key:"Parse",value:function(e){if(e===t._lastFont)return t._lastFontInfo;var i=t._cache[e];return i||(i=t._cache[e]=new t(e)),t._lastFont=e,t._lastFontInfo=i,i}}]),t}();e.FontInfo=h,(0,u.default)(h,"EMPTY",new h(null)),(0,u.default)(h,"_cache",{}),(0,u.default)(h,"_gfontID",0),(0,u.default)(h,"_lastFont","")},52619:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.GraphicAnimation=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(92135)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(14290),y=i(22010),p=i(5866),g=i(84581);var m=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,_.default)((0,u.default)(e),"_nodeIDAniDic",{}),e}return(0,o.default)(r,[{key:"_parseNodeList",value:function(t){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[t.compId]=t.props,t.compId&&this._nodeList.push(t.compId);var e=t.child;if(e){var i,a=e.length;for(i=0;i<a;i++)this._parseNodeList(e[i])}}},{key:"_calGraphicData",value:function(t){var e;if(this._setUp(null,t),this._createGraphicData(),this._nodeIDAniDic)for(e in this._nodeIDAniDic)this._nodeIDAniDic[e]=null}},{key:"_createGraphicData",value:function(){var t,e,i=[],a=this.count,n=this._usedFrames;for(n||(n=[]),t=0;t<a;t++)!n[t]&&e||(e=this._createFrameGraphic(t)),i.push(e);this._gList=i}},{key:"_createFrameGraphic",value:function(t){var e=new y.Graphics;return r._rootMatrix||(r._rootMatrix=new p.Matrix),this._updateNodeGraphic(this._rootNode,t,r._rootMatrix,e),e}},{key:"_updateNodeGraphic",value:function(t,e,i,a){var n,r,s,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;(n=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId])).resultTransform||(n.resultTransform=new p.Matrix),r=n.resultTransform,p.Matrix.mul(n.transform,i,r);var o=n.alpha*l;if(!(o<.01)){n.skin&&(s=this._getTextureByUrl(n.skin))&&(r._checkTransform()?(a.drawTexture(s,0,0,n.width,n.height,r,o),n.resultTransform=null):a.drawTexture(s,r.tx,r.ty,n.width,n.height,null,o));var u,h,c=t.child;if(c)for(h=c.length,u=0;u<h;u++)this._updateNodeGraphic(c[u],e,r,a,o)}}},{key:"_updateNoChilds",value:function(t,e){if(t.skin){var i=this._getTextureByUrl(t.skin);if(i){var a=t.transform;a._checkTransform(),a._bTransform?e.drawTexture(i,0,0,t.width,t.height,a.clone(),t.alpha):e.drawTexture(i,a.tx,a.ty,t.width,t.height,null,t.alpha)}}}},{key:"_updateNodeGraphic2",value:function(t,e,i){var a;if(a=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]),t.child){var n,r,s,l=a.transform;l._checkTransform(),r=(n=!l._bTransform)&&(0!=l.tx||0!=l.ty),(s=l._bTransform||1!=a.alpha)&&i.save(),1!=a.alpha&&i.alpha(a.alpha),n?r&&i.translate(l.tx,l.ty):i.transform(l.clone());var o,u,h,c=t.child;if(a.skin&&(o=this._getTextureByUrl(a.skin))&&i.drawImage(o,0,0,a.width,a.height),c)for(h=c.length,u=0;u<h;u++)this._updateNodeGraphic2(c[u],e,i);s?i.restore():n?r&&i.translate(-l.tx,-l.ty):i.transform(l.clone().invert())}else this._updateNoChilds(a,i)}},{key:"_calculateKeyFrames",value:function(t){(0,h.default)((0,f.default)(r.prototype),"_calculateKeyFrames",this).call(this,t),this._nodeIDAniDic[t.target]=t}},{key:"getNodeDataByID",value:function(t){return this._nodeIDAniDic[t]}},{key:"_getParams",value:function(t,e,i,a){var n=r._temParam;n.length=e.length;var s,l=e.length;for(s=0;s<l;s++)n[s]=this._getObjVar(t,e[s][0],i,e[s][1],a);return n}},{key:"_getObjVar",value:function(t,e,i,a,n){if(e in t){var r=t[e];return i>=r.length&&(i=r.length-1),t[e][i]}return e in n?n[e]:a}},{key:"_getNodeGraphicData",value:function(t,e,i){i||(i=new x),i.transform?i.transform.identity():i.transform=new p.Matrix;var a=this.getNodeDataByID(t);if(!a)return i;var n,s,l,o=a.frames,u=this._getParams(o,r._drawTextureCmd,e,this._nodeDefaultProps[t]),h=u[0],c=u[5],d=u[6],f=u[13],_=u[14],v=u[7],y=u[8],g=u[9],m=u[11],T=u[12];n=u[3],s=u[4],0!=n&&0!=s||(h=null),-1==n&&(n=0),-1==s&&(s=0),i.skin=h,i.width=n,i.height=s,h&&((l=this._getTextureByUrl(h))?(n||(n=l.sourceWidth),s||(s=l.sourceHeight)):console.warn("lost skin:",h,",you may load pics first")),i.alpha=u[10];var k=i.transform;0!=f&&(c=f*n),0!=_&&(d=_*s),0==c&&0==d||k.translate(-c,-d);var C=null;if(g||1!==v||1!==y||m||T){(C=r._tempMt).identity(),C._bTransform=!0;var S=.0174532922222222*(g-m),E=.0174532922222222*(g+T),M=Math.cos(E),L=Math.sin(E),b=Math.sin(S),I=Math.cos(S);C.a=v*M,C.b=v*L,C.c=-y*b,C.d=y*I,C.tx=C.ty=0}return C&&(k=p.Matrix.mul(k,C,k)),k.translate(u[1],u[2]),i}},{key:"_getTextureByUrl",value:function(t){return g.Loader.getRes(t)}},{key:"setAniData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=t,this._parseNodeList(t);var i,a,n={},s=[],l=t.animations,o=l.length;for(i=0;i<o;i++)if(a=l[i],this._labels=null,(!e||e==a.name)&&a){try{this._calGraphicData(a)}catch(t){console.warn("parse animation fail:"+a.name+",empty animation created"),this._gList=[]}var u={};u.interval=1e3/a.frameRate,u.frames=this._gList,u.labels=this._labels,u.name=a.name,s.push(u),n[a.name]=u}this.animationList=s,this.animationDic=n}r._temParam.length=0}},{key:"parseByData",value:function(t){var e,i;e=t.nodeRoot,i=t.aniO,delete t.nodeRoot,delete t.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=e,this._parseNodeList(e),this._labels=null;try{this._calGraphicData(i)}catch(t){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}var a=t;return a.interval=1e3/i.frameRate,a.frames=this._gList,a.labels=this._labels,a.name=i.name,a}},{key:"setUpAniData",value:function(t){if(t.animations){var e,i,a={},n=[],r=t.animations,s=r.length;for(e=0;e<s;e++)if(i=r[e]){var l={};l.name=i.name,l.aniO=i,l.nodeRoot=t,n.push(l),a[i.name]=l}this.animationList=n,this.animationDic=a}}},{key:"_clear",value:function(){this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic=null}}],[{key:"parseAnimationByData",value:function(t){var e;return r._I||(r._I=new r),e=r._I.parseByData(t),r._I._clear(),e}},{key:"parseAnimationData",value:function(t){var e;return r._I||(r._I=new r),r._I.setUpAniData(t),(e={}).animationList=r._I.animationList,e.animationDic=r._I.animationDic,r._I._clear(),e}}]),r}(v.FrameAnimation);e.GraphicAnimation=m,(0,_.default)(m,"_drawTextureCmd",[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]]),(0,_.default)(m,"_temParam",[]),(0,_.default)(m,"_tempMt",new p.Matrix);var x=(0,o.default)((function t(){(0,l.default)(this,t),(0,_.default)(this,"alpha",1)}))},76869:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HTMLChar=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(89761),u=function(){function t(){(0,r.default)(this,t),this.reset()}return(0,s.default)(t,[{key:"setData",value:function(e,i,a,n){return this.char=e,this.charNum=e.charCodeAt(0),this.x=this.y=0,this.width=i,this.height=a,this.style=n,this.isWord=!t._isWordRegExp.test(e),this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this.isWord=!1,this.char=null,this.charNum=0,this.style=null,this}},{key:"recover",value:function(){o.Pool.recover("HTMLChar",this.reset())}},{key:"_isChar",value:function(){return!0}},{key:"_getCSSStyle",value:function(){return this.style}}],[{key:"create",value:function(){return o.Pool.getItemByClass("HTMLChar",t)}}]),t}();e.HTMLChar=u,(0,l.default)(u,"_isWordRegExp",new RegExp("[\\w.]",""))},64774:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HalfFloatUtils=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"__init__",value:function(){for(var e=0;e<256;++e){var i=e-127;i<-27?(t._baseTable[0|e]=0,t._baseTable[256|e]=32768,t._shiftTable[0|e]=24,t._shiftTable[256|e]=24):i<-14?(t._baseTable[0|e]=1024>>-i-14,t._baseTable[256|e]=1024>>-i-14|32768,t._shiftTable[0|e]=-i-1,t._shiftTable[256|e]=-i-1):i<=15?(t._baseTable[0|e]=i+15<<10,t._baseTable[256|e]=i+15<<10|32768,t._shiftTable[0|e]=13,t._shiftTable[256|e]=13):i<128?(t._baseTable[0|e]=31744,t._baseTable[256|e]=64512,t._shiftTable[0|e]=24,t._shiftTable[256|e]=24):(t._baseTable[0|e]=31744,t._baseTable[256|e]=64512,t._shiftTable[0|e]=13,t._shiftTable[256|e]=13)}for(t._mantissaTable[0]=0,e=1;e<1024;++e){var a=e<<13;for(i=0;0==(8388608&a);)i-=8388608,a<<=1;a&=-8388609,i+=947912704,t._mantissaTable[e]=a|i}for(e=1024;e<2048;++e)t._mantissaTable[e]=939524096+(e-1024<<13);for(t._exponentTable[0]=0,e=1;e<31;++e)t._exponentTable[e]=e<<23;for(t._exponentTable[31]=1199570944,t._exponentTable[32]=2147483648,e=33;e<63;++e)t._exponentTable[e]=2147483648+(e-32<<23);for(t._exponentTable[63]=3347054592,t._offsetTable[0]=0,e=1;e<64;++e)t._offsetTable[e]=32===e?0:1024}},{key:"roundToFloat16Bits",value:function(e){t._floatView[0]=e;var i=t._uint32View[0],a=i>>23&511;return t._baseTable[a]+((8388607&i)>>t._shiftTable[a])}},{key:"convertToNumber",value:function(e){var i=e>>10;return t._uint32View[0]=t._mantissaTable[t._offsetTable[i]+(1023&e)]+t._exponentTable[i],t._floatView[0]}}]),t}();e.HalfFloatUtils=o,(0,l.default)(o,"_buffer",new ArrayBuffer(4)),(0,l.default)(o,"_floatView",new Float32Array(o._buffer)),(0,l.default)(o,"_uint32View",new Uint32Array(o._buffer)),(0,l.default)(o,"_baseTable",new Uint32Array(512)),(0,l.default)(o,"_shiftTable",new Uint32Array(512)),(0,l.default)(o,"_mantissaTable",new Uint32Array(2048)),(0,l.default)(o,"_exponentTable",new Uint32Array(64)),(0,l.default)(o,"_offsetTable",new Uint32Array(64))},35696:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Handler=void 0;var r=n(i(77766)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,s.default)(this,t),(0,o.default)(this,"once",!1),(0,o.default)(this,"_id",0),this.setTo(e,i,a,n)}return(0,l.default)(t,[{key:"setTo",value:function(e,i,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this._id=t._gid++,this.caller=e,this.method=i,this.args=a,this.once=n,this}},{key:"run",value:function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e}},{key:"runWith",value:function(t){var e;if(null==this.method)return null;var i=this._id;if(null==t)var a=this.method.apply(this.caller,this.args);else a=this.args||t.unshift?this.args?this.method.apply(this.caller,(0,r.default)(e=this.args).call(e,t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===i&&this.once&&this.recover(),a}},{key:"clear",value:function(){return this.caller=null,this.method=null,this.args=null,this}},{key:"recover",value:function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))}}],[{key:"create",value:function(e,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return t._pool.length?t._pool.pop().setTo(e,i,a,n):new t(e,i,a,n)}}]),t}();e.Handler=u,(0,o.default)(u,"_pool",[]),(0,o.default)(u,"_gid",1)},89570:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.HitArea=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(91020),u=i(63701),h=i(93561),c=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"contains",value:function(e,i){return!!t._isHitGraphic(e,i,this.hit)&&!t._isHitGraphic(e,i,this.unHit)}},{key:"hit",get:function(){return this._hit||(this._hit=new h.ILaya.Graphics),this._hit},set:function(t){this._hit=t}},{key:"unHit",get:function(){return this._unHit||(this._unHit=new h.ILaya.Graphics),this._unHit},set:function(t){this._unHit=t}}],[{key:"_isHitGraphic",value:function(e,i,a){if(!a)return!1;var n,r,s,l=a.cmds;if(!l&&a._one&&((l=t._cmds).length=1,l[0]=a._one),!l)return!1;for(r=l.length,n=0;n<r;n++)if((s=l[n])&&("Translate"===s.cmdID&&(e-=s.tx,i-=s.ty),t._isHitCmd(e,i,s)))return!0;return!1}},{key:"_isHitCmd",value:function(e,i,a){if(!a)return!1;var n=!1;switch(a.cmdID){case"DrawRect":t._rect.setTo(a.x,a.y,a.width,a.height),n=t._rect.contains(e,i);break;case"DrawCircle":n=(e-=a.x)*e+(i-=a.y)*i<a.radius*a.radius;break;case"DrawPoly":e-=a.x,i-=a.y,n=t._ptInPolygon(e,i,a.points)}return n}},{key:"_ptInPolygon",value:function(e,i,a){var n=t._ptPoint;n.setTo(e,i);var r,s,l,o,u,h=0;u=a.length;for(var c=0;c<u;c+=2)r=a[c],s=a[c+1],l=a[(c+2)%u],s!=(o=a[(c+3)%u])&&(n.y<Math.min(s,o)||n.y>=Math.max(s,o)||(n.y-s)*(l-r)/(o-s)+r>n.x&&h++);return h%2==1}}]),t}();e.HitArea=c,(0,l.default)(c,"_cmds",[]),(0,l.default)(c,"_rect",new u.Rectangle),(0,l.default)(c,"_ptPoint",new o.Point)},11842:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.IStatRender=void 0;var r=n(i(87368)),s=n(i(28146)),l=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"show",value:function(){}},{key:"enable",value:function(){}},{key:"hide",value:function(){}},{key:"set_onclick",value:function(t){}},{key:"isCanvasRender",value:function(){return!0}},{key:"renderNotCanvas",value:function(t,e,i){}}]),t}();e.IStatRender=l},79041:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Mouse=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(27175),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"cursor",get:function(){return t._style.cursor},set:function(e){t._style.cursor=e}},{key:"__init__",value:function(){t._style=l.Browser.document.body.style}},{key:"hide",value:function(){"none"!=t.cursor&&(t._preCursor=t.cursor,t.cursor="none")}},{key:"show",value:function(){"none"==t.cursor&&(t._preCursor?t.cursor=t._preCursor:t.cursor="auto")}}]),t}();e.Mouse=o},7695:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.PerformancePlugin=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"setPerformanceDataTool",value:function(t){this.performanceTool=t}},{key:"begainSample",value:function(t){this.performanceTool&&this.performanceTool.enable&&this.performanceTool.BegainSample(t)}},{key:"endSample",value:function(t){return this.performanceTool&&this.performanceTool.enable?this.performanceTool.EndSample(t):0}},{key:"expoertFile",value:function(t){if(this.performanceTool)return this.performanceTool.enable?this.performanceTool.exportPerformanceFile():null}},{key:"showFunSampleFun",value:function(t){this.performanceTool.showFunSampleFun(t)}},{key:"enable",get:function(){return!!this.performanceTool&&this._enable},set:function(t){this.performanceTool&&(this.performanceTool.enable=t)}},{key:"enableDataExport",get:function(){return!!this.performanceTool&&this.performanceTool.enableDataExport},set:function(t){this.performanceTool&&(this.performanceTool.enableDataExport=t)}}]),t}();e.PerformancePlugin=o,(0,l.default)(o,"performanceTool",null),(0,l.default)(o,"_enable",!1),(0,l.default)(o,"PERFORMANCE_LAYA","Laya"),(0,l.default)(o,"PERFORMANCE_LAYA_3D","Laya/3D"),(0,l.default)(o,"PERFORMANCE_LAYA_2D","Laya/2D"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_PRERENDER","Laya/3D/PreRender"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_UPDATESCRIPT","Laya/3D/UpdateScript"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_PHYSICS","Laya/3D/Physics"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_PHYSICS_SIMULATE","Laya/3D/Physics/simulate"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_PHYSICS_CHARACTORCOLLISION","Laya/3D/Physics/updataCharacters&Collisions"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_PHYSICS_EVENTSCRIPTS","Laya/3D/Physics/eventScripts"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER","Laya/3D/Render"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_SHADOWMAP","Laya/3D/Render/ShadowMap"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_CLUSTER","Laya/3D/Render/Cluster"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_CULLING","Laya/3D/Render/Culling"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_RENDERDEPTHMDOE","Laya/3D/Render/RenderDepthMode"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_RENDEROPAQUE","Laya/3D/Render/RenderOpaque"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_RENDERCOMMANDBUFFER","Laya/3D/Render/RenderCommandBuffer"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_RENDERTRANSPARENT","Laya/3D/Render/RenderTransparent"),(0,l.default)(o,"PERFORMANCE_LAYA_3D_RENDER_POSTPROCESS","Laya/3D/Render/PostProcess"),window.PerformancePlugin=o},89761:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Pool=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"getPoolBySign",value:function(e){return t._poolDic[e]||(t._poolDic[e]=[])}},{key:"clearBySign",value:function(e){t._poolDic[e]&&(t._poolDic[e].length=0)}},{key:"recover",value:function(e,i){i[t.POOLSIGN]||(i[t.POOLSIGN]=!0,t.getPoolBySign(e).push(i))}},{key:"recoverByClass",value:function(e){if(e){var i=e.__className||e.constructor._$gid;i&&t.recover(i,e)}}},{key:"_getClassSign",value:function(e){var i=e.__className||e._$gid;return i||(e._$gid=i=t._CLSID+"",t._CLSID++),i}},{key:"createByClass",value:function(e){return t.getItemByClass(t._getClassSign(e),e)}},{key:"getItemByClass",value:function(e,i){if(!t._poolDic[e])return new i;var a=t.getPoolBySign(e);if(a.length){var n=a.pop();n[t.POOLSIGN]=!1}else n=new i;return n}},{key:"getItemByCreateFun",value:function(e,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.getPoolBySign(e),r=n.length?n.pop():i.call(a);return r[t.POOLSIGN]=!1,r}},{key:"getItem",value:function(e){var i=t.getPoolBySign(e),a=i.length?i.pop():null;return a&&(a[t.POOLSIGN]=!1),a}}]),t}();e.Pool=o,(0,l.default)(o,"_CLSID",0),(0,l.default)(o,"POOLSIGN","__InPool"),(0,l.default)(o,"_poolDic",{})},62082:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.RunDriver=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=i(56843),u=(0,r.default)((function t(){(0,s.default)(this,t)}));e.RunDriver=u,(0,l.default)(u,"createShaderCondition",(function(t){var e="(function() {return "+t+";})";return window.Laya._runScript(e)})),(0,l.default)(u,"changeWebGLSize",(function(t,e){o.WebGL.onStageResize(t,e)}))},45651:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SceneUtils=void 0;var r=n(i(81643)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(89761),h=i(46222),c=i(65098),d=i(14290),f=i(64099),_=i(57964),v=i(84581),y=i(35696),p=i(93561),g=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"__init",value:function(){t._funMap=new _.WeakObject}},{key:"getBindFun",value:function(e){var i=t._funMap.get(e);if(null==i){var a='"'+e+'"',n="(function(data){if(data==null)return;with(data){try{\nreturn "+(a=a.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";i=window.Laya._runScript(n),t._funMap.set(e,i)}return i}},{key:"createByData",value:function(e,i){var a=x.create();if((e=t.createComp(i,e,e,null,a))._setBit(h.Const.NOT_READY,!0),"_idMap"in e&&(e._idMap=a._idMap),i.animations){var n,r,s,l=[],o=i.animations,u=o.length;for(n=0;n<u;n++){switch(r=new d.FrameAnimation,s=o[n],r._setUp(a._idMap,s),e[s.name]=r,r._setControlNode(e),s.action){case 1:r.play(0,!1);break;case 2:r.play(0,!0)}l.push(r)}e._aniList=l}return"Scene"===e._$componentType&&e._width>0&&null==i.props.hitTestPrior&&!e.mouseThrough&&(e.hitTestPrior=!0),a.beginLoad(e),e}},{key:"createInitTool",value:function(){return x.create()}},{key:"createComp",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("Scene3D"==e.type||"Sprite3D"==e.type){var l=[],o=p.ILaya.Laya.Utils3D._createSceneByJsonForMaker(e,l,s);return"Sprite3D"==e.type?p.ILaya.Laya.StaticBatchManager.combine(o,l):p.ILaya.Laya.StaticBatchManager.combine(null,l),o}if(!(i=i||t.getCompInstance(e)))return e.props&&e.props.runtime?console.warn("runtime not found:"+e.props.runtime):console.warn("can not create:"+e.type),null;var u=e.child;if(u)for(var h="List"==i._$componentType,d=0,_=u.length;d<_;d++){var v=u[d];if(!("itemRender"in i)||"render"!=v.props.name&&"render"!==v.props.renderType)if("Graphic"==v.type)p.ILaya.ClassUtils._addGraphicsToSprite(v,i);else if(p.ILaya.ClassUtils._isDrawType(v.type))p.ILaya.ClassUtils._addGraphicToSprite(v,i,!0);else{if(h){var y=[],g=t.createComp(v,null,a,y,s);y.length&&(g._$bindData=y)}else g=t.createComp(v,null,a,n,s);"Script"==v.type?g instanceof c.Component?i._addComponentInstance(g):"owner"in g?g.owner=i:"target"in g&&(g.target=i):"mask"==v.props.renderType||"mask"==v.props.name?i.mask=g:g instanceof f.Node&&i.addChild(g)}else i.itemRender=v}var m=e.props;for(var x in m){var T=m[x];"string"==typeof T&&((0,r.default)(T).call(T,"@node:")>=0||(0,r.default)(T).call(T,"@Prefab:")>=0)?s&&s.addNodeRef(i,x,T):t.setCompValue(i,x,T,a,n)}return i._afterInited&&i._afterInited(),e.compId&&s&&s._idMap&&(s._idMap[e.compId]=i),i}},{key:"setCompValue",value:function(e,i,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if("string"==typeof a&&(0,r.default)(a).call(a,"${")>-1){if(t._sheet||(t._sheet=p.ILaya.ClassUtils.getClass("laya.data.Table")),!t._sheet)return void console.warn("Can not find class Sheet");if(s)s.push(e,i,a);else if(n){-1==(0,r.default)(a).call(a,"].")&&(a=a.replace(".","[0]."));var l,o,u=new m(e,i,a);u.exe(n);for(var h=a.replace(/\[.*?\]\./g,".");null!=(l=t._parseWatchData.exec(h));){for(var c=l[1];null!=(o=t._parseKeyWord.exec(c));){var d=o[0],f=n._watchMap[d]||(n._watchMap[d]=[]);f.push(u),t._sheet.I.notifer.on(d,n,n.changeData,[d])}(f=n._watchMap[c]||(n._watchMap[c]=[])).push(u),t._sheet.I.notifer.on(c,n,n.changeData,[c])}}}else"var"===i&&n?n[a]=e:e[i]="true"===a||"false"!==a&&a}},{key:"getCompInstance",value:function(e){if("UIView"==e.type&&e.props&&e.props.pageData)return t.createByData(null,e.props.pageData);var i=e.props&&e.props.runtime||e.type,a=p.ILaya.ClassUtils.getClass(i);if(!a)throw"Can not find class "+i;if("Script"===e.type&&a.prototype._doAwake){var n=u.Pool.createByClass(a);return n._destroyed=!1,n}return e.props&&"renderType"in e.props&&"instance"==e.props.renderType?(a.instance||(a.instance=new a),a.instance):new a}}]),t}();e.SceneUtils=g,(0,o.default)(g,"_parseWatchData",/\${(.*?)}/g),(0,o.default)(g,"_parseKeyWord",/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g);var m=function(){function t(e,i,a){(0,s.default)(this,t),this.comp=e,this.prop=i,this.value=a}return(0,l.default)(t,[{key:"exe",value:function(t){var e=g.getBindFun(this.value);this.comp[this.prop]=e.call(this,t)}}]),t}(),x=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,[{key:"reset",value:function(){this._nodeRefList=null,this._initList=null,this._idMap=null,this._loadList=null,this._scene=null}},{key:"recover",value:function(){this.reset(),u.Pool.recover("InitTool",this)}},{key:"addLoadRes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._loadList||(this._loadList=[]),p.ILaya.loader.getRes(t)||(e?this._loadList.push({url:t,type:e}):this._loadList.push(t))}},{key:"addNodeRef",value:function(t,e,i){this._nodeRefList||(this._nodeRefList=[]),this._nodeRefList.push([t,e,i]),(0,r.default)(i).call(i,"@Prefab:")>=0&&this.addLoadRes(i.replace("@Prefab:",""),v.Loader.PREFAB)}},{key:"setNodeRef",value:function(){if(this._nodeRefList)if(this._idMap){var t,e,i;for(e=this._nodeRefList.length,t=0;t<e;t++)(i=this._nodeRefList[t])[0][i[1]]=this.getReferData(i[2]);this._nodeRefList=null}else this._nodeRefList=null}},{key:"getReferData",value:function(t){if((0,r.default)(t).call(t,"@Prefab:")>=0)return v.Loader.getRes(t.replace("@Prefab:",""));if((0,r.default)(t).call(t,"@arr:")>=0){var e,i,a,n;for(a=(e=(t=t.replace("@arr:","")).split(",")).length,i=0;i<a;i++)n=e[i],e[i]=n?this._idMap[n.replace("@node:","")]:null;return e}return this._idMap[t.replace("@node:","")]}},{key:"addInitItem",value:function(t){this._initList||(this._initList=[]),this._initList.push(t)}},{key:"doInits",value:function(){this._initList&&(this._initList=null)}},{key:"finish",value:function(){this.setNodeRef(),this.doInits(),this._scene._setBit(h.Const.NOT_READY,!1),this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._processActive(),this._scene.event("onViewCreated"),this.recover()}},{key:"beginLoad",value:function(t){this._scene=t,!this._loadList||this._loadList.length<1?this.finish():p.ILaya.loader.load(this._loadList,y.Handler.create(this,this.finish))}}],[{key:"create",value:function(){var e=u.Pool.getItemByClass("InitTool",t);return e._idMap={},e}}]),t}()},14880:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Stat=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t._StatRender.show(e,i)}},{key:"enable",value:function(){t._StatRender.enable()}},{key:"hide",value:function(){t._StatRender.hide()}},{key:"clear",value:function(){t.trianglesFaces=t.renderBatches=t.savedRenderBatches=t.shaderCall=t.spriteRenderUseCacheCount=t.frustumCulling=t.octreeNodeCulling=t.canvasNormal=t.canvasBitmap=t.canvasReCache=0}},{key:"onclick",set:function(e){t._StatRender.set_onclick(e)}}]),t}();e.Stat=o,(0,l.default)(o,"FPS",0),(0,l.default)(o,"loopCount",0),(0,l.default)(o,"shaderCall",0),(0,l.default)(o,"renderBatches",0),(0,l.default)(o,"savedRenderBatches",0),(0,l.default)(o,"trianglesFaces",0),(0,l.default)(o,"spriteCount",0),(0,l.default)(o,"spriteRenderUseCacheCount",0),(0,l.default)(o,"frustumCulling",0),(0,l.default)(o,"octreeNodeCulling",0),(0,l.default)(o,"canvasNormal",0),(0,l.default)(o,"canvasBitmap",0),(0,l.default)(o,"canvasReCache",0),(0,l.default)(o,"renderSlow",!1),(0,l.default)(o,"_fpsData",[]),(0,l.default)(o,"_timer",0),(0,l.default)(o,"_count",0),(0,l.default)(o,"_StatRender",null)},86345:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.StatUI=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(11842),v=i(27175),y=i(87210),p=i(23699),g=i(3117),m=i(54013),x=i(8865),T=i(14880),k=i(93561);var C=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e;(0,l.default)(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e=n.call.apply(n,(0,s.default)(t=[this]).call(t,a)),(0,f.default)((0,u.default)(e),"_show",!1),(0,f.default)((0,u.default)(e),"_useCanvas",!1),(0,f.default)((0,u.default)(e),"_height",100),(0,f.default)((0,u.default)(e),"_view",[]),e}return(0,o.default)(r,[{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;T.Stat,v.Browser._isMiniGame||k.ILaya.Render.isConchApp||(this._useCanvas=!0),this._show=!0,T.Stat._fpsData.length=60,this._view[0]={title:"FPS(WebGL)",value:"_fpsStr",color:"yellow",units:"int"},this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"},this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"},this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"},this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"},this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"},this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"},g.Render.is3DMode&&(this._view[0].title="FPS(3D)",this._view[8]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},this._view[9]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"},this._view[10]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}),this._useCanvas?this.createUIPre(t,e):this.createUI(t,e),this.enable()}},{key:"createUIPre",value:function(t,e){var i=v.Browser.pixelRatio;this._width=180*i,this._vx=120*i,this._height=i*(12*this._view.length+3*i)+4,r._fontSize=12*i;for(var a=0;a<this._view.length;a++)this._view[a].x=4,this._view[a].y=a*r._fontSize+2*i;this._canvas||(this._canvas=new m.HTMLCanvas(!0),this._canvas.size(this._width,this._height),this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="top",this._ctx.font=r._fontSize+"px Arial",this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+e+"px;width:"+this._width/i+"px;height:"+this._height/i+"px;"),v.Browser.onKGMiniGame||v.Browser.container.appendChild(this._canvas.source),this._first=!0,this.loop(),this._first=!1}},{key:"createUI",value:function(t,e){var i=this._sp,a=v.Browser.pixelRatio;i||(i=new y.Sprite,this._leftText=new p.Text,this._leftText.pos(5,5),this._leftText.color="#ffffff",i.addChild(this._leftText),this._txt=new p.Text,this._txt.pos(130*a,5),this._txt.color="#ffffff",i.addChild(this._txt),this._sp=i),i.pos(t,e);for(var n="",s=0;s<this._view.length;s++)n+=this._view[s].title+"\n";this._leftText.text=n;var l=138*a,o=a*(12*this._view.length+3*a)+4;this._txt.fontSize=r._fontSize*a,this._leftText.fontSize=r._fontSize*a,i.size(l,o),i.graphics.clear(),i.graphics.alpha(.5),i.graphics.drawRect(0,0,l+110,o+30,"#999999"),i.graphics.alpha(2),this.loop()}},{key:"enable",value:function(){k.ILaya.systemTimer.frameLoop(1,this,this.loop)}},{key:"hide",value:function(){this._show=!1,k.ILaya.systemTimer.clear(this,this.loop),this._canvas&&v.Browser.removeElement(this._canvas.source)}},{key:"set_onclick",value:function(t){this._sp&&this._sp.on("click",this._sp,t),this._canvas&&(this._canvas.source.onclick=t,this._canvas.source.style.pointerEvents="")}},{key:"loop",value:function(){T.Stat._count++;var t=v.Browser.now();if(!(t-T.Stat._timer<1e3)){var e=T.Stat._count;if(T.Stat.FPS=Math.round(1e3*e/(t-T.Stat._timer)),this._show){T.Stat.trianglesFaces=Math.round(T.Stat.trianglesFaces/e),this._useCanvas?T.Stat.renderBatches=Math.round(T.Stat.renderBatches/e):T.Stat.renderBatches=Math.round(T.Stat.renderBatches/e)-1,T.Stat.savedRenderBatches=Math.round(T.Stat.savedRenderBatches/e),T.Stat.shaderCall=Math.round(T.Stat.shaderCall/e),T.Stat.spriteRenderUseCacheCount=Math.round(T.Stat.spriteRenderUseCacheCount/e),T.Stat.canvasNormal=Math.round(T.Stat.canvasNormal/e),T.Stat.canvasBitmap=Math.round(T.Stat.canvasBitmap/e),T.Stat.canvasReCache=Math.ceil(T.Stat.canvasReCache/e),T.Stat.frustumCulling=Math.round(T.Stat.frustumCulling/e),T.Stat.octreeNodeCulling=Math.round(T.Stat.octreeNodeCulling/e);var i=T.Stat.FPS>0?Math.floor(1e3/T.Stat.FPS).toString():" ";T.Stat._fpsStr=T.Stat.FPS+(T.Stat.renderSlow?" slow":"")+" "+i,T.Stat._spriteStr=T.Stat.spriteCount+(T.Stat.spriteRenderUseCacheCount?"/"+T.Stat.spriteRenderUseCacheCount:""),T.Stat._canvasStr=T.Stat.canvasReCache+"/"+T.Stat.canvasNormal+"/"+T.Stat.canvasBitmap,T.Stat.cpuMemory=x.Resource.cpuMemory,T.Stat.gpuMemory=x.Resource.gpuMemory,this._useCanvas?this.renderInfoPre():this.renderInfo(),T.Stat.clear()}T.Stat._count=0,T.Stat._timer=t}}},{key:"renderInfoPre",value:function(){var t,e,i=0;if(this._canvas){var a=this._ctx;for(a.clearRect(this._first?0:this._vx,0,this._width,this._height),i=0;i<this._view.length;i++)t=this._view[i],this._first&&(a.fillStyle="white",a.fillText(t.title,t.x,t.y)),a.fillStyle=t.color,e=T.Stat[t.value],"M"==t.units&&(e=Math.floor(e/1048576*100)/100+" M"),a.fillText(e+"",t.x+this._vx,t.y)}}},{key:"renderInfo",value:function(){for(var t="",e=0;e<this._view.length;e++){var i=this._view[e],a=T.Stat[i.value];"M"==i.units&&(a=Math.floor(a/1048576*100)/100+" M"),"K"==i.units&&(a=Math.floor(a/1024*100)/100+" K"),t+=a+"\n"}this._txt.text=t}},{key:"isCanvasRender",value:function(){return this._useCanvas}},{key:"renderNotCanvas",value:function(t,e,i){this._show&&this._sp&&this._sp.render(t,0,0)}}]),r}(_.IStatRender);e.StatUI=C,(0,f.default)(C,"_fontSize",12)},28498:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.StringKey=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_strsToID",{}),(0,l.default)(this,"_idToStrs",[]),(0,l.default)(this,"_length",0)}return(0,s.default)(t,[{key:"add",value:function(t){var e=this._strsToID[t];return null!=e?e:(this._idToStrs[this._length]=t,this._strsToID[t]=this._length++)}},{key:"getID",value:function(t){var e=this._strsToID[t];return null==e?-1:e}},{key:"getName",value:function(t){var e=this._idToStrs[t];return null==e?void 0:e}}]),t}();e.StringKey=o},69833:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Timer=void 0;var r=n(i(11128)),s=n(i(39291)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(37444),c=i(93561),d=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,l.default)(this,t),(0,u.default)(this,"scale",1),(0,u.default)(this,"currTimer",(0,r.default)()),(0,u.default)(this,"currFrame",0),(0,u.default)(this,"_delta",0),(0,u.default)(this,"_lastTimer",(0,r.default)()),(0,u.default)(this,"_map",[]),(0,u.default)(this,"_handlers",[]),(0,u.default)(this,"_temp",[]),(0,u.default)(this,"_count",0),e&&t.gSysTimer&&t.gSysTimer.frameLoop(1,this,this._update)}return(0,o.default)(t,[{key:"delta",get:function(){return this._delta}},{key:"_update",value:function(){if(this.scale<=0)return this._lastTimer=(0,r.default)(),void(this._delta=0);var t=this.currFrame=this.currFrame+this.scale,e=(0,r.default)(),i=e-this._lastTimer>3e4;this._delta=(e-this._lastTimer)*this.scale;var a=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var n=this._handlers;this._count=0;for(var l=0,o=n.length;l<o;l++){var u=n[l];if(null!==u.method){var h=u.userFrame?t:a;if(h>=u.exeTime)if((0,s.default)(u))if(!u.jumpFrame||i)u.exeTime+=u.delay,u.run(!1),h>u.exeTime&&(u.exeTime+=Math.ceil((h-u.exeTime)/u.delay)*u.delay);else for(;h>=u.exeTime;)u.exeTime+=u.delay,u.run(!1);else u.run(!0)}else this._count++}(this._count>30||t%200==0)&&this._clearHandlers()}},{key:"_clearHandlers",value:function(){for(var t=this._handlers,e=0,i=t.length;e<i;e++){var a=t[e];null!==a.method?this._temp.push(a):this._recoverHandler(a)}this._handlers=this._temp,t.length=0,this._temp=t}},{key:"_recoverHandler",value:function(e){this._map[e.key]==e&&(this._map[e.key]=null),e.clear(),t._pool.push(e)}},{key:"_create",value:function(e,i,a,n,s,l,o){if(!a)return s.apply(n,l),null;if(o){var u=this._getHandler(n,s);if(u)return u.repeat=i,u.userFrame=e,u.delay=a,u.caller=n,u.method=s,u.args=l,u.exeTime=a+(e?this.currFrame:this.currTimer+(0,r.default)()-this._lastTimer),u}return(u=t._pool.length>0?t._pool.pop():new f).repeat=i,u.userFrame=e,u.delay=a,u.caller=n,u.method=s,u.args=l,u.exeTime=a+(e?this.currFrame:this.currTimer+(0,r.default)()-this._lastTimer),this._indexHandler(u),this._handlers.push(u),u}},{key:"_indexHandler",value:function(e){var i=e.caller,a=e.method,n=i?i.$_GID||(i.$_GID=c.ILaya.Utils.getGID()):0,r=a.$_TID||(a.$_TID=1e5*t._mid++);e.key=n+r,this._map[e.key]=e}},{key:"once",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!1,!1,t,e,i,a,n)}},{key:"loop",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=this._create(!1,!0,t,e,i,a,n);s&&(s.jumpFrame=r)}},{key:"frameOnce",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!0,!1,t,e,i,a,n)}},{key:"frameLoop",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this._create(!0,!0,t,e,i,a,n)}},{key:"toString",value:function(){return" handlers:"+this._handlers.length+" pool:"+t._pool.length}},{key:"clear",value:function(t,e){var i=this._getHandler(t,e);i&&(this._map[i.key]=null,i.key=0,i.clear())}},{key:"clearAll",value:function(t){if(t)for(var e=0,i=this._handlers.length;e<i;e++){var a=this._handlers[e];a.caller===t&&(this._map[a.key]=null,a.key=0,a.clear())}}},{key:"_getHandler",value:function(e,i){var a=e?e.$_GID||(e.$_GID=c.ILaya.Utils.getGID()):0,n=i.$_TID||(i.$_TID=1e5*t._mid++);return this._map[a+n]}},{key:"callLater",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;h.CallLater.I.callLater(t,e,i)}},{key:"runCallLater",value:function(t,e){h.CallLater.I.runCallLater(t,e)}},{key:"runTimer",value:function(t,e){var i=this._getHandler(t,e);i&&null!=i.method&&(this._map[i.key]=null,i.run(!0))}},{key:"pause",value:function(){this.scale=0}},{key:"resume",value:function(){this.scale=1}}]),t}();e.Timer=d,(0,u.default)(d,"gSysTimer",null),(0,u.default)(d,"_pool",[]),(0,u.default)(d,"_mid",1);var f=function(){function t(){(0,l.default)(this,t)}return(0,o.default)(t,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var i=this.method,a=this.args;t&&this.clear(),null!=i&&(a?i.apply(e,a):i.call(e))}}]),t}()},42461:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Tween=void 0;var r=n(i(39291)),s=n(i(92762)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(89761),c=i(27175),d=i(11179),f=i(93561),_=function(){function t(){(0,l.default)(this,t),(0,u.default)(this,"gid",0),(0,u.default)(this,"repeat",1),(0,u.default)(this,"_count",0)}return(0,o.default)(t,[{key:"to",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this._create(t,e,i,a,n,r,s,!0,!1,!0)}},{key:"from",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this._create(t,e,i,a,n,r,s,!1,!1,!0)}},{key:"_create",value:function(e,i,a,n,r,s,l,o,u,h){if(!e)throw new Error("Tween:target is null");this._target=e,this._duration=a,this._ease=n||i.ease||t.easeNone,this._complete=r||i.complete,this._delay=s,this._props=[],this._usedTimer=0,this._startTimer=c.Browser.now(),this._usedPool=u,this._delayParam=null,this.update=i.update;var _=e.$_GID||(e.$_GID=d.Utils.getGID());return t.tweenMap[_]?(l&&t.clearTween(e),t.tweenMap[_].push(this)):t.tweenMap[_]=[this],h?s<=0?this.firstStart(e,i,o):(this._delayParam=[e,i,o],f.ILaya.timer.once(s,this,this.firstStart,this._delayParam)):this._initProps(e,i,o),this}},{key:"firstStart",value:function(t,e,i){this._delayParam=null,t.destroyed?this.clear():(this._initProps(t,e,i),this._beginLoop())}},{key:"_initProps",value:function(t,e,i){for(var a in e)if("number"==typeof t[a]){var n=i?t[a]:e[a],r=i?e[a]:t[a];this._props.push([a,n,r-n]),i||(t[a]=n)}}},{key:"_beginLoop",value:function(){f.ILaya.timer.frameLoop(1,this,this._doEase)}},{key:"_doEase",value:function(){this._updateEase(c.Browser.now())}},{key:"_updateEase",value:function(e){var i=this._target;if(i){if(i.destroyed)return t.clearTween(i);var a=this._usedTimer=e-this._startTimer-this._delay;if(!(a<0)){if(a>=this._duration)return this.complete();for(var n=a>0?this._ease(a,0,1,this._duration):0,r=this._props,s=0,l=r.length;s<l;s++){var o=r[s];i[o[0]]=o[1]+n*o[2]}this.update&&this.update.run()}}}},{key:"progress",set:function(t){var e=t*this._duration;this._startTimer=c.Browser.now()-this._delay-e}},{key:"complete",value:function(){if(this._target){f.ILaya.timer.runTimer(this,this.firstStart);for(var t=this._target,e=this._props,i=this._complete,a=0,n=e.length;a<n;a++){var s=e[a];t[s[0]]=s[1]+s[2]}this.update&&this.update.run(),this._count++,0!=(0,r.default)(this)&&this._count>=(0,r.default)(this)?(this.clear(),i&&i.run()):this.restart()}}},{key:"pause",value:function(){var t;f.ILaya.timer.clear(this,this._beginLoop),f.ILaya.timer.clear(this,this._doEase),f.ILaya.timer.clear(this,this.firstStart),(t=c.Browser.now()-this._startTimer-this._delay)<0&&(this._usedTimer=t)}},{key:"setStartTime",value:function(t){this._startTimer=t}},{key:"clear",value:function(){this._target&&(this._remove(),this._clear())}},{key:"_clear",value:function(){this.pause(),f.ILaya.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this.repeat=1,this._usedPool&&(this.update=null,h.Pool.recover("tween",this))}},{key:"recover",value:function(){this._usedPool=!0,this._clear()}},{key:"_remove",value:function(){var e=t.tweenMap[this._target.$_GID];if(e)for(var i=0,a=e.length;i<a;i++)if(e[i]===this){(0,s.default)(e).call(e,i,1);break}}},{key:"restart",value:function(){if(this.pause(),this._usedTimer=0,this._startTimer=c.Browser.now(),this._delayParam)f.ILaya.timer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var t=this._props,e=0,i=t.length;e<i;e++){var a=t[e];this._target[a[0]]=a[1]}f.ILaya.timer.once(this._delay,this,this._beginLoop)}}},{key:"resume",value:function(){this._usedTimer>=this._duration||(this._startTimer=c.Browser.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?f.ILaya.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())}}],[{key:"to",value:function(e,i,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return h.Pool.getItemByClass("tween",t)._create(e,i,a,n,r,s,l,!0,o,!0)}},{key:"from",value:function(e,i,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return h.Pool.getItemByClass("tween",t)._create(e,i,a,n,r,s,l,!1,o,!0)}},{key:"clearAll",value:function(e){if(e&&e.$_GID){var i=t.tweenMap[e.$_GID];if(i){for(var a=0,n=i.length;a<n;a++)i[a]._clear();i.length=0}}}},{key:"clear",value:function(t){t.clear()}},{key:"clearTween",value:function(e){t.clearAll(e)}},{key:"easeNone",value:function(t,e,i,a){return i*t/a+e}}]),t}();e.Tween=_,(0,u.default)(_,"tweenMap",[])},11179:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Utils=void 0;var r=n(i(54103)),s=n(i(94198)),l=n(i(23054)),o=n(i(81643)),u=n(i(87368)),h=n(i(28146)),c=n(i(17454)),d=i(91020),f=i(63701),_=i(93561),v=function(){function t(){(0,u.default)(this,t)}return(0,h.default)(t,null,[{key:"toRadian",value:function(e){return e*t._pi2}},{key:"toAngle",value:function(e){return e*t._pi}},{key:"toHexColor",value:function(t){if(t<0||isNaN(t))return null;for(var e=t.toString(16);e.length<6;)e="0"+e;return"#"+e}},{key:"getGID",value:function(){return t._gid++}},{key:"concatArray",value:function(t,e){if(!e)return t;if(!t)return e;var i,a=e.length;for(i=0;i<a;i++)t.push(e[i]);return t}},{key:"clearArray",value:function(t){return t?(t.length=0,t):t}},{key:"copyArray",value:function(t,e){if(t||(t=[]),!e)return t;t.length=e.length;var i,a=e.length;for(i=0;i<a;i++)t[i]=e[i];return t}},{key:"getGlobalRecByPoints",value:function(t,e,i,a,n){var r,s;r=d.Point.create().setTo(e,i),r=t.localToGlobal(r),s=d.Point.create().setTo(a,n),s=t.localToGlobal(s);var l=f.Rectangle._getWrapRec([r.x,r.y,s.x,s.y]);return r.recover(),s.recover(),l}},{key:"getGlobalPosAndScale",value:function(e){return t.getGlobalRecByPoints(e,0,0,1,1)}},{key:"bind",value:function(t,e){return(0,r.default)(t).call(t,e)}},{key:"updateOrder",value:function(t){if(!t||t.length<2)return!1;for(var e,i,a,n=1,r=t.length;n<r;){for(a=t[e=n],i=t[e]._zOrder;--e>-1&&t[e]._zOrder>i;)t[e+1]=t[e];t[e+1]=a,n++}return!0}},{key:"transPointList",value:function(t,e,i){var a,n=t.length;for(a=0;a<n;a+=2)t[a]+=e,t[a+1]+=i}},{key:"parseInt",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(0,s.default)(t,e);return isNaN(i)?0:i}))},{key:"getFileExtension",value:function(e){t._extReg.lastIndex=(0,l.default)(e).call(e,".");var i=t._extReg.exec(e);return i&&i.length>1?i[1].toLowerCase():null}},{key:"getFilecompatibleExtension",value:function(t){var e=t.split("."),i=e.length;return e.length>2?e[i-2]+"."+e[i-1]:null}},{key:"getTransformRelativeToWindow",value:function(e,i,a){var n=t.gStage,r=t.getGlobalPosAndScale(e),s=n._canvasTransform.clone(),l=s.tx,o=s.ty;s.rotate(-Math.PI/180*n.canvasDegree),s.scale(n.clientScaleX,n.clientScaleY);var u,h,c,d,f=n.canvasDegree%180!=0;return f?(u=a+r.y,h=i+r.x,u*=s.d,h*=s.a,90==n.canvasDegree?(u=l-u,h+=o):(u+=l,h=o-h)):(u=i+r.x,h=a+r.y,u*=s.a,h*=s.d,u+=l,h+=o),h+=n._safariOffsetY,f?(c=s.d*r.height,d=s.a*r.width):(c=s.a*r.width,d=s.d*r.height),{x:u,y:h,scaleX:c,scaleY:d}}},{key:"fitDOMElementInArea",value:function(e,i,a,n,r,s){e._fitLayaAirInitialized||(e._fitLayaAirInitialized=!0,e.style.transformOrigin=e.style.webKittransformOrigin="left top",e.style.position="absolute");var l=t.getTransformRelativeToWindow(i,a,n);e.style.transform=e.style.webkitTransform="scale("+l.scaleX+","+l.scaleY+") rotate("+t.gStage.canvasDegree+"deg)",e.style.width=r+"px",e.style.height=s+"px",e.style.left=l.x+"px",e.style.top=l.y+"px"}},{key:"isOkTextureList",value:function(t){if(!t)return!1;var e,i,a=t.length;for(e=0;e<a;e++)if(!(i=t[e])||!i._getSource())return!1;return!0}},{key:"isOKCmdList",value:function(t){if(!t)return!1;var e,i=t.length;for(e=0;e<i;e++)t[e];return!0}},{key:"getQueryString",value:function(t){if(_.ILaya.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null}}]),t}();e.Utils=v,(0,c.default)(v,"gStage",null),(0,c.default)(v,"_gid",1),(0,c.default)(v,"_pi",180/Math.PI),(0,c.default)(v,"_pi2",Math.PI/180),(0,c.default)(v,"_extReg",/\.(\w+)\??/g),(0,c.default)(v,"parseXMLFromString",(function(t){var e,i;if(t=t.replace(/>\s+</g,"><"),i=(new DOMParser).parseFromString(t,"text/xml"),(0,o.default)(e=i.firstChild.textContent).call(e,"This page contains the following errors")>-1)throw new Error(i.firstChild.firstChild.textContent);return i}))},48331:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.VectorGraphManager=void 0;var r=n(i(54103)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(68173),h=function(){function t(){var e,i;(0,s.default)(this,t),(0,o.default)(this,"useDic",{}),(0,o.default)(this,"shapeDic",{}),(0,o.default)(this,"shapeLineDic",{}),(0,o.default)(this,"_id",0),(0,o.default)(this,"_checkKey",!1),(0,o.default)(this,"_freeIdArray",[]),u.CacheManger.regCacheByFunction((0,r.default)(e=this.startDispose).call(e,this),(0,r.default)(i=this.getCacheList).call(i,this))}return(0,l.default)(t,[{key:"getId",value:function(){return this._id++}},{key:"addShape",value:function(t,e){this.shapeDic[t]=e,this.useDic[t]||(this.useDic[t]=!0)}},{key:"addLine",value:function(t,e){this.shapeLineDic[t]=e,this.shapeLineDic[t]||(this.shapeLineDic[t]=!0)}},{key:"getShape",value:function(t){this._checkKey&&null!=this.useDic[t]&&(this.useDic[t]=!0)}},{key:"deleteShape",value:function(t){this.shapeDic[t]&&(this.shapeDic[t]=null,delete this.shapeDic[t]),this.shapeLineDic[t]&&(this.shapeLineDic[t]=null,delete this.shapeLineDic[t]),null!=this.useDic[t]&&delete this.useDic[t]}},{key:"getCacheList",value:function(){var t,e=[];for(t in this.shapeDic)e.push(this.shapeDic[t]);for(t in this.shapeLineDic)e.push(this.shapeLineDic[t]);return e}},{key:"startDispose",value:function(t){var e;for(e in this.useDic)this.useDic[e]=!1;this._checkKey=!0}},{key:"endDispose",value:function(){if(this._checkKey){var t;for(t in this.useDic)this.useDic[t]||this.deleteShape(t);this._checkKey=!1}}}],[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}]),t}();e.VectorGraphManager=h},57964:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.WeakObject=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11179),u=i(93561),h=function(){function t(){(0,r.default)(this,t),this._obj={},t._maps.push(this)}return(0,s.default)(t,[{key:"set",value:function(e,i){null!=e&&(t.supportWeakMap||("string"==typeof e||"number"==typeof e?this._obj[e]=i:(e.$_GID||(e.$_GID=o.Utils.getGID()),this._obj[e.$_GID]=i)))}},{key:"get",value:function(e){return null==e?null:t.supportWeakMap?void 0:"string"==typeof e||"number"==typeof e?this._obj[e]:this._obj[e.$_GID]}},{key:"del",value:function(e){null!=e&&(t.supportWeakMap||("string"==typeof e||"number"==typeof e?delete this._obj[e]:delete this._obj[this._obj.$_GID]))}},{key:"has",value:function(e){return null!=e&&!t.supportWeakMap&&("string"==typeof e||"number"==typeof e?null!=this._obj[e]:null!=this._obj[this._obj.$_GID])}}],[{key:"__init__",value:function(){t.I=new t,t.supportWeakMap||u.ILaya.systemTimer.loop(t.delInterval,null,t.clearCache)}},{key:"clearCache",value:function(){for(var e=0,i=t._maps.length;e<i;e++)t._maps[e]._obj={}}}]),t}();e.WeakObject=h,(0,l.default)(h,"supportWeakMap",!1),(0,l.default)(h,"delInterval",6e5),(0,l.default)(h,"_maps",[])},87956:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.WordText=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"save",[]),(0,l.default)(this,"toUpperCase",null),(0,l.default)(this,"width",-1),(0,l.default)(this,"pageChars",[]),(0,l.default)(this,"startID",0),(0,l.default)(this,"startIDStroke",0),(0,l.default)(this,"lastGCCnt",0),(0,l.default)(this,"splitRender",!1),(0,l.default)(this,"scalex",1),(0,l.default)(this,"scaley",1)}return(0,s.default)(t,[{key:"setText",value:function(t){this.changed=!0,this._text=t,this.width=-1,this.cleanCache()}},{key:"toString",value:function(){return this._text}},{key:"length",get:function(){return this._text?this._text.length:0}},{key:"charCodeAt",value:function(t){return this._text?this._text.charCodeAt(t):NaN}},{key:"charAt",value:function(t){return this._text?this._text.charAt(t):null}},{key:"cleanCache",value:function(){var t=this.pageChars;for(var e in t){var i=t[e],a=i.tex;1==i.words.length&&a&&a.ri&&a.destroy()}this.pageChars=[],this.startID=0,this.scalex=1,this.scaley=1}}]),t}();e.WordText=o},25126:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.BufferState2D=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669));var c=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,l.default)(this,r),n.call(this)}return(0,s.default)(r)}(i(87090).BufferStateBase);e.BufferState2D=c},87090:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BufferStateBase=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(54008),o=function(){function t(){(0,r.default)(this,t),this._nativeVertexArrayObject=l.LayaGL.layaGPUInstance.createVertexArray()}return(0,s.default)(t,[{key:"bind",value:function(){t._curBindedBufferState!==this&&(l.LayaGL.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this)}},{key:"unBind",value:function(){if(t._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";l.LayaGL.layaGPUInstance.bindVertexArray(null),t._curBindedBufferState=null}},{key:"destroy",value:function(){l.LayaGL.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject)}},{key:"bindForNative",value:function(){l.LayaGL.instance.bindVertexArray(this._nativeVertexArrayObject),t._curBindedBufferState=this}},{key:"unBindForNative",value:function(){l.LayaGL.instance.bindVertexArray(null),t._curBindedBufferState=null}}]),t}();e.BufferStateBase=o},1974:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.LayaGPU=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(20516),u=i(93561),h=i(26024),c=i(27218),d=function(){function t(e,i){(0,r.default)(this,t),(0,l.default)(this,"_gl",null),(0,l.default)(this,"_vaoExt",null),(0,l.default)(this,"_angleInstancedArrays",null),(0,l.default)(this,"_isWebGL2",!1),(0,l.default)(this,"_oesTextureHalfFloat",null),(0,l.default)(this,"_oes_element_index_uint",null),(0,l.default)(this,"_oesTextureHalfFloatLinear",null),(0,l.default)(this,"_oesTextureFloat",null),(0,l.default)(this,"_extShaderTextureLod",null),(0,l.default)(this,"_extTextureFilterAnisotropic",null),(0,l.default)(this,"_compressedTextureS3tc",null),(0,l.default)(this,"_compressedTexturePvrtc",null),(0,l.default)(this,"_compressedTextureEtc1",null),(0,l.default)(this,"_compressedTextureETC",null),(0,l.default)(this,"_compressedTextureASTC",null),(0,l.default)(this,"_webgl_depth_texture",null),(0,l.default)(this,"_extColorBufferFloat",null),this._gl=e,this._isWebGL2=i;var a=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),n=e.getParameter(e.MAX_TEXTURE_SIZE);i?(this._extColorBufferFloat=this._getExtension("EXT_color_buffer_float"),c.SystemUtils._shaderCapailityLevel=35):(u.ILaya.Render.isConchApp||(h.VertexArrayObject,window._setupVertexArrayObject&&window._setupVertexArrayObject(e)),this._vaoExt=this._getExtension("OES_vertex_array_object"),this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays"),this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float"),this._oesTextureHalfFloatLinear=this._getExtension("OES_texture_half_float_linear"),this._oesTextureFloat=this._getExtension("OES_texture_float"),this._oes_element_index_uint=this._getExtension("OES_element_index_uint"),this._extShaderTextureLod=this._getExtension("EXT_shader_texture_lod"),this._webgl_depth_texture=this._getExtension("WEBGL_depth_texture"),c.SystemUtils._shaderCapailityLevel=30),this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic"),this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc"),this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1"),this._compressedTextureETC=this._getExtension("WEBGL_compressed_texture_etc"),this._compressedTextureASTC=this._getExtension("WEBGL_compressed_texture_astc"),c.SystemUtils._maxTextureCount=a,c.SystemUtils._maxTextureSize=n}return(0,s.default)(t,[{key:"_getExtension",value:function(e){var i=t._extentionVendorPrefixes;for(var a in i){var n=this._gl.getExtension(i[a]+e);if(n)return n}return null}},{key:"createVertexArray",value:function(){return this._isWebGL2?this._gl.createVertexArray():this._vaoExt.createVertexArrayOES()}},{key:"bindVertexArray",value:function(t){this._isWebGL2?this._gl.bindVertexArray(t):this._vaoExt.bindVertexArrayOES(t)}},{key:"deleteVertexArray",value:function(t){this._isWebGL2?this._gl.deleteVertexArray(t):this._vaoExt.deleteVertexArrayOES(t)}},{key:"isVertexArray",value:function(t){this._isWebGL2?this._gl.isVertexArray(t):this._vaoExt.isVertexArrayOES(t)}},{key:"drawElementsInstanced",value:function(t,e,i,a,n){this._isWebGL2?this._gl.drawElementsInstanced(t,e,i,a,n):this._angleInstancedArrays.drawElementsInstancedANGLE(t,e,i,a,n)}},{key:"drawArraysInstanced",value:function(t,e,i,a){this._isWebGL2?this._gl.drawArraysInstanced(t,e,i,a):this._angleInstancedArrays.drawArraysInstancedANGLE(t,e,i,a)}},{key:"vertexAttribDivisor",value:function(t,e){this._isWebGL2?this._gl.vertexAttribDivisor(t,e):this._angleInstancedArrays.vertexAttribDivisorANGLE(t,e)}},{key:"supportInstance",value:function(){return!(!this._isWebGL2&&!this._angleInstancedArrays||!o.Config.allowGPUInstanceDynamicBatch)}},{key:"supportElementIndexUint32",value:function(){return!(!this._isWebGL2&&!this._oes_element_index_uint)}}]),t}();e.LayaGPU=d,(0,l.default)(d,"_extentionVendorPrefixes",["","WEBKIT_","MOZ_"])},27218:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SystemUtils=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(54008),o=i(96719),u=i(52719),h=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"maxTextureCount",get:function(){return this._maxTextureCount}},{key:"maxTextureSize",get:function(){return this._maxTextureSize}},{key:"shaderCapailityLevel",get:function(){return this._shaderCapailityLevel}},{key:"supportTextureFormat",value:function(t){switch(t){case o.TextureFormat.R32G32B32A32:return!(!l.LayaGL.layaGPUInstance._isWebGL2&&!l.LayaGL.layaGPUInstance._oesTextureFloat);case o.TextureFormat.R16G16B16A16:return!(!l.LayaGL.layaGPUInstance._isWebGL2&&!l.LayaGL.layaGPUInstance._oesTextureHalfFloat);default:return!0}}},{key:"supportRenderTextureFormat",value:function(t){switch(t){case u.RenderTextureFormat.R16G16B16A16:return!!(l.LayaGL.layaGPUInstance._isWebGL2&&l.LayaGL.layaGPUInstance._extColorBufferFloat||l.LayaGL.layaGPUInstance._oesTextureHalfFloat&&l.LayaGL.layaGPUInstance._oesTextureHalfFloatLinear);case u.RenderTextureFormat.Depth:return!(!l.LayaGL.layaGPUInstance._isWebGL2&&!l.LayaGL.layaGPUInstance._webgl_depth_texture);case u.RenderTextureFormat.ShadowMap:return!!l.LayaGL.layaGPUInstance._isWebGL2;default:return!0}}}]),t}();e.SystemUtils=h},26024:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.VertexArrayObject=void 0;var r=n(i(94198)),s=n(i(92762)),l=n(i(81643)),o=n(i(28146)),u=n(i(87368)),h=(0,o.default)((function t(){(0,u.default)(this,t)}));e.VertexArrayObject=h,function(){var t={};var e=function t(e){var i=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var a=0;a<this.attribs.length;a++){var n=new t.VertexAttrib(i);this.attribs[a]=n}this.maxAttrib=0};(e.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=t.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var i=function(e){var i=this;this.gl=e,function(e){var i=e.getError;e.getError=function(){var a;do{(a=i.apply(e))!=e.NO_ERROR&&(t[a]=!0)}while(a!=e.NO_ERROR);for(var n in t)if(t[n])return delete t[n],(0,r.default)(n);return e.NO_ERROR}}(e);var a=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(t){return t==i.VERTEX_ARRAY_BINDING_OES?i.currentVertexArrayObject==i.defaultVertexArrayObject?null:i.currentVertexArrayObject:a.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(t){var e=i.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var n=e.attribs[t];return n.enabled=!0,a.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(t){var e=i.currentVertexArrayObject;e.maxAttrib=Math.max(e.maxAttrib,t);var n=e.attribs[t];return n.enabled=!1,a.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(t,n){switch(t){case e.ARRAY_BUFFER:i.currentArrayBuffer=n;break;case e.ELEMENT_ARRAY_BUFFER:i.currentVertexArrayObject.elementArrayBuffer=n}return a.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(t,n){var r=i.currentVertexArrayObject,s=r.attribs[t];switch(n){case e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return s.buffer;case e.VERTEX_ATTRIB_ARRAY_ENABLED:return s.enabled;case e.VERTEX_ATTRIB_ARRAY_SIZE:return s.size;case e.VERTEX_ATTRIB_ARRAY_STRIDE:return s.stride;case e.VERTEX_ATTRIB_ARRAY_TYPE:return s.type;case e.VERTEX_ATTRIB_ARRAY_NORMALIZED:return s.normalized;default:return a.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(t,e,n,r,s,l){var o=i.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,t);var u=o.attribs[t];return u.buffer=i.currentArrayBuffer,u.size=e,u.type=n,u.normalized=r,u.stride=s,u.offset=l,u.recache(),a.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas.addEventListener("webglcontextrestored",(function(){window.console&&window.console.log&&window.console.log("OESVertexArrayObject emulation library context restored"),i.reset_()}),!0),this.reset_()};i.prototype.VERTEX_ARRAY_BINDING_OES=34229,i.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var i=this.gl;this.maxVertexAttribs=i.getParameter(i.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new e(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},i.prototype.createVertexArrayOES=function(){var t=new e(this);return this.vertexArrayObjects.push(t),t},i.prototype.deleteVertexArrayOES=function(t){var e,i;t.isAlive=!1,(0,s.default)(e=this.vertexArrayObjects).call(e,(0,l.default)(i=this.vertexArrayObjects).call(i,t),1),this.currentVertexArrayObject==t&&this.bindVertexArrayOES(null)},i.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof e&&t.hasBeenBound&&t.ext==this)},i.prototype.bindVertexArrayOES=function(e){var i,a,n,r=this.gl;if(!e||e.isAlive){var s=this.original,l=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var o=this.currentVertexArrayObject;if(l!=o){l&&o.elementArrayBuffer==l.elementArrayBuffer||s.bindBuffer.call(r,r.ELEMENT_ARRAY_BUFFER,o.elementArrayBuffer);for(var u=this.currentArrayBuffer,h=Math.max(l?l.maxAttrib:0,o.maxAttrib),c=0;c<=h;c++){var d=o.attribs[c],f=l?l.attribs[c]:null;if(l&&d.enabled==f.enabled||(d.enabled?s.enableVertexAttribArray.call(r,c):s.disableVertexAttribArray.call(r,c)),d.enabled){var _=!1;l&&d.buffer==f.buffer||(u!=d.buffer&&(s.bindBuffer.call(r,r.ARRAY_BUFFER,d.buffer),u=d.buffer),_=!0),(_||d.cached!=f.cached)&&s.vertexAttribPointer.call(r,c,d.size,d.type,d.normalized,d.stride,d.offset)}}this.currentArrayBuffer!=u&&s.bindBuffer.call(r,r.ARRAY_BUFFER,this.currentArrayBuffer)}}else i=r.INVALID_OPERATION,a="bindVertexArrayOES: attempt to bind deleted arrayObject",t[i]=!0,void 0!==a&&(n=a,window.console&&window.console.error&&window.console.error(n))},window._setupVertexArrayObject=function(t){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return(0,l.default)(t).call(t,"OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var a=t.getExtension;t.getExtension=function(t){return a.call(this,t)||("OES_vertex_array_object"!==t?null:(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new i(this)),this.__OESVertexArrayObject))}}}()},56843:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.WebGL=void 0;var r=n(i(3649)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(33965),h=i(52379),c=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"_uint8ArraySlice",value:function(){for(var t=this,e=t.length,i=new Uint8Array(t.length),a=0;a<e;a++)i[a]=t[a];return i}},{key:"_float32ArraySlice",value:function(){for(var t=this,e=t.length,i=new Float32Array(t.length),a=0;a<e;a++)i[a]=t[a];return i}},{key:"_uint16ArraySlice",value:function(){var t,e,i,a=this;if(0===arguments.length)for(t=a.length,e=new Uint16Array(t),i=0;i<t;i++)e[i]=a[i];else if(2===arguments.length){var n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];if(r>n)for(t=r-n,e=new Uint16Array(t),i=n;i<r;i++)e[i-n]=a[i];else e=new Uint16Array(0)}return e}},{key:"_nativeRender_enable",value:function(){}},{key:"enable",value:function(){return!0}},{key:"inner_enable",value:function(){return(0,r.default)(Float32Array.prototype)||(Float32Array.prototype.slice=t._float32ArraySlice),(0,r.default)(Uint16Array.prototype)||(Uint16Array.prototype.slice=t._uint16ArraySlice),(0,r.default)(Uint8Array.prototype)||(Uint8Array.prototype.slice=t._uint8ArraySlice),!0}},{key:"onStageResize",value:function(t,e){null!=h.WebGLContext.mainContext&&(h.WebGLContext.mainContext.viewport(0,0,t,e),u.RenderState2D.width=t,u.RenderState2D.height=e)}}]),t}();e.WebGL=c,(0,o.default)(c,"_isWebGL2",!1),(0,o.default)(c,"isNativeRender_enable",!1)},52379:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.WebGLContext=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(93561),u=i(54008),h=1,c=0,d=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"__init__",value:function(){var e=u.LayaGL.instance;t._depthFunc=e.LESS,t._blendEquation=e.FUNC_ADD,t._blendEquationRGB=e.FUNC_ADD,t._blendEquationAlpha=e.FUNC_ADD,h=e.ONE,c=e.ZERO,t._sFactorAlpha=e.ONE,t._dFactorAlpha=e.ZERO,t._activedTextureID=e.TEXTURE0;var i=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);t._activeTextures=new Array(i),t._glTextureIDs=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7,e.TEXTURE8,e.TEXTURE9,e.TEXTURE10,e.TEXTURE11,e.TEXTURE12,e.TEXTURE13,e.TEXTURE14,e.TEXTURE15,e.TEXTURE16,e.TEXTURE17,e.TEXTURE18,e.TEXTURE19,e.TEXTURE20,e.TEXTURE21,e.TEXTURE22,e.TEXTURE23,e.TEXTURE24,e.TEXTURE25,e.TEXTURE26,e.TEXTURE27,e.TEXTURE28,e.TEXTURE29,e.TEXTURE30,e.TEXTURE31];var a=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),n=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);t._maxUniformFragmentVectors=Math.min(a,n)}},{key:"useProgram",value:function(e,i){return t._useProgram!==i&&(e.useProgram(i),t._useProgram=i,!0)}},{key:"setDepthTest",value:function(e,i){i!==t._depthTest&&(t._depthTest=i,i?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST))}},{key:"setDepthMask",value:function(e,i){i!==t._depthMask&&(t._depthMask=i,e.depthMask(i))}},{key:"setDepthFunc",value:function(e,i){i!==t._depthFunc&&(t._depthFunc=i,e.depthFunc(i))}},{key:"setBlend",value:function(e,i){i!==t._blend&&(t._blend=i,i?e.enable(e.BLEND):e.disable(e.BLEND))}},{key:"setBlendEquation",value:function(e,i){i!==t._blendEquation&&(t._blendEquation=i,t._blendEquationRGB=t._blendEquationAlpha=null,e.blendEquation(i))}},{key:"setBlendEquationSeparate",value:function(e,i,a){i===t._blendEquationRGB&&a===t._blendEquationAlpha||(t._blendEquationRGB=i,t._blendEquationAlpha=a,t._blendEquation=null,e.blendEquationSeparate(i,a))}},{key:"setBlendFunc",value:function(e,i,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(n||i!==h||a!==c)&&(h=i,c=a,t._sFactorRGB=null,t._dFactorRGB=null,t._sFactorAlpha=null,t._dFactorAlpha=null,e.blendFunc(i,a))}},{key:"setBlendFuncSeperate",value:function(e,i,a,n,r){i===t._sFactorRGB&&a===t._dFactorRGB&&n===t._sFactorAlpha&&r===t._dFactorAlpha||(t._sFactorRGB=i,t._dFactorRGB=a,t._sFactorAlpha=n,t._dFactorAlpha=r,h=null,c=null,e.blendFuncSeparate(i,a,n,r))}},{key:"setCullFace",value:function(e,i){i!==t._cullFace&&(t._cullFace=i,i?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE))}},{key:"setFrontFace",value:function(e,i){i!==t._frontFace&&(t._frontFace=i,e.frontFace(i))}},{key:"activeTexture",value:function(e,i){t._activedTextureID!==i&&(e.activeTexture(i),t._activedTextureID=i)}},{key:"bindTexture",value:function(e,i,a){t._activeTextures[t._activedTextureID-e.TEXTURE0]!==a&&(e.bindTexture(i,a),t._activeTextures[t._activedTextureID-e.TEXTURE0]=a)}},{key:"__init_native",value:function(){if(o.ILaya.Render.supportWebGLPlusRendering){var e=t;e.activeTexture=e.activeTextureForNative,e.bindTexture=e.bindTextureForNative}}},{key:"useProgramForNative",value:function(t,e){return t.useProgram(e),!0}},{key:"setDepthTestForNative",value:function(t,e){e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)}},{key:"setDepthMaskForNative",value:function(t,e){t.depthMask(e)}},{key:"setDepthFuncForNative",value:function(t,e){t.depthFunc(e)}},{key:"setBlendForNative",value:function(t,e){e?t.enable(t.BLEND):t.disable(t.BLEND)}},{key:"setBlendFuncForNative",value:function(t,e,i){t.blendFunc(e,i)}},{key:"setCullFaceForNative",value:function(t,e){e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)}},{key:"setFrontFaceForNative",value:function(t,e){t.frontFace(e)}},{key:"activeTextureForNative",value:function(t,e){t.activeTexture(e)}},{key:"bindTextureForNative",value:function(t,e,i){t.bindTexture(e,i)}},{key:"bindVertexArrayForNative",value:function(t,e){t.bindVertexArray(e)}},{key:"getUniformMaxVector",value:function(){return t._maxUniformFragmentVectors}}]),t}();e.WebGLContext=d,(0,l.default)(d,"_activeTextures",new Array(1)),(0,l.default)(d,"_useProgram",null),(0,l.default)(d,"_depthTest",!0),(0,l.default)(d,"_depthMask",!0),(0,l.default)(d,"_blend",!1),(0,l.default)(d,"_cullFace",!1),(0,l.default)(d,"mainContext",null)},14972:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BlendMode=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(52379),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"_init_",value:function(e){t.fns=[t.BlendNormal,t.BlendAdd,t.BlendMultiply,t.BlendScreen,t.BlendOverlay,t.BlendLight,t.BlendMask,t.BlendDestinationOut,t.BlendAddOld],t.targetFns=[t.BlendNormalTarget,t.BlendAddTarget,t.BlendMultiplyTarget,t.BlendScreenTarget,t.BlendOverlayTarget,t.BlendLightTarget,t.BlendMask,t.BlendDestinationOut,t.BlendAddTargetOld]}},{key:"BlendNormal",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendAddOld",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA,!0)}},{key:"BlendAdd",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMultiply",value:function(t){o.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendScreen",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendOverlay",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR,!0)}},{key:"BlendLight",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendNormalTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendAddTargetOld",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.DST_ALPHA,!0)}},{key:"BlendAddTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMultiplyTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,!0)}},{key:"BlendScreenTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendOverlayTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR,!0)}},{key:"BlendLightTarget",value:function(t){o.WebGLContext.setBlendFunc(t,t.ONE,t.ONE,!0)}},{key:"BlendMask",value:function(t){o.WebGLContext.setBlendFunc(t,t.ZERO,t.SRC_ALPHA,!0)}},{key:"BlendDestinationOut",value:function(t){o.WebGLContext.setBlendFunc(t,t.ZERO,t.ZERO,!0)}}]),t}();e.BlendMode=u,(0,l.default)(u,"activeBlendFunction",null),(0,l.default)(u,"NAMES",["normal","add","multiply","screen","overlay","light","mask","destination-out","add_old"]),(0,l.default)(u,"TOINT",{normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1,lighter_old:8,add_old:8}),(0,l.default)(u,"NORMAL","normal"),(0,l.default)(u,"MASK","mask"),(0,l.default)(u,"LIGHTER","lighter")},57552:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.DrawStyle=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(53546),u=function(){function t(e){(0,r.default)(this,t),this.setValue(e)}return(0,s.default)(t,[{key:"setValue",value:function(t){this._color=t?t instanceof o.ColorUtils?t:o.ColorUtils.create(t):o.ColorUtils.create("#000000")}},{key:"reset",value:function(){this._color=o.ColorUtils.create("#000000")}},{key:"toInt",value:function(){return this._color.numColor}},{key:"equal",value:function(t){return"string"==typeof t?this._color.strColor===t:t instanceof o.ColorUtils&&this._color.numColor===t.numColor}},{key:"toColorStr",value:function(){return this._color.strColor}}],[{key:"create",value:function(e){if(e){var i=e instanceof o.ColorUtils?e:o.ColorUtils.create(e);return i._drawStyle||(i._drawStyle=new t(e))}return t.DEFAULT}}]),t}();e.DrawStyle=u,(0,l.default)(u,"DEFAULT",new u("#000000"))},23418:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Path=void 0;var r=n(i(3649)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=function(){function t(){(0,s.default)(this,t),(0,o.default)(this,"_lastOriX",0),(0,o.default)(this,"_lastOriY",0),(0,o.default)(this,"paths",[]),(0,o.default)(this,"_curPath",null)}return(0,l.default)(t,[{key:"beginPath",value:function(t){this.paths.length=1,this._curPath=this.paths[0]=new h,this._curPath.convex=t}},{key:"closePath",value:function(){this._curPath.loop=!0}},{key:"newPath",value:function(){this._curPath=new h,this.paths.push(this._curPath)}},{key:"addPoint",value:function(t,e){this._curPath.path.push(t,e)}},{key:"push",value:function(t,e){this._curPath?this._curPath.path.length>0&&(this._curPath=new h,this.paths.push(this._curPath)):(this._curPath=new h,this.paths.push(this._curPath));var i=this._curPath;i.path=(0,r.default)(t).call(t),i.convex=e}},{key:"reset",value:function(){this.paths.length=0}}]),t}();e.Path=u;var h=(0,l.default)((function t(){(0,s.default)(this,t),(0,o.default)(this,"path",[]),(0,o.default)(this,"loop",!1),(0,o.default)(this,"convex",!1)}))},19511:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.WebGLCacheAsNormalCanvas=void 0;var r=n(i(78914)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(5866),h=i(97806),c=i(93543),d=i(45147),f=i(50642),_=function(){function t(e,i){(0,s.default)(this,t),(0,o.default)(this,"submitStartPos",0),(0,o.default)(this,"submitEndPos",0),(0,o.default)(this,"touches",[]),(0,o.default)(this,"submits",[]),(0,o.default)(this,"sprite",null),(0,o.default)(this,"meshlist",[]),(0,o.default)(this,"cachedClipInfo",new u.Matrix),(0,o.default)(this,"oldTx",0),(0,o.default)(this,"oldTy",0),(0,o.default)(this,"invMat",new u.Matrix),this.context=e,this.sprite=i,e._globalClipMatrix.copyTo(this.cachedClipInfo)}return(0,l.default)(t,[{key:"startRec",value:function(){var t=this.context;t._charSubmitCache&&t._charSubmitCache._enable&&(t._charSubmitCache.enable(!1,t),t._charSubmitCache.enable(!0,t)),t._incache=!0,this.touches.length=0,t.touches=this.touches,t._globalClipMatrix.copyTo(this.cachedClipInfo),this.submits.length=0,this.submitStartPos=t._submits._length;for(var e=0,i=this.meshlist.length;e<i;e++){var a=this.meshlist[e];a.canReuse?a.releaseMesh():a.destroy()}this.meshlist.length=0,this._mesh=c.MeshQuadTexture.getAMesh(!1),this._pathMesh=f.MeshVG.getAMesh(!1),this._triangleMesh=d.MeshTexture.getAMesh(!1),this.meshlist.push(this._mesh),this.meshlist.push(this._pathMesh),this.meshlist.push(this._triangleMesh),t._curSubmit=h.SubmitBase.RENDERBASE,this._oldMesh=t._mesh,this._oldPathMesh=t._pathMesh,this._oldTriMesh=t._triangleMesh,this._oldMeshList=t.meshlist,t._mesh=this._mesh,t._pathMesh=this._pathMesh,t._triangleMesh=this._triangleMesh,t.meshlist=this.meshlist,this.oldTx=t._curMat.tx,this.oldTy=t._curMat.ty,t._curMat.tx=0,t._curMat.ty=0,t._curMat.copyTo(this.invMat),this.invMat.invert()}},{key:"endRec",value:function(){var t=this.context;t._charSubmitCache&&t._charSubmitCache._enable&&(t._charSubmitCache.enable(!1,t),t._charSubmitCache.enable(!0,t));var e=t._submits;this.submitEndPos=e._length;for(var i=this.submitEndPos-this.submitStartPos,a=0;a<i;a++)this.submits.push(e[this.submitStartPos+a]);e._length-=i,t._mesh=this._oldMesh,t._pathMesh=this._oldPathMesh,t._triangleMesh=this._oldTriMesh,t.meshlist=this._oldMeshList,t._curSubmit=h.SubmitBase.RENDERBASE,t._curMat.tx=this.oldTx,t._curMat.ty=this.oldTy,t.touches=null,t._incache=!1}},{key:"isCacheValid",value:function(){var t=this.context._globalClipMatrix;return t.a==this.cachedClipInfo.a&&t.b==this.cachedClipInfo.b&&t.c==this.cachedClipInfo.c&&t.d==this.cachedClipInfo.d&&t.tx==this.cachedClipInfo.tx&&t.ty==this.cachedClipInfo.ty}},{key:"flushsubmit",value:function(){var t,e=h.SubmitBase.RENDERBASE;(0,r.default)(t=this.submits).call(t,(function(t){t!=h.SubmitBase.RENDERBASE&&(h.SubmitBase.preRender=e,e=t,t.renderSubmit())}))}},{key:"releaseMem",value:function(){}}]),t}();e.WebGLCacheAsNormalCanvas=_,(0,o.default)(_,"matI",new u.Matrix)},11426:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SaveBase=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(97806),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._dataObj[this._valueName]=this._value,t.POOL[t.POOL._length++]=this,this._newSubmit&&(e._curSubmit=o.SubmitBase.RENDERBASE)}}],[{key:"_createArray",value:function(){var t=[];return t._length=0,t}},{key:"_init",value:function(){var e=t._namemap={};return e[t.TYPE_ALPHA]="ALPHA",e[t.TYPE_FILESTYLE]="fillStyle",e[t.TYPE_FONT]="font",e[t.TYPE_LINEWIDTH]="lineWidth",e[t.TYPE_STROKESTYLE]="strokeStyle",e[t.TYPE_ENABLEMERGE]="_mergeID",e[t.TYPE_MARK]=e[t.TYPE_TRANSFORM]=e[t.TYPE_TRANSLATE]=[],e[t.TYPE_TEXTBASELINE]="textBaseline",e[t.TYPE_TEXTALIGN]="textAlign",e[t.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType",e[t.TYPE_SHADER]="shader",e[t.TYPE_FILTERS]="filters",e[t.TYPE_COLORFILTER]="_colorFiler",e}},{key:"save",value:function(e,i,a,n){if((e._saveMark._saveuse&i)!==i){e._saveMark._saveuse|=i;var r=t.POOL,s=r._length>0?r[--r._length]:new t;s._value=a[s._valueName=t._namemap[i]],s._dataObj=a,s._newSubmit=n;var l=e._save;l[l._length++]=s}}}]),t}();e.SaveBase=u,(0,l.default)(u,"TYPE_ALPHA",1),(0,l.default)(u,"TYPE_FILESTYLE",2),(0,l.default)(u,"TYPE_FONT",8),(0,l.default)(u,"TYPE_LINEWIDTH",256),(0,l.default)(u,"TYPE_STROKESTYLE",512),(0,l.default)(u,"TYPE_MARK",1024),(0,l.default)(u,"TYPE_TRANSFORM",2048),(0,l.default)(u,"TYPE_TRANSLATE",4096),(0,l.default)(u,"TYPE_ENABLEMERGE",8192),(0,l.default)(u,"TYPE_TEXTBASELINE",16384),(0,l.default)(u,"TYPE_TEXTALIGN",32768),(0,l.default)(u,"TYPE_GLOBALCOMPOSITEOPERATION",65536),(0,l.default)(u,"TYPE_CLIPRECT",131072),(0,l.default)(u,"TYPE_CLIPRECT_STENCIL",262144),(0,l.default)(u,"TYPE_IBVB",524288),(0,l.default)(u,"TYPE_SHADER",1048576),(0,l.default)(u,"TYPE_FILTERS",2097152),(0,l.default)(u,"TYPE_FILTERS_TYPE",4194304),(0,l.default)(u,"TYPE_COLORFILTER",8388608),(0,l.default)(u,"POOL",u._createArray()),(0,l.default)(u,"_namemap",u._init())},79870:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SaveClipRect=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11426),u=i(5866),h=i(63701),c=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_globalClipMatrix",new u.Matrix),(0,l.default)(this,"_clipInfoID",-1),(0,l.default)(this,"_clipRect",new h.Rectangle),(0,l.default)(this,"incache",!1)}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._globalClipMatrix.copyTo(e._globalClipMatrix),this._clipRect.clone(e._clipRect),e._clipInfoID=this._clipInfoID,t.POOL[t.POOL._length++]=this,e._clipInCache=this.incache}}],[{key:"save",value:function(e){if((e._saveMark._saveuse&o.SaveBase.TYPE_CLIPRECT)!=o.SaveBase.TYPE_CLIPRECT){e._saveMark._saveuse|=o.SaveBase.TYPE_CLIPRECT;var i=t.POOL,a=i._length>0?i[--i._length]:new t;e._globalClipMatrix.copyTo(a._globalClipMatrix),e._clipRect.clone(a._clipRect),a._clipInfoID=e._clipInfoID,a.incache=e._clipInCache;var n=e._save;n[n._length++]=a}}}]),t}();e.SaveClipRect=c,(0,l.default)(c,"POOL",o.SaveBase._createArray())},51498:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SaveMark=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11426),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_saveuse",0)}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!0}},{key:"restore",value:function(e){e._saveMark=this._preSaveMark,t.POOL[t.POOL._length++]=this}}],[{key:"Create",value:function(e){var i=t.POOL,a=i._length>0?i[--i._length]:new t;return a._saveuse=0,a._preSaveMark=e._saveMark,e._saveMark=a,a}}]),t}();e.SaveMark=u,(0,l.default)(u,"POOL",o.SaveBase._createArray())},47314:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SaveTransform=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11426),u=i(5866),h=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_matrix",new u.Matrix)}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){e._curMat=this._savematrix,t.POOL[t.POOL._length++]=this}}],[{key:"save",value:function(e){var i=e._saveMark;if((i._saveuse&o.SaveBase.TYPE_TRANSFORM)!==o.SaveBase.TYPE_TRANSFORM){i._saveuse|=o.SaveBase.TYPE_TRANSFORM;var a=t.POOL,n=a._length>0?a[--a._length]:new t;n._savematrix=e._curMat,e._curMat=e._curMat.copyTo(n._matrix);var r=e._save;r[r._length++]=n}}}]),t}();e.SaveTransform=h,(0,l.default)(h,"POOL",o.SaveBase._createArray())},56790:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SaveTranslate=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(11426),u=i(5866),h=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_mat",new u.Matrix)}return(0,s.default)(t,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._mat.copyTo(e._curMat),t.POOL[t.POOL._length++]=this}}],[{key:"save",value:function(e){var i=t.POOL,a=i._length>0?i[--i._length]:new t;e._curMat.copyTo(a._mat);var n=e._save;n[n._length++]=a}}]),t}();e.SaveTranslate=h,(0,l.default)(h,"POOL",o.SaveBase._createArray())},83530:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.BaseShader=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669));var c=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,l.default)(this,r),n.call(this)}return(0,s.default)(r)}(i(8865).Resource);e.BaseShader=c},23857:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Shader=void 0;var s=r(i(81643)),l=r(i(54103)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(93561),y=i(14880),p=i(28498),g=i(52379),m=i(83530),x=i(54008);var T=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(t,e){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,o.default)(this,r),i=n.call(this),(0,_.default)((0,h.default)(i),"_attribInfo",null),(0,_.default)((0,h.default)(i),"customCompile",!1),(0,_.default)((0,h.default)(i),"_curActTexIndex",0),(0,_.default)((0,h.default)(i),"tag",{}),(0,_.default)((0,h.default)(i),"_program",null),(0,_.default)((0,h.default)(i),"_params",null),(0,_.default)((0,h.default)(i),"_paramsMap",{}),!t||!e)throw"Shader Error";return i._attribInfo=l,i._id=++r._count,i._vs=t,i._ps=e,i._nameMap=s||{},null!=a&&(r.sharders[a]=(0,h.default)(i)),i.recreateResource(),i.lock=!0,i}return(0,u.default)(r,[{key:"recreateResource",value:function(){this._compile(),this._setGPUMemory(0)}},{key:"_disposeResource",value:function(){g.WebGLContext.mainContext.deleteShader(this._vshader),g.WebGLContext.mainContext.deleteShader(this._pshader),g.WebGLContext.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0}},{key:"_compile",value:function(){if(this._vs&&this._ps&&!this._params){var t;this._reCompile=!0,this._params=[],this.customCompile&&(t=v.ILaya.ShaderCompile.preGetParams(this._vs,this._ps));var e,i,a,n=g.WebGLContext.mainContext;this._program=n.createProgram(),this._vshader=r._createShader(n,this._vs,n.VERTEX_SHADER),this._pshader=r._createShader(n,this._ps,n.FRAGMENT_SHADER),n.attachShader(this._program,this._vshader),n.attachShader(this._program,this._pshader);var l=this._attribInfo?this._attribInfo.length:0;for(i=0;i<l;i+=2)n.bindAttribLocation(this._program,this._attribInfo[i+1],this._attribInfo[i]);if(n.linkProgram(this._program),!this.customCompile&&!n.getProgramParameter(this._program,n.LINK_STATUS))throw n.getProgramInfoLog(this._program);var o=this.customCompile?t.uniforms.length:n.getProgramParameter(this._program,n.ACTIVE_UNIFORMS);for(i=0;i<o;i++){var u,h=this.customCompile?t.uniforms[i]:n.getActiveUniform(this._program,i);e={vartype:"uniform",glfun:null,ivartype:1,location:n.getUniformLocation(this._program,h.name),name:h.name,type:h.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},(0,s.default)(u=e.name).call(u,"[0]")>0&&(e.name=e.name.substr(0,e.name.length-3),e.isArray=!0,e.location=n.getUniformLocation(this._program,e.name)),this._params.push(e)}for(i=0,a=this._params.length;i<a;i++)switch((e=this._params[i]).indexOfParams=i,e.index=1,e.value=[e.location,null],e.codename=e.name,e.name=this._nameMap[e.codename]?this._nameMap[e.codename]:e.codename,this._paramsMap[e.name]=e,e._this=this,e.uploadedValue=[],e.type){case n.INT:e.fun=e.isArray?this._uniform1iv:this._uniform1i;break;case n.FLOAT:e.fun=e.isArray?this._uniform1fv:this._uniform1f;break;case n.FLOAT_VEC2:e.fun=e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case n.FLOAT_VEC3:e.fun=e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case n.FLOAT_VEC4:e.fun=e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case n.SAMPLER_2D:e.fun=this._uniform_sampler2D;break;case n.SAMPLER_CUBE:e.fun=this._uniform_samplerCube;break;case n.FLOAT_MAT4:e.glfun=n.uniformMatrix4fv,e.fun=this._uniformMatrix4fv;break;case n.BOOL:e.fun=this._uniform1i;break;case n.FLOAT_MAT2:case n.FLOAT_MAT3:default:throw new Error("compile shader err!")}}}},{key:"getUniform",value:function(t){return this._paramsMap[t]}},{key:"_uniform1f",value:function(t,e){var i=t.uploadedValue;return i[0]!==e?(g.WebGLContext.mainContext.uniform1f(t.location,i[0]=e),1):0}},{key:"_uniform1fv",value:function(t,e){if(e.length<4){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(g.WebGLContext.mainContext.uniform1fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return g.WebGLContext.mainContext.uniform1fv(t.location,e),1}},{key:"_uniform_vec2",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(g.WebGLContext.mainContext.uniform2f(t.location,i[0]=e[0],i[1]=e[1]),1):0}},{key:"_uniform_vec2v",value:function(t,e){if(e.length<2){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(g.WebGLContext.mainContext.uniform2fv(t.location,e),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],1):0}return g.WebGLContext.mainContext.uniform2fv(t.location,e),1}},{key:"_uniform_vec3",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(g.WebGLContext.mainContext.uniform3f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0}},{key:"_uniform_vec3v",value:function(t,e){return g.WebGLContext.mainContext.uniform3fv(t.location,e),1}},{key:"_uniform_vec4",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(g.WebGLContext.mainContext.uniform4f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0}},{key:"_uniform_vec4v",value:function(t,e){return g.WebGLContext.mainContext.uniform4fv(t.location,e),1}},{key:"_uniformMatrix2fv",value:function(t,e){return g.WebGLContext.mainContext.uniformMatrix2fv(t.location,!1,e),1}},{key:"_uniformMatrix3fv",value:function(t,e){return g.WebGLContext.mainContext.uniformMatrix3fv(t.location,!1,e),1}},{key:"_uniformMatrix4fv",value:function(t,e){return g.WebGLContext.mainContext.uniformMatrix4fv(t.location,!1,e),1}},{key:"_uniform1i",value:function(t,e){var i=t.uploadedValue;return i[0]!==e?(g.WebGLContext.mainContext.uniform1i(t.location,i[0]=e),1):0}},{key:"_uniform1iv",value:function(t,e){return g.WebGLContext.mainContext.uniform1iv(t.location,e),1}},{key:"_uniform_ivec2",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]?(g.WebGLContext.mainContext.uniform2i(t.location,i[0]=e[0],i[1]=e[1]),1):0}},{key:"_uniform_ivec2v",value:function(t,e){return g.WebGLContext.mainContext.uniform2iv(t.location,e),1}},{key:"_uniform_vec3i",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]?(g.WebGLContext.mainContext.uniform3i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]),1):0}},{key:"_uniform_vec3vi",value:function(t,e){return g.WebGLContext.mainContext.uniform3iv(t.location,e),1}},{key:"_uniform_vec4i",value:function(t,e){var i=t.uploadedValue;return i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]?(g.WebGLContext.mainContext.uniform4i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),1):0}},{key:"_uniform_vec4vi",value:function(t,e){return g.WebGLContext.mainContext.uniform4iv(t.location,e),1}},{key:"_uniform_sampler2D",value:function(t,e){var i=g.WebGLContext.mainContext,a=t.uploadedValue;return null==a[0]?(a[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),g.WebGLContext.activeTexture(i,i.TEXTURE0+this._curActTexIndex),g.WebGLContext.bindTexture(i,i.TEXTURE_2D,e),this._curActTexIndex++,1):(g.WebGLContext.activeTexture(i,i.TEXTURE0+a[0]),g.WebGLContext.bindTexture(i,i.TEXTURE_2D,e),0)}},{key:"_uniform_samplerCube",value:function(t,e){var i=g.WebGLContext.mainContext,a=t.uploadedValue;return null==a[0]?(a[0]=this._curActTexIndex,i.uniform1i(t.location,this._curActTexIndex),g.WebGLContext.activeTexture(i,i.TEXTURE0+this._curActTexIndex),g.WebGLContext.bindTexture(i,i.TEXTURE_CUBE_MAP,e),this._curActTexIndex++,1):(g.WebGLContext.activeTexture(i,i.TEXTURE0+a[0]),g.WebGLContext.bindTexture(i,i.TEXTURE_CUBE_MAP,e),0)}},{key:"_noSetValue",value:function(t){console.log("no....:"+t.name)}},{key:"uploadOne",value:function(t,e){g.WebGLContext.useProgram(g.WebGLContext.mainContext,this._program);var i=this._paramsMap[t];i.fun.call(this,i,e)}},{key:"uploadTexture2D",value:function(t){var e=g.WebGLContext;e._activeTextures[0]!==t&&(e.bindTexture(g.WebGLContext.mainContext,x.LayaGL.instance.TEXTURE_2D,t),e._activeTextures[0]=t)}},{key:"upload",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;m.BaseShader.activeShader=m.BaseShader.bindShader=this;var i=g.WebGLContext.mainContext;g.WebGLContext.useProgram(i,this._program),this._reCompile?(e=this._params,this._reCompile=!1):e=e||this._params;for(var a,n,r=e.length,s=0,l=0;l<r;l++)null!==(n=t[(a=e[l]).name])&&(s+=a.fun.call(this,a,n));y.Stat.shaderCall+=s}},{key:"uploadArray",value:function(t,e,i){m.BaseShader.activeShader=this,m.BaseShader.bindShader=this,g.WebGLContext.useProgram(g.WebGLContext.mainContext,this._program),this._params;for(var a,n,r=0,s=e-2;s>=0;s-=2){var o;(n=this._paramsMap[t[s]])&&null!=(a=t[s+1])&&(i&&i[n.name]&&(0,l.default)(o=i[n.name]).call(o),r+=n.fun.call(this,n,a))}y.Stat.shaderCall+=r}},{key:"getParams",value:function(){return this._params}},{key:"setAttributesLocation",value:function(t){this._attribInfo=t}}],[{key:"getShader",value:function(t){return r.sharders[t]}},{key:"create",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new r(t,e,i,a,n)}},{key:"withCompile",value:function(t,e,i,a){if(i&&r.sharders[i])return r.sharders[i];var n=r._preCompileShader[r.SHADERNAME2ID*t];if(!n)throw new Error("withCompile shader err!"+t);return n.createShader(e,i,a,null)}},{key:"withCompile2D",value:function(t,e,i,a,n){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(a&&r.sharders[a])return r.sharders[a];var l=r._preCompileShader[r.SHADERNAME2ID*t+e];if(!l)throw new Error("withCompile shader err!"+t+" "+e);return l.createShader(i,a,n,s)}},{key:"addInclude",value:function(t,e){v.ILaya.ShaderCompile.addInclude(t,e)}},{key:"preCompile",value:function(t,e,i,a){var n=r.SHADERNAME2ID*t;r._preCompileShader[n]=new v.ILaya.ShaderCompile(e,i,a)}},{key:"preCompile2D",value:function(t,e,i,a,n){var s=r.SHADERNAME2ID*t+e;r._preCompileShader[s]=new v.ILaya.ShaderCompile(i,a,n)}},{key:"_createShader",value:function(t,e,i){var a=t.createShader(i);return t.shaderSource(a,e),t.compileShader(a),t.getShaderParameter(a,t.COMPILE_STATUS)?a:(console.log(t.getShaderInfoLog(a)),null)}}]),r}(m.BaseShader);e.Shader=T,(0,_.default)(T,"_count",0),(0,_.default)(T,"_preCompileShader",{}),(0,_.default)(T,"SHADERNAME2ID",2e-4),(0,_.default)(T,"nameKey",new p.StringKey),(0,_.default)(T,"sharders",new Array(32))},61566:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ShaderDefinesBase=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(e,i,a){(0,r.default)(this,t),(0,l.default)(this,"_value",0),this._name2int=e,this._int2name=i,this._int2nameMap=a}return(0,s.default)(t,[{key:"add",value:function(t){return this._value|="string"==typeof t?this._name2int[t]:t,this._value}},{key:"addInt",value:function(t){return this._value|=t,this._value}},{key:"remove",value:function(t){return this._value&="string"==typeof t?~this._name2int[t]:~t,this._value}},{key:"isDefine",value:function(t){return(this._value&t)===t}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(t){this._value=t}},{key:"toNameDic",value:function(){return this._int2nameMap[this._value]||t._toText(this._value,this._int2name,this._int2nameMap)}}],[{key:"_reg",value:function(t,e,i,a){i[t]=e,a[e]=t}},{key:"_toText",value:function(t,e,i){var a=i[t];if(a)return a;for(var n={},r=1,s=0;s<32&&!((r=1<<s)>t);s++)if(t&r){var l=e[r];l&&(n[l]="")}return i[t]=n,n}},{key:"_toInt",value:function(t,e){for(var i=t.split("."),a=0,n=0,r=i.length;n<r;n++){var s=e[i[n]];if(!s)throw new Error("Defines to int err:"+t+"/"+i[n]);a|=s}return a}}]),t}();e.ShaderDefinesBase=o},80795:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Shader2D=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(54347),u=i(57552),h=i(23857),c=n(i(13867)),d=n(i(1793)),f=n(i(18962)),_=n(i(46011)),v=n(i(50347)),y=n(i(45301)),p=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"ALPHA",1),(0,l.default)(this,"defines",new o.ShaderDefines2D),(0,l.default)(this,"shaderType",0),(0,l.default)(this,"fillStyle",u.DrawStyle.DEFAULT),(0,l.default)(this,"strokeStyle",u.DrawStyle.DEFAULT)}return(0,s.default)(t,[{key:"destroy",value:function(){this.defines=null,this.filters=null}}],[{key:"__init__",value:function(){h.Shader.preCompile2D(0,o.ShaderDefines2D.TEXTURE2D,c.default,d.default,null),h.Shader.preCompile2D(0,o.ShaderDefines2D.PRIMITIVE,f.default,_.default,null),h.Shader.preCompile2D(0,o.ShaderDefines2D.SKINMESH,v.default,y.default,null)}}]),t}();e.Shader2D=p},21576:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Shader2X=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(92135)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454));var _=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(t,e){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(0,s.default)(this,r),i=n.call(this,t,e,a,l,u),(0,f.default)((0,o.default)(i),"_params2dQuick2",null),(0,f.default)((0,o.default)(i),"_shaderValueWidth",0),(0,f.default)((0,o.default)(i),"_shaderValueHeight",0),i}return(0,l.default)(r,[{key:"_disposeResource",value:function(){(0,u.default)((0,d.default)(r.prototype),"_disposeResource",this).call(this),this._params2dQuick2=null}},{key:"upload2dQuick2",value:function(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())}},{key:"_make2dQuick2",value:function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var t,e=this._params,i=0,a=e.length;i<a;i++)"size"!==(t=e[i]).name&&this._params2dQuick2.push(t)}return this._params2dQuick2}}],[{key:"create",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new r(t,e,i,a,n)}}]),r}(i(23857).Shader);e.Shader2X=_},54347:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.ShaderDefines2D=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454));var d=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){return(0,s.default)(this,r),n.call(this,r.__name2int,r.__int2name,r.__int2nameMap)}return(0,l.default)(r,null,[{key:"__init__",value:function(){r.reg("TEXTURE2D",r.TEXTURE2D),r.reg("PRIMITIVE",r.PRIMITIVE),r.reg("GLOW_FILTER",r.FILTERGLOW),r.reg("BLUR_FILTER",r.FILTERBLUR),r.reg("COLOR_FILTER",r.FILTERCOLOR),r.reg("COLOR_ADD",r.COLORADD),r.reg("WORLDMAT",r.WORLDMAT),r.reg("FILLTEXTURE",r.FILLTEXTURE),r.reg("MVP3D",r.MVP3D)}},{key:"reg",value:function(t,e){this._reg(t,e,r.__name2int,r.__int2name)}},{key:"toText",value:function(t,e,i){return this._toText(t,e,i)}},{key:"toInt",value:function(t){return this._toInt(t,r.__name2int)}}]),r}(i(61566).ShaderDefinesBase);e.ShaderDefines2D=d,(0,c.default)(d,"TEXTURE2D",1),(0,c.default)(d,"PRIMITIVE",4),(0,c.default)(d,"FILTERGLOW",8),(0,c.default)(d,"FILTERBLUR",16),(0,c.default)(d,"FILTERCOLOR",32),(0,c.default)(d,"COLORADD",64),(0,c.default)(d,"WORLDMAT",128),(0,c.default)(d,"FILLTEXTURE",256),(0,c.default)(d,"SKINMESH",512),(0,c.default)(d,"MVP3D",2048),(0,c.default)(d,"NOOPTMASK",d.FILTERGLOW|d.FILTERBLUR|d.FILTERCOLOR|d.FILLTEXTURE),(0,c.default)(d,"__name2int",{}),(0,c.default)(d,"__int2name",[]),(0,c.default)(d,"__int2nameMap",[])},48991:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SkinMeshBuffer=void 0;var r=n(i(87368)),s=n(i(28146)),l=i(51651),o=i(20786),u=i(54008),h=function(){function t(){(0,r.default)(this,t);var e=u.LayaGL.instance;this.ib=l.IndexBuffer2D.create(e.DYNAMIC_DRAW),this.vb=o.VertexBuffer2D.create(8)}return(0,s.default)(t,[{key:"addSkinMesh",value:function(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)}},{key:"reset",value:function(){this.vb.clear(),this.ib.clear()}}],[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}]),t}();e.SkinMeshBuffer=h},73061:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.SkinSV=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(54347),_=i(54642),v=i(29728),y=i(52379);var p=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(t){var e;(0,l.default)(this,r),e=n.call(this,f.ShaderDefines2D.SKINMESH,0),(0,d.default)((0,o.default)(e),"offsetX",300),(0,d.default)((0,o.default)(e),"offsetY",0);var i=y.WebGLContext.mainContext,a=8*v.CONST3D2D.BYTES_PE;return e.position=[2,i.FLOAT,!1,a,0],e.texcoord=[2,i.FLOAT,!1,a,2*v.CONST3D2D.BYTES_PE],e.color=[4,i.FLOAT,!1,a,4*v.CONST3D2D.BYTES_PE],e}return(0,s.default)(r)}(_.Value2D);e.SkinSV=p},86836:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.PrimitiveSV=void 0;var s=r(i(28146)),l=r(i(87368)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=i(54642),d=i(54347);var f=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(t){var e;return(0,l.default)(this,r),(e=n.call(this,d.ShaderDefines2D.PRIMITIVE,0))._attribLocation=["position",0,"attribColor",1],e}return(0,s.default)(r)}(c.Value2D);e.PrimitiveSV=f},43601:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.TextureSV=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(54642),_=i(54347);var v=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,s.default)(this,r),t=n.call(this,_.ShaderDefines2D.TEXTURE2D,e),(0,d.default)((0,o.default)(t),"strength",0),(0,d.default)((0,o.default)(t),"blurInfo",null),(0,d.default)((0,o.default)(t),"colorMat",null),(0,d.default)((0,o.default)(t),"colorAlpha",null),t._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2],t}return(0,l.default)(r,[{key:"clear",value:function(){this.texture=null,this.shader=null,this.defines._value=this.subID}}]),r}(f.Value2D);e.TextureSV=v},54642:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Value2D=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(23857),u=i(21576),h=i(54347),c=i(33965),d=i(93561),f=function(){function t(e,i){(0,r.default)(this,t),(0,l.default)(this,"defines",new h.ShaderDefines2D),(0,l.default)(this,"size",[0,0]),(0,l.default)(this,"alpha",1),(0,l.default)(this,"ALPHA",1),(0,l.default)(this,"subID",0),(0,l.default)(this,"ref",1),(0,l.default)(this,"_cacheID",0),(0,l.default)(this,"clipMatDir",[d.ILaya.Context._MAXSIZE,0,0,d.ILaya.Context._MAXSIZE]),(0,l.default)(this,"clipMatPos",[0,0]),(0,l.default)(this,"clipOff",[0,0]),this.mainID=e,this.subID=i,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=e|i,this._inClassCache=t._cache[this._cacheID],e>0&&!this._inClassCache&&(this._inClassCache=t._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}return(0,s.default)(t,[{key:"setValue",value:function(t){}},{key:"_ShaderWithCompile",value:function(){return o.Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,u.Shader2X.create,this._attribLocation)}},{key:"upload",value:function(){var t=c.RenderState2D;c.RenderState2D.worldMatrix4===c.RenderState2D.TEMPMAT4_ARRAY||this.defines.addInt(h.ShaderDefines2D.WORLDMAT),this.mmat=t.worldMatrix4,c.RenderState2D.matWVP&&(this.defines.addInt(h.ShaderDefines2D.MVP3D),this.u_MvpMatrix=c.RenderState2D.matWVP.elements);var e=o.Shader.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height?(this.size[0]=t.width,this.size[1]=t.height,e._shaderValueWidth=t.width,e._shaderValueHeight=t.height,e.upload(this,null)):e.upload(this,e._params2dQuick2||e._make2dQuick2())}},{key:"setFilters",value:function(t){if(this.filters=t,t)for(var e,i=t.length,a=0;a<i;a++)(e=t[a])&&(this.defines.add(e.type),e.action.setValue(this))}},{key:"clear",value:function(){this.defines._value=this.subID,this.clipOff[0]=0}},{key:"release",value:function(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1,this.clipOff[0]=0)}}],[{key:"_initone",value:function(e,i){t._typeClass[e]=i,t._cache[e]=[],t._cache[e]._length=0}},{key:"__init__",value:function(){}},{key:"create",value:function(e,i){var a=t._cache[e|i];return a._length?a[--a._length]:new t._typeClass[e|i](i)}}]),t}();e.Value2D=f,(0,l.default)(f,"_cache",[]),(0,l.default)(f,"_typeClass",[]),(0,l.default)(f,"TEMPMAT4_ARRAY",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},33761:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.BasePoly=void 0;var r=n(i(3649)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"createLine2",value:function(e,i,a,n,r,s){if(e.length<4)return null;var l=t.tempData.length>e.length+2?t.tempData:new Array(e.length+2);l[0]=e[0],l[1]=e[1];var o=2,u=0,h=e.length;for(u=2;u<h;u+=2)Math.abs(e[u]-e[u-2])+Math.abs(e[u+1]-e[u-1])>.01&&(l[o++]=e[u],l[o++]=e[u+1]);s&&Math.abs(e[0]-l[o-2])+Math.abs(e[1]-l[o-1])>.01&&(l[o++]=e[0],l[o++]=e[1]);var c=r;h=o/2;var d,f,_,v,y,p,g,m,x,T,k,C,S,E,M,L,b,I,R,w,A=a/2;for(_=l[0],v=l[1],T=_-(y=l[2]),x=(x=-(v-(p=l[3])))/(w=Math.sqrt(x*x+T*T))*A,T=T/w*A,c.push(_-x,v-T,_+x,v+T),u=1;u<h-1;u++)_=l[2*(u-1)],v=l[2*(u-1)+1],y=l[2*u],p=l[2*u+1],g=l[2*(u+1)],m=l[2*(u+1)+1],T=_-y,C=y-g,M=(-(x=(x=-(v-p))/(w=Math.sqrt(x*x+T*T))*A)+_)*(-(T=T/w*A)+p)-(-x+y)*(-T+v),I=(-(k=(k=-(p-m))/(w=Math.sqrt(k*k+C*C))*A)+g)*(-(C=C/w*A)+p)-(-k+y)*(-C+m),R=(S=-T+v-(-T+p))*(b=-k+y-(-k+g))-(L=-C+m-(-C+p))*(E=-x+y-(-x+_)),Math.abs(R)<.1?(R+=10.1,c.push(y-x,p-T,y+x,p+T)):(d=(E*I-b*M)/R,f=(L*M-S*I)/R,c.push(d,f,y-(d-y),p-(f-p)));for(_=l[o-4],v=l[o-3],T=_-(y=l[o-2]),x=(x=-(v-(p=l[o-1])))/(w=Math.sqrt(x*x+T*T))*A,T=T/w*A,c.push(y-x,p-T,y+x,p+T),u=1;u<h;u++)i.push(n+2*(u-1),n+2*(u-1)+1,n+2*u+1,n+2*u+1,n+2*u,n+2*(u-1));return c}},{key:"createLineTriangle",value:function(t,e,i,a,n,s,l){var o=(0,r.default)(t).call(t),u=o.length,h=o[0],c=o[1],d=o[2],f=(o[2],0),_=0,v=0,y=0,p=u/2;if(!(p<=1)&&2!=p){for(var g=new Array(4*p),m=0,x=0,T=0;T<p-1;T++)h=o[x++],c=o[x++],d=o[x++],y=o[x++]-c,0!=(v=d-h)&&0!=y&&(f=Math.sqrt(v*v+y*y))>.001&&(g[_=4*m]=h,g[_+1]=c,g[_+2]=v/f,g[_+3]=y/f,m++);for(a?(h=o[u-2],c=o[u-1],d=o[0],y=o[1]-c,0!=(v=d-h)&&0!=y&&(f=Math.sqrt(v*v+y*y))>.001&&(g[_=4*m]=h,g[_+1]=c,g[_+2]=v/f,g[_+3]=y/f,m++)):(g[_=4*m]=h,g[_+1]=c,g[_+2]=v/f,g[_+3]=y/f,m++),x=0,T=0;T<p;T++)h=o[x],c=o[x+1],d=o[x+2],o[x+3]}}}]),t}();e.BasePoly=u,(0,o.default)(u,"tempData",new Array(256))},30582:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Earcut=void 0;var r=n(i(47302)),s=n(i(87368)),l=n(i(28146)),o=i(19765),u=function(){function t(){(0,s.default)(this,t)}return(0,l.default)(t,null,[{key:"earcut",value:function(e,i,a){a=a||2;var n,r,s,l,o,u,h,c=i&&i.length,d=c?i[0]*a:e.length,f=t.linkedList(e,0,d,a,!0),_=[];if(!f)return _;if(c&&(f=t.eliminateHoles(e,i,f,a)),e.length>80*a){n=s=e[0],r=l=e[1];for(var v=a;v<d;v+=a)(o=e[v])<n&&(n=o),(u=e[v+1])<r&&(r=u),o>s&&(s=o),u>l&&(l=u);h=0!==(h=Math.max(s-n,l-r))?1/h:0}return t.earcutLinked(f,_,a,n,r,h),_}},{key:"linkedList",value:function(e,i,a,n,r){var s,l;if(r===t.signedArea(e,i,a,n)>0)for(s=i;s<a;s+=n)l=t.insertNode(s,e[s],e[s+1],l);else for(s=a-n;s>=i;s-=n)l=t.insertNode(s,e[s],e[s+1],l);return l&&t.equals(l,l.next)&&(t.removeNode(l),l=l.next),l}},{key:"filterPoints",value:function(e,i){if(!e)return e;i||(i=e);var a,n=e;do{if(a=!1,n.steiner||!t.equals(n,n.next)&&0!==t.area(n.prev,n,n.next))n=n.next;else{if(t.removeNode(n),(n=i=n.prev)===n.next)break;a=!0}}while(a||n!==i);return i}},{key:"earcutLinked",value:function(e,i,a,n,r,s){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(e){!l&&s&&t.indexCurve(e,n,r,s);for(var o,u,h=e;e.prev!==e.next;)if(o=e.prev,u=e.next,s?t.isEarHashed(e,n,r,s):t.isEar(e))i.push(o.i/a),i.push(e.i/a),i.push(u.i/a),t.removeNode(e),e=u.next,h=u.next;else if((e=u)===h){l?1===l?(e=t.cureLocalIntersections(e,i,a),t.earcutLinked(e,i,a,n,r,s,2)):2===l&&t.splitEarcut(e,i,a,n,r,s):t.earcutLinked(t.filterPoints(e,null),i,a,n,r,s,1);break}}}},{key:"isEar",value:function(e){var i=e.prev,a=e,n=e.next;if(t.area(i,a,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(t.pointInTriangle(i.x,i.y,a.x,a.y,n.x,n.y,r.x,r.y)&&t.area(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}},{key:"isEarHashed",value:function(e,i,a,n){var r=e.prev,s=e,l=e.next;if(t.area(r,s,l)>=0)return!1;for(var o=r.x<s.x?r.x<l.x?r.x:l.x:s.x<l.x?s.x:l.x,u=r.y<s.y?r.y<l.y?r.y:l.y:s.y<l.y?s.y:l.y,h=r.x>s.x?r.x>l.x?r.x:l.x:s.x>l.x?s.x:l.x,c=r.y>s.y?r.y>l.y?r.y:l.y:s.y>l.y?s.y:l.y,d=t.zOrder(o,u,i,a,n),f=t.zOrder(h,c,i,a,n),_=e.nextZ;_&&_.z<=f;){if(_!==e.prev&&_!==e.next&&t.pointInTriangle(r.x,r.y,s.x,s.y,l.x,l.y,_.x,_.y)&&t.area(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(_=e.prevZ;_&&_.z>=d;){if(_!==e.prev&&_!==e.next&&t.pointInTriangle(r.x,r.y,s.x,s.y,l.x,l.y,_.x,_.y)&&t.area(_.prev,_,_.next)>=0)return!1;_=_.prevZ}return!0}},{key:"cureLocalIntersections",value:function(e,i,a){var n=e;do{var r=n.prev,s=n.next.next;!t.equals(r,s)&&t.intersects(r,n,n.next,s)&&t.locallyInside(r,s)&&t.locallyInside(s,r)&&(i.push(r.i/a),i.push(n.i/a),i.push(s.i/a),t.removeNode(n),t.removeNode(n.next),n=e=s),n=n.next}while(n!==e);return n}},{key:"splitEarcut",value:function(e,i,a,n,r,s){var l=e;do{for(var o=l.next.next;o!==l.prev;){if(l.i!==o.i&&t.isValidDiagonal(l,o)){var u=t.splitPolygon(l,o);return l=t.filterPoints(l,l.next),u=t.filterPoints(u,u.next),t.earcutLinked(l,i,a,n,r,s),void t.earcutLinked(u,i,a,n,r,s)}o=o.next}l=l.next}while(l!==e)}},{key:"eliminateHoles",value:function(e,i,a,n){var s,l,o,u,h,c=[];for(s=0,l=i.length;s<l;s++)o=i[s]*n,u=s<l-1?i[s+1]*n:e.length,(h=t.linkedList(e,o,u,n,!1))===h.next&&(h.steiner=!0),c.push(t.getLeftmost(h));for((0,r.default)(c).call(c,t.compareX),s=0;s<c.length;s++)t.eliminateHole(c[s],a),a=t.filterPoints(a,a.next);return a}},{key:"compareX",value:function(t,e){return t.x-e.x}},{key:"eliminateHole",value:function(e,i){if(i=t.findHoleBridge(e,i)){var a=t.splitPolygon(i,e);t.filterPoints(a,a.next)}}},{key:"findHoleBridge",value:function(e,i){var a,n=i,r=e.x,s=e.y,l=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var o=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>l){if(l=o,o===r){if(s===n.y)return n;if(s===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==i);if(!a)return null;if(r===l)return a.prev;var u,h=a,c=a.x,d=a.y,f=1/0;for(n=a.next;n!==h;)r>=n.x&&n.x>=c&&r!==n.x&&t.pointInTriangle(s<d?r:l,s,c,d,s<d?l:r,s,n.x,n.y)&&((u=Math.abs(s-n.y)/(r-n.x))<f||u===f&&n.x>a.x)&&t.locallyInside(n,e)&&(a=n,f=u),n=n.next;return a}},{key:"indexCurve",value:function(e,i,a,n){var r=e;do{null===r.z&&(r.z=t.zOrder(r.x,r.y,i,a,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,t.sortLinked(r)}},{key:"sortLinked",value:function(t){var e,i,a,n,r,s,l,o,u=1;do{for(i=t,t=null,r=null,s=0;i;){for(s++,a=i,l=0,e=0;e<u&&(l++,a=a.nextZ);e++);for(o=u;l>0||o>0&&a;)0!==l&&(0===o||!a||i.z<=a.z)?(n=i,i=i.nextZ,l--):(n=a,a=a.nextZ,o--),r?r.nextZ=n:t=n,n.prevZ=r,r=n;i=a}r.nextZ=null,u*=2}while(s>1);return t}},{key:"zOrder",value:function(t,e,i,a,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-a)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}},{key:"getLeftmost",value:function(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}},{key:"pointInTriangle",value:function(t,e,i,a,n,r,s,l){return(n-s)*(e-l)-(t-s)*(r-l)>=0&&(t-s)*(a-l)-(i-s)*(e-l)>=0&&(i-s)*(r-l)-(n-s)*(a-l)>=0}},{key:"isValidDiagonal",value:function(e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!t.intersectsPolygon(e,i)&&t.locallyInside(e,i)&&t.locallyInside(i,e)&&t.middleInside(e,i)}},{key:"area",value:function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}},{key:"intersects",value:function(e,i,a,n){return!!(t.equals(e,i)&&t.equals(a,n)||t.equals(e,n)&&t.equals(a,i))||t.area(e,i,a)>0!=t.area(e,i,n)>0&&t.area(a,n,e)>0!=t.area(a,n,i)>0}},{key:"intersectsPolygon",value:function(e,i){var a=e;do{if(a.i!==e.i&&a.next.i!==e.i&&a.i!==i.i&&a.next.i!==i.i&&t.intersects(a,a.next,e,i))return!0;a=a.next}while(a!==e);return!1}},{key:"locallyInside",value:function(e,i){return t.area(e.prev,e,e.next)<0?t.area(e,i,e.next)>=0&&t.area(e,e.prev,i)>=0:t.area(e,i,e.prev)<0||t.area(e,e.next,i)<0}},{key:"middleInside",value:function(t,e){var i=t,a=!1,n=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&n<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(a=!a),i=i.next}while(i!==t);return a}},{key:"splitPolygon",value:function(t,e){var i=new o.EarcutNode(t.i,t.x,t.y),a=new o.EarcutNode(e.i,e.x,e.y),n=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,a.next=i,i.prev=a,r.next=a,a.prev=r,a}},{key:"insertNode",value:function(t,e,i,a){var n=new o.EarcutNode(t,e,i);return a?(n.next=a.next,n.prev=a,a.next.prev=n,a.next=n):(n.prev=n,n.next=n),n}},{key:"removeNode",value:function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}},{key:"signedArea",value:function(t,e,i,a){for(var n=0,r=e,s=i-a;r<i;r+=a)n+=(t[s]-t[r])*(t[r+1]+t[s+1]),s=r;return n}}]),t}();e.Earcut=u},19765:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.EarcutNode=void 0;var r=n(i(28146)),s=n(i(87368)),l=(0,r.default)((function t(e,i,a){(0,s.default)(this,t),this.i=e,this.x=i,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}));e.EarcutNode=l},73943:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Submit=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(14880),f=i(14972),_=i(29728),v=i(52379),y=i(97806);var p=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.SubmitBase.TYPE_2D;return(0,s.default)(this,r),n.call(this,t)}return(0,l.default)(r,[{key:"renderSubmit",value:function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var i=v.WebGLContext.mainContext;return this._mesh.useMesh(i),this.shaderValue.upload(),f.BlendMode.activeBlendFunction!==this._blendFn&&(v.WebGLContext.setBlend(i,!0),this._blendFn(i),f.BlendMode.activeBlendFunction=this._blendFn),i.drawElements(i.TRIANGLES,this._numEle,i.UNSIGNED_SHORT,this._startIdx),d.Stat.renderBatches++,d.Stat.trianglesFaces+=this._numEle/3,1}},{key:"releaseRender",value:function(){y.SubmitBase.RENDERBASE!=this&&--this._ref<1&&(r.POOL[r._poolSize++]=this,this.shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}}],[{key:"create",value:function(t,e,i){var a=r._poolSize?r.POOL[--r._poolSize]:new r;a._ref=1,a._mesh=e,a._key.clear(),a._startIdx=e.indexNum*_.CONST3D2D.BYTES_PIDX,a._numEle=0;var n=t._nBlendType;a._blendFn=t._targets?f.BlendMode.targetFns[n]:f.BlendMode.fns[n],a.shaderValue=i,a.shaderValue.setValue(t._shader2D);var s=t._shader2D.filters;return s&&a.shaderValue.setFilters(s),a}},{key:"createShape",value:function(t,e,i,a){var n=r._poolSize?r.POOL[--r._poolSize]:new r;n._mesh=e,n._numEle=i,n._startIdx=2*e.indexNum,n._ref=1,n.shaderValue=a,n.shaderValue.setValue(t._shader2D);var s=t._nBlendType;return n._key.blendShader=s,n._blendFn=t._targets?f.BlendMode.targetFns[s]:f.BlendMode.fns[s],n}}]),r}(y.SubmitBase);e.Submit=p,(0,c.default)(p,"_poolSize",0),(0,c.default)(p,"POOL",[])},97806:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SubmitBase=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(84666),u=i(54642),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.TYPE_2D;(0,r.default)(this,t),(0,l.default)(this,"clipInfoID",-1),(0,l.default)(this,"_mesh",null),(0,l.default)(this,"_blendFn",null),(0,l.default)(this,"_id",0),(0,l.default)(this,"_renderType",0),(0,l.default)(this,"_parent",null),(0,l.default)(this,"_key",new o.SubmitKey),(0,l.default)(this,"_startIdx",0),(0,l.default)(this,"_numEle",0),(0,l.default)(this,"_ref",1),(0,l.default)(this,"shaderValue",null),this._renderType=e,this._id=++t.ID}return(0,s.default)(t,[{key:"getID",value:function(){return this._id}},{key:"getRenderType",value:function(){return this._renderType}},{key:"toString",value:function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key}},{key:"renderSubmit",value:function(){return 1}},{key:"releaseRender",value:function(){}}],[{key:"__init__",value:function(){var e=t.RENDERBASE=new t(-1);e.shaderValue=new u.Value2D(0,0),e.shaderValue.ALPHA=1,e._ref=4294967295}}]),t}();e.SubmitBase=h,(0,l.default)(h,"TYPE_2D",1e4),(0,l.default)(h,"TYPE_CANVAS",10003),(0,l.default)(h,"TYPE_CMDSETRT",10004),(0,l.default)(h,"TYPE_CUSTOM",10005),(0,l.default)(h,"TYPE_BLURRT",10006),(0,l.default)(h,"TYPE_CMDDESTORYPRERT",10007),(0,l.default)(h,"TYPE_DISABLESTENCIL",10008),(0,l.default)(h,"TYPE_OTHERIBVB",10009),(0,l.default)(h,"TYPE_PRIMITIVE",10010),(0,l.default)(h,"TYPE_RT",10011),(0,l.default)(h,"TYPE_BLUR_RT",10012),(0,l.default)(h,"TYPE_TARGET",10013),(0,l.default)(h,"TYPE_CHANGE_VALUE",10014),(0,l.default)(h,"TYPE_SHAPE",10015),(0,l.default)(h,"TYPE_TEXTURE",10016),(0,l.default)(h,"TYPE_FILLTEXTURE",10017),(0,l.default)(h,"KEY_ONCE",-1),(0,l.default)(h,"KEY_FILLRECT",1),(0,l.default)(h,"KEY_DRAWTEXTURE",2),(0,l.default)(h,"KEY_VG",3),(0,l.default)(h,"KEY_TRIANGLES",4),(0,l.default)(h,"ID",1),(0,l.default)(h,"preRender",null)},87328:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SubmitCMD=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(84666),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_ref",1),(0,l.default)(this,"_key",new o.SubmitKey)}return(0,s.default)(t,[{key:"renderSubmit",value:function(){return this.fun.apply(this._this,this.args),1}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}}}],[{key:"create",value:function(e,i,a){var n=t.POOL._length?t.POOL[--t.POOL._length]:new t;return n.fun=i,n.args=e,n._this=a,n._ref=1,n._key.clear(),n}}]),t}();e.SubmitCMD=u,(0,l.default)(u,"POOL",[]),u.POOL._length=0},61888:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.SubmitCanvas=void 0;var s=r(i(77766)),l=r(i(87368)),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(5866),v=i(54642),y=i(29728),p=i(33965),g=i(97806);var m=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(){var t,e;return(0,l.default)(this,r),e=n.call(this,g.SubmitBase.TYPE_2D),(0,f.default)((0,u.default)(e),"_matrix",new _.Matrix),(0,f.default)((0,u.default)(e),"_matrix4",(0,s.default)(t=y.CONST3D2D.defaultMatrix4).call(t)),e.shaderValue=new v.Value2D(0,0),e}return(0,o.default)(r,[{key:"renderSubmit",value:function(){var t=p.RenderState2D.worldAlpha,e=p.RenderState2D.worldMatrix4,i=p.RenderState2D.worldMatrix,a=p.RenderState2D.worldFilters,n=p.RenderState2D.worldShaderDefines,r=this.shaderValue,s=this._matrix,l=this._matrix4,o=_.Matrix.TEMP;return _.Matrix.mul(s,i,o),l[0]=o.a,l[1]=o.b,l[4]=o.c,l[5]=o.d,l[12]=o.tx,l[13]=o.ty,p.RenderState2D.worldMatrix=o.clone(),p.RenderState2D.worldMatrix4=l,p.RenderState2D.worldAlpha=p.RenderState2D.worldAlpha*r.alpha,r.filters&&r.filters.length&&(p.RenderState2D.worldFilters=r.filters,p.RenderState2D.worldShaderDefines=r.defines),this.canv.flushsubmit(),p.RenderState2D.worldAlpha=t,p.RenderState2D.worldMatrix4=e,p.RenderState2D.worldMatrix.destroy(),p.RenderState2D.worldMatrix=i,p.RenderState2D.worldFilters=a,p.RenderState2D.worldShaderDefines=n,1}},{key:"releaseRender",value:function(){if(--this._ref<1){var t=r.POOL;this._mesh=null,t[t._length++]=this}}},{key:"getRenderType",value:function(){return g.SubmitBase.TYPE_CANVAS}}],[{key:"create",value:function(t,e,i){var a=r.POOL._length?r.POOL[--r.POOL._length]:new r;a.canv=t,a._ref=1,a._numEle=0;var n=a.shaderValue;return n.alpha=e,n.defines.setValue(0),i&&i.length&&n.setFilters(i),a}}]),r}(g.SubmitBase);e.SubmitCanvas=m,(0,f.default)(m,"POOL",[]),m.POOL._length=0},84666:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SubmitKey=void 0;var r=n(i(87368)),s=n(i(28146)),l=function(){function t(){(0,r.default)(this,t),this.clear()}return(0,s.default)(t,[{key:"clear",value:function(){this.submitType=-1,this.blendShader=this.other=0}},{key:"copyFrom",value:function(t){this.other=t.other,this.blendShader=t.blendShader,this.submitType=t.submitType}},{key:"copyFrom2",value:function(t,e,i){this.other=i,this.submitType=e}},{key:"equal3_2",value:function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader}},{key:"equal4_2",value:function(t,e,i){return this.submitType===e&&this.other===i&&this.blendShader===t.blendShader}},{key:"equal_3",value:function(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader}},{key:"equal",value:function(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader}}]),t}();e.SubmitKey=l},58585:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.SubmitTarget=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(84666),u=i(14880),h=i(52379),c=i(14972),d=i(29728),f=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"blendType",0),(0,l.default)(this,"_ref",1),(0,l.default)(this,"_key",new o.SubmitKey)}return(0,s.default)(t,[{key:"renderSubmit",value:function(){var t=h.WebGLContext.mainContext;this._mesh.useMesh(t);var e=this.srcRT;return e&&(this.shaderValue.texture=e._getSource(),this.shaderValue.upload(),this.blend(),u.Stat.renderBatches++,u.Stat.trianglesFaces+=this._numEle/3,t.drawElements(t.TRIANGLES,this._numEle,t.UNSIGNED_SHORT,this._startIdx)),1}},{key:"blend",value:function(){if(c.BlendMode.activeBlendFunction!==c.BlendMode.fns[this.blendType]){var t=h.WebGLContext.mainContext;t.enable(t.BLEND),c.BlendMode.fns[this.blendType](t),c.BlendMode.activeBlendFunction=c.BlendMode.fns[this.blendType]}}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){if(--this._ref<1){var e=t.POOL;e[e._length++]=this}}}],[{key:"create",value:function(e,i,a,n){var r=t.POOL._length?t.POOL[--t.POOL._length]:new t;if(r._mesh=i,r.srcRT=n,r._startIdx=i.indexNum*d.CONST3D2D.BYTES_PIDX,r._ref=1,r._key.clear(),r._numEle=0,r.blendType=e._nBlendType,r._key.blendShader=r.blendType,r.shaderValue=a,r.shaderValue.setValue(e._shader2D),e._colorFiler){var s=e._colorFiler;a.defines.add(s.type),a.colorMat=s._mat,a.colorAlpha=s._alpha}return r}}]),t}();e.SubmitTarget=f,(0,l.default)(f,"POOL",[]),f.POOL._length=0},59445:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.SubmitTexture=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(97806),f=i(14880),_=i(52379),v=i(14972),y=i(83530),p=i(54347),g=i(29728);var m=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.SubmitBase.TYPE_2D;return(0,s.default)(this,r),n.call(this,t)}return(0,l.default)(r,[{key:"releaseRender",value:function(){--this._ref<1&&(r.POOL[r._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}},{key:"renderSubmit",value:function(){if(0===this._numEle)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var i=_.WebGLContext.mainContext;this._mesh.useMesh(i);var a=d.SubmitBase.preRender,n=d.SubmitBase.preRender._key;return 0===this._key.blendShader&&this._key.submitType===n.submitType&&this._key.blendShader===n.blendShader&&y.BaseShader.activeShader&&d.SubmitBase.preRender.clipInfoID==this.clipInfoID&&a.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&p.ShaderDefines2D.NOOPTMASK)?y.BaseShader.activeShader.uploadTexture2D(e):(v.BlendMode.activeBlendFunction!==this._blendFn&&(_.WebGLContext.setBlend(i,!0),this._blendFn(i),v.BlendMode.activeBlendFunction=this._blendFn),this.shaderValue.texture=e,this.shaderValue.upload()),i.drawElements(i.TRIANGLES,this._numEle,i.UNSIGNED_SHORT,this._startIdx),f.Stat.renderBatches++,f.Stat.trianglesFaces+=this._numEle/3,1}}],[{key:"create",value:function(t,e,i){var a=r._poolSize?r.POOL[--r._poolSize]:new r(d.SubmitBase.TYPE_TEXTURE);a._mesh=e,a._key.clear(),a._key.submitType=d.SubmitBase.KEY_DRAWTEXTURE,a._ref=1,a._startIdx=e.indexNum*g.CONST3D2D.BYTES_PIDX,a._numEle=0;var n=t._nBlendType;if(a._key.blendShader=n,a._blendFn=t._targets?v.BlendMode.targetFns[n]:v.BlendMode.fns[n],a.shaderValue=i,t._colorFiler){var s=t._colorFiler;i.defines.add(s.type),i.colorMat=s._mat,i.colorAlpha=s._alpha}return a}}]),r}(d.SubmitBase);e.SubmitTexture=m,(0,c.default)(m,"_poolSize",0),(0,c.default)(m,"POOL",[])},82205:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.AtlasGrid=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,r.default)(this,t),(0,l.default)(this,"atlasID",0),(0,l.default)(this,"_width",0),(0,l.default)(this,"_height",0),(0,l.default)(this,"_texCount",0),(0,l.default)(this,"_rowInfo",null),(0,l.default)(this,"_cells",null),(0,l.default)(this,"_used",0),this._cells=null,this._rowInfo=null,this.atlasID=a,this._init(e,i)}return(0,s.default)(t,[{key:"addRect",value:function(t,e,i,a){return!!this._get(e,i,a)&&(this._fill(a.x,a.y,e,i,t),this._texCount++,!0)}},{key:"_release",value:function(){this._cells=null,this._rowInfo=null}},{key:"_init",value:function(t,e){return this._width=t,this._height=e,this._release(),0!=this._width&&(this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=new Uint8Array(this._height),this._used=0,this._clear(),!0)}},{key:"_get",value:function(t,e,i){if(t>this._width||e>this._height)return!1;for(var a=-1,n=-1,r=this._width,s=this._height,l=this._cells,o=0;o<s;o++)if(!(this._rowInfo[o]<t))for(var u=0;u<r;){var h=3*(o*r+u);if(0!=l[h]||l[h+1]<t||l[h+2]<e)u+=l[h+1];else{a=u,n=o;for(var c=0;c<t;c++)if(l[3*c+h+2]<e){a=-1;break}if(!(a<0))return i.x=a,i.y=n,!0;u+=l[h+1]}}return!1}},{key:"_fill",value:function(t,e,i,a,n){var r=this._width,s=this._height;this._check(t+i<=r&&e+a<=s);for(var l=e;l<a+e;++l){this._check(this._rowInfo[l]>=i),this._rowInfo[l]-=i;for(var o=0;o<i;o++){var u=3*(t+l*r+o);this._check(0==this._cells[u]),this._cells[u]=n,this._cells[u+1]=i,this._cells[u+2]=a}}if(t>0)for(l=0;l<a;++l){var h=0;for(o=t-1;o>=0&&0==this._cells[3*((e+l)*r+o)];--o,++h);for(o=h;o>0;--o)this._cells[3*((e+l)*r+t-o)+1]=o,this._check(o>0)}if(e>0)for(o=t;o<t+i;++o){for(h=0,l=e-1;l>=0&&0==this._cells[3*(o+l*r)];--l,h++);for(l=h;l>0;--l)this._cells[3*(o+(e-l)*r)+2]=l,this._check(l>0)}this._used+=i*a/(this._width*this._height)}},{key:"_check",value:function(t){0==t&&console.log("xtexMerger 错误啦")}},{key:"_clear",value:function(){this._texCount=0;for(var t=0;t<this._height;t++)this._rowInfo[t]=this._width;for(var e=0;e<this._height;e++)for(var i=0;i<this._width;i++){var a=3*(e*this._width+i);this._cells[a]=0,this._cells[a+1]=this._width-i,this._cells[a+2]=this._width-e}}}]),t}();e.AtlasGrid=o},10799:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.CharRenderInfo=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(39498),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"char",""),(0,l.default)(this,"deleted",!1),(0,l.default)(this,"uv",new Array(8)),(0,l.default)(this,"pos",0),(0,l.default)(this,"orix",0),(0,l.default)(this,"oriy",0),(0,l.default)(this,"touchTick",0),(0,l.default)(this,"isSpace",!1)}return(0,s.default)(t,[{key:"touch",value:function(){var t=o.RenderInfo.loopCount;this.touchTick!=t&&this.tex.touchRect(this,t),this.touchTick=t}}]),t}();e.CharRenderInfo=u},63784:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.CharRender_Canvas=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(76427),_=i(27175);var v=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(t,e){var i,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,s.default)(this,r),i=n.call(this),(0,d.default)((0,o.default)(i),"ctx",null),(0,d.default)((0,o.default)(i),"lastScaleX",1),(0,d.default)((0,o.default)(i),"lastScaleY",1),(0,d.default)((0,o.default)(i),"maxTexW",0),(0,d.default)((0,o.default)(i),"maxTexH",0),(0,d.default)((0,o.default)(i),"scaleFontSize",!0),(0,d.default)((0,o.default)(i),"showDbgInfo",!1),(0,d.default)((0,o.default)(i),"supportImageData",!0),i.maxTexW=t,i.maxTexH=e,i.scaleFontSize=a,i.supportImageData=l,i.showDbgInfo=u,r.canvas||(r.canvas=_.Browser.createElement("canvas"),r.canvas.width=1024,r.canvas.height=512,r.canvas.style.left="-10000px",r.canvas.style.position="absolute",document.body.appendChild(r.canvas),i.ctx=r.canvas.getContext("2d")),i}return(0,l.default)(r,[{key:"canvasWidth",get:function(){return r.canvas.width},set:function(t){r.canvas.width!=t&&(r.canvas.width=t,t>2048&&console.warn("画文字设置的宽度太大，超过2048了"),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.lastScaleX,this.lastScaleY))}},{key:"getWidth",value:function(t,e){return this.ctx?(this.ctx._lastFont!=t&&(this.ctx.font=t,this.ctx._lastFont=t),this.ctx.measureText(e).width):0}},{key:"scale",value:function(t,e){if(!this.supportImageData)return this.lastScaleX=t,void(this.lastScaleY=e);this.lastScaleX==t&&this.lastScaleY==e||(this.ctx.setTransform(t,0,0,e,0,0),this.lastScaleX=t,this.lastScaleY=e)}},{key:"getCharBmp",value:function(t,e,i,a,n,s,l,o,u,h){var c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null;if(!this.supportImageData)return this.getCharCanvas(t,e,i,a,n,s,l,o,u,h);var d=this.ctx,f=this.fontsz;d.font!=e&&(d.font=e,d._lastFont=e),s.width=d.measureText(t).width;var _=s.width*this.lastScaleX,v=s.height*this.lastScaleY;_+=(l+u)*this.lastScaleX,v+=(o+h)*this.lastScaleY,_=Math.ceil(_),v=Math.ceil(v);var y=(_=Math.min(_,r.canvas.width))+2*i+1,p=(v=Math.min(v,r.canvas.height))+2*i+1;c&&(y=Math.max(y,c[0]+c[2]+1),p=Math.max(p,c[1]+c[3]+1)),d.clearRect(0,0,y/this.lastScaleX+1,p/this.lastScaleY+1),d.save(),d.textBaseline="middle",i>0&&(d.strokeStyle=n,d.lineWidth=i,d.strokeText(t,l,o+f/2)),a&&(d.fillStyle=a,d.fillText(t,l,o+f/2)),this.showDbgInfo&&(d.strokeStyle="#ff0000",d.strokeRect(1,1,_-2,v-2),d.strokeStyle="#00ff00",d.strokeRect(l,o,s.width,s.height)),c&&(-1==c[2]&&(c[2]=Math.ceil((s.width+2*i)*this.lastScaleX)),c[2]<=0&&(c[2]=1));var g=c?d.getImageData(c[0],c[1],c[2],c[3]+1):d.getImageData(0,0,_,v+1);return d.restore(),s.bmpWidth=g.width,s.bmpHeight=g.height,g}},{key:"getCharCanvas",value:function(t,e,i,a,n,s,l,o,u,h){var c=this.ctx;c.font!=e&&(c.font=e,c._lastFont=e),s.width=c.measureText(t).width;var d=s.width*this.lastScaleX,f=s.height*this.lastScaleY;d+=(l+u)*this.lastScaleX,f+=(o+h)*this.lastScaleY+1,d=Math.min(d,this.maxTexW),f=Math.min(f,this.maxTexH),r.canvas.width=Math.min(d+1,this.maxTexW),r.canvas.height=Math.min(f+1,this.maxTexH),c.font=e,c.clearRect(0,0,d+1+i,f+1+i),c.setTransform(1,0,0,1,0,0),c.save(),this.scaleFontSize&&c.scale(this.lastScaleX,this.lastScaleY),c.translate(l,o),c.textAlign="left";var _=this.fontsz;return c.textBaseline="middle",i>0?(c.strokeStyle=n,c.fillStyle=a,c.lineWidth=i,c.fillAndStrokeText?c.fillAndStrokeText(t,0,_/2):(c.strokeText(t,0,_/2),c.fillText(t,0,_/2))):a&&(c.fillStyle=a,c.fillText(t,0,_/2)),this.showDbgInfo&&(c.strokeStyle="#ff0000",c.strokeRect(0,0,d,f),c.strokeStyle="#00ff00",c.strokeRect(0,0,s.width,s.height)),c.restore(),s.bmpWidth=r.canvas.width,s.bmpHeight=r.canvas.height,r.canvas}}]),r}(f.ICharRender);e.CharRender_Canvas=v,(0,d.default)(v,"canvas",null)},31413:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.CharRender_Native=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(43714)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(76427),_=i(53546);var v=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(){var t;return(0,s.default)(this,r),t=n.call(this),(0,d.default)((0,o.default)(t),"lastFont",""),(0,d.default)((0,o.default)(t),"lastScaleX",1),(0,d.default)((0,o.default)(t),"lastScaleY",1),t}return(0,l.default)(r,[{key:"getWidth",value:function(t,e){return window.conchTextCanvas?(window.conchTextCanvas.font=t,this.lastFont=t,window.conchTextCanvas.measureText(e).width):0}},{key:"scale",value:function(t,e){this.lastScaleX=t,this.lastScaleY=e}},{key:"getCharBmp",value:function(t,e,i,a,n,r,s,l,o,u){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=e,this.lastFont=e,r.width=window.conchTextCanvas.measureText(t).width,r.height,window.conchTextCanvas.scale&&window.conchTextCanvas.scale(this.lastScaleX,this.lastScaleY);var h=_.ColorUtils.create(n).numColor,c=_.ColorUtils.create(a).numColor,d=window.conchTextCanvas.getTextBitmapData(t,c,i>2?2:i,h);return r.bmpWidth=d.width,r.bmpHeight=d.height,d}}]),r}(f.ICharRender);e.CharRender_Native=v},47198:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.CharSubmitCache=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(5866),u=i(54347),h=i(54642),c=i(59445),d=i(39498),f=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_data",[]),(0,l.default)(this,"_ndata",0),(0,l.default)(this,"_clipid",-1),(0,l.default)(this,"_clipMatrix",new o.Matrix),(0,l.default)(this,"_enable",!1)}return(0,s.default)(t,[{key:"clear",value:function(){this._tex=null,this._imgId=-1,this._ndata=0,this._enable=!1,this._colorFiler=null}},{key:"destroy",value:function(){this.clear(),this._data.length=0,this._data=null}},{key:"add",value:function(t,e,i,a,n,r){this._ndata>0&&(this._tex!=e||this._imgId!=i||this._clipid>=0&&this._clipid!=t._clipInfoID)&&this.submit(t),this._clipid=t._clipInfoID,t._globalClipMatrix.copyTo(this._clipMatrix),this._tex=e,this._imgId=i,this._colorFiler=t._colorFiler,this._data[this._ndata]=a,this._data[this._ndata+1]=n,this._data[this._ndata+2]=r,this._ndata+=3}},{key:"getPos",value:function(){return 0==t.__nPosPool?new Array(8):t.__posPool[--t.__nPosPool]}},{key:"enable",value:function(t,e){t!==this._enable&&(this._enable=t,this._enable||this.submit(e))}},{key:"submit",value:function(e){var i=this._ndata;if(i){var a=e._mesh,n=e._colorFiler;e._colorFiler=this._colorFiler;var r=c.SubmitTexture.create(e,a,h.Value2D.create(u.ShaderDefines2D.TEXTURE2D,0));e._submits[e._submits._length++]=e._curSubmit=r,r.shaderValue.textureHost=this._tex,r._key.other=this._imgId,e._colorFiler=n,e._copyClipInfo(r,this._clipMatrix),r.clipInfoID=this._clipid;for(var s=0;s<i;s+=3)a.addQuad(this._data[s],this._data[s+1],this._data[s+2],!0),t.__posPool[t.__nPosPool++]=this._data[s];i/=3,r._numEle+=6*i,a.indexNum+=6*i,a.vertNum+=4*i,e._drawCount+=i,this._ndata=0,d.RenderInfo.loopCount%100==0&&(this._data.length=0)}}}]),t}();e.CharSubmitCache=f,(0,l.default)(f,"__posPool",[]),(0,l.default)(f,"__nPosPool",0)},76427:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ICharRender=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"fontsz",16)}return(0,s.default)(t,[{key:"getWidth",value:function(t,e){return 0}},{key:"scale",value:function(t,e){}},{key:"canvasWidth",get:function(){return 0},set:function(t){}},{key:"getCharBmp",value:function(t,e,i,a,n,r,s,l,o,u){return null}}]),t}();e.ICharRender=o},25425:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TextAtlas=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(82205),u=i(78843),h=i(93561),c=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"texWidth",1024),(0,l.default)(this,"texHeight",1024),(0,l.default)(this,"texture",null),(0,l.default)(this,"charMaps",{}),this.texHeight=this.texWidth=h.ILaya.TextRender.atlasWidth,this.texture=u.TextTexture.getTextTexture(this.texWidth,this.texHeight),this.texWidth/t.atlasGridW>256&&(t.atlasGridW=Math.ceil(this.texWidth/256)),this.atlasgrid=new o.AtlasGrid(this.texWidth/t.atlasGridW,this.texHeight/t.atlasGridW,this.texture.id)}return(0,s.default)(t,[{key:"setProtecteDist",value:function(t){}},{key:"getAEmpty",value:function(e,i,a){var n=this.atlasgrid.addRect(1,Math.ceil(e/t.atlasGridW),Math.ceil(i/t.atlasGridW),a);return n&&(a.x*=t.atlasGridW,a.y*=t.atlasGridW),n}},{key:"usedRate",get:function(){return this.atlasgrid._used}},{key:"destroy",value:function(){for(var t in this.charMaps)this.charMaps[t].deleted=!0;this.texture.discard()}},{key:"printDebugInfo",value:function(){}}]),t}();e.TextAtlas=c,(0,l.default)(c,"atlasGridW",16)},74433:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.TextRender=void 0;var r=n(i(81643)),s=n(i(78914)),l=n(i(87368)),o=n(i(28146)),u=n(i(17454)),h=i(25425),c=i(78843),d=i(91020),f=i(39498),_=i(29148),v=i(17333),y=i(87956),p=i(10799),g=i(63784),m=i(31413),x=i(93561),T=function(){function t(){(0,l.default)(this,t),(0,u.default)(this,"fontSizeInfo",{}),(0,u.default)(this,"mapFont",{}),(0,u.default)(this,"fontID",0),(0,u.default)(this,"fontScaleX",1),(0,u.default)(this,"fontScaleY",1),(0,u.default)(this,"_curStrPos",0),(0,u.default)(this,"textAtlases",[]),(0,u.default)(this,"isoTextures",[]),(0,u.default)(this,"lastFont",null),(0,u.default)(this,"fontSizeW",0),(0,u.default)(this,"fontSizeH",0),(0,u.default)(this,"fontSizeOffX",0),(0,u.default)(this,"fontSizeOffY",0),(0,u.default)(this,"renderPerChar",!0),(0,u.default)(this,"tmpAtlasPos",new d.Point),(0,u.default)(this,"textureMem",0),x.ILaya.TextAtlas=h.TextAtlas;var e=!1,i=x.ILaya.Laya.MiniAdpter;i&&i.systemInfo&&i.systemInfo.system&&(e="ios 10.1.1"===i.systemInfo.system.toLowerCase()),(x.ILaya.Browser.onMiniGame||x.ILaya.Browser.onTTMiniGame||x.ILaya.Browser.onBLMiniGame||x.ILaya.Browser.onAlipayMiniGame||x.ILaya.Browser.onTBMiniGame)&&!e&&(t.isWan1Wan=!0),this.charRender=x.ILaya.Render.isConchApp?new m.CharRender_Native:new g.CharRender_Canvas(2048,2048,t.scaleFontWithCtx,!t.isWan1Wan,!1),t.textRenderInst=this,x.ILaya.Laya.textRender=this,t.atlasWidth2=t.atlasWidth*t.atlasWidth}return(0,o.default)(t,[{key:"setFont",value:function(e){var i;if(this.lastFont!=e){this.lastFont=e;var a=this.getFontSizeInfo(e._family),n=a>>24,s=a>>16&255,l=a>>8&255,o=255&a,u=e._size/t.standardFontSize;this.fontSizeOffX=Math.ceil(n*u),this.fontSizeOffY=Math.ceil(s*u),this.fontSizeW=Math.ceil(l*u),this.fontSizeH=Math.ceil(o*u),(0,r.default)(i=e._font).call(i,"italic")>=0?this.fontStr=e._font.replace("italic",""):this.fontStr=e._font}}},{key:"getNextChar",value:function(t){var e=t.length,i=this._curStrPos;if(!t.substring)return null;if(i>=e)return null;for(var a=i,n=0;a<e;a++){var r=t.charCodeAt(a);if(r>>>11==27){if(1==n)break;n=1,a++}else if(65038===r||65039===r);else if(8205==r)n=2;else if(0==n)n=1;else if(1==n)break}return this._curStrPos=a,t.substring(i,a)}},{key:"filltext",value:function(t,e,i,a,n,r,s,l,o){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;if(!(e.length<=0)){var h=v.FontInfo.Parse(n),c=0;switch(o){case"center":c=x.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":c=x.ILaya.Context.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(t,e,null,i,a,h,r,s,l,c,u)}}},{key:"fillWords",value:function(t,e,i,a,n,r,s,l){if(e&&!(e.length<=0)){var o="string"==typeof n?v.FontInfo.Parse(n):n;this._fast_filltext(t,null,e,i,a,o,r,s,l,0,0)}}},{key:"_fast_filltext",value:function(e,i,a,n,r,s,l,o,u,h){if((!i||i.length>=1)&&!(a&&a.length<1)){if(u<0&&(u=0),this.setFont(s),this.fontScaleX=this.fontScaleY=1,t.scaleFontWithCtx){var c=1,d=1;if(x.ILaya.Render.isConchApp&&!window.conchTextCanvas.scale||(c=e.getMatScaleX(),d=e.getMatScaleY()),c<1e-4||d<.1)return;c>1&&(this.fontScaleX=c),d>1&&(this.fontScaleY=d)}s._italic&&(e._italicDeg=13);var f=i,_=!a&&i instanceof y.WordText,v=i&&i.toString(),p=!!a,g=_?f.pageChars:[],m=0;switch(_?(v=f._text,(m=f.width)<0&&(m=f.width=this.charRender.getWidth(this.fontStr,v))):m=v?this.charRender.getWidth(this.fontStr,v):0,h){case x.ILaya.Context.ENUM_TEXTALIGN_CENTER:n-=m/2;break;case x.ILaya.Context.ENUM_TEXTALIGN_RIGHT:n-=m}f&&g&&this.hasFreedText(g)&&(g=f.pageChars=[]);var T=null,k=this.renderPerChar=!_||t.forceSplitRender||p||_&&f.splitRender;if(!g||g.length<1)if(_&&(f.scalex=this.fontScaleX,f.scaley=this.fontScaleY),k){var C,S=0,E=0;for(this._curStrPos=0;;){if(a){var M=a[this._curStrPos++];M?(C=M.char,S=M.x,E=M.y):C=null}else C=this.getNextChar(v);if(!C)break;if(!(T=this.getCharRenderInfo(C,s,l,o,u,!1)))break;if(T.isSpace);else{var L=g[T.tex.id];if(L)L=L.words;else{var b={texgen:T.tex.genID,tex:T.tex,words:new Array};g[T.tex.id]=b,L=b.words}L.push({ri:T,x:S,y:E,w:T.bmpWidth/this.fontScaleX,h:T.bmpHeight/this.fontScaleY}),S+=T.width}}}else{var I=x.ILaya.Render.isConchApp?0:s._size/3|0,R=t.noAtlas||(m+I+I)*this.fontScaleX>t.atlasWidth;T=this.getCharRenderInfo(v,s,l,o,u,R),g[0]={texgen:T.tex.genID,tex:T.tex,words:[{ri:T,x:0,y:0,w:T.bmpWidth/this.fontScaleX,h:T.bmpHeight/this.fontScaleY}]}}this._drawResortedWords(e,n,r,g),e._italicDeg=0}}},{key:"_drawResortedWords",value:function(t,e,i,a){var n=!!t._charSubmitCache&&t._charSubmitCache._enable,r=t._curMat;for(var s in a){var l=a[s];if(l){var o=l.words,u=o.length;if(!(u<=0))for(var h=a[s].tex,c=0;c<u;c++){var d=o[c],f=d.ri;if(!f.isSpace){if(f.touch(),t.drawTexAlign=!0,x.ILaya.Render.isConchApp)t._drawTextureM(h.texture,e+d.x-f.orix,i+d.y-f.oriy,d.w,d.h,null,1,f.uv);else{var _=h;t._inner_drawTexture(_.texture,_.id,e+d.x-f.orix,i+d.y-f.oriy,d.w,d.h,r,f.uv,1,n)}t.touches&&t.touches.push(f)}}}}}},{key:"hasFreedText",value:function(t){for(var e in t){var i=t[e];if(i){var a=i.tex;if(a.__destroyed||a.genID!=i.texgen)return!0}}return!1}},{key:"getCharRenderInfo",value:function(e,i,a,n,r){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=this.mapFont[i._family];null==l&&(this.mapFont[i._family]=l=this.fontID++);var o=e+"_"+l+"_"+i._size+"_"+a;r>0&&(o+="_"+n+r),i._bold&&(o+="P"),1==this.fontScaleX&&1==this.fontScaleY||(o+=(20*this.fontScaleX|0)+"_"+(20*this.fontScaleY|0));var u,h,d=0,f=this.textAtlases.length;if(!s)for(d=0;d<f;d++)if(u=(h=this.textAtlases[d]).charMaps[o])return u.touch(),u;u=new p.CharRenderInfo,this.charRender.scale(this.fontScaleX,this.fontScaleY),u.char=e,u.height=i._size;var _=x.ILaya.Render.isConchApp?0:i._size/3|0,v=null;r||(r=0);var y=Math.ceil((this.charRender.getWidth(this.fontStr,e)+2*r)*this.fontScaleX);if(y>this.charRender.canvasWidth&&(this.charRender.canvasWidth=Math.min(2048,y+2*_)),s){if(this.charRender.fontsz=i._size,v=this.charRender.getCharBmp(e,this.fontStr,r,a,n,u,_,_,_,_,null)){var g=c.TextTexture.getTextTexture(v.width,v.height);g.addChar(v,0,0,u.uv),u.tex=g,u.orix=_,u.oriy=_,g.ri=u,this.isoTextures.push(g)}}else{var m=e.length,T=1*r,k=Math.ceil((this.fontSizeW+2*T)*this.fontScaleX),C=Math.ceil((this.fontSizeH+2*T)*this.fontScaleY);t.imgdtRect[0]=(_-this.fontSizeOffX-T)*this.fontScaleX|0,t.imgdtRect[1]=(_-this.fontSizeOffY-T)*this.fontScaleY|0,this.renderPerChar||1==m?(t.imgdtRect[2]=Math.max(y,k),t.imgdtRect[3]=Math.max(y,C)):(t.imgdtRect[2]=-1,t.imgdtRect[3]=C),this.charRender.fontsz=i._size,(v=this.charRender.getCharBmp(e,this.fontStr,r,a,n,u,_,_,_,_,t.imgdtRect))&&(h=this.addBmpData(v,u),t.isWan1Wan?(u.orix=_,u.oriy=_):(u.orix=this.fontSizeOffX+T,u.oriy=this.fontSizeOffY+T),h.charMaps[o]=u)}return u}},{key:"addBmpData",value:function(t,e){for(var i,a=t.width,n=t.height,r=this.textAtlases.length,s=!1,l=0;l<r&&!(s=(i=this.textAtlases[l]).getAEmpty(a,n,this.tmpAtlasPos));l++);if(!s){if(i=new h.TextAtlas,this.textAtlases.push(i),!(s=i.getAEmpty(a,n,this.tmpAtlasPos)))throw"err1";this.cleanAtlases()}return s&&(i.texture.addChar(t,this.tmpAtlasPos.x,this.tmpAtlasPos.y,e.uv),e.tex=i.texture),i}},{key:"GC",value:function(){for(var e=0,i=this.textAtlases.length,a=t.destroyAtlasDt,n=0,r=f.RenderInfo.loopCount,s=-1,l=0,o=null,u=null;e<i;e++){if(o=(u=this.textAtlases[e]).texture){o.curUsedCovRate,n+=o.curUsedCovRateAtlas;var h=u.usedRate-o.curUsedCovRateAtlas;l<h&&(l=h,s=e)}r-u.texture.lastTouchTm>a&&(t.showLog&&console.log(u.texture.id),u.destroy(),this.textAtlases[e]=this.textAtlases[i-1],i--,e--,s=-1)}for(this.textAtlases.length=i,i=this.isoTextures.length,e=0;e<i;e++)r-(o=this.isoTextures[e]).lastTouchTm>t.destroyUnusedTextureDt&&(o.ri.deleted=!0,o.ri.tex=null,o.destroy(),this.isoTextures[e]=this.isoTextures[i-1],i--,e--);this.isoTextures.length=i;var d=this.textAtlases.length>1&&this.textAtlases.length-n>=2;(t.atlasWidth*t.atlasWidth*4*this.textAtlases.length>t.cleanMem||d||t.simClean)&&(t.simClean=!1,t.showLog&&console.log("清理使用率低的贴图。总使用率:",n,":",this.textAtlases.length,"最差贴图:"+s),s>=0&&((u=this.textAtlases[s]).destroy(),this.textAtlases[s]=this.textAtlases[this.textAtlases.length-1],this.textAtlases.length=this.textAtlases.length-1)),c.TextTexture.clean()}},{key:"cleanAtlases",value:function(){}},{key:"getCharBmp",value:function(t){}},{key:"checkBmpLine",value:function(t,e,i,a){this.bmpData32.buffer!=t.data.buffer&&(this.bmpData32=new Uint32Array(t.data.buffer));for(var n=t.width*e+i,r=i;r<a;r++)if(0!=this.bmpData32[n++])return!0;return!1}},{key:"updateBbx",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.width,n=t.height,r=0,s=e[1],l=0,o=s;if(this.checkBmpLine(t,s,0,a))for(;;){if(1+(o=(s+l)/2|0)>=s){e[1]=o;break}this.checkBmpLine(t,o,0,a)?s=o:l=o}if(e[3]>n)e[3]=n;else if(o=s=e[3],l=n,this.checkBmpLine(t,s,0,a))for(;;){if((o=(s+l)/2|0)-1<=s){e[3]=o;break}this.checkBmpLine(t,o,0,a)?s=o:l=o}if(!i){var u=e[0],h=a*e[1];for(o=e[1];o<e[3];o++){for(r=0;r<u;r++)if(0!=this.bmpData32[h+r]){u=r;break}h+=a}e[0]=u;var c=e[2];for(h=a*e[1],o=e[1];o<e[3];o++){for(r=c;r<a;r++)if(0!=this.bmpData32[h+r]){c=r;break}h+=a}e[2]=c}}},{key:"getFontSizeInfo",value:function(e){var i=this.fontSizeInfo[e];if(null!=i)return i;var a="bold "+t.standardFontSize+"px "+e;if(t.isWan1Wan){this.fontSizeW=1.5*this.charRender.getWidth(a,"有"),this.fontSizeH=1.5*t.standardFontSize;var n=this.fontSizeW<<8|this.fontSizeH;return this.fontSizeInfo[e]=n,n}t.pixelBBX[0]=t.standardFontSize/2,t.pixelBBX[1]=t.standardFontSize/2,t.pixelBBX[2]=t.standardFontSize,t.pixelBBX[3]=t.standardFontSize;var r=16,s=16;this.charRender.scale(1,1),t.tmpRI.height=t.standardFontSize,this.charRender.fontsz=t.standardFontSize;var l=this.charRender.getCharBmp("g",a,0,"red",null,t.tmpRI,r,s,16,16);x.ILaya.Render.isConchApp&&(l.data=new Uint8ClampedArray(l.data)),this.bmpData32=new Uint32Array(l.data.buffer),this.updateBbx(l,t.pixelBBX,!1),l=this.charRender.getCharBmp("有",a,0,"red",null,t.tmpRI,s,s,16,16),x.ILaya.Render.isConchApp&&(l.data=new Uint8ClampedArray(l.data)),this.bmpData32=new Uint32Array(l.data.buffer),t.pixelBBX[2]<r+t.tmpRI.width&&(t.pixelBBX[2]=r+t.tmpRI.width),this.updateBbx(l,t.pixelBBX,!1),x.ILaya.Render.isConchApp&&(r=0,s=0);var o=Math.max(r-t.pixelBBX[0],0)<<24|Math.max(s-t.pixelBBX[1],0)<<16|t.pixelBBX[2]-t.pixelBBX[0]<<8|t.pixelBBX[3]-t.pixelBBX[1];return this.fontSizeInfo[e]=o,o}},{key:"printDbgInfo",value:function(){var e,i;for(var a in console.log("图集个数:"+this.textAtlases.length+",每个图集大小:"+t.atlasWidth+"x"+t.atlasWidth," 用canvas:",t.isWan1Wan),console.log("图集占用空间:"+t.atlasWidth*t.atlasWidth*4/1024/1024*this.textAtlases.length+"M"),console.log("缓存用到的字体:"),this.mapFont){var n=this.getFontSizeInfo(a),r=n>>24,l=n>>16&255,o=n>>8&255,u=255&n;console.log("    "+a," off:",r,l," size:",o,u)}var h=0;console.log("缓存数据:");var c=0,d=0;(0,s.default)(e=this.textAtlases).call(e,(function(e){var i=e.texture.id,a=f.RenderInfo.loopCount-e.texture.lastTouchTm,n=a>0?a+"帧以前":"当前帧";for(var r in c+=e.texture.curUsedCovRate,d+=e.texture.curUsedCovRateAtlas,console.log("--图集(id:"+i+",当前使用率:"+(1e3*e.texture.curUsedCovRate|0)+"‰","当前图集使用率:",(100*e.texture.curUsedCovRateAtlas|0)+"%","图集使用率:",100*e.usedRate|0,"%, 使用于:"+n+")--:"),e.charMaps){var s=e.charMaps[r];console.log("     off:",s.orix,s.oriy," bmp宽高:",s.bmpWidth,s.bmpHeight,"无效:",s.deleted,"touchdt:",f.RenderInfo.loopCount-s.touchTick,"位置:",s.uv[0]*t.atlasWidth|0,s.uv[1]*t.atlasWidth|0,"字符:",s.char,"key:",r),h++}})),console.log("独立贴图文字("+this.isoTextures.length+"个):"),(0,s.default)(i=this.isoTextures).call(i,(function(t){console.log("    size:",t._texW,t._texH,"touch间隔:",f.RenderInfo.loopCount-t.lastTouchTm,"char:",t.ri.char)})),console.log("总缓存:",h,"总使用率:",c,"总当前图集使用率:",d)}},{key:"showAtlas",value:function(e,i,a,n,r,s){if(!this.textAtlases[e])return console.log("没有这个图集"),null;var l=new x.ILaya.Sprite,o=this.textAtlases[e].texture,u={width:t.atlasWidth,height:t.atlasWidth,sourceWidth:t.atlasWidth,sourceHeight:t.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return!0},_addReference:function(){},_removeReference:function(){},_getSource:function(){return o._getSource()},bitmap:{id:o.id},_uv:_.Texture.DEF_UV};return l.size=function(t,e){return this.width=t,this.height=e,l.graphics.clear(),l.graphics.drawRect(0,0,l.width,l.height,i),l.graphics.drawTexture(u,0,0,l.width,l.height),this},l.graphics.drawRect(0,0,r,s,i),l.graphics.drawTexture(u,0,0,r,s),l.pos(a,n),x.ILaya.stage.addChild(l),l}},{key:"filltext_native",value:function(t,e,i,a,n,r,s,l,o,u){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0;if(!(e&&e.length<=0||i&&i.length<1)){var c=v.FontInfo.Parse(r),d=0;switch(u){case"center":d=x.ILaya.Context.ENUM_TEXTALIGN_CENTER;break;case"right":d=x.ILaya.Context.ENUM_TEXTALIGN_RIGHT}return this._fast_filltext(t,e,i,a,n,c,s,l,o,d,h)}}}]),t}();e.TextRender=T,(0,u.default)(T,"useOldCharBook",!1),(0,u.default)(T,"atlasWidth",1024),(0,u.default)(T,"noAtlas",!1),(0,u.default)(T,"forceSplitRender",!1),(0,u.default)(T,"forceWholeRender",!1),(0,u.default)(T,"scaleFontWithCtx",!0),(0,u.default)(T,"standardFontSize",32),(0,u.default)(T,"destroyAtlasDt",10),(0,u.default)(T,"checkCleanTextureDt",2e3),(0,u.default)(T,"destroyUnusedTextureDt",3e3),(0,u.default)(T,"cleanMem",104857600),(0,u.default)(T,"isWan1Wan",!1),(0,u.default)(T,"showLog",!1),(0,u.default)(T,"debugUV",!1),(0,u.default)(T,"tmpRI",new p.CharRenderInfo),(0,u.default)(T,"pixelBBX",[0,0,0,0]),(0,u.default)(T,"imgdtRect",[0,0,0,0]),(0,u.default)(T,"simClean",!1),c.TextTexture.gTextRender=T},78843:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.TextTexture=void 0;var s=r(i(44494)),l=(r(i(77766)),r(i(87368))),o=r(i(28146)),u=r(i(43714)),h=r(i(13383)),c=r(i(78310)),d=r(i(82669)),f=r(i(17454)),_=i(54008),v=i(39498),y=i(8865),p=i(52379),g=i(93561);var m=function(t){(0,h.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,d.default)(e);if(i){var r=(0,d.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,c.default)(this,t)});function r(t,e){var i;return(0,l.default)(this,r),i=n.call(this),(0,f.default)((0,u.default)(i),"_texW",0),(0,f.default)((0,u.default)(i),"_texH",0),(0,f.default)((0,u.default)(i),"__destroyed",!1),(0,f.default)((0,u.default)(i),"_discardTm",0),(0,f.default)((0,u.default)(i),"genID",0),(0,f.default)((0,u.default)(i),"bitmap",{id:0,_glTexture:null}),(0,f.default)((0,u.default)(i),"curUsedCovRate",0),(0,f.default)((0,u.default)(i),"curUsedCovRateAtlas",0),(0,f.default)((0,u.default)(i),"lastTouchTm",0),(0,f.default)((0,u.default)(i),"ri",null),i._texW=t||r.gTextRender.atlasWidth,i._texH=e||r.gTextRender.atlasWidth,i.bitmap.id=i.id,i.lock=!0,i}return(0,o.default)(r,[{key:"recreateResource",value:function(){if(!this._source){var t=_.LayaGL.instance,e=this._source=t.createTexture();this.bitmap._glTexture=e,p.WebGLContext.bindTexture(t,t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._texW,this._texH,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r.gTextRender.debugUV&&this.fillWhite()}}},{key:"addChar",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r.gTextRender.isWan1Wan)return this.addCharCanvas(t,e,i,a);!this._source&&this.recreateResource();var n=_.LayaGL.instance;p.WebGLContext.bindTexture(n,n.TEXTURE_2D,this._source),!g.ILaya.Render.isConchApp&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var s,l,o,u,h=t.data;return t.data instanceof Uint8ClampedArray&&(h=new Uint8Array(h.buffer)),n.texSubImage2D(n.TEXTURE_2D,0,e,i,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,h),!g.ILaya.Render.isConchApp&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s=e/this._texW,l=i/this._texH,o=(e+t.width)/this._texW,u=(i+t.height)/this._texH,(a=a||new Array(8))[0]=s,a[1]=l,a[2]=o,a[3]=l,a[4]=o,a[5]=u,a[6]=s,a[7]=u,a}},{key:"addCharCanvas",value:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!this._source&&this.recreateResource();var n,r,s,l,o=_.LayaGL.instance;return p.WebGLContext.bindTexture(o,o.TEXTURE_2D,this._source),!g.ILaya.Render.isConchApp&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.texSubImage2D(o.TEXTURE_2D,0,e,i,o.RGBA,o.UNSIGNED_BYTE,t),!g.ILaya.Render.isConchApp&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.ILaya.Render.isConchApp?(n=e/this._texW,r=i/this._texH,s=(e+t.width)/this._texW,l=(i+t.height)/this._texH):(n=(e+1)/this._texW,r=(i+1)/this._texH,s=(e+t.width-1)/this._texW,l=(i+t.height-1)/this._texH),(a=a||new Array(8))[0]=n,a[1]=r,a[2]=s,a[3]=r,a[4]=s,a[5]=l,a[6]=n,a[7]=l,a}},{key:"fillWhite",value:function(){var t;!this._source&&this.recreateResource();var e=_.LayaGL.instance,i=new Uint8Array(this._texW*this._texH*4);(0,s.default)(t=i).call(t,255),e.texSubImage2D(e.TEXTURE_2D,0,0,0,this._texW,this._texH,e.RGBA,e.UNSIGNED_BYTE,i)}},{key:"discard",value:function(){g.ILaya.stage.setGlobalRepaint(),this.destroy()}},{key:"destroy",value:function(){this.__destroyed=!0;var t=_.LayaGL.instance;this._source&&t.deleteTexture(this._source),this._source=null}},{key:"touchRect",value:function(t,e){this.lastTouchTm!=e&&(this.curUsedCovRate=0,this.curUsedCovRateAtlas=0,this.lastTouchTm=e);var i=r.gTextRender.atlasWidth*r.gTextRender.atlasWidth,a=g.ILaya.TextAtlas.atlasGridW*g.ILaya.TextAtlas.atlasGridW;this.curUsedCovRate+=t.bmpWidth*t.bmpHeight/i,this.curUsedCovRateAtlas+=Math.ceil(t.bmpWidth/g.ILaya.TextAtlas.atlasGridW)*Math.ceil(t.bmpHeight/g.ILaya.TextAtlas.atlasGridW)/(i/a)}},{key:"texture",get:function(){return this}},{key:"_getSource",value:function(){return this._source}},{key:"drawOnScreen",value:function(t,e){}}],[{key:"getTextTexture",value:function(t,e){return new r(t,e)}},{key:"clean",value:function(){var t=v.RenderInfo.loopStTm;if(0===r.cleanTm&&(r.cleanTm=t),t-r.cleanTm>=r.gTextRender.checkCleanTextureDt){for(var e=0;e<r.poolLen;e++){var i=r.pool[e];t-i._discardTm>=r.gTextRender.destroyUnusedTextureDt&&(i.destroy(),r.pool[e]=r.pool[r.poolLen-1],r.poolLen--,e--)}r.cleanTm=t}}}]),r}(y.Resource);e.TextTexture=m,(0,f.default)(m,"gTextRender",null),(0,f.default)(m,"pool",new Array(10)),(0,f.default)(m,"poolLen",0),(0,f.default)(m,"cleanTm",0)},30904:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Buffer=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(54008),u=function(){function t(){(0,r.default)(this,t),(0,l.default)(this,"_byteLength",0),this._glBuffer=o.LayaGL.instance.createBuffer()}return(0,s.default)(t,[{key:"bufferUsage",get:function(){return this._bufferUsage}},{key:"_bindForVAO",value:function(){}},{key:"bind",value:function(){return!1}},{key:"destroy",value:function(){this._glBuffer&&(o.LayaGL.instance.deleteBuffer(this._glBuffer),this._glBuffer=null)}}]),t}();e.Buffer=u},80510:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.Buffer2D=void 0;var s=r(i(3649)),l=r(i(54103)),o=r(i(87368)),u=r(i(28146)),h=r(i(43714)),c=r(i(13383)),d=r(i(78310)),f=r(i(82669)),_=r(i(17454)),v=i(54008),y=i(39498),p=i(83530),g=i(30904);var m=function(t){(0,c.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,f.default)(e);if(i){var r=(0,f.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,d.default)(this,t)});function r(){var t;return(0,o.default)(this,r),t=n.call(this),(0,_.default)((0,h.default)(t),"_maxsize",0),(0,_.default)((0,h.default)(t),"_upload",!0),(0,_.default)((0,h.default)(t),"_uploadSize",0),(0,_.default)((0,h.default)(t),"_bufferSize",0),(0,_.default)((0,h.default)(t),"_u8Array",null),t}return(0,u.default)(r,[{key:"bufferLength",get:function(){return this._buffer.byteLength}},{key:"byteLength",set:function(t){this.setByteLength(t)}},{key:"setByteLength",value:function(t){this._byteLength!==t&&(t<=this._bufferSize||this._resizeBuffer(2*t+256,!0),this._byteLength=t)}},{key:"needSize",value:function(t){var e=this._byteLength;if(t){var i=this._byteLength+t;i<=this._bufferSize||this._resizeBuffer(i<<1,!0),this._byteLength=i}return e}},{key:"_bufferData",value:function(){var t;(this._maxsize=Math.max(this._maxsize,this._byteLength),y.RenderInfo.loopCount%30==0)&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=(0,s.default)(t=this._buffer).call(t,0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength);this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,v.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),v.LayaGL.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))}},{key:"_bufferSubData",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(this._maxsize=Math.max(this._maxsize,this._byteLength),y.RenderInfo.loopCount%30==0)&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=(0,s.default)(t=this._buffer).call(t,0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength);if(this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,v.LayaGL.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),i||a){var n,r=(0,s.default)(n=this._buffer).call(n,i,a);v.LayaGL.instance.bufferSubData(this._bufferType,e,r)}else v.LayaGL.instance.bufferSubData(this._bufferType,e,this._buffer)}},{key:"_checkArrayUse",value:function(){}},{key:"_bind_uploadForVAO",value:function(){return!!this._upload&&(this._upload=!1,this._bindForVAO(),this._bufferData(),!0)}},{key:"_bind_upload",value:function(){return!!this._upload&&(this._upload=!1,(0,l.default)(this).call(this),this._bufferData(),!0)}},{key:"_bind_subUpload",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!!this._upload&&(this._upload=!1,(0,l.default)(t=this).call(t),this._bufferSubData(e,i,a),!0)}},{key:"_resizeBuffer",value:function(t,e){var i=this._buffer;if(t<=i.byteLength)return this;var a=this._u8Array;if(e&&i&&i.byteLength>0){var n=new ArrayBuffer(t),r=a&&a.buffer==i?a:new Uint8Array(i);(a=this._u8Array=new Uint8Array(n)).set(r,0),i=this._buffer=n}else i=this._buffer=new ArrayBuffer(t),this._u8Array=null;return this._checkArrayUse(),this._upload=!0,this._bufferSize=i.byteLength,this}},{key:"append",value:function(t){var e,i;this._upload=!0,e=t.byteLength,t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+e,!0),i=new Uint8Array(this._buffer,this._byteLength)):t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+e,!0),i=new Uint16Array(this._buffer,this._byteLength)):t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+e,!0),i=new Float32Array(this._buffer,this._byteLength)),i.set(t,0),this._byteLength+=e,this._checkArrayUse()}},{key:"appendU16Array",value:function(t,e){this._resizeBuffer(this._byteLength+2*e,!0);var i=new Uint16Array(this._buffer,this._byteLength,e);if(6==e)i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5];else if(e>=100)i.set(new Uint16Array(t.buffer,0,e));else for(var a=0;a<e;a++)i[a]=t[a];this._byteLength+=2*e,this._checkArrayUse()}},{key:"appendEx",value:function(t,e){var i;this._upload=!0,i=t.byteLength,this._resizeBuffer(this._byteLength+i,!0),new e(this._buffer,this._byteLength).set(t,0),this._byteLength+=i,this._checkArrayUse()}},{key:"appendEx2",value:function(t,e,i){var a,n,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(this._upload=!0,a=i*s,this._resizeBuffer(this._byteLength+a,!0),n=new e(this._buffer,this._byteLength),r=0;r<i;r++)n[r]=t[r];this._byteLength+=a,this._checkArrayUse()}},{key:"getBuffer",value:function(){return this._buffer}},{key:"setNeedUpload",value:function(){this._upload=!0}},{key:"getNeedUpload",value:function(){return this._upload}},{key:"upload",value:function(){var t=v.LayaGL.instance,e=this._bind_upload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(g.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(g.Buffer._bindedIndexBuffer=null),p.BaseShader.activeShader=null,e}},{key:"subUpload",value:function(){var t=v.LayaGL.instance,e=this._bind_subUpload();return t.bindBuffer(this._bufferType,null),this._bufferType==t.ARRAY_BUFFER&&(g.Buffer._bindedVertexBuffer=null),this._bufferType==t.ELEMENT_ARRAY_BUFFER&&(g.Buffer._bindedIndexBuffer=null),p.BaseShader.activeShader=null,e}},{key:"_disposeResource",value:function(){this._upload=!0,this._uploadSize=0}},{key:"clear",value:function(){this._byteLength=0,this._upload=!0}}],[{key:"__int__",value:function(t){}}]),r}(g.Buffer);e.Buffer2D=m,(0,_.default)(m,"FLOAT32",4),(0,_.default)(m,"SHORT",2)},29728:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.CONST3D2D=void 0;var r=n(i(28146)),s=n(i(87368)),l=n(i(17454)),o=(0,r.default)((function t(){(0,s.default)(this,t)}));e.CONST3D2D=o,(0,l.default)(o,"BYTES_PE",4),(0,l.default)(o,"BYTES_PIDX",2),(0,l.default)(o,"defaultMatrix4",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),(0,l.default)(o,"defaultMinusYMatrix4",[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1]),(0,l.default)(o,"uniformMatrix3",[1,0,0,0,0,1,0,0,0,0,1,0]),(0,l.default)(o,"_TMPARRAY",[]),(0,l.default)(o,"_OFFSETX",0),(0,l.default)(o,"_OFFSETY",0)},51651:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.IndexBuffer2D=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(54008),f=i(30904);var _=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:35044;return(0,s.default)(this,r),(t=n.call(this))._bufferUsage=e,t._bufferType=d.LayaGL.instance.ELEMENT_ARRAY_BUFFER,t._buffer=new ArrayBuffer(8),t}return(0,l.default)(r,[{key:"_checkArrayUse",value:function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))}},{key:"getUint16Array",value:function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))}},{key:"_bindForVAO",value:function(){var t=d.LayaGL.instance;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){if(f.Buffer._bindedIndexBuffer!==this._glBuffer){var t=d.LayaGL.instance;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer),f.Buffer._bindedIndexBuffer=this._glBuffer,!0}return!1}},{key:"destory",value:function(){this._uint16Array=null,this._buffer=null}},{key:"disposeResource",value:function(){this._disposeResource()}}]),r}(i(80510).Buffer2D);e.IndexBuffer2D=_,(0,c.default)(_,"create",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:35044;return new _(t)}))},55400:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.InlcudeFile=void 0;var r=n(i(81643)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(93561),h=function(){function t(e){(0,s.default)(this,t),(0,o.default)(this,"codes",{}),(0,o.default)(this,"funs",{}),(0,o.default)(this,"curUseID",-1),(0,o.default)(this,"funnames",""),this.script=e;for(var i,a,n=0;!((n=(0,r.default)(e).call(e,"#begin",n))<0);){for(a=n+5;!((a=(0,r.default)(e).call(e,"#end",a))<0)&&"i"===e.charAt(a+4);)a+=5;if(a<0)throw"add include err,no #end:"+e;i=(0,r.default)(e).call(e,"\n",n);var l=u.ILaya.ShaderCompile.splitToWords(e.substr(n,i-n),null);"code"==l[1]?this.codes[l[2]]=e.substr(i+1,a-i-1):"function"==l[1]&&(i=(0,r.default)(e).call(e,"function",n),i+="function".length,this.funs[l[3]]=e.substr(i+1,a-i-1),this.funnames+=l[3]+";"),n=a+1}}return(0,l.default)(t,[{key:"getWith",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=t?this.codes[t]:this.script;if(!e)throw"get with error:"+t;return e}},{key:"getFunsScript",value:function(t){var e="";for(var i in this.funs)(0,r.default)(t).call(t,i+";")>=0&&(e+=this.funs[i]);return e}}]),t}();e.InlcudeFile=h},36418:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.Mesh2D=void 0;var r=n(i(54103)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(54008),h=i(25126),c=i(20516),d=i(51651),f=i(20786),_=function(){function t(e,i,a){(0,s.default)(this,t),(0,o.default)(this,"_stride",0),(0,o.default)(this,"vertNum",0),(0,o.default)(this,"indexNum",0),(0,o.default)(this,"_applied",!1),(0,o.default)(this,"_quadNum",0),(0,o.default)(this,"canReuse",!1),this._stride=e,this._vb=new f.VertexBuffer2D(e,u.LayaGL.instance.DYNAMIC_DRAW),i?this._vb._resizeBuffer(i,!1):c.Config.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*e,!1),this._ib=new d.IndexBuffer2D,a&&this._ib._resizeBuffer(a,!1)}return(0,l.default)(t,[{key:"cloneWithNewVB",value:function(){var e=new t(this._stride,0,0);return e._ib=this._ib,e._quadNum=this._quadNum,e._attribInfo=this._attribInfo,e}},{key:"cloneWithNewVBIB",value:function(){var e=new t(this._stride,0,0);return e._attribInfo=this._attribInfo,e}},{key:"getVBW",value:function(){return this._vb.setNeedUpload(),this._vb}},{key:"getVBR",value:function(){return this._vb}},{key:"getIBR",value:function(){return this._ib}},{key:"getIBW",value:function(){return this._ib.setNeedUpload(),this._ib}},{key:"createQuadIB",value:function(t){this._quadNum=t,this._ib._resizeBuffer(6*t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var e=this._ib.getUint16Array(),i=0,a=0,n=0;n<t;n++)e[i++]=a,e[i++]=a+2,e[i++]=a+1,e[i++]=a,e[i++]=a+3,e[i++]=a+2,a+=4;this._ib.setNeedUpload()}},{key:"setAttributes",value:function(t){if(this._attribInfo=t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"}},{key:"configVAO",value:function(t){var e;if(!this._applied){this._applied=!0,this._vao||(this._vao=new h.BufferState2D),(0,r.default)(e=this._vao).call(e),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var i=this._attribInfo.length/3,a=0,n=0;n<i;n++){var s=this._attribInfo[a+1],l=this._attribInfo[a],o=this._attribInfo[a+2];t.enableVertexAttribArray(n),t.vertexAttribPointer(n,s,l,!1,this._stride,o),a+=3}this._vao.unBind()}}},{key:"useMesh",value:function(t){var e,i,a,n;this._applied||this.configVAO(t),(0,r.default)(e=this._vao).call(e),(0,r.default)(i=this._vb).call(i),this._ib._bind_upload()||(0,r.default)(a=this._ib).call(a),this._vb._bind_upload()||(0,r.default)(n=this._vb).call(n)}},{key:"getEleNum",value:function(){return this._ib.getBuffer().byteLength/2}},{key:"releaseMesh",value:function(){}},{key:"destroy",value:function(){}},{key:"clearVB",value:function(){this._vb.clear()}}]),t}();e.Mesh2D=_,(0,o.default)(_,"_gvaoid",0)},16729:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.MeshParticle2D=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(36418),f=i(54008);var _=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(t){var e;return(0,s.default)(this,r),(e=n.call(this,r.const_stride,4*t*r.const_stride,4)).canReuse=!0,e.setAttributes(r._fixattriInfo),e.createQuadIB(t),e._quadNum=t,e}return(0,l.default)(r,[{key:"setMaxParticleNum",value:function(t){this._vb._resizeBuffer(4*t*r.const_stride,!1),this.createQuadIB(t)}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,r._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){var t=f.LayaGL.instance;r._fixattriInfo=[t.FLOAT,4,0,t.FLOAT,3,16,t.FLOAT,3,28,t.FLOAT,4,40,t.FLOAT,4,56,t.FLOAT,3,72,t.FLOAT,2,84,t.FLOAT,4,92,t.FLOAT,1,108,t.FLOAT,1,112]}},{key:"getAMesh",value:function(t){if(r._POOL.length){var e=r._POOL.pop();return e.setMaxParticleNum(t),e}return new r(t)}}]),r}(d.Mesh2D);e.MeshParticle2D=_,(0,c.default)(_,"const_stride",116),(0,c.default)(_,"_POOL",[])},93543:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.MeshQuadTexture=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454));var d=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t;return(0,s.default)(this,r),(t=n.call(this,r.const_stride,4,4)).canReuse=!0,t.setAttributes(r._fixattriInfo),r._fixib?(t._ib=r._fixib,t._quadNum=r._maxIB):(t.createQuadIB(r._maxIB),r._fixib=t._ib),t}return(0,l.default)(r,[{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,r._POOL.push(this)}},{key:"destroy",value:function(){this._vb.destroy(),this._vb.deleteBuffer()}},{key:"addQuad",value:function(t,e,i,a){var n=this._vb,s=n._byteLength>>2;n.setByteLength(s+r.const_stride<<2);var l=n._floatArray32||n.getFloat32Array(),o=n._uint32Array,u=s,h=a?255:0;l[u++]=t[0],l[u++]=t[1],l[u++]=e[0],l[u++]=e[1],o[u++]=i,o[u++]=h,l[u++]=t[2],l[u++]=t[3],l[u++]=e[2],l[u++]=e[3],o[u++]=i,o[u++]=h,l[u++]=t[4],l[u++]=t[5],l[u++]=e[4],l[u++]=e[5],o[u++]=i,o[u++]=h,l[u++]=t[6],l[u++]=t[7],l[u++]=e[6],l[u++]=e[7],o[u++]=i,o[u++]=h,n._upload=!0}}],[{key:"__int__",value:function(){r._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(t){var e=null;return e=r._POOL.length?r._POOL.pop():new r,t&&e._vb._resizeBuffer(65536*r.const_stride,!1),e}}]),r}(i(36418).Mesh2D);e.MeshQuadTexture=d,(0,c.default)(d,"const_stride",24),(0,c.default)(d,"_maxIB",16384),(0,c.default)(d,"_POOL",[])},45147:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.MeshTexture=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(54008);var f=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t;return(0,s.default)(this,r),(t=n.call(this,r.const_stride,4,4)).canReuse=!0,t.setAttributes(r._fixattriInfo),t}return(0,l.default)(r,[{key:"addData",value:function(t,e,i,a,n){var s=this._vb,l=this._ib,o=t.length>>1,u=s.needSize(o*r.const_stride)>>2,h=s._floatArray32||s.getFloat32Array(),c=s._uint32Array,d=0,f=a.a,_=a.b,v=a.c,y=a.d,p=a.tx,g=a.ty,m=0;for(m=0;m<o;m++){var x=t[d],T=t[d+1];h[u]=x*f+T*v+p,h[u+1]=x*_+T*y+g,h[u+2]=e[d],h[u+3]=e[d+1],c[u+4]=n,c[u+5]=255,u+=6,d+=2}s.setNeedUpload();var k=this.vertNum,C=i.length,S=l.needSize(i.byteLength),E=l.getUint16Array(),M=S>>1;if(k>0){var L=M+C,b=0;for(m=M;m<L;m++,b++)E[m]=i[b]+k}else E.set(i,M);l.setNeedUpload(),this.vertNum+=o,this.indexNum+=i.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,r._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){d.LayaGL.instance,r._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(t){var e;return e=r._POOL.length?r._POOL.pop():new r,t&&e._vb._resizeBuffer(65536*r.const_stride,!1),e}}]),r}(i(36418).Mesh2D);e.MeshTexture=f,(0,c.default)(f,"const_stride",24),(0,c.default)(f,"_POOL",[])},50642:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.MeshVG=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(13383)),u=r(i(78310)),h=r(i(82669)),c=r(i(17454)),d=i(54008);var f=function(t){(0,o.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,h.default)(e);if(i){var r=(0,h.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,u.default)(this,t)});function r(){var t;return(0,s.default)(this,r),(t=n.call(this,r.const_stride,4,4)).canReuse=!0,t.setAttributes(r._fixattriInfo),t}return(0,l.default)(r,[{key:"addVertAndIBToMesh",value:function(t,e,i,a){for(var n=this._vb.needSize(e.length/2*r.const_stride)>>2,s=this._vb._floatArray32||this._vb.getFloat32Array(),l=this._vb._uint32Array,o=0,u=e.length/2,h=0;h<u;h++)s[n++]=e[o],s[n++]=e[o+1],o+=2,l[n++]=i;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(a)),this._ib.setNeedUpload(),this.vertNum+=u,this.indexNum+=a.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,r._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){d.LayaGL.instance,r._fixattriInfo=[5126,2,0,5121,4,8]}},{key:"getAMesh",value:function(t){var e;return e=r._POOL.length?r._POOL.pop():new r,t&&e._vb._resizeBuffer(65536*r.const_stride,!1),e}}]),r}(i(36418).Mesh2D);e.MeshVG=f,(0,c.default)(f,"const_stride",12),(0,c.default)(f,"_POOL",[])},33965:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.RenderState2D=void 0;var r=n(i(87368)),s=n(i(28146)),l=n(i(17454)),o=i(5866),u=function(){function t(){(0,r.default)(this,t)}return(0,s.default)(t,null,[{key:"mat2MatArray",value:function(e,i){var a=e,n=i;return n[0]=a.a,n[1]=a.b,n[2]=t.EMPTYMAT4_ARRAY[2],n[3]=t.EMPTYMAT4_ARRAY[3],n[4]=a.c,n[5]=a.d,n[6]=t.EMPTYMAT4_ARRAY[6],n[7]=t.EMPTYMAT4_ARRAY[7],n[8]=t.EMPTYMAT4_ARRAY[8],n[9]=t.EMPTYMAT4_ARRAY[9],n[10]=t.EMPTYMAT4_ARRAY[10],n[11]=t.EMPTYMAT4_ARRAY[11],n[12]=a.tx,n[13]=a.ty,n[14]=t.EMPTYMAT4_ARRAY[14],n[15]=t.EMPTYMAT4_ARRAY[15],i}},{key:"restoreTempArray",value:function(){t.TEMPMAT4_ARRAY[0]=1,t.TEMPMAT4_ARRAY[1]=0,t.TEMPMAT4_ARRAY[4]=0,t.TEMPMAT4_ARRAY[5]=1,t.TEMPMAT4_ARRAY[12]=0,t.TEMPMAT4_ARRAY[13]=0}},{key:"clear",value:function(){t.worldScissorTest=!1,t.worldAlpha=1}}]),t}();e.RenderState2D=u,(0,l.default)(u,"_MAXSIZE",99999999),(0,l.default)(u,"EMPTYMAT4_ARRAY",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),(0,l.default)(u,"TEMPMAT4_ARRAY",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),(0,l.default)(u,"worldMatrix4",u.TEMPMAT4_ARRAY),(0,l.default)(u,"worldMatrix",new o.Matrix),(0,l.default)(u,"matWVP",null),(0,l.default)(u,"worldAlpha",1),(0,l.default)(u,"worldScissorTest",!1),(0,l.default)(u,"width",0),(0,l.default)(u,"height",0)},36169:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ShaderCompile=void 0;var r=n(i(11128)),s=n(i(81643)),l=n(i(78580)),o=n(i(94198)),u=n(i(87368)),h=n(i(28146)),c=n(i(17454)),d=i(54008),f=i(23857),_=i(55400),v=i(30011),y=function(){function t(e,i,a){(0,u.default)(this,t),(0,c.default)(this,"defs",{});var n=this;function s(e){e=e.replace(t._clearCR,"");var i=[],a=new v.ShaderNode(i);return n._compileToTree(a,e.split("\n"),0,i,n.defs),a}var l=(0,r.default)();this._VS=s(e),this._PS=s(i),this._nameMap=a,(0,r.default)()-l>2&&console.log("ShaderCompile use time:"+((0,r.default)()-l)+"  size:"+e.length+"/"+i.length)}return(0,h.default)(t,[{key:"_compileToTree",value:function(e,i,a,n,r){var o,u,h,c,d,f,_,y,p,g,m,x;for(g=a;g<i.length;g++)if(!((c=i[g]).length<1)&&0!==(_=(0,s.default)(c).call(c,"//"))){if(_>=0&&(c=c.substr(0,_)),u=p||new v.ShaderNode(n),p=null,u.text=c,u.noCompile=!0,(_=(0,s.default)(c).call(c,"#"))>=0){for(d="#",x=_+1,m=c.length;x<m;x++){var T=c.charAt(x);if(" "===T||"\t"===T||"?"===T)break;d+=T}switch(u.name=d,d){case"#ifdef":case"#ifndef":if(u.src=c,u.noCompile=null!=c.match(/[!&|()=<>]/),u.noCompile?console.log("function():Boolean{return "+c.substr(_+u.name.length)+"}"):(y=c.replace(/^\s*/,"").split(/\s+/),u.setCondition(y[1],"#ifdef"===d?t.IFDEF_YES:t.IFDEF_ELSE),u.text="//"+u.text),u.setParent(e),e=u,r)for(y=c.substr(x).split(t._splitToWordExps3),x=0;x<y.length;x++)(c=y[x]).length&&(r[c]=!0);continue;case"#if":if(u.src=c,u.noCompile=!0,u.setParent(e),e=u,r)for(y=c.substr(x).split(t._splitToWordExps3),x=0;x<y.length;x++)(c=y[x]).length&&"defined"!=c&&(r[c]=!0);continue;case"#else":u.src=c,h=(e=e.parent).childs[e.childs.length-1],u.noCompile=h.noCompile,u.noCompile||(u.condition=h.condition,u.conditionType=h.conditionType==t.IFDEF_YES?t.IFDEF_ELSE:t.IFDEF_YES,u.text="//"+u.text+" "+h.text+" "+u.conditionType),u.setParent(e),e=u;continue;case"#endif":h=(e=e.parent).childs[e.childs.length-1],u.noCompile=h.noCompile,u.noCompile||(u.text="//"+u.text),u.setParent(e);continue;case"#include":y=t.splitToWords(c,null);var k=(0,l.default)(t)[y[1]];if(!k)throw"ShaderCompile error no this include file:"+y[1];if((_=(0,s.default)(o=y[0]).call(o,"?"))<0){u.setParent(e),c=k.getWith("with"==y[2]?y[3]:null),this._compileToTree(u,c.split("\n"),0,n,r),u.text="";continue}u.setCondition(y[0].substr(_+1),t.IFDEF_YES),u.text=k.getWith("with"==y[2]?y[3]:null);break;case"#import":f=(y=t.splitToWords(c,null))[1],n.push({node:u,file:(0,l.default)(t)[f],ofs:u.text.length});continue}}else{if((h=e.childs[e.childs.length-1])&&!h.name){n.length>0&&t.splitToWords(c,h),p=u,h.text+="\n"+c;continue}n.length>0&&t.splitToWords(c,u)}u.setParent(e)}}},{key:"createShader",value:function(t,e,i,a){var n={},r="";if(t)for(var s in t)r+="#define "+s+"\n",n[s]=!0;var l=this._VS.toscript(n,[]),o=this._PS.toscript(n,[]);return(i||f.Shader.create)(r+l.join("\n"),r+o.join("\n"),e,this._nameMap,a)}}],[{key:"__init__",value:function(){var e=d.LayaGL.instance;t.shaderParamsMap={float:e.FLOAT,int:e.INT,bool:e.BOOL,vec2:e.FLOAT_VEC2,vec3:e.FLOAT_VEC3,vec4:e.FLOAT_VEC4,ivec2:e.INT_VEC2,ivec3:e.INT_VEC3,ivec4:e.INT_VEC4,bvec2:e.BOOL_VEC2,bvec3:e.BOOL_VEC3,bvec4:e.BOOL_VEC4,mat2:e.FLOAT_MAT2,mat3:e.FLOAT_MAT3,mat4:e.FLOAT_MAT4,sampler2D:e.SAMPLER_2D,samplerCube:e.SAMPLER_CUBE}}},{key:"_parseOne",value:function(e,i,a,n,r,s){var l={type:t.shaderParamsMap[a[n+1]],name:a[n+2],size:isNaN((0,o.default)(a[n+3]))?1:(0,o.default)(a[n+3])};return s&&("attribute"==r?e.push(l):i.push(l)),":"==a[n+3]&&(l.type=a[n+4],n+=2),n+2}},{key:"addInclude",value:function(e,i){if(!i||0===i.length)throw new Error("add shader include file err:"+e);if((0,l.default)(t)[e])throw new Error("add shader include file err, has add:"+e);(0,l.default)(t)[e]=new _.InlcudeFile(i)}},{key:"preGetParams",value:function(e,i){var a,n,r=[e,i],s={},l=[],o=[],u={},h={};s.attributes=l,s.uniforms=o,s.defines=u;for(var c=0;c<2;c++){r[c]=r[c].replace(t._removeAnnotation,"");var d,f=r[c].match(t._reg);for(a=0,n=f.length;a<n;a++){var _=f[a];if("attribute"==_||"uniform"==_)a=t._parseOne(l,o,f,a,_,!0);else{if("#define"==_){h[_=f[++a]]=1;continue}if("#ifdef"==_)for(u[d=f[++a]]=u[d]||[],a++;a<n;a++)if("attribute"==(_=f[a])||"uniform"==_)a=t._parseOne(l,o,f,a,_,!!h[d]);else if("#else"==_)for(a++;a<n;a++)if("attribute"==(_=f[a])||"uniform"==_)a=t._parseOne(l,o,f,a,_,!h[d]);else if("#endif"==_)break}}}return s}},{key:"splitToWords",value:function(t,e){for(var i,a,n=[],r=-1,l=0,o=t.length;l<o;l++)if(i=t.charAt(l),(0,s.default)(" \t=+-*/&%!<>()'\",;").call(" \t=+-*/&%!<>()'\",;",i)>=0){if(r>=0&&l-r>1&&(a=t.substr(r,l-r),n.push(a)),'"'==i||"'"==i){var u=(0,s.default)(t).call(t,i,l+1);if(u<0)throw"Sharder err:"+t;n.push(t.substr(l+1,u-l-1)),l=u,r=-1;continue}"("==i&&e&&n.length>0&&(a=n[n.length-1]+";",(0,s.default)("vec4;main;").call("vec4;main;",a)<0&&(e.useFuns+=a)),r=-1}else r<0&&(r=l);return r<o&&o-r>1&&(a=t.substr(r,o-r),n.push(a)),n}}]),t}();e.ShaderCompile=y,(0,c.default)(y,"IFDEF_NO",0),(0,c.default)(y,"IFDEF_YES",1),(0,c.default)(y,"IFDEF_ELSE",2),(0,c.default)(y,"IFDEF_PARENT",3),(0,c.default)(y,"_removeAnnotation",new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g")),(0,c.default)(y,"_reg",new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g")),(0,c.default)(y,"_splitToWordExps",new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g")),(0,c.default)(y,"includes",{}),(0,c.default)(y,"_clearCR",new RegExp("\r","g")),(0,c.default)(y,"_splitToWordExps3",new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g"))},30011:(t,e,i)=>{"use strict";var a=i(63978),n=i(56363);a(e,"__esModule",{value:!0}),e.ShaderNode=void 0;var r=n(i(78914)),s=n(i(87368)),l=n(i(28146)),o=n(i(17454)),u=i(93561),h=function(){function t(e){(0,s.default)(this,t),(0,o.default)(this,"childs",[]),(0,o.default)(this,"text",""),(0,o.default)(this,"useFuns",""),(0,o.default)(this,"z",0),this.includefiles=e}return(0,l.default)(t,[{key:"setParent",value:function(t){t.childs.push(this),this.z=t.z+1,this.parent=t}},{key:"setCondition",value:function(t,e){t&&(this.conditionType=e,t=t.replace(/(\s*$)/g,""),this.condition=function(){return this[t]},this.condition.__condition=t)}},{key:"toscript",value:function(e,i){return this._toscript(e,i,++t.__id)}},{key:"_toscript",value:function(t,e,i){var a;if(this.childs.length<1&&!this.text)return e;if(e.length,this.condition){var n=!!this.condition.call(t);if(this.conditionType===u.ILaya.ShaderCompile.IFDEF_ELSE&&(n=!n),!n)return e}if(this.noCompile&&this.text&&e.push(this.text),this.childs.length>0&&(0,r.default)(a=this.childs).call(a,(function(a,n,r){a._toscript(t,e,i)})),this.includefiles.length>0&&this.useFuns.length>0)for(var s,l=0,o=this.includefiles.length;l<o;l++)this.includefiles[l].curUseID!=i&&(s=this.includefiles[l].file.getFunsScript(this.useFuns)).length>0&&(this.includefiles[l].curUseID=i,e[0]=s+e[0]);return e}}]),t}();e.ShaderNode=h,(0,o.default)(h,"__id",1)},20786:(t,e,i)=>{"use strict";var a=i(1068),n=i(63978),r=i(56363);n(e,"__esModule",{value:!0}),e.VertexBuffer2D=void 0;var s=r(i(87368)),l=r(i(28146)),o=r(i(92135)),u=r(i(13383)),h=r(i(78310)),c=r(i(82669)),d=r(i(17454)),f=i(80510),_=i(54008),v=i(30904);var y=function(t){(0,u.default)(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=(0,c.default)(e);if(i){var r=(0,c.default)(this).constructor;t=a(n,arguments,r)}else t=n.apply(this,arguments);return(0,h.default)(this,t)});function r(t,e){var i;return(0,s.default)(this,r),(i=n.call(this))._vertexStride=t,i._bufferUsage=e,i._bufferType=_.LayaGL.instance.ARRAY_BUFFER,i._buffer=new ArrayBuffer(8),i._floatArray32=new Float32Array(i._buffer),i._uint32Array=new Uint32Array(i._buffer),i}return(0,l.default)(r,[{key:"vertexStride",get:function(){return this._vertexStride}},{key:"getFloat32Array",value:function(){return this._floatArray32}},{key:"appendArray",value:function(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+4*t.length),this.getFloat32Array().set(t,e),this._upload=!0}},{key:"_checkArrayUse",value:function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))}},{key:"deleteBuffer",value:function(){(0,o.default)((0,c.default)(r.prototype),"_disposeResource",this).call(this)}},{key:"_bindForVAO",value:function(){var t=_.LayaGL.instance;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){if(v.Buffer._bindedVertexBuffer!==this._glBuffer){var t=_.LayaGL.instance;return t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer),v.Buffer._bindedVertexBuffer=this._glBuffer,!0}return!1}},{key:"destroy",value:function(){(0,o.default)((0,c.default)(r.prototype),"destroy",this).call(this),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null}}]),r}(f.Buffer2D);e.VertexBuffer2D=y,(0,d.default)(y,"create",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35048;return new y(t,e)}))},46011:t=>{t.exports="precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=color.a;\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n}"},18962:t=>{t.exports="attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}"},1793:t=>{t.exports="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#if defined(GL_FRAGMENT_PRECISION_HIGH)// 原来的写法会被我们自己的解析流程处理，而我们的解析是不认内置宏的，导致被删掉，所以改成 if defined 了\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;\r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}"},13867:t=>{t.exports="/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n#ifdef MVP3D\n\tuniform mat4 u_MvpMatrix;\n#endif\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n\tvec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n\tpos=mmat*pos;\n#endif\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#ifdef MVP3D\n\tgl_Position=u_MvpMatrix*pos1;\n#else\n\tgl_Position=pos1;\n#endif\n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\t\n\tvec2 clpos = clipMatPos.xy;\n\t#ifdef WORLDMAT\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\n\t\tif(clipOff[0]>0.0){\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\n\t\t\tclpos.y+=mmat[3].y;\t//ty\n\t\t}\n\t#endif\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}"},45301:t=>{t.exports="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}"},50347:t=>{t.exports="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}"}}]);